const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/web-lnRWL8UI.js","assets/react-BWleWAQa.js","assets/supabase-Cx6s5QAw.js","assets/ChatPanel-Dfk8zaw2.js"])))=>i.map(i=>d[i]);
var ha=t=>{throw TypeError(t)};var lr=(t,e,s)=>e.has(t)||ha("Cannot "+s);var p=(t,e,s)=>(lr(t,e,"read from private field"),s?s.call(t):e.get(t)),ee=(t,e,s)=>e.has(t)?ha("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),U=(t,e,s,n)=>(lr(t,e,"write to private field"),n?n.call(t,s):e.set(t,s),s),ue=(t,e,s)=>(lr(t,e,"access private method"),s);var kn=(t,e,s,n)=>({set _(i){U(t,e,i,s)},get _(){return p(t,e,n)}});import{r as pu,b as gu,a as xu,c as d,u as qt,O as yu,L as we,d as bu,e as jt,f as fn,R as as,h as vu,i as Le,N as Js,B as wu}from"./react-BWleWAQa.js";import{c as ju}from"./supabase-Cx6s5QAw.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function s(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=s(i);fetch(i.href,o)}})();var cr={exports:{}},Bs={};var fa;function Nu(){if(fa)return Bs;fa=1;var t=pu(),e=Symbol.for("react.element"),s=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function a(c,l,u){var h,f={},m=null,g=null;u!==void 0&&(m=""+u),l.key!==void 0&&(m=""+l.key),l.ref!==void 0&&(g=l.ref);for(h in l)n.call(l,h)&&!o.hasOwnProperty(h)&&(f[h]=l[h]);if(c&&c.defaultProps)for(h in l=c.defaultProps,l)f[h]===void 0&&(f[h]=l[h]);return{$$typeof:e,type:c,key:m,ref:g,props:f,_owner:i.current}}return Bs.Fragment=s,Bs.jsx=a,Bs.jsxs=a,Bs}var ma;function Su(){return ma||(ma=1,cr.exports=Nu()),cr.exports}var r=Su(),Pn={},pa;function Cu(){if(pa)return Pn;pa=1;var t=gu();return Pn.createRoot=t.createRoot,Pn.hydrateRoot=t.hydrateRoot,Pn}var _u=Cu();const ku=xu(_u);var mn=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Pu={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},Mt,ri,al,Tu=(al=class{constructor(){ee(this,Mt,Pu);ee(this,ri,!1)}setTimeoutProvider(t){U(this,Mt,t)}setTimeout(t,e){return p(this,Mt).setTimeout(t,e)}clearTimeout(t){p(this,Mt).clearTimeout(t)}setInterval(t,e){return p(this,Mt).setInterval(t,e)}clearInterval(t){p(this,Mt).clearInterval(t)}},Mt=new WeakMap,ri=new WeakMap,al),Wt=new Tu;function Mu(t){setTimeout(t,0)}var os=typeof window>"u"||"Deno"in globalThis;function Qe(){}function Eu(t,e){return typeof t=="function"?t(e):t}function kr(t){return typeof t=="number"&&t>=0&&t!==1/0}function gl(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Ft(t,e){return typeof t=="function"?t(e):t}function rt(t,e){return typeof t=="function"?t(e):t}function ga(t,e){const{type:s="all",exact:n,fetchStatus:i,predicate:o,queryKey:a,stale:c}=t;if(a){if(n){if(e.queryHash!==ii(a,e.options))return!1}else if(!en(e.queryKey,a))return!1}if(s!=="all"){const l=e.isActive();if(s==="active"&&!l||s==="inactive"&&l)return!1}return!(typeof c=="boolean"&&e.isStale()!==c||i&&i!==e.state.fetchStatus||o&&!o(e))}function xa(t,e){const{exact:s,status:n,predicate:i,mutationKey:o}=t;if(o){if(!e.options.mutationKey)return!1;if(s){if(Zs(e.options.mutationKey)!==Zs(o))return!1}else if(!en(e.options.mutationKey,o))return!1}return!(n&&e.state.status!==n||i&&!i(e))}function ii(t,e){return(e?.queryKeyHashFn||Zs)(t)}function Zs(t){return JSON.stringify(t,(e,s)=>Tr(s)?Object.keys(s).sort().reduce((n,i)=>(n[i]=s[i],n),{}):s)}function en(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(s=>en(t[s],e[s])):!1}var Au=Object.prototype.hasOwnProperty;function xl(t,e){if(t===e)return t;const s=ya(t)&&ya(e);if(!s&&!(Tr(t)&&Tr(e)))return e;const i=(s?t:Object.keys(t)).length,o=s?e:Object.keys(e),a=o.length,c=s?new Array(a):{};let l=0;for(let u=0;u<a;u++){const h=s?u:o[u],f=t[h],m=e[h];if(f===m){c[h]=f,(s?u<i:Au.call(t,h))&&l++;continue}if(f===null||m===null||typeof f!="object"||typeof m!="object"){c[h]=m;continue}const g=xl(f,m);c[h]=g,g===f&&l++}return i===a&&l===i?t:c}function Pr(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const s in t)if(t[s]!==e[s])return!1;return!0}function ya(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Tr(t){if(!ba(t))return!1;const e=t.constructor;if(e===void 0)return!0;const s=e.prototype;return!(!ba(s)||!s.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function ba(t){return Object.prototype.toString.call(t)==="[object Object]"}function Ru(t){return new Promise(e=>{Wt.setTimeout(e,t)})}function Mr(t,e,s){return typeof s.structuralSharing=="function"?s.structuralSharing(t,e):s.structuralSharing!==!1?xl(t,e):e}function Du(t,e,s=0){const n=[...t,e];return s&&n.length>s?n.slice(1):n}function Lu(t,e,s=0){const n=[e,...t];return s&&n.length>s?n.slice(0,-1):n}var ai=Symbol();function yl(t,e){return!t.queryFn&&e?.initialPromise?()=>e.initialPromise:!t.queryFn||t.queryFn===ai?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function Ou(t,e){return typeof t=="function"?t(...e):!!t}var Yt,Et,xs,ol,Vu=(ol=class extends mn{constructor(){super();ee(this,Yt);ee(this,Et);ee(this,xs);U(this,xs,e=>{if(!os&&window.addEventListener){const s=()=>e();return window.addEventListener("visibilitychange",s,!1),()=>{window.removeEventListener("visibilitychange",s)}}})}onSubscribe(){p(this,Et)||this.setEventListener(p(this,xs))}onUnsubscribe(){var e;this.hasListeners()||((e=p(this,Et))==null||e.call(this),U(this,Et,void 0))}setEventListener(e){var s;U(this,xs,e),(s=p(this,Et))==null||s.call(this),U(this,Et,e(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(e){p(this,Yt)!==e&&(U(this,Yt,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(s=>{s(e)})}isFocused(){return typeof p(this,Yt)=="boolean"?p(this,Yt):globalThis.document?.visibilityState!=="hidden"}},Yt=new WeakMap,Et=new WeakMap,xs=new WeakMap,ol),oi=new Vu;function Er(){let t,e;const s=new Promise((i,o)=>{t=i,e=o});s.status="pending",s.catch(()=>{});function n(i){Object.assign(s,i),delete s.resolve,delete s.reject}return s.resolve=i=>{n({status:"fulfilled",value:i}),t(i)},s.reject=i=>{n({status:"rejected",reason:i}),e(i)},s}var Fu=Mu;function Iu(){let t=[],e=0,s=c=>{c()},n=c=>{c()},i=Fu;const o=c=>{e?t.push(c):i(()=>{s(c)})},a=()=>{const c=t;t=[],c.length&&i(()=>{n(()=>{c.forEach(l=>{s(l)})})})};return{batch:c=>{let l;e++;try{l=c()}finally{e--,e||a()}return l},batchCalls:c=>(...l)=>{o(()=>{c(...l)})},schedule:o,setNotifyFunction:c=>{s=c},setBatchNotifyFunction:c=>{n=c},setScheduler:c=>{i=c}}}var Be=Iu(),ys,At,bs,ll,$u=(ll=class extends mn{constructor(){super();ee(this,ys,!0);ee(this,At);ee(this,bs);U(this,bs,e=>{if(!os&&window.addEventListener){const s=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",s,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",n)}}})}onSubscribe(){p(this,At)||this.setEventListener(p(this,bs))}onUnsubscribe(){var e;this.hasListeners()||((e=p(this,At))==null||e.call(this),U(this,At,void 0))}setEventListener(e){var s;U(this,bs,e),(s=p(this,At))==null||s.call(this),U(this,At,e(this.setOnline.bind(this)))}setOnline(e){p(this,ys)!==e&&(U(this,ys,e),this.listeners.forEach(n=>{n(e)}))}isOnline(){return p(this,ys)}},ys=new WeakMap,At=new WeakMap,bs=new WeakMap,ll),In=new $u;function qu(t){return Math.min(1e3*2**t,3e4)}function bl(t){return(t??"online")==="online"?In.isOnline():!0}var Ar=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function vl(t){let e=!1,s=0,n;const i=Er(),o=()=>i.status!=="pending",a=w=>{if(!o()){const b=new Ar(w);m(b),t.onCancel?.(b)}},c=()=>{e=!0},l=()=>{e=!1},u=()=>oi.isFocused()&&(t.networkMode==="always"||In.isOnline())&&t.canRun(),h=()=>bl(t.networkMode)&&t.canRun(),f=w=>{o()||(n?.(),i.resolve(w))},m=w=>{o()||(n?.(),i.reject(w))},g=()=>new Promise(w=>{n=b=>{(o()||u())&&w(b)},t.onPause?.()}).then(()=>{n=void 0,o()||t.onContinue?.()}),x=()=>{if(o())return;let w;const b=s===0?t.initialPromise:void 0;try{w=b??t.fn()}catch(j){w=Promise.reject(j)}Promise.resolve(w).then(f).catch(j=>{if(o())return;const T=t.retry??(os?0:3),A=t.retryDelay??qu,D=typeof A=="function"?A(s,j):A,R=T===!0||typeof T=="number"&&s<T||typeof T=="function"&&T(s,j);if(e||!R){m(j);return}s++,t.onFail?.(s,j),Ru(D).then(()=>u()?void 0:g()).then(()=>{e?m(j):x()})})};return{promise:i,status:()=>i.status,cancel:a,continue:()=>(n?.(),i),cancelRetry:c,continueRetry:l,canStart:h,start:()=>(h()?x():g().then(x),i)}}var Xt,cl,wl=(cl=class{constructor(){ee(this,Xt)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),kr(this.gcTime)&&U(this,Xt,Wt.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(os?1/0:300*1e3))}clearGcTimeout(){p(this,Xt)&&(Wt.clearTimeout(p(this,Xt)),U(this,Xt,void 0))}},Xt=new WeakMap,cl),Jt,vs,nt,Zt,Ie,ln,es,at,gt,ul,Bu=(ul=class extends wl{constructor(e){super();ee(this,at);ee(this,Jt);ee(this,vs);ee(this,nt);ee(this,Zt);ee(this,Ie);ee(this,ln);ee(this,es);U(this,es,!1),U(this,ln,e.defaultOptions),this.setOptions(e.options),this.observers=[],U(this,Zt,e.client),U(this,nt,p(this,Zt).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,U(this,Jt,wa(this.options)),this.state=e.state??p(this,Jt),this.scheduleGc()}get meta(){return this.options.meta}get promise(){return p(this,Ie)?.promise}setOptions(e){if(this.options={...p(this,ln),...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const s=wa(this.options);s.data!==void 0&&(this.setState(va(s.data,s.dataUpdatedAt)),U(this,Jt,s))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&p(this,nt).remove(this)}setData(e,s){const n=Mr(this.state.data,e,this.options);return ue(this,at,gt).call(this,{data:n,type:"success",dataUpdatedAt:s?.updatedAt,manual:s?.manual}),n}setState(e,s){ue(this,at,gt).call(this,{type:"setState",state:e,setStateOptions:s})}cancel(e){const s=p(this,Ie)?.promise;return p(this,Ie)?.cancel(e),s?s.then(Qe).catch(Qe):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(p(this,Jt))}isActive(){return this.observers.some(e=>rt(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===ai||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>Ft(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!gl(this.state.dataUpdatedAt,e)}onFocus(){this.observers.find(s=>s.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),p(this,Ie)?.continue()}onOnline(){this.observers.find(s=>s.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),p(this,Ie)?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),p(this,nt).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(s=>s!==e),this.observers.length||(p(this,Ie)&&(p(this,es)?p(this,Ie).cancel({revert:!0}):p(this,Ie).cancelRetry()),this.scheduleGc()),p(this,nt).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||ue(this,at,gt).call(this,{type:"invalidate"})}async fetch(e,s){if(this.state.fetchStatus!=="idle"&&p(this,Ie)?.status()!=="rejected"){if(this.state.data!==void 0&&s?.cancelRefetch)this.cancel({silent:!0});else if(p(this,Ie))return p(this,Ie).continueRetry(),p(this,Ie).promise}if(e&&this.setOptions(e),!this.options.queryFn){const l=this.observers.find(u=>u.options.queryFn);l&&this.setOptions(l.options)}const n=new AbortController,i=l=>{Object.defineProperty(l,"signal",{enumerable:!0,get:()=>(U(this,es,!0),n.signal)})},o=()=>{const l=yl(this.options,s),h=(()=>{const f={client:p(this,Zt),queryKey:this.queryKey,meta:this.meta};return i(f),f})();return U(this,es,!1),this.options.persister?this.options.persister(l,h,this):l(h)},c=(()=>{const l={fetchOptions:s,options:this.options,queryKey:this.queryKey,client:p(this,Zt),state:this.state,fetchFn:o};return i(l),l})();this.options.behavior?.onFetch(c,this),U(this,vs,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==c.fetchOptions?.meta)&&ue(this,at,gt).call(this,{type:"fetch",meta:c.fetchOptions?.meta}),U(this,Ie,vl({initialPromise:s?.initialPromise,fn:c.fetchFn,onCancel:l=>{l instanceof Ar&&l.revert&&this.setState({...p(this,vs),fetchStatus:"idle"}),n.abort()},onFail:(l,u)=>{ue(this,at,gt).call(this,{type:"failed",failureCount:l,error:u})},onPause:()=>{ue(this,at,gt).call(this,{type:"pause"})},onContinue:()=>{ue(this,at,gt).call(this,{type:"continue"})},retry:c.options.retry,retryDelay:c.options.retryDelay,networkMode:c.options.networkMode,canRun:()=>!0}));try{const l=await p(this,Ie).start();if(l===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(l),p(this,nt).config.onSuccess?.(l,this),p(this,nt).config.onSettled?.(l,this.state.error,this),l}catch(l){if(l instanceof Ar){if(l.silent)return p(this,Ie).promise;if(l.revert){if(this.state.data===void 0)throw l;return this.state.data}}throw ue(this,at,gt).call(this,{type:"error",error:l}),p(this,nt).config.onError?.(l,this),p(this,nt).config.onSettled?.(this.state.data,l,this),l}finally{this.scheduleGc()}}},Jt=new WeakMap,vs=new WeakMap,nt=new WeakMap,Zt=new WeakMap,Ie=new WeakMap,ln=new WeakMap,es=new WeakMap,at=new WeakSet,gt=function(e){const s=n=>{switch(e.type){case"failed":return{...n,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...jl(n.data,this.options),fetchMeta:e.meta??null};case"success":const i={...n,...va(e.data,e.dataUpdatedAt),dataUpdateCount:n.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return U(this,vs,e.manual?i:void 0),i;case"error":const o=e.error;return{...n,error:o,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...e.state}}};this.state=s(this.state),Be.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),p(this,nt).notify({query:this,type:"updated",action:e})})},ul);function jl(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:bl(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function va(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function wa(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,s=e!==void 0,n=s?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:s?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}var We,de,cn,Ke,ts,ws,xt,Rt,un,js,Ns,ss,ns,Dt,Ss,ge,Gs,Rr,Dr,Lr,Or,Vr,Fr,Ir,Nl,dl,Uu=(dl=class extends mn{constructor(e,s){super();ee(this,ge);ee(this,We);ee(this,de);ee(this,cn);ee(this,Ke);ee(this,ts);ee(this,ws);ee(this,xt);ee(this,Rt);ee(this,un);ee(this,js);ee(this,Ns);ee(this,ss);ee(this,ns);ee(this,Dt);ee(this,Ss,new Set);this.options=s,U(this,We,e),U(this,Rt,null),U(this,xt,Er()),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(p(this,de).addObserver(this),ja(p(this,de),this.options)?ue(this,ge,Gs).call(this):this.updateResult(),ue(this,ge,Or).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return $r(p(this,de),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return $r(p(this,de),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,ue(this,ge,Vr).call(this),ue(this,ge,Fr).call(this),p(this,de).removeObserver(this)}setOptions(e){const s=this.options,n=p(this,de);if(this.options=p(this,We).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof rt(this.options.enabled,p(this,de))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");ue(this,ge,Ir).call(this),p(this,de).setOptions(this.options),s._defaulted&&!Pr(this.options,s)&&p(this,We).getQueryCache().notify({type:"observerOptionsUpdated",query:p(this,de),observer:this});const i=this.hasListeners();i&&Na(p(this,de),n,this.options,s)&&ue(this,ge,Gs).call(this),this.updateResult(),i&&(p(this,de)!==n||rt(this.options.enabled,p(this,de))!==rt(s.enabled,p(this,de))||Ft(this.options.staleTime,p(this,de))!==Ft(s.staleTime,p(this,de)))&&ue(this,ge,Rr).call(this);const o=ue(this,ge,Dr).call(this);i&&(p(this,de)!==n||rt(this.options.enabled,p(this,de))!==rt(s.enabled,p(this,de))||o!==p(this,Dt))&&ue(this,ge,Lr).call(this,o)}getOptimisticResult(e){const s=p(this,We).getQueryCache().build(p(this,We),e),n=this.createResult(s,e);return zu(this,n)&&(U(this,Ke,n),U(this,ws,this.options),U(this,ts,p(this,de).state)),n}getCurrentResult(){return p(this,Ke)}trackResult(e,s){return new Proxy(e,{get:(n,i)=>(this.trackProp(i),s?.(i),i==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&p(this,xt).status==="pending"&&p(this,xt).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,i))})}trackProp(e){p(this,Ss).add(e)}getCurrentQuery(){return p(this,de)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const s=p(this,We).defaultQueryOptions(e),n=p(this,We).getQueryCache().build(p(this,We),s);return n.fetch().then(()=>this.createResult(n,s))}fetch(e){return ue(this,ge,Gs).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),p(this,Ke)))}createResult(e,s){const n=p(this,de),i=this.options,o=p(this,Ke),a=p(this,ts),c=p(this,ws),u=e!==n?e.state:p(this,cn),{state:h}=e;let f={...h},m=!1,g;if(s._optimisticResults){const L=this.hasListeners(),I=!L&&ja(e,s),Z=L&&Na(e,n,s,i);(I||Z)&&(f={...f,...jl(h.data,e.options)}),s._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:x,errorUpdatedAt:w,status:b}=f;g=f.data;let j=!1;if(s.placeholderData!==void 0&&g===void 0&&b==="pending"){let L;o?.isPlaceholderData&&s.placeholderData===c?.placeholderData?(L=o.data,j=!0):L=typeof s.placeholderData=="function"?s.placeholderData(p(this,Ns)?.state.data,p(this,Ns)):s.placeholderData,L!==void 0&&(b="success",g=Mr(o?.data,L,s),m=!0)}if(s.select&&g!==void 0&&!j)if(o&&g===a?.data&&s.select===p(this,un))g=p(this,js);else try{U(this,un,s.select),g=s.select(g),g=Mr(o?.data,g,s),U(this,js,g),U(this,Rt,null)}catch(L){U(this,Rt,L)}p(this,Rt)&&(x=p(this,Rt),g=p(this,js),w=Date.now(),b="error");const T=f.fetchStatus==="fetching",A=b==="pending",D=b==="error",R=A&&T,B=g!==void 0,S={status:b,fetchStatus:f.fetchStatus,isPending:A,isSuccess:b==="success",isError:D,isInitialLoading:R,isLoading:R,data:g,dataUpdatedAt:f.dataUpdatedAt,error:x,errorUpdatedAt:w,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>u.dataUpdateCount||f.errorUpdateCount>u.errorUpdateCount,isFetching:T,isRefetching:T&&!A,isLoadingError:D&&!B,isPaused:f.fetchStatus==="paused",isPlaceholderData:m,isRefetchError:D&&B,isStale:li(e,s),refetch:this.refetch,promise:p(this,xt),isEnabled:rt(s.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const L=q=>{S.status==="error"?q.reject(S.error):S.data!==void 0&&q.resolve(S.data)},I=()=>{const q=U(this,xt,S.promise=Er());L(q)},Z=p(this,xt);switch(Z.status){case"pending":e.queryHash===n.queryHash&&L(Z);break;case"fulfilled":(S.status==="error"||S.data!==Z.value)&&I();break;case"rejected":(S.status!=="error"||S.error!==Z.reason)&&I();break}}return S}updateResult(){const e=p(this,Ke),s=this.createResult(p(this,de),this.options);if(U(this,ts,p(this,de).state),U(this,ws,this.options),p(this,ts).data!==void 0&&U(this,Ns,p(this,de)),Pr(s,e))return;U(this,Ke,s);const n=()=>{if(!e)return!0;const{notifyOnChangeProps:i}=this.options,o=typeof i=="function"?i():i;if(o==="all"||!o&&!p(this,Ss).size)return!0;const a=new Set(o??p(this,Ss));return this.options.throwOnError&&a.add("error"),Object.keys(p(this,Ke)).some(c=>{const l=c;return p(this,Ke)[l]!==e[l]&&a.has(l)})};ue(this,ge,Nl).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&ue(this,ge,Or).call(this)}},We=new WeakMap,de=new WeakMap,cn=new WeakMap,Ke=new WeakMap,ts=new WeakMap,ws=new WeakMap,xt=new WeakMap,Rt=new WeakMap,un=new WeakMap,js=new WeakMap,Ns=new WeakMap,ss=new WeakMap,ns=new WeakMap,Dt=new WeakMap,Ss=new WeakMap,ge=new WeakSet,Gs=function(e){ue(this,ge,Ir).call(this);let s=p(this,de).fetch(this.options,e);return e?.throwOnError||(s=s.catch(Qe)),s},Rr=function(){ue(this,ge,Vr).call(this);const e=Ft(this.options.staleTime,p(this,de));if(os||p(this,Ke).isStale||!kr(e))return;const n=gl(p(this,Ke).dataUpdatedAt,e)+1;U(this,ss,Wt.setTimeout(()=>{p(this,Ke).isStale||this.updateResult()},n))},Dr=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(p(this,de)):this.options.refetchInterval)??!1},Lr=function(e){ue(this,ge,Fr).call(this),U(this,Dt,e),!(os||rt(this.options.enabled,p(this,de))===!1||!kr(p(this,Dt))||p(this,Dt)===0)&&U(this,ns,Wt.setInterval(()=>{(this.options.refetchIntervalInBackground||oi.isFocused())&&ue(this,ge,Gs).call(this)},p(this,Dt)))},Or=function(){ue(this,ge,Rr).call(this),ue(this,ge,Lr).call(this,ue(this,ge,Dr).call(this))},Vr=function(){p(this,ss)&&(Wt.clearTimeout(p(this,ss)),U(this,ss,void 0))},Fr=function(){p(this,ns)&&(Wt.clearInterval(p(this,ns)),U(this,ns,void 0))},Ir=function(){const e=p(this,We).getQueryCache().build(p(this,We),this.options);if(e===p(this,de))return;const s=p(this,de);U(this,de,e),U(this,cn,e.state),this.hasListeners()&&(s?.removeObserver(this),e.addObserver(this))},Nl=function(e){Be.batch(()=>{e.listeners&&this.listeners.forEach(s=>{s(p(this,Ke))}),p(this,We).getQueryCache().notify({query:p(this,de),type:"observerResultsUpdated"})})},dl);function Gu(t,e){return rt(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function ja(t,e){return Gu(t,e)||t.state.data!==void 0&&$r(t,e,e.refetchOnMount)}function $r(t,e,s){if(rt(e.enabled,t)!==!1&&Ft(e.staleTime,t)!=="static"){const n=typeof s=="function"?s(t):s;return n==="always"||n!==!1&&li(t,e)}return!1}function Na(t,e,s,n){return(t!==e||rt(n.enabled,t)===!1)&&(!s.suspense||t.state.status!=="error")&&li(t,s)}function li(t,e){return rt(e.enabled,t)!==!1&&t.isStaleByTime(Ft(e.staleTime,t))}function zu(t,e){return!Pr(t.getCurrentResult(),e)}function Sa(t){return{onFetch:(e,s)=>{const n=e.options,i=e.fetchOptions?.meta?.fetchMore?.direction,o=e.state.data?.pages||[],a=e.state.data?.pageParams||[];let c={pages:[],pageParams:[]},l=0;const u=async()=>{let h=!1;const f=x=>{Object.defineProperty(x,"signal",{enumerable:!0,get:()=>(e.signal.aborted?h=!0:e.signal.addEventListener("abort",()=>{h=!0}),e.signal)})},m=yl(e.options,e.fetchOptions),g=async(x,w,b)=>{if(h)return Promise.reject();if(w==null&&x.pages.length)return Promise.resolve(x);const T=(()=>{const B={client:e.client,queryKey:e.queryKey,pageParam:w,direction:b?"backward":"forward",meta:e.options.meta};return f(B),B})(),A=await m(T),{maxPages:D}=e.options,R=b?Lu:Du;return{pages:R(x.pages,A,D),pageParams:R(x.pageParams,w,D)}};if(i&&o.length){const x=i==="backward",w=x?Ku:Ca,b={pages:o,pageParams:a},j=w(n,b);c=await g(b,j,x)}else{const x=t??o.length;do{const w=l===0?a[0]??n.initialPageParam:Ca(n,c);if(l>0&&w==null)break;c=await g(c,w),l++}while(l<x)}return c};e.options.persister?e.fetchFn=()=>e.options.persister?.(u,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},s):e.fetchFn=u}}}function Ca(t,{pages:e,pageParams:s}){const n=e.length-1;return e.length>0?t.getNextPageParam(e[n],e,s[n],s):void 0}function Ku(t,{pages:e,pageParams:s}){return e.length>0?t.getPreviousPageParam?.(e[0],e,s[0],s):void 0}var dn,dt,He,rs,ht,Pt,hl,Hu=(hl=class extends wl{constructor(e){super();ee(this,ht);ee(this,dn);ee(this,dt);ee(this,He);ee(this,rs);U(this,dn,e.client),this.mutationId=e.mutationId,U(this,He,e.mutationCache),U(this,dt,[]),this.state=e.state||Wu(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){p(this,dt).includes(e)||(p(this,dt).push(e),this.clearGcTimeout(),p(this,He).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){U(this,dt,p(this,dt).filter(s=>s!==e)),this.scheduleGc(),p(this,He).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){p(this,dt).length||(this.state.status==="pending"?this.scheduleGc():p(this,He).remove(this))}continue(){return p(this,rs)?.continue()??this.execute(this.state.variables)}async execute(e){const s=()=>{ue(this,ht,Pt).call(this,{type:"continue"})},n={client:p(this,dn),meta:this.options.meta,mutationKey:this.options.mutationKey};U(this,rs,vl({fn:()=>this.options.mutationFn?this.options.mutationFn(e,n):Promise.reject(new Error("No mutationFn found")),onFail:(a,c)=>{ue(this,ht,Pt).call(this,{type:"failed",failureCount:a,error:c})},onPause:()=>{ue(this,ht,Pt).call(this,{type:"pause"})},onContinue:s,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>p(this,He).canRun(this)}));const i=this.state.status==="pending",o=!p(this,rs).canStart();try{if(i)s();else{ue(this,ht,Pt).call(this,{type:"pending",variables:e,isPaused:o}),await p(this,He).config.onMutate?.(e,this,n);const c=await this.options.onMutate?.(e,n);c!==this.state.context&&ue(this,ht,Pt).call(this,{type:"pending",context:c,variables:e,isPaused:o})}const a=await p(this,rs).start();return await p(this,He).config.onSuccess?.(a,e,this.state.context,this,n),await this.options.onSuccess?.(a,e,this.state.context,n),await p(this,He).config.onSettled?.(a,null,this.state.variables,this.state.context,this,n),await this.options.onSettled?.(a,null,e,this.state.context,n),ue(this,ht,Pt).call(this,{type:"success",data:a}),a}catch(a){try{throw await p(this,He).config.onError?.(a,e,this.state.context,this,n),await this.options.onError?.(a,e,this.state.context,n),await p(this,He).config.onSettled?.(void 0,a,this.state.variables,this.state.context,this,n),await this.options.onSettled?.(void 0,a,e,this.state.context,n),a}finally{ue(this,ht,Pt).call(this,{type:"error",error:a})}}finally{p(this,He).runNext(this)}}},dn=new WeakMap,dt=new WeakMap,He=new WeakMap,rs=new WeakMap,ht=new WeakSet,Pt=function(e){const s=n=>{switch(e.type){case"failed":return{...n,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...n,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:e.error,failureCount:n.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=s(this.state),Be.batch(()=>{p(this,dt).forEach(n=>{n.onMutationUpdate(e)}),p(this,He).notify({mutation:this,type:"updated",action:e})})},hl);function Wu(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var yt,ot,hn,fl,Qu=(fl=class extends mn{constructor(e={}){super();ee(this,yt);ee(this,ot);ee(this,hn);this.config=e,U(this,yt,new Set),U(this,ot,new Map),U(this,hn,0)}build(e,s,n){const i=new Hu({client:e,mutationCache:this,mutationId:++kn(this,hn)._,options:e.defaultMutationOptions(s),state:n});return this.add(i),i}add(e){p(this,yt).add(e);const s=Tn(e);if(typeof s=="string"){const n=p(this,ot).get(s);n?n.push(e):p(this,ot).set(s,[e])}this.notify({type:"added",mutation:e})}remove(e){if(p(this,yt).delete(e)){const s=Tn(e);if(typeof s=="string"){const n=p(this,ot).get(s);if(n)if(n.length>1){const i=n.indexOf(e);i!==-1&&n.splice(i,1)}else n[0]===e&&p(this,ot).delete(s)}}this.notify({type:"removed",mutation:e})}canRun(e){const s=Tn(e);if(typeof s=="string"){const i=p(this,ot).get(s)?.find(o=>o.state.status==="pending");return!i||i===e}else return!0}runNext(e){const s=Tn(e);return typeof s=="string"?p(this,ot).get(s)?.find(i=>i!==e&&i.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){Be.batch(()=>{p(this,yt).forEach(e=>{this.notify({type:"removed",mutation:e})}),p(this,yt).clear(),p(this,ot).clear()})}getAll(){return Array.from(p(this,yt))}find(e){const s={exact:!0,...e};return this.getAll().find(n=>xa(s,n))}findAll(e={}){return this.getAll().filter(s=>xa(e,s))}notify(e){Be.batch(()=>{this.listeners.forEach(s=>{s(e)})})}resumePausedMutations(){const e=this.getAll().filter(s=>s.state.isPaused);return Be.batch(()=>Promise.all(e.map(s=>s.continue().catch(Qe))))}},yt=new WeakMap,ot=new WeakMap,hn=new WeakMap,fl);function Tn(t){return t.options.scope?.id}var ft,ml,Yu=(ml=class extends mn{constructor(e={}){super();ee(this,ft);this.config=e,U(this,ft,new Map)}build(e,s,n){const i=s.queryKey,o=s.queryHash??ii(i,s);let a=this.get(o);return a||(a=new Bu({client:e,queryKey:i,queryHash:o,options:e.defaultQueryOptions(s),state:n,defaultOptions:e.getQueryDefaults(i)}),this.add(a)),a}add(e){p(this,ft).has(e.queryHash)||(p(this,ft).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const s=p(this,ft).get(e.queryHash);s&&(e.destroy(),s===e&&p(this,ft).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Be.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return p(this,ft).get(e)}getAll(){return[...p(this,ft).values()]}find(e){const s={exact:!0,...e};return this.getAll().find(n=>ga(s,n))}findAll(e={}){const s=this.getAll();return Object.keys(e).length>0?s.filter(n=>ga(e,n)):s}notify(e){Be.batch(()=>{this.listeners.forEach(s=>{s(e)})})}onFocus(){Be.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Be.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},ft=new WeakMap,ml),_e,Lt,Ot,Cs,_s,Vt,ks,Ps,pl,Xu=(pl=class{constructor(t={}){ee(this,_e);ee(this,Lt);ee(this,Ot);ee(this,Cs);ee(this,_s);ee(this,Vt);ee(this,ks);ee(this,Ps);U(this,_e,t.queryCache||new Yu),U(this,Lt,t.mutationCache||new Qu),U(this,Ot,t.defaultOptions||{}),U(this,Cs,new Map),U(this,_s,new Map),U(this,Vt,0)}mount(){kn(this,Vt)._++,p(this,Vt)===1&&(U(this,ks,oi.subscribe(async t=>{t&&(await this.resumePausedMutations(),p(this,_e).onFocus())})),U(this,Ps,In.subscribe(async t=>{t&&(await this.resumePausedMutations(),p(this,_e).onOnline())})))}unmount(){var t,e;kn(this,Vt)._--,p(this,Vt)===0&&((t=p(this,ks))==null||t.call(this),U(this,ks,void 0),(e=p(this,Ps))==null||e.call(this),U(this,Ps,void 0))}isFetching(t){return p(this,_e).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return p(this,Lt).findAll({...t,status:"pending"}).length}getQueryData(t){const e=this.defaultQueryOptions({queryKey:t});return p(this,_e).get(e.queryHash)?.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),s=p(this,_e).build(this,e),n=s.state.data;return n===void 0?this.fetchQuery(t):(t.revalidateIfStale&&s.isStaleByTime(Ft(e.staleTime,s))&&this.prefetchQuery(e),Promise.resolve(n))}getQueriesData(t){return p(this,_e).findAll(t).map(({queryKey:e,state:s})=>{const n=s.data;return[e,n]})}setQueryData(t,e,s){const n=this.defaultQueryOptions({queryKey:t}),o=p(this,_e).get(n.queryHash)?.state.data,a=Eu(e,o);if(a!==void 0)return p(this,_e).build(this,n).setData(a,{...s,manual:!0})}setQueriesData(t,e,s){return Be.batch(()=>p(this,_e).findAll(t).map(({queryKey:n})=>[n,this.setQueryData(n,e,s)]))}getQueryState(t){const e=this.defaultQueryOptions({queryKey:t});return p(this,_e).get(e.queryHash)?.state}removeQueries(t){const e=p(this,_e);Be.batch(()=>{e.findAll(t).forEach(s=>{e.remove(s)})})}resetQueries(t,e){const s=p(this,_e);return Be.batch(()=>(s.findAll(t).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const s={revert:!0,...e},n=Be.batch(()=>p(this,_e).findAll(t).map(i=>i.cancel(s)));return Promise.all(n).then(Qe).catch(Qe)}invalidateQueries(t,e={}){return Be.batch(()=>(p(this,_e).findAll(t).forEach(s=>{s.invalidate()}),t?.refetchType==="none"?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},e)))}refetchQueries(t,e={}){const s={...e,cancelRefetch:e.cancelRefetch??!0},n=Be.batch(()=>p(this,_e).findAll(t).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let o=i.fetch(void 0,s);return s.throwOnError||(o=o.catch(Qe)),i.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(n).then(Qe)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const s=p(this,_e).build(this,e);return s.isStaleByTime(Ft(e.staleTime,s))?s.fetch(e):Promise.resolve(s.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Qe).catch(Qe)}fetchInfiniteQuery(t){return t.behavior=Sa(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Qe).catch(Qe)}ensureInfiniteQueryData(t){return t.behavior=Sa(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return In.isOnline()?p(this,Lt).resumePausedMutations():Promise.resolve()}getQueryCache(){return p(this,_e)}getMutationCache(){return p(this,Lt)}getDefaultOptions(){return p(this,Ot)}setDefaultOptions(t){U(this,Ot,t)}setQueryDefaults(t,e){p(this,Cs).set(Zs(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...p(this,Cs).values()],s={};return e.forEach(n=>{en(t,n.queryKey)&&Object.assign(s,n.defaultOptions)}),s}setMutationDefaults(t,e){p(this,_s).set(Zs(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...p(this,_s).values()],s={};return e.forEach(n=>{en(t,n.mutationKey)&&Object.assign(s,n.defaultOptions)}),s}defaultQueryOptions(t){if(t._defaulted)return t;const e={...p(this,Ot).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=ii(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===ai&&(e.enabled=!1),e}defaultMutationOptions(t){return t?._defaulted?t:{...p(this,Ot).mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){p(this,_e).clear(),p(this,Lt).clear()}},_e=new WeakMap,Lt=new WeakMap,Ot=new WeakMap,Cs=new WeakMap,_s=new WeakMap,Vt=new WeakMap,ks=new WeakMap,Ps=new WeakMap,pl),Sl=d.createContext(void 0),Ju=t=>{const e=d.useContext(Sl);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},Zu=({client:t,children:e})=>(d.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),r.jsx(Sl.Provider,{value:t,children:e})),Cl=d.createContext(!1),ed=()=>d.useContext(Cl);Cl.Provider;function td(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var sd=d.createContext(td()),nd=()=>d.useContext(sd),rd=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},id=t=>{d.useEffect(()=>{t.clearReset()},[t])},ad=({result:t,errorResetBoundary:e,throwOnError:s,query:n,suspense:i})=>t.isError&&!e.isReset()&&!t.isFetching&&n&&(i&&t.data===void 0||Ou(s,[t.error,n])),od=t=>{if(t.suspense){const s=i=>i==="static"?i:Math.max(i??1e3,1e3),n=t.staleTime;t.staleTime=typeof n=="function"?(...i)=>s(n(...i)):s(n),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},ld=(t,e)=>t.isLoading&&t.isFetching&&!e,cd=(t,e)=>t?.suspense&&e.isPending,_a=(t,e,s)=>e.fetchOptimistic(t).catch(()=>{s.clearReset()});function ud(t,e,s){const n=ed(),i=nd(),o=Ju(),a=o.defaultQueryOptions(t);o.getDefaultOptions().queries?._experimental_beforeQuery?.(a),a._optimisticResults=n?"isRestoring":"optimistic",od(a),rd(a,i),id(i);const c=!o.getQueryCache().get(a.queryHash),[l]=d.useState(()=>new e(o,a)),u=l.getOptimisticResult(a),h=!n&&t.subscribed!==!1;if(d.useSyncExternalStore(d.useCallback(f=>{const m=h?l.subscribe(Be.batchCalls(f)):Qe;return l.updateResult(),m},[l,h]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),d.useEffect(()=>{l.setOptions(a)},[a,l]),cd(a,u))throw _a(a,l,i);if(ad({result:u,errorResetBoundary:i,throwOnError:a.throwOnError,query:o.getQueryCache().get(a.queryHash),suspense:a.suspense}))throw u.error;return o.getDefaultOptions().queries?._experimental_afterQuery?.(a,u),a.experimental_prefetchInRender&&!os&&ld(u,n)&&(c?_a(a,l,i):o.getQueryCache().get(a.queryHash)?.promise)?.catch(Qe).finally(()=>{l.updateResult()}),a.notifyOnChangeProps?u:l.trackResult(u)}function dd(t,e){return ud(t,Uu)}const v=ju("https://jjotzbghqifpnaldiyfp.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impqb3R6YmdocWlmcG5hbGRpeWZwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ3NzM4NTcsImV4cCI6MjA4MDM0OTg1N30.eaivVRDPFmXzw_9DLaymXj_MJS_Jewj1DAZ-9NAonHs",{auth:{persistSession:!0,autoRefreshToken:!0}});const hd=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),fd=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,s,n)=>n?n.toUpperCase():s.toLowerCase()),ka=t=>{const e=fd(t);return e.charAt(0).toUpperCase()+e.slice(1)},_l=(...t)=>t.filter((e,s,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===s).join(" ").trim(),md=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var pd={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const gd=d.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:s=2,absoluteStrokeWidth:n,className:i="",children:o,iconNode:a,...c},l)=>d.createElement("svg",{ref:l,...pd,width:e,height:e,stroke:t,strokeWidth:n?Number(s)*24/Number(e):s,className:_l("lucide",i),...!o&&!md(c)&&{"aria-hidden":"true"},...c},[...a.map(([u,h])=>d.createElement(u,h)),...Array.isArray(o)?o:[o]]));const he=(t,e)=>{const s=d.forwardRef(({className:n,...i},o)=>d.createElement(gd,{ref:o,iconNode:e,className:_l(`lucide-${hd(ka(t))}`,`lucide-${t}`,n),...i}));return s.displayName=ka(t),s};const xd=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Ts=he("arrow-left",xd);const yd=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],bd=he("bell",yd);const vd=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],kl=he("calendar",vd);const wd=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Pa=he("check",wd);const jd=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Pl=he("chevron-down",jd);const Nd=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Sd=he("chevron-left",Nd);const Cd=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Tl=he("chevron-up",Cd);const _d=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Ta=he("circle-alert",_d);const kd=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Pd=he("circle-question-mark",kd);const Td=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ci=he("clock",Td);const Md=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ed=he("compass",Md);const Ad=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Rd=he("funnel",Ad);const Dd=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Ld=he("globe",Dd);const Od=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],Ma=he("heart",Od);const Vd=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],Fd=he("lock-open",Vd);const Id=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],$d=he("log-out",Id);const qd=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Bd=he("mail",qd);const Ud=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],tn=he("map-pin",Ud);const Gd=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Ml=he("message-circle",Gd);const zd=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],$n=he("message-square",zd);const Kd=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Hd=he("pen",Kd);const Wd=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],qr=he("plus",Wd);const Qd=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ui=he("search",Qd);const Yd=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Xd=he("send",Yd);const Jd=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Zd=he("share-2",Jd);const eh=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Ea=he("square-check-big",eh);const th=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],sh=he("tag",th);const nh=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],rh=he("trash-2",nh);const ih=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ah=he("triangle-alert",ih);const oh=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],lh=he("user-check",oh);const ch=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],uh=he("user-minus",ch);const dh=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],El=he("user-plus",dh);const hh=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],fh=he("user",hh);const mh=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Ds=he("users",mh);const ph=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ln=he("x",ph);function gh(){const e=qt().pathname,s=i=>e===i||e.startsWith(`${i}/`),n=i=>`flex flex-col items-center p-2 transition-transform duration-150 ease-in-out active:scale-90 ${s(i)?"text-black scale-105 font-semibold":"text-gray-400 hover:text-gray-600"}`;return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"pb-[calc(64px+env(safe-area-inset-bottom))]",children:r.jsx(yu,{})}),r.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-[100] border-t border-gray-200 bg-white/95 backdrop-blur-lg pb-[env(safe-area-inset-bottom)]",children:r.jsxs("div",{className:"mx-auto flex h-16 max-w-md items-center justify-around px-2",children:[r.jsxs(we,{to:"/chats",className:n("/chats"),children:[r.jsx($n,{className:"h-6 w-6"}),r.jsx("span",{className:"text-[10px] font-medium",children:"Chats"})]}),r.jsxs(we,{to:"/groups",className:n("/groups"),children:[r.jsx(Ds,{className:"h-6 w-6"}),r.jsx("span",{className:"text-[10px] font-medium",children:"Groups"})]}),r.jsxs(we,{to:"/browse",className:n("/browse"),children:[r.jsx("div",{className:`rounded-full p-1 -mt-1 transition-colors ${s("/browse")?"bg-gray-100":""}`,children:r.jsx(Ed,{className:"h-7 w-7"})}),r.jsx("span",{className:"text-[10px] font-medium",children:"Browse"})]}),r.jsxs(we,{to:"/notifications",className:n("/notifications"),children:[r.jsx(bd,{className:"h-6 w-6"}),r.jsx("span",{className:"text-[10px] font-medium",children:"Activity"})]}),r.jsxs(we,{to:"/profile",className:n("/profile"),children:[r.jsx(fh,{className:"h-6 w-6"}),r.jsx("span",{className:"text-[10px] font-medium",children:"Profile"})]})]})})]})}function Al(t){return dd({queryKey:["profile",t],enabled:!!t,queryFn:async()=>{if(!t)throw new Error("No user ID");const e=await v.from("profiles").select("*").eq("user_id",t).maybeSingle();if(e.error&&e.error.code!=="PGRST116")throw e.error;let s=e.data;if(!s){const o=await v.from("profiles").insert({user_id:t,name:"",onboarded:!1}).select("*").single();if(o.error)throw o.error;s=o.data}const[n,i]=await Promise.all([v.from("group_members").select("group_id",{count:"exact",head:!0}).eq("user_id",t).in("role",["owner","host"]).in("status",["active","accepted"]),v.from("group_members").select("group_id",{count:"exact",head:!0}).eq("user_id",t).in("status",["active","accepted"])]);return{id:t,name:s.name||"",avatar_url:s.avatar_url,city:s.city,rating_avg:s.rating_avg||0,rating_count:s.rating_count||0,groups_created:n.count||0,groups_joined:i.count||0,onboarded:!!s.onboarded}}})}const xh=["All","Games","Study","Outdoors"],Aa=[{id:"hokm",name:"Hokm",blurb:"Classic Persian card game",tag:"Games",online:120,groups:8,image:"ğŸ´"},{id:"takhtenard",name:"Takhte Nard",blurb:"Traditional backgammon",tag:"Games",online:95,groups:6,image:"ğŸ²"},{id:"mafia",name:"Mafia",blurb:"Social deduction party game",tag:"Games",online:210,groups:12,image:"ğŸ•µï¸"},{id:"mono",name:"Monopoly",blurb:"Buy, sell, and trade properties",tag:"Games",online:180,groups:10,image:"ğŸ’°"},{id:"uno",name:"Uno",blurb:"Colorful card matching fun",tag:"Games",online:250,groups:15,image:"ğŸƒ"},{id:"chess",name:"Chess",blurb:"Classic strategy board game",tag:"Games",online:130,groups:9,image:"â™Ÿï¸"},{id:"mathematics",name:"Mathematics",blurb:"Study numbers",tag:"Study",online:75,groups:5,image:"ğŸ“"},{id:"biology",name:"Biology",blurb:"Explore life sciences",tag:"Study",online:60,groups:4,image:"ğŸ§¬"},{id:"chemistry",name:"Chemistry",blurb:"Chemicals and reactions",tag:"Study",online:50,groups:3,image:"âš—ï¸"},{id:"history",name:"History",blurb:"Past events and cultures",tag:"Study",online:45,groups:3,image:"ğŸ“œ"},{id:"hiking",name:"Hiking",blurb:"Join a hike up the mountain",tag:"Outdoors",online:40,groups:3,image:"â›°ï¸"},{id:"visit",name:"Visiting",blurb:"Cultural and city visits",tag:"Outdoors",online:55,groups:4,image:"ğŸ›ï¸"},{id:"camp",name:"Camping",blurb:"Overnight outdoor trips",tag:"Outdoors",online:35,groups:2,image:"ğŸ•ï¸"},{id:"kayak",name:"Kayaking",blurb:"Water adventures",tag:"Outdoors",online:30,groups:2,image:"ğŸ›¶"}];function yh(){const[t,e]=bu(),s=t.get("id"),n=t.get("code"),[i,o]=d.useState(t.get("q")??""),[a,c]=d.useState(t.get("category")??"All"),[l,u]=d.useState("discover"),[h,f]=d.useState(!0),[m,g]=d.useState([]),[x,w]=d.useState(!1),[b,j]=d.useState(0),[T,A]=d.useState({}),[D,R]=d.useState({}),[B,_]=d.useState(0),[S,L]=d.useState(null),[I,Z]=d.useState(1),[q,M]=d.useState([]),[z,E]=d.useState(!1),K="support@circles.app",[F,$]=d.useState(!1),[P,N]=d.useState(""),[O,H]=d.useState(""),[ae,W]=d.useState(!1),[te,ne]=d.useState(null);d.useEffect(()=>{const k=new URLSearchParams(t);a&&a!=="All"?k.set("category",a):k.delete("category"),i?k.set("q",i):k.delete("q"),k.toString()!==t.toString()&&e(k,{replace:!0})},[i,a,s,n]);const re=d.useMemo(()=>{const k=(i||"").trim().replace(/[^A-Za-z0-9]/g,"");return/^[A-Za-z0-9]{6,16}$/.test(k)?k.toUpperCase():null},[i]);d.useEffect(()=>{(async()=>{const{data:k}=await v.auth.getUser();if(!k.user)return;const{data:me}=await v.from("profiles").select("city, verification_level").eq("user_id",k.user.id).maybeSingle();me?.city&&L(me.city),me?.verification_level&&Z(me.verification_level)})()},[]),d.useEffect(()=>{let k=!0;async function me(){try{if(w(!0),g([]),n||re){const le=n||re,Ve=le.replace(/[^A-Za-z0-9]/g,"").toUpperCase(),{data:ye,error:$e}=await v.from("groups").select("id, title, description, city, category, game, capacity, created_at, code").or(`code.eq.${Ve},id.eq.${le}`).maybeSingle();if(!$e&&ye){k&&g([ye]),w(!1),f(!0);return}}let pe=v.from("groups").select("id, title, description, city, category, game, capacity, created_at, code").order("created_at",{ascending:!1}).limit(50);a&&a!=="All"&&(pe=pe.eq("category",a.toLowerCase())),i&&!re&&(pe=pe.ilike("title",`%${i}%`));const{data:Pe}=await pe;k&&g(Pe||[])}catch(pe){console.warn(pe)}finally{k&&w(!1)}}return me(),()=>{k=!1}},[a,i,n,re,b]),d.useEffect(()=>{let k=!0;return(async()=>{const{data:me}=await v.from("group_members").select("user_id, group_id, groups(game)");if(!k||!me)return;const pe={},Pe={},le=new Set;me.forEach(ye=>{const $e=(ye.groups?.game||"").toLowerCase(),lt=ye.group_id;$e&&lt&&(Pe[$e]=(Pe[$e]||0)+1,pe[$e]||(pe[$e]=new Set),pe[$e].add(lt)),ye.user_id&&le.add(ye.user_id)});const Ve={};Object.keys(pe).forEach(ye=>{Ve[ye]=pe[ye].size}),A(Ve),R(Pe),_(le.size)})(),()=>{k=!1}},[]),d.useEffect(()=>{if(l!=="moments")return;let k=!0;return(async()=>{E(!0);const{data:me,error:pe}=await v.from("group_moments").select("id, photo_url, caption, verified, min_view_level, created_at, group_id, groups(title, city)").order("created_at",{ascending:!1}).limit(30);k&&(pe||M(me??[]),E(!1))})(),()=>{k=!1}},[l,b]);async function Oe(k){const{data:me}=await v.auth.getUser(),pe=me?.user?.id?`Reporter: ${me.user.id}`:"Reporter: anonymous",Pe=encodeURIComponent(`Moment review request ${k.id}`),le=encodeURIComponent([`Moment ID: ${k.id}`,`Group ID: ${k.group_id}`,`Group title: ${k.groups?.title||""}`,pe,"","Reason: "].join(`
`));window.location.href=`mailto:${K}?subject=${Pe}&body=${le}`}const Ue=d.useMemo(()=>{const k=a==="All"?Aa:Aa.filter(me=>me.tag===a);return i?k.filter(me=>me.name.toLowerCase().includes(i.toLowerCase())):k},[i,a]);return r.jsxs("div",{className:"mx-auto w-full max-w-3xl px-4 py-8 pb-32",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h1",{className:"text-3xl font-extrabold text-neutral-900 tracking-tight",children:"Discover"}),r.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-emerald-600 bg-emerald-50 px-3 py-1 rounded-full",children:[r.jsxs("span",{className:"relative flex h-2 w-2",children:[r.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"}),r.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-emerald-500"})]}),B," Online Now"]}),r.jsx("button",{onClick:()=>$(!0),className:"text-sm font-semibold text-neutral-500 hover:text-black underline",children:"Request Game"})]})]}),r.jsxs("div",{className:"flex gap-2 mb-4",children:[r.jsx("button",{onClick:()=>u("discover"),className:`rounded-full px-4 py-2 text-sm font-bold border ${l==="discover"?"bg-black text-white border-black":"bg-white text-neutral-700 border-neutral-200"}`,children:"Circles"}),r.jsx("button",{onClick:()=>u("moments"),className:`rounded-full px-4 py-2 text-sm font-bold border ${l==="moments"?"bg-black text-white border-black":"bg-white text-neutral-700 border-neutral-200"}`,children:"Moments"})]}),l==="moments"?r.jsxs("div",{className:"space-y-4",children:[z&&r.jsx("div",{className:"text-sm text-neutral-500",children:"Loading meetups..."}),!z&&q.length===0&&r.jsx("div",{className:"rounded-2xl border border-dashed border-neutral-200 bg-neutral-50 p-6 text-center text-sm text-neutral-500",children:"No verified meetups yet. Be the first to share a Moment."}),r.jsx("div",{className:"grid gap-4",children:q.map(k=>{const me=!k.verified||I<(k.min_view_level??1);return r.jsxs("div",{className:"overflow-hidden rounded-2xl border border-neutral-100 bg-white shadow-sm",children:[r.jsxs("div",{className:"relative",children:[r.jsx("img",{src:k.photo_url,className:"h-56 w-full object-cover"}),r.jsxs("div",{className:"absolute top-3 left-3 rounded-full bg-black/70 text-white text-[10px] font-bold px-2 py-1",children:[k.verified?"Verified meetup":"Unverified"," â€¢ ",k.id.slice(0,8)]}),me&&r.jsx("div",{className:"absolute inset-0 flex items-end justify-start p-3",children:r.jsx("button",{type:"button",onClick:()=>Oe(k),className:"rounded-lg bg-white/90 text-[11px] font-bold text-neutral-800 px-3 py-1.5 shadow-sm border border-neutral-200 hover:bg-white",children:"Not yet reviewed â€” report if inappropriate"})})]}),r.jsxs("div",{className:"p-3 space-y-1",children:[r.jsx("div",{className:"text-sm font-bold text-neutral-900",children:k.groups?.title||"Circle"}),r.jsxs("div",{className:"text-xs text-neutral-500",children:[k.groups?.city||"Anywhere"," â€¢ ",new Date(k.created_at).toLocaleDateString()]}),k.caption&&r.jsx("div",{className:"text-xs text-neutral-600",children:k.caption})]})]},k.id)})})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"sticky top-0 z-30 bg-neutral-50/95 py-3 backdrop-blur-md mb-6 -mx-4 px-4 border-b border-neutral-100 transition-all",children:[r.jsxs("div",{className:"relative mb-3",children:[r.jsx(ui,{className:"absolute left-3.5 top-3 h-5 w-5 text-neutral-400"}),r.jsx("input",{value:i,onChange:k=>o(k.target.value),placeholder:"Search groups, or invite codes...",className:"w-full h-11 rounded-xl border border-neutral-200 bg-white pl-11 pr-4 text-sm shadow-sm outline-none focus:border-black focus:ring-1 focus:ring-black transition-all placeholder:text-neutral-400"})]}),r.jsx("div",{className:"flex gap-2 overflow-x-auto pb-1 scrollbar-hide",children:xh.map(k=>r.jsx("button",{onClick:()=>{c(k)},className:`whitespace-nowrap rounded-full px-4 py-1.5 text-sm font-medium transition-all ${a===k?"bg-neutral-900 text-white shadow-md scale-105":"bg-white text-neutral-600 border border-neutral-200 hover:bg-neutral-100"}`,children:k},k))})]}),r.jsxs("div",{className:"mb-8",children:[r.jsxs("button",{onClick:()=>f(!h),className:"w-full flex items-center justify-between bg-neutral-50 border border-neutral-200 rounded-2xl p-4 shadow-sm hover:bg-neutral-100 transition-all active:scale-[0.99]",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-10 w-10 flex items-center justify-center bg-white rounded-full text-emerald-600 shadow-sm",children:r.jsx(tn,{className:"h-5 w-5"})}),r.jsxs("div",{className:"text-left",children:[r.jsx("div",{className:"text-xs font-bold text-neutral-400 uppercase tracking-wide",children:"Location"}),r.jsxs("div",{className:"text-base font-bold text-neutral-900 flex items-center gap-2",children:[S?`${S} & Nearby`:"All Locations",re&&r.jsx("span",{className:"text-xs bg-amber-100 text-amber-700 px-2 py-0.5 rounded-full",children:"Filtered"})]})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"text-xs font-bold text-neutral-400",children:[m.length," found"]}),h?r.jsx(Tl,{className:"text-neutral-400"}):r.jsx(Pl,{className:"text-neutral-400"})]})]}),h&&r.jsx("div",{className:"mt-4 animate-in slide-in-from-top-4 duration-300",children:x?r.jsx("div",{className:"space-y-3",children:[1,2,3].map(k=>r.jsx("div",{className:"h-24 w-full rounded-2xl bg-white animate-pulse shadow-sm"},k))}):m.length===0?r.jsxs("div",{className:"py-12 text-center rounded-3xl bg-neutral-50 border-2 border-dashed border-neutral-200",children:[r.jsx("div",{className:"inline-flex h-12 w-12 items-center justify-center rounded-full bg-white shadow-sm mb-3 text-2xl",children:"ğŸ”"}),r.jsx("h3",{className:"text-lg font-bold text-neutral-900",children:"No groups found"}),r.jsx("p",{className:"text-sm text-neutral-500 max-w-xs mx-auto mt-1 px-4",children:"Try adjusting your search or filters."}),r.jsx(we,{to:"/create",className:"mt-4 inline-block rounded-full bg-black px-6 py-2 text-sm font-bold text-white shadow-lg hover:bg-neutral-800 active:scale-95 transition-all",children:"Create New Group"})]}):r.jsx("div",{className:"grid gap-3",children:m.map(k=>r.jsx(we,{to:`/group/${k.id}`,className:"block group",children:r.jsxs("div",{className:"relative overflow-hidden rounded-2xl border border-neutral-100 bg-white p-4 shadow-sm transition-all hover:shadow-md hover:border-neutral-200 active:scale-[0.99]",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{className:"flex-1 min-w-0 pr-4",children:[r.jsx("h3",{className:"font-bold text-neutral-900 text-base truncate",children:k.title}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-1 text-xs text-neutral-500 font-medium",children:[r.jsx("span",{className:"capitalize text-emerald-700 bg-emerald-50 px-2 py-0.5 rounded-md font-bold",children:k.game||k.category}),r.jsxs("span",{className:"flex items-center gap-0.5",children:[k.city?r.jsx(tn,{className:"h-3 w-3"}):r.jsx(Ld,{className:"h-3 w-3"}),k.city||"Online"]})]})]}),r.jsx("div",{className:"h-8 w-8 flex-shrink-0 rounded-full bg-neutral-50 flex items-center justify-center text-neutral-300 group-hover:bg-black group-hover:text-white transition-colors",children:r.jsx(Ts,{className:"h-4 w-4 rotate-180"})})]}),k.description&&r.jsx("p",{className:"mt-3 text-sm text-neutral-600 line-clamp-2 leading-relaxed",children:k.description}),k.code&&r.jsxs("div",{className:"mt-3 pt-3 border-t border-neutral-50 flex items-center gap-2",children:[r.jsx("span",{className:"text-[10px] font-bold text-neutral-400 uppercase tracking-wider",children:"Invite Code"}),r.jsx("span",{className:"font-mono text-xs font-bold text-neutral-700 bg-neutral-100 px-1.5 py-0.5 rounded",children:k.code})]})]})},k.id))})})]}),r.jsxs("section",{children:[r.jsx("h2",{className:"text-lg font-bold text-neutral-900 mb-4",children:"Browse by Category"}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:Ue.map(k=>r.jsx(we,{to:`/groups/game/${k.id}`,className:"block group",children:r.jsxs("div",{className:"flex items-center p-4 bg-white rounded-2xl border border-neutral-100 shadow-sm transition-all hover:shadow-md hover:border-neutral-200 active:scale-[0.98]",children:[r.jsx("div",{className:"h-14 w-14 flex items-center justify-center text-3xl bg-neutral-50 rounded-2xl mr-4 shadow-inner ring-1 ring-black/5",children:k.image}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"font-bold text-neutral-900 truncate",children:k.name}),r.jsx("span",{className:"text-[10px] font-bold bg-neutral-100 text-neutral-500 px-1.5 py-0.5 rounded uppercase tracking-wide",children:k.tag})]}),r.jsx("p",{className:"text-xs text-neutral-500 truncate mt-0.5",children:k.blurb}),r.jsxs("div",{className:"flex items-center gap-3 mt-2 text-[11px] font-medium text-neutral-400",children:[r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(Ds,{className:"h-3 w-3"})," ",D[k.id]||0]}),r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(sh,{className:"h-3 w-3"})," ",T[k.id]||0," groups"]})]})]})]})},k.id))}),Ue.length===0&&r.jsx("div",{className:"py-12 text-center text-neutral-500",children:"No games found. Try a different search."})]})]}),F&&r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[r.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>$(!1)}),r.jsxs("div",{className:"relative w-full max-w-sm bg-white rounded-3xl p-6 shadow-2xl animate-in zoom-in-95 duration-200",children:[r.jsx("h3",{className:"text-xl font-bold text-neutral-900 mb-2",children:"Request Game"}),r.jsx("p",{className:"text-sm text-neutral-500 mb-6",children:"Don't see your favorite game? Let us know."}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-neutral-400 uppercase mb-1",children:"Game Name"}),r.jsx("input",{value:P,onChange:k=>N(k.target.value),className:"w-full rounded-xl border-2 border-neutral-100 px-4 py-3 text-sm font-bold focus:border-black focus:ring-0 outline-none transition-colors",placeholder:"e.g. Catan"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-neutral-400 uppercase mb-1",children:"Why?"}),r.jsx("textarea",{value:O,onChange:k=>H(k.target.value),className:"w-full rounded-xl border-2 border-neutral-100 px-4 py-3 text-sm focus:border-black focus:ring-0 outline-none transition-colors resize-none",rows:3,placeholder:"It's super popular..."})]}),te&&r.jsx("p",{className:"text-sm font-medium text-emerald-600 text-center",children:te}),r.jsxs("div",{className:"flex gap-3 pt-2",children:[r.jsx("button",{onClick:()=>$(!1),className:"flex-1 rounded-xl font-bold text-neutral-500 hover:bg-neutral-50 py-3 text-sm transition-colors",children:"Cancel"}),r.jsx("button",{disabled:ae||!P,onClick:async()=>{W(!0);const{data:k}=await v.auth.getUser();await v.from("category_requests").insert({name:P,note:O,requested_by:k.user?.id}),ne("Request sent! Thanks."),setTimeout(()=>{$(!1),ne(null),N("")},1500),W(!1)},className:"flex-1 rounded-xl bg-black text-white font-bold py-3 text-sm shadow-lg active:scale-95 transition-all disabled:opacity-50 disabled:scale-100",children:ae?"Sending...":"Submit"})]})]})]})]})]})}const bh="modulepreload",vh=function(t){return"/circles/"+t},Ra={},Qn=function(e,s,n){let i=Promise.resolve();if(s&&s.length>0){let l=function(u){return Promise.all(u.map(h=>Promise.resolve(h).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),c=a?.nonce||a?.getAttribute("nonce");i=l(s.map(u=>{if(u=vh(u),u in Ra)return;Ra[u]=!0;const h=u.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":bh,h||(m.as="script"),m.crossOrigin="",m.href=u,c&&m.setAttribute("nonce",c),document.head.appendChild(m),h)return new Promise((g,x)=>{m.addEventListener("load",g),m.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${u}`)))})}))}function o(a){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=a,window.dispatchEvent(c),!c.defaultPrevented)throw a}return i.then(a=>{for(const c of a||[])c.status==="rejected"&&o(c.reason);return e().catch(o)})};function wh(t,e){const s=t.trim().toLowerCase();if(!s)return null;const n=e.find(i=>i.toLowerCase()===s);return n||(e.find(i=>i.toLowerCase().startsWith(s))??null)}function jh(){const[t,e]=d.useState([]),[s,n]=d.useState(!1),i=async()=>{if(s||t.length>0)return;const{State:C,City:X}=await Qn(async()=>{const{State:Fe,City:xe}=await import("./index-D7rQSa_G.js");return{State:Fe,City:xe}},[]),J=C.getStatesOfCountry("DE")||[],ce=[];for(const Fe of J){const xe=X.getCitiesOfState("DE",Fe.isoCode)||[];for(const Re of xe)Re&&typeof Re.name=="string"&&Re.name.trim()&&ce.push(Re.name.trim())}const be=Array.from(new Set(ce)).sort((Fe,xe)=>Fe.localeCompare(xe,"de"));e(be),n(!0)},o=jt(),a="Games",c="",[l,u]=d.useState([]),[h,f]=d.useState([]),[m,g]=d.useState(!0),[x,w]=d.useState(""),[b,j]=d.useState([]),[T,A]=d.useState(!0),[D,R]=d.useState([]),[B,_]=d.useState("");d.useMemo(()=>new Map(b.map(C=>[C.id,C])),[b]),d.useMemo(()=>new Set(b.map(C=>C.id)),[b]),d.useMemo(()=>{const C=B.trim().toLowerCase();return C?b.filter(X=>(X.display_name||"").toLowerCase().includes(C)||(X.id||"").toLowerCase().includes(C)):b},[b,B]);async function S(C){A(!0);try{const[X,J]=await Promise.all([v.from("friends").select("friend_id").eq("user_id",C).eq("status","accepted"),v.from("friends").select("user_id").eq("friend_id",C).eq("status","accepted")]),ce=[];!X.error&&Array.isArray(X.data)&&ce.push(...X.data.map(Te=>Te.friend_id).filter(Boolean)),!J.error&&Array.isArray(J.data)&&ce.push(...J.data.map(Te=>Te.user_id).filter(Boolean));const be=Array.from(new Set(ce));if(be.length===0){const Ct=await v.from("profiles").select("id, user_id, display_name, name, avatar_url").neq("id",C).neq("user_id",C).limit(12),Gt=(!Ct.error&&Array.isArray(Ct.data)?Ct.data:[]).map(ut=>({id:ut.id||ut.user_id,display_name:(ut.display_name||ut.name)??null,avatar_url:ut.avatar_url??null}));j(Gt);return}const Fe="id, user_id, display_name, name, avatar_url";let xe=[];const Re=await v.from("profiles").select(Fe).in("id",be);if(!Re.error&&Re.data?.length)xe=Re.data;else{const Te=await v.from("profiles").select(Fe).in("user_id",be);!Te.error&&Te.data?.length&&(xe=Te.data)}const St=(xe||[]).map(Te=>({id:Te.id||Te.user_id,display_name:(Te.display_name||Te.name)??null,avatar_url:Te.avatar_url??null})).filter(Te=>be.includes(Te.id));j(St)}finally{A(!1)}}d.useEffect(()=>{let C=!0;return(async()=>{const{data:X,error:J}=await v.auth.getUser();if(!C)return;const ce=J?void 0:X?.user?.id;ce&&(w(ce),await S(ce))})(),()=>{C=!1}},[]),d.useEffect(()=>{let C=!0;return(async()=>{g(!0);const{data:X}=await v.from("allowed_categories").select("name").eq("is_active",!0),{data:J}=await v.from("allowed_games").select("id, name, category").eq("is_active",!0);C&&(u((X??[]).map(ce=>({name:ce.name}))),f((J??[]).map(ce=>({id:ce.id,label:ce.name||ce.id,category:ce.category}))),g(!1))})(),()=>{C=!1}},[]),d.useEffect(()=>{function C(X){const J=X.target,ce=document.getElementById("cat-combobox"),be=document.getElementById("game-combobox");ce&&!ce.contains(J)&&re(!1),be&&!be.contains(J)&&Pe(!1)}return document.addEventListener("mousedown",C),()=>document.removeEventListener("mousedown",C)},[]);const[L,I]=d.useState(""),[Z,q]=d.useState(""),[M,z]=d.useState(""),[E,K]=d.useState(!1),F=d.useMemo(()=>wh(M,t),[M,t]),$=!!F,[P,N]=d.useState(!1),[O,H]=d.useState(-1),ae=d.useMemo(()=>{const C=M.trim().toLowerCase();return C?t.filter(X=>X.toLowerCase().includes(C)).slice(0,8):t.slice(0,8)},[M,t]),[W,te]=d.useState(3),[ne,re]=d.useState(!1),[Oe,Ue]=d.useState(""),[k,me]=d.useState("");d.useEffect(()=>{if(!l.length)return;const C=String(a),X=l.find(J=>J.name.toLowerCase()===C.toLowerCase());me((X?.name||l[0].name).toLowerCase())},[l,a]);const[pe,Pe]=d.useState(!1),[le,Ve]=d.useState(""),[ye,$e]=d.useState("");d.useEffect(()=>{if(!h.length||!k)return;const C="".toLowerCase().replace(/\s+/g,""),X=h.find(J=>J.id===C||J.label.toLowerCase().replace(/\s+/g,"")===C);X&&$e(X.id)},[h,c,k]);const lt=d.useMemo(()=>{const C=Oe.trim().toLowerCase(),X=l.map(J=>J.name);return C?X.filter(J=>J.toLowerCase().includes(C)):X},[Oe,l]),Ut=d.useMemo(()=>{const C=h.filter(J=>J.category.toLowerCase()===(k||"").toLowerCase()),X=le.trim().toLowerCase();return X?C.filter(J=>J.label.toLowerCase().includes(X)||J.id.includes(X)):C},[k,le,h]),cs=!m&&L.trim().length>0&&k&&ye&&W>=3&&W<=16&&$,[Ae,ct]=d.useState(1),Ye=L.trim().length>0&&!!k&&!!ye,Nt=$&&W>=3&&W<=16;function us(){Ae===1&&!Ye||Ae===2&&!Nt||ct(C=>Math.min(3,C+1))}function bn(){ct(C=>Math.max(1,C-1))}async function ds(C,X){if(D.length){try{const{error:J}=await v.rpc("send_group_invites",{p_group_id:C,p_recipient_ids:D});if(!J){console.debug("[CreateGroup] send_group_invites RPC ok",{groupId:C,inviteeCount:D.length});return}console.warn("[CreateGroup] send_group_invites RPC failed, will fallback",J?.message)}catch(J){console.warn("[CreateGroup] send_group_invites RPC threw, will fallback",J)}try{const J=D.map(be=>({group_id:C,inviter_id:X,recipient_id:be,status:"pending"})),{error:ce}=await v.from("group_invitations").insert(J);ce&&console.warn("[CreateGroup] group_invitations insert failed",ce.message)}catch{}try{let J=null;try{const{data:xe}=await v.from("groups").select("title").eq("id",C).maybeSingle();J=xe?.title??null}catch{}let ce=null;try{const{data:xe}=await v.from("profiles").select("display_name,name").in("id",[X]).maybeSingle();ce=xe?.display_name||xe?.name||null}catch{}const be=D.map(xe=>({user_id:xe,kind:"group_invite",payload:{group_id:C,group_title:J,inviter_id:X,inviter_name:ce},is_read:!1})),{error:Fe}=await v.from("notifications").insert(be);Fe&&console.warn("[CreateGroup] notifications insert likely blocked by RLS (expected). Use RPC send_group_invites.",Fe.message)}catch{}}}async function vn(){if(!cs)return;if(!$){K(!0);return}const{data:C,error:X}=await v.auth.getUser();if(X||!C?.user?.id){alert(X?.message||"Sign in required");return}const J=C.user.id,ce=Math.max(3,Math.min(16,W)),be=F??null,Fe={title:L.trim(),description:Z.trim().replace(/\s+$/,"")||null,category:(k||"").toLowerCase(),game:ye,city:be,capacity:ce,visibility:"public",host_id:J},{data:xe,error:Re}=await v.from("groups").insert([Fe]).select("id").maybeSingle();if(Re){alert(String(Re.message??"Unknown error"));return}if(!xe?.id){alert("Group created but ID missing. Try refreshing.");return}ds(xe.id,J),o(`/group/${xe.id}`)}return r.jsx("div",{className:"min-h-screen bg-neutral-50",children:r.jsxs("div",{className:"mx-auto w-full max-w-xl px-4 pb-10 pt-6",children:[r.jsxs("div",{className:"mb-6 flex items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-semibold tracking-tight",children:"Start a new Circle"}),r.jsx("p",{className:"mt-1 text-sm text-neutral-600",children:"A small, calm group for the right people. 3 quick steps."})]}),r.jsx(we,{to:"/browse",className:"shrink-0 rounded-full border border-neutral-200 px-3 py-1.5 text-xs font-medium text-neutral-700 hover:bg-neutral-100",children:"Back"})]}),r.jsx("div",{className:"mb-6 flex items-center justify-between text-xs font-medium text-neutral-600",children:[{id:1,label:"Basics"},{id:2,label:"Location"},{id:3,label:"Details"}].map(C=>{const X=Ae===C.id,J=Ae>C.id;return r.jsxs("div",{className:"flex flex-1 items-center gap-2",children:[r.jsx("div",{className:["flex h-7 w-7 items-center justify-center rounded-full border text-[11px]",X?"border-emerald-600 bg-emerald-600 text-white":J?"border-emerald-400 bg-emerald-50 text-emerald-700":"border-neutral-300 bg-white text-neutral-500"].join(" "),children:C.id}),r.jsx("span",{className:X?"text-neutral-900":"text-neutral-500",children:C.label})]},C.id)})}),r.jsxs("div",{className:"space-y-4",children:[Ae===1&&r.jsxs("section",{className:"rounded-2xl border border-neutral-200 bg-white p-4 shadow-sm",children:[r.jsx("h2",{className:"mb-3 text-sm font-semibold text-neutral-800",children:"Basics"}),m&&r.jsx("div",{className:"mb-2 text-xs text-neutral-500",children:"Loading categoriesâ€¦"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-neutral-700",children:"Title"}),r.jsx("input",{value:L,onChange:C=>I(C.target.value),placeholder:"e.g., Friday Night Hokm",className:"mt-1 w-full rounded-lg border border-neutral-200 bg-white px-3 py-2 text-sm outline-none shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/30"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-neutral-700",children:"Category"}),r.jsxs("div",{id:"cat-combobox",className:"relative mt-1",children:[r.jsx("input",{value:ne?Oe:k||"",onChange:C=>{re(!0),Ue(C.target.value)},onFocus:()=>re(!0),placeholder:"Search or choose categoryâ€¦",className:"w-full rounded-lg border border-neutral-200 bg-white px-3 py-2 text-sm outline-none shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/30",disabled:m}),ne&&r.jsxs("div",{className:"absolute z-20 mt-1 max-h-56 w-full overflow-auto rounded-lg border bg-white shadow-lg",children:[lt.length===0&&r.jsx("div",{className:"px-3 py-2 text-sm text-neutral-500",children:"No matches"}),lt.map(C=>r.jsx("button",{type:"button",onClick:()=>{me(C.toLowerCase()),re(!1),Ue(""),h.some(X=>X.category===C&&X.id===ye)||$e("")},className:"block w-full px-3 py-2 text-left text-sm hover:bg-neutral-50",children:C},C))]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-neutral-700",children:"Game / Activity"}),r.jsxs("div",{id:"game-combobox",className:"relative mt-1",children:[r.jsx("input",{value:pe?le:h.find(C=>C.category.toLowerCase()===(k||"").toLowerCase()&&C.id===ye)?.label||"",onChange:C=>{Pe(!0),Ve(C.target.value)},onFocus:()=>Pe(!0),placeholder:"Search or choose game/activityâ€¦",className:"w-full rounded-lg border border-neutral-200 bg-white px-3 py-2 text-sm outline-none shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/30",disabled:m||!(k&&k.trim().length>0)}),pe&&r.jsxs("div",{className:"absolute z-20 mt-1 max-h-56 w-full overflow-auto rounded-lg border bg-white shadow-lg",children:[Ut.length===0&&r.jsx("div",{className:"px-3 py-2 text-sm text-neutral-500",children:"No matches"}),Ut.map(C=>r.jsx("button",{type:"button",onClick:()=>{$e(C.id),Pe(!1),Ve("")},className:"block w-full px-3 py-2 text-left text-sm hover:bg-neutral-50",children:C.label},C.id))]})]})]})]})]}),Ae===2&&r.jsxs("section",{className:"rounded-2xl border border-neutral-200 bg-white p-4 shadow-sm",children:[r.jsx("h2",{className:"mb-3 text-sm font-semibold text-neutral-800",children:"Location & size"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"relative",children:[r.jsxs("label",{className:"block text-xs font-medium text-neutral-700",children:["City ",r.jsx("span",{className:"text-red-600",children:"*"})]}),r.jsx("input",{value:M,onChange:C=>{z(C.target.value),N(!0),H(-1)},onFocus:async()=>{await i(),N(!0)},onBlur:()=>{setTimeout(()=>N(!1),120),K(!0)},onKeyDown:C=>{P&&(C.key==="ArrowDown"?(C.preventDefault(),H(X=>Math.min(ae.length-1,X+1))):C.key==="ArrowUp"?(C.preventDefault(),H(X=>Math.max(-1,X-1))):C.key==="Enter"&&O>=0&&ae[O]&&(C.preventDefault(),z(ae[O]),N(!1)))},placeholder:"Start typingâ€¦ e.g., Offenburg",className:["mt-1 w-full rounded-lg border border-neutral-200 bg-white px-3 py-2 text-sm outline-none shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/30",E&&!$?"border-red-400 focus:border-red-500":""].join(" "),"aria-autocomplete":"list","aria-expanded":P,"aria-controls":"city-suggest",role:"combobox"}),P&&ae.length>0&&r.jsx("div",{id:"city-suggest",className:"absolute z-20 mt-1 max-h-64 w-full overflow-auto rounded-lg border border-neutral-200 bg-white shadow-lg",role:"listbox",children:ae.map((C,X)=>r.jsx("button",{type:"button",onMouseDown:J=>J.preventDefault(),onClick:()=>{z(C),N(!1),H(-1)},className:["flex w-full items-center justify-between px-3 py-2 text-left text-sm hover:bg-emerald-50",X===O?"bg-emerald-50":""].join(" "),role:"option","aria-selected":X===O,children:r.jsx("span",{className:"truncate",children:C})},C+X))}),!$&&E&&r.jsx("p",{className:"mt-1 text-xs text-red-600",children:"Choose a city from suggestions."}),$&&E&&F!==M&&r.jsxs("p",{className:"mt-1 text-xs text-neutral-500",children:["Using â€œ",F,"â€."]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-neutral-700",children:"Capacity"}),r.jsx("div",{className:"mt-1 flex items-center gap-3",children:r.jsx("input",{type:"number",value:W===0?"":W,onChange:C=>{const X=C.target.value;if(X===""){te(0);return}const J=Number(X);te(J)},placeholder:"3â€“16",className:"w-24 rounded-lg border border-neutral-200 bg-white px-3 py-2 text-sm outline-none shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/30"})}),(W<3||W>16)&&W!==0&&r.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Capacity must be between 3 and 16."})]})]})]}),Ae===3&&r.jsxs("section",{className:"rounded-2xl border border-neutral-200 bg-white p-4 shadow-sm",children:[r.jsx("h2",{className:"mb-3 text-sm font-semibold text-neutral-800",children:"Details & preview"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-neutral-700",children:"Description"}),r.jsx("textarea",{value:Z,onChange:C=>q(C.target.value),placeholder:"Tell people what this circle is aboutâ€¦",rows:4,className:"mt-1 w-full rounded-lg border border-neutral-200 bg-white px-3 py-2 text-sm outline-none shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/30"})]}),r.jsxs("div",{className:"rounded-xl border border-dashed border-neutral-200 bg-neutral-50 p-3 text-xs text-neutral-700",children:[r.jsx("div",{className:"mb-1 text-[11px] font-semibold uppercase tracking-wide text-neutral-500",children:"Preview"}),r.jsx("div",{className:"text-sm font-semibold text-neutral-900",children:L||"Untitled Circle"}),r.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2 text-[11px] text-neutral-600",children:[k&&r.jsx("span",{className:"rounded-full bg-white px-2 py-0.5",children:k}),ye&&r.jsx("span",{className:"rounded-full bg-white px-2 py-0.5",children:h.find(C=>C.id===ye)?.label||ye}),F&&r.jsxs("span",{className:"rounded-full bg-white px-2 py-0.5 flex items-center gap-1",children:[r.jsx("span",{children:"ğŸ“"}),F]}),r.jsxs("span",{className:"rounded-full bg-white px-2 py-0.5",children:[W," spots"]})]}),Z&&r.jsx("p",{className:"mt-2 line-clamp-3 text-xs text-neutral-700",children:Z})]})]})]})]}),r.jsxs("div",{className:"mt-6 flex items-center justify-between gap-3",children:[r.jsx("button",{type:"button",onClick:Ae===1?()=>o("/browse"):bn,className:"rounded-full border border-neutral-200 px-3 py-1.5 text-xs font-medium text-neutral-700 hover:bg-neutral-100",children:Ae===1?"Cancel":"Back"}),r.jsxs("div",{className:"flex gap-2",children:[Ae<3&&r.jsx("button",{type:"button",onClick:us,disabled:Ae===1&&!Ye||Ae===2&&!Nt||m,className:"rounded-full bg-emerald-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-emerald-700 disabled:opacity-60",children:"Next"}),Ae===3&&r.jsx("button",{type:"button",disabled:!cs,onClick:vn,className:"rounded-full bg-emerald-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-emerald-700 disabled:opacity-60",children:"Create Circle"})]})]})]})})}const Da=t=>alert(t);function di({isOpen:t,onClose:e,viewUserId:s}){const n=jt(),[i,o]=d.useState(null),[a,c]=d.useState(""),[l,u]=d.useState(null),[h,f]=d.useState(!0),[m,g]=d.useState(0),[x,w]=d.useState(0),[b,j]=d.useState(0),[T,A]=d.useState(0),[D,R]=d.useState([]),[B,_]=d.useState([]),[S,L]=d.useState(0),[I,Z]=d.useState(!1),[q,M]=d.useState(null),[z,E]=d.useState("none"),[K,F]=d.useState(null),[$,P]=d.useState(!1);d.useEffect(()=>{(async()=>{const{data:W}=await v.auth.getUser();o(W.user?.id||null)})()},[]),d.useEffect(()=>{if(!t||!s||!i)return;F(null),Z(!1),M(null),P(!1);async function W(){const{data:te}=await v.from("profiles").select("name,avatar_url,allow_ratings,rating_avg,rating_count").eq("user_id",s).maybeSingle();c(te?.name??"User"),u(te?.avatar_url??null),f(!!(te?.allow_ratings??!0)),g(Number(te?.rating_avg??0)),w(Number(te?.rating_count??0));const{data:ne}=await v.from("rating_pairs").select("stars").eq("rater_id",i).eq("ratee_id",s).maybeSingle();L(Number(ne?.stars??0));const{data:re}=await v.from("friendships").select("status,requested_by").or(`and(user_id_a.eq.${i},user_id_b.eq.${s}),and(user_id_a.eq.${s},user_id_b.eq.${i})`).maybeSingle();let Oe="none";re&&(re.status==="accepted"?Oe="accepted":re.status==="blocked"?Oe="blocked":re.status==="pending"&&(Oe=re.requested_by===i?"pending_out":"pending_in")),E(Oe);const{data:Ue}=await v.from("group_members").select("group_id").eq("user_id",s).eq("status","active"),k=(Ue||[]).map(le=>le.group_id);if(j(k.length),k.length>0){const{data:le}=await v.from("groups").select("title").in("id",k).limit(12);_((le||[]).map(Ve=>Ve.title))}else _([]);const{data:me}=await v.from("group_members").select("group_id").eq("user_id",i).eq("status","active"),pe=new Set((me||[]).map(le=>le.group_id)),Pe=k.filter(le=>pe.has(le));if(A(Pe.length),Pe.length>0){const{data:le}=await v.from("groups").select("title").in("id",Pe).limit(3);R((le||[]).map(Ve=>Ve.title))}else R([])}W()},[t,s,i]);async function N(W){if(s)try{W==="add"?(await v.rpc("request_friend",{target_id:s}),E("pending_out")):W==="accept"?(await v.rpc("accept_friend",{from_id:s}),E("accepted")):(await v.rpc("remove_friend",{other_id:s}),E("none"))}catch{}}async function O(){if(!(!i||!s)&&window.confirm("Are you sure you want to report and block this user? They will not be able to contact you.")){P(!0);try{const{error:W}=await v.from("reports").insert({reporter_id:i,reported_id:s,reason:"User Reported via Profile"});if(W)throw W;const{error:te}=await v.rpc("block_user",{target_id:s});if(te)throw te;Da("User reported and blocked."),E("blocked"),e()}catch{Da("Failed to report user.")}finally{P(!1)}}}async function H(W){if(!i||!s||I||!h)return;Z(!0);const te=S;L(W);try{const{error:ne}=await v.rpc("submit_rating",{p_ratee:s,p_stars:W});if(ne)throw ne;const{data:re}=await v.from("profiles").select("rating_avg,rating_count").eq("user_id",s).single();re&&(g(re.rating_avg),w(re.rating_count))}catch{L(te),F("Failed to rate.")}finally{Z(!1)}}function ae(){s&&(e(),n("/chats",{state:{openDmId:s}}))}return t?r.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[r.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:e}),r.jsxs("div",{className:"relative w-full max-w-sm bg-white rounded-3xl p-6 shadow-2xl overflow-y-auto max-h-[90vh]",children:[r.jsx("button",{onClick:e,className:"absolute top-4 right-4 p-2 rounded-full bg-white text-neutral-500",children:r.jsx(Ln,{className:"h-5 w-5"})}),r.jsxs("div",{className:"flex flex-col items-center mb-6",children:[r.jsx("div",{className:"h-24 w-24 rounded-full bg-neutral-200 overflow-hidden shadow-sm",children:l?r.jsx("img",{src:l,alt:"Avatar",className:"h-full w-full object-cover"}):r.jsx("div",{className:"h-full w-full flex items-center justify-center text-3xl font-bold text-neutral-500",children:a.slice(0,1).toUpperCase()})}),r.jsx("h2",{className:"text-xl font-bold mt-3",children:a})]}),r.jsxs("div",{className:"flex gap-3 mb-6",children:[r.jsxs("button",{onClick:ae,className:"flex-1 py-2 rounded-xl bg-indigo-600 text-white text-sm font-bold flex items-center justify-center gap-2",children:[r.jsx($n,{className:"h-4 w-4"})," Message"]}),z==="none"&&r.jsxs("button",{onClick:()=>N("add"),className:"flex-1 py-2 rounded-xl bg-black text-white text-sm font-bold flex items-center justify-center gap-2",children:[r.jsx(El,{className:"h-4 w-4"})," Add"]}),z==="pending_in"&&r.jsxs("button",{onClick:()=>N("accept"),className:"flex-1 py-2 rounded-xl bg-emerald-600 text-white text-sm font-bold flex items-center justify-center gap-2",children:[r.jsx(lh,{className:"h-4 w-4"})," Accept"]}),z==="accepted"&&r.jsxs("button",{onClick:()=>{window.confirm("Are you sure you want to unfriend this user?")&&N("remove")},className:"flex-1 py-2 rounded-xl bg-neutral-100 text-red-600 hover:bg-red-50 border border-transparent hover:border-red-200 text-sm font-bold flex items-center justify-center gap-2 transition-all",children:[r.jsx(uh,{className:"h-4 w-4"})," Unfriend"]}),z==="blocked"&&r.jsxs("button",{onClick:()=>{window.confirm("Unblock this user? They will be able to request you again.")&&N("remove")},className:"flex-1 py-2 rounded-xl bg-neutral-800 text-white text-sm font-bold flex items-center justify-center gap-2 hover:bg-neutral-900 transition-all",children:[r.jsx(Fd,{className:"h-4 w-4"})," Unblock"]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-6",children:[r.jsxs("div",{className:"p-3 rounded-xl bg-neutral-50 text-center",children:[r.jsx("div",{className:"text-xl font-bold",children:b}),r.jsxs("div",{className:"text-[10px] uppercase font-bold text-neutral-500 mt-1 flex items-center justify-center gap-1",children:[r.jsx(kl,{className:"h-3 w-3"})," Groups Joined"]})]}),r.jsxs("div",{className:"p-3 rounded-xl bg-blue-50 text-center",children:[r.jsx("div",{className:"text-xl font-bold text-blue-600",children:T}),r.jsxs("div",{className:"text-[10px] uppercase font-bold text-blue-400 mt-1 flex items-center justify-center gap-1",children:[r.jsx(Ds,{className:"h-3 w-3"})," Mutual Groups"]})]})]}),r.jsxs("div",{className:"mb-6 bg-neutral-50 rounded-xl p-3 border border-neutral-100",children:[r.jsx("div",{className:"text-[10px] font-bold text-neutral-400 uppercase mb-2",children:"Groups they joined:"}),B.length===0?r.jsx("div",{className:"text-xs text-neutral-400",children:"No groups found."}):r.jsx("div",{className:"flex flex-wrap gap-1.5",children:B.map((W,te)=>r.jsx("span",{className:"px-2 py-0.5 bg-white border border-neutral-200 rounded-md text-xs font-medium text-neutral-700",children:W},te))})]}),D.length>0&&r.jsxs("div",{className:"mb-6 bg-neutral-50 rounded-xl p-3 border border-neutral-100",children:[r.jsx("div",{className:"text-[10px] font-bold text-neutral-400 uppercase mb-2",children:"You are both in:"}),r.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[D.map((W,te)=>r.jsx("span",{className:"px-2 py-0.5 bg-white border border-neutral-200 rounded-md text-xs font-medium text-neutral-700",children:W},te)),T>3&&r.jsxs("span",{className:"px-2 py-0.5 text-xs text-neutral-400",children:["+",T-3," more"]})]})]}),h&&z!=="blocked"&&r.jsxs("div",{className:"pt-3 border-t border-neutral-100",children:[r.jsx("div",{className:"text-center text-xs font-medium text-neutral-400 mb-2",children:"Rate this player"}),r.jsx("div",{className:"flex justify-center gap-1",children:Array.from({length:6}).map((W,te)=>{const ne=te+1,re=(q??S)>=ne;return r.jsx("button",{disabled:I,onMouseEnter:()=>M(ne),onMouseLeave:()=>M(null),onClick:()=>H(ne),className:`text-2xl transition-transform hover:scale-110 ${re?"text-amber-400":"text-neutral-200"}`,"aria-label":`Rate ${ne} star${ne>1?"s":""}`,children:"â˜…"},ne)})}),K&&r.jsx("div",{className:"text-center text-[10px] text-red-500 mt-1",children:K})]}),z!=="blocked"&&r.jsx("div",{className:"mt-6 flex justify-center",children:r.jsxs("button",{onClick:O,disabled:$,className:"flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white py-2 px-4 rounded-xl text-sm font-bold disabled:opacity-50 disabled:cursor-not-allowed",children:[r.jsx(ah,{className:"h-4 w-4"}),$?"Reporting...":"Report & Block User"]})})]})]}):null}var Ms;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(Ms||(Ms={}));class ur extends Error{constructor(e,s,n){super(e),this.message=e,this.code=s,this.data=n}}const Nh=t=>{var e,s;return t?.androidBridge?"android":!((s=(e=t?.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||s===void 0)&&s.bridge?"ios":"web"},Sh=t=>{const e=t.CapacitorCustomPlatform||null,s=t.Capacitor||{},n=s.Plugins=s.Plugins||{},i=()=>e!==null?e.name:Nh(t),o=()=>i()!=="web",a=f=>{const m=u.get(f);return!!(m?.platforms.has(i())||c(f))},c=f=>{var m;return(m=s.PluginHeaders)===null||m===void 0?void 0:m.find(g=>g.name===f)},l=f=>t.console.error(f),u=new Map,h=(f,m={})=>{const g=u.get(f);if(g)return console.warn(`Capacitor plugin "${f}" already registered. Cannot register plugins twice.`),g.proxy;const x=i(),w=c(f);let b;const j=async()=>(!b&&x in m?b=typeof m[x]=="function"?b=await m[x]():b=m[x]:e!==null&&!b&&"web"in m&&(b=typeof m.web=="function"?b=await m.web():b=m.web),b),T=(S,L)=>{var I,Z;if(w){const q=w?.methods.find(M=>L===M.name);if(q)return q.rtype==="promise"?M=>s.nativePromise(f,L.toString(),M):(M,z)=>s.nativeCallback(f,L.toString(),M,z);if(S)return(I=S[L])===null||I===void 0?void 0:I.bind(S)}else{if(S)return(Z=S[L])===null||Z===void 0?void 0:Z.bind(S);throw new ur(`"${f}" plugin is not implemented on ${x}`,Ms.Unimplemented)}},A=S=>{let L;const I=(...Z)=>{const q=j().then(M=>{const z=T(M,S);if(z){const E=z(...Z);return L=E?.remove,E}else throw new ur(`"${f}.${S}()" is not implemented on ${x}`,Ms.Unimplemented)});return S==="addListener"&&(q.remove=async()=>L()),q};return I.toString=()=>`${S.toString()}() { [capacitor code] }`,Object.defineProperty(I,"name",{value:S,writable:!1,configurable:!1}),I},D=A("addListener"),R=A("removeListener"),B=(S,L)=>{const I=D({eventName:S},L),Z=async()=>{const M=await I;R({eventName:S,callbackId:M},L)},q=new Promise(M=>I.then(()=>M({remove:Z})));return q.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await Z()},q},_=new Proxy({},{get(S,L){switch(L){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return w?B:D;case"removeListener":return R;default:return A(L)}}});return n[f]=_,u.set(f,{name:f,proxy:_,platforms:new Set([...Object.keys(m),...w?[x]:[]])}),_};return s.convertFileSrc||(s.convertFileSrc=f=>f),s.getPlatform=i,s.handleError=l,s.isNativePlatform=o,s.isPluginAvailable=a,s.registerPlugin=h,s.Exception=ur,s.DEBUG=!!s.DEBUG,s.isLoggingEnabled=!!s.isLoggingEnabled,s},Ch=t=>t.Capacitor=Sh(t),Br=Ch(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),hi=Br.registerPlugin;class Rl{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,s){let n=!1;this.listeners[e]||(this.listeners[e]=[],n=!0),this.listeners[e].push(s);const o=this.windowListeners[e];o&&!o.registered&&this.addWindowListener(o),n&&this.sendRetainedArgumentsForEvent(e);const a=async()=>this.removeListener(e,s);return Promise.resolve({remove:a})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,s,n){const i=this.listeners[e];if(!i){if(n){let o=this.retainedEventArguments[e];o||(o=[]),o.push(s),this.retainedEventArguments[e]=o}return}i.forEach(o=>o(s))}hasListeners(e){var s;return!!(!((s=this.listeners[e])===null||s===void 0)&&s.length)}registerWindowListener(e,s){this.windowListeners[s]={registered:!1,windowEventName:e,pluginEventName:s,handler:n=>{this.notifyListeners(s,n)}}}unimplemented(e="not implemented"){return new Br.Exception(e,Ms.Unimplemented)}unavailable(e="not available"){return new Br.Exception(e,Ms.Unavailable)}async removeListener(e,s){const n=this.listeners[e];if(!n)return;const i=n.indexOf(s);this.listeners[e].splice(i,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const s=this.retainedEventArguments[e];s&&(delete this.retainedEventArguments[e],s.forEach(n=>{this.notifyListeners(e,n)}))}}const La=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Oa=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class _h extends Rl{async getCookies(){const e=document.cookie,s={};return e.split(";").forEach(n=>{if(n.length<=0)return;let[i,o]=n.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");i=Oa(i).trim(),o=Oa(o).trim(),s[i]=o}),s}async setCookie(e){try{const s=La(e.key),n=La(e.value),i=`; expires=${(e.expires||"").replace("expires=","")}`,o=(e.path||"/").replace("path=",""),a=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${s}=${n||""}${i}; path=${o}; ${a};`}catch(s){return Promise.reject(s)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(s){return Promise.reject(s)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const s of e)document.cookie=s.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}hi("CapacitorCookies",{web:()=>new _h});const kh=async t=>new Promise((e,s)=>{const n=new FileReader;n.onload=()=>{const i=n.result;e(i.indexOf(",")>=0?i.split(",")[1]:i)},n.onerror=i=>s(i),n.readAsDataURL(t)}),Ph=(t={})=>{const e=Object.keys(t);return Object.keys(t).map(i=>i.toLocaleLowerCase()).reduce((i,o,a)=>(i[o]=t[e[a]],i),{})},Th=(t,e=!0)=>t?Object.entries(t).reduce((n,i)=>{const[o,a]=i;let c,l;return Array.isArray(a)?(l="",a.forEach(u=>{c=e?encodeURIComponent(u):u,l+=`${o}=${c}&`}),l.slice(0,-1)):(c=e?encodeURIComponent(a):a,l=`${o}=${c}`),`${n}&${l}`},"").substr(1):null,Mh=(t,e={})=>{const s=Object.assign({method:t.method||"GET",headers:t.headers},e),i=Ph(t.headers)["content-type"]||"";if(typeof t.data=="string")s.body=t.data;else if(i.includes("application/x-www-form-urlencoded")){const o=new URLSearchParams;for(const[a,c]of Object.entries(t.data||{}))o.set(a,c);s.body=o.toString()}else if(i.includes("multipart/form-data")||t.data instanceof FormData){const o=new FormData;if(t.data instanceof FormData)t.data.forEach((c,l)=>{o.append(l,c)});else for(const c of Object.keys(t.data))o.append(c,t.data[c]);s.body=o;const a=new Headers(s.headers);a.delete("content-type"),s.headers=a}else(i.includes("application/json")||typeof t.data=="object")&&(s.body=JSON.stringify(t.data));return s};class Eh extends Rl{async request(e){const s=Mh(e,e.webFetchExtra),n=Th(e.params,e.shouldEncodeUrlParams),i=n?`${e.url}?${n}`:e.url,o=await fetch(i,s),a=o.headers.get("content-type")||"";let{responseType:c="text"}=o.ok?e:{};a.includes("application/json")&&(c="json");let l,u;switch(c){case"arraybuffer":case"blob":u=await o.blob(),l=await kh(u);break;case"json":l=await o.json();break;case"document":case"text":default:l=await o.text()}const h={};return o.headers.forEach((f,m)=>{h[m]=f}),{data:l,headers:h,status:o.status,url:o.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}hi("CapacitorHttp",{web:()=>new Eh});function Ah(t){t.CapacitorUtils.Synapse=new Proxy({},{get(e,s){return new Proxy({},{get(n,i){return(o,a,c)=>{const l=t.Capacitor.Plugins[s];if(l===void 0){c(new Error(`Capacitor plugin ${s} not found`));return}if(typeof l[i]!="function"){c(new Error(`Method ${i} not found in Capacitor plugin ${s}`));return}(async()=>{try{const u=await l[i](o);a(u)}catch(u){c(u)}})()}}})}})}function Rh(t){t.CapacitorUtils.Synapse=new Proxy({},{get(e,s){return t.cordova.plugins[s]}})}function Dh(t=!1){typeof window>"u"||(window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!t?Ah(window):window.cordova!==void 0&&Rh(window))}const Lh=hi("Geolocation",{web:()=>Qn(()=>import("./web-lnRWL8UI.js"),__vite__mapDeps([0,1,2])).then(t=>new t.GeolocationWeb)});Dh();function Oh(t,e){const[s,n]=d.useState({});d.useEffect(()=>{if(!t||!e)return;const o=async()=>{try{const c=await Lh.getCurrentPosition({enableHighAccuracy:!0}),{latitude:l,longitude:u}=c.coords;await v.from("group_members").upsert({group_id:t,user_id:e,role:"member",status:"active"},{onConflict:"group_id,user_id"}),await v.from("group_live_locations").upsert({user_id:e,group_id:t,lat:l,long:u,updated_at:new Date().toISOString()})}catch{}};o();const a=setInterval(o,15e3);return()=>clearInterval(a)},[t,e]),d.useEffect(()=>{if(!t)return;v.from("group_live_locations").select("user_id, lat, long").eq("group_id",t).then(({data:a})=>{if(a){const c={};a.forEach(l=>{c[l.user_id]={lat:l.lat,long:l.long}}),n(c)}});const o=v.channel(`presence:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"group_live_locations",filter:`group_id=eq.${t}`},a=>{const c=a.new;c&&c.user_id&&n(l=>({...l,[c.user_id]:{lat:c.lat,long:c.long}}))}).subscribe();return()=>{v.removeChannel(o)}},[t]);function i(o){if(!e||!s[e]||!s[o]||o===e)return!1;const a=s[e],c=s[o];return Vh(a.lat,a.long,c.lat,c.long)<.05}return{isTogether:i}}function Vh(t,e,s,n){const o=Mn(s-t),a=Mn(n-e),c=Math.sin(o/2)*Math.sin(o/2)+Math.cos(Mn(t))*Math.cos(Mn(s))*Math.sin(a/2)*Math.sin(a/2);return 6371*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))}function Mn(t){return t*(Math.PI/180)}const Fh=d.lazy(()=>Qn(()=>import("./ChatPanel-Dfk8zaw2.js"),__vite__mapDeps([3,1,2])));function Ih(){const{id:t=""}=fn(),e=jt(),s=qt(),[n,i]=d.useState(null),[o,a]=d.useState(!0),[c,l]=d.useState(null),[u,h]=d.useState(null),f=!!(u&&n&&(u===n.host_id||(n?.creator_id??null)===u)),[m,g]=d.useState(!1),[x,w]=d.useState(!1),[b,j]=d.useState(!1),[T,A]=d.useState(!1),[D,R]=d.useState(null),[B,_]=d.useState(!1),[S,L]=d.useState(!1),[I,Z]=d.useState(""),[q,M]=d.useState(!1),[z,E]=d.useState(!1),[K,F]=d.useState(!1),[$,P]=d.useState(!1),[N,O]=d.useState(null),[H,ae]=d.useState([]),[W,te]=d.useState({}),[ne,re]=d.useState(0),[Oe,Ue]=d.useState(0),[k,me]=d.useState(null),[pe,Pe]=d.useState([]),[le,Ve]=d.useState(!1),ye=7,[$e,lt]=d.useState(0),[Ut,cs]=d.useState(1),[Ae,ct]=d.useState(null),[Ye,Nt]=d.useState(null),[us,bn]=d.useState([]),[ds,vn]=d.useState(0),[C,X]=d.useState(!1),[J,ce]=d.useState(null),[be,Fe]=d.useState(null),{isTogether:xe}=Oh(t,le?u??void 0:void 0),Re=d.useMemo(()=>pe.some(y=>xe(y.user_id)),[pe,xe]),St=d.useRef(null),Te=d.useRef(null),Ct="support@circles.app",[Gt,ut]=d.useState("Schedule"),[sr,wn]=d.useState(""),[Fs,jn]=d.useState("24h"),[Is,nr]=d.useState(""),Nn=d.useMemo(()=>N?.closes_at?new Date(N.closes_at)<new Date:!1,[N]);function rr(y,G){if(y==="closed")return"Voting Closed";if(!G)return"Open";const Q=new Date(G).getTime()-Date.now();if(Q<=0)return"Time Expired";const oe=Math.floor(Q/(1e3*60*60*24)),ie=Math.floor(Q%(1e3*60*60*24)/(1e3*60*60)),Ce=Math.floor(Q%(1e3*60*60)/(1e3*60));return oe>0?`${oe}d ${ie}h left`:ie>0?`${ie}h ${Ce}m left`:`${Ce}m left`}function Wi(y){if(!y)return"TBD";try{const G=new Date(y);return`${G.toLocaleDateString()} ${G.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`}catch{return"TBD"}}function Sn(y){const G=Q=>String(Q).padStart(2,"0");return`${y.getUTCFullYear()}${G(y.getUTCMonth()+1)}${G(y.getUTCDate())}T${G(y.getUTCHours())}${G(y.getUTCMinutes())}${G(y.getUTCSeconds())}Z`}function Qi(y){const G=y.starts_at?new Date(y.starts_at):new Date,Q=new Date(G.getTime()+3600*1e3),oe=["BEGIN:VCALENDAR","VERSION:2.0","PRODID:-//circles//event//EN","BEGIN:VEVENT",`UID:${y.id}`,`DTSTAMP:${Sn(new Date)}`,`DTSTART:${Sn(G)}`,`DTEND:${Sn(Q)}`,`SUMMARY:${y.title||"Circle Event"}`,y.place?`LOCATION:${y.place}`:"",`DESCRIPTION:Created from poll ${y.poll_id||""}`,"END:VEVENT","END:VCALENDAR"].filter(Boolean).join(`\r
`),ie=new Blob([oe],{type:"text/calendar;charset=utf-8"}),Ce=URL.createObjectURL(ie),Ne=document.createElement("a");Ne.href=Ce,Ne.download=`${y.title||"event"}.ics`,Ne.click(),URL.revokeObjectURL(Ce)}d.useEffect(()=>{s.hash==="#chat"&&g(!0)},[s.hash]),d.useEffect(()=>{let y=!1;return(async()=>{a(!0);const{data:G}=await v.auth.getUser();y||h(G.user?.id??null);const Q=await v.from("groups").select("*").eq("id",t).maybeSingle();if(y||i(Q.data??null),Q.data&&Z(Q.data.description||""),Q.data?.id){const{count:oe}=await v.from("group_members").select("*",{count:"exact",head:!0}).eq("group_id",Q.data.id).eq("status","active");y||re(oe??0)}a(!1)})(),()=>{y=!0}},[t]),d.useEffect(()=>{let y=!1;return(async()=>{if(!n?.id)return;const{data:G}=await v.auth.getUser(),Q=G.user?.id;if(!Q||y)return;const{data:oe}=await v.from("profiles").select("verification_level").eq("user_id",Q).maybeSingle();y||cs(oe?.verification_level??1);const{data:ie,count:Ce}=await v.from("group_members").select("group_id, user_id, role, status, last_joined_at, created_at",{count:"exact"}).eq("user_id",Q).eq("status","active");if(y)return;lt(Ce??ie?.length??0);const Ne=(ie??[]).find(ve=>ve.group_id===n.id);Ne?(ct(Ne),Ve(!0)):(Ve(!1),ct(null))})(),()=>{y=!0}},[n?.id,n?.host_id]),d.useEffect(()=>{let y=!1;return(async()=>{if(!n?.id){Pe([]);return}const{data:G}=await v.from("group_members").select("user_id, role, created_at, status, group_id, profiles(name, avatar_url)").eq("group_id",n.id).eq("status","active").order("created_at",{ascending:!0}),Q=(G??[]).map(ie=>({user_id:ie.user_id,role:ie.user_id===n.host_id?"host":ie.role,created_at:ie.created_at,group_id:n.id,status:ie.status??"active",name:ie.profiles?.name??"User",avatar_url:ie.profiles?.avatar_url??null}));if(y)return;Pe(Q);const oe=(await v.auth.getUser()).data.user?.id||null;oe&&Ve(Q.some(ie=>ie.user_id===oe))})(),()=>{y=!0}},[n?.id]),d.useEffect(()=>{let y=!1;return(async()=>{if(!n?.id)return;const{data:G}=await v.from("group_polls").select("*").eq("group_id",n.id).order("created_at",{ascending:!1}).limit(1);if(y)return;const Q=G&&G[0];if(O(Q||null),!Q){ae([]),te({}),Ue(0);return}const{data:oe}=await v.from("group_poll_options").select("*").eq("poll_id",Q.id).order("created_at");if(y)return;ae(oe||[]);const{data:ie}=await v.from("group_votes").select("option_id,user_id").eq("poll_id",Q.id);if(y)return;const Ce={},Ne=new Set;ie?.forEach(ve=>{Ce[ve.option_id]=(Ce[ve.option_id]||0)+1,Ne.add(ve.user_id)}),te(Ce),Ue(Ne.size)})(),()=>{y=!0}},[n?.id]),d.useEffect(()=>{let y=!1;return(async()=>{if(!n?.id)return;const{data:G}=await v.from("group_events").select("*").eq("group_id",n.id).order("created_at",{ascending:!1}).limit(1);y||Nt((G??[])[0]||null)})(),()=>{y=!0}},[n?.id,N?.id]),d.useEffect(()=>{let y=!1;return(async()=>{if(!n?.id)return;const{data:G}=await v.from("group_moments").select("id, group_id, created_by, photo_url, caption, verified, min_view_level, created_at, verified_at").eq("group_id",n.id).order("created_at",{ascending:!1}).limit(12);y||bn(G??[])})(),()=>{y=!0}},[n?.id,ds]);async function ir(){if(l(null),!n)return;if($e>=ye){l("You can only be in 7 circles at once. Leave another to join.");return}const y=Number(n.requires_verification_level??1);if(Ut<y){l("This circle is for verified members only.");return}const{data:G}=await v.auth.getUser();if(!G.user){l("Please sign in.");return}const Q={group_id:t,user_id:G.user.id,role:"member",status:"active",last_joined_at:new Date().toISOString()},{error:oe}=await v.from("group_members").upsert(Q,{onConflict:"group_id,user_id"});if(oe){const ie=(oe.message||"").toLowerCase();ie.includes("group_join_limit")?l("You can only be in 7 circles at once. Leave another to join."):ie.includes("verification")?l("This circle requires a higher verification level."):l(oe.message||"Could not join.");return}Ve(!0),ct({...Q,created_at:new Date().toISOString()}),re(ie=>ie+(le?0:1)),lt(ie=>Math.min(ye,ie+(le?0:1)))}async function Yi(){if(l(null),!n||!u)return;if(u===n.host_id){l("Host cannot leave their own group.");return}const y=Ae?.last_joined_at;if(y&&Date.now()-new Date(y).getTime()<720*60*1e3){l("You must stay in a Circle for at least 12 hours before leaving.");return}const{error:G}=await v.from("group_members").delete().match({group_id:n.id,user_id:u});if(G){(G.message||"").toLowerCase().includes("leave_cooldown")?l("You must stay in a Circle for at least 12 hours before leaving."):l(G.message||"Could not leave.");return}Ve(!1),re(Q=>Math.max(0,Q-1)),lt(Q=>Math.max(0,Q-1)),ct(null)}async function ar(y){if(!n||!f)return;l(null),Fe(y);const{error:G}=await v.from("groups").update({host_id:y}).eq("id",n.id);if(G){l(G.message||"Could not transfer host."),Fe(null);return}i(Q=>Q&&{...Q,host_id:y}),Pe(Q=>Q.map(oe=>({...oe,role:oe.user_id===y?"host":oe.role==="host"?"member":oe.role}))),Fe(null)}async function Xi(){n?.code&&(navigator.clipboard.writeText(n.code),P(!0),setTimeout(()=>P(!1),1500))}async function Ji(){if(l(null),!!n?.id){E(!0);try{const{data:y,error:G}=await v.rpc("make_group_invite",{p_group_id:n.id,p_hours:168,p_max_uses:null});if(G)throw G;const Q=`${window.location.origin}/invite/${y}`;await navigator.clipboard.writeText(Q),F(!0),setTimeout(()=>F(!1),1500)}catch(y){l(y.message)}finally{E(!1)}}}async function or(y){if(!y||!y[0]||!n)return;const G=y[0];if(G.size>4e6){ce("Image must be under 4MB.");return}const{data:Q}=await v.auth.getUser();if(!Q.user){ce("Sign in to share a moment.");return}X(!0);try{const oe=await new Promise((Ce,Ne)=>{const ve=new FileReader;ve.onload=()=>Ce(String(ve.result)),ve.onerror=()=>Ne(ve.error),ve.readAsDataURL(G)}),{error:ie}=await v.from("group_moments").insert({group_id:n.id,created_by:Q.user.id,photo_url:oe,verified:Re,min_view_level:Re?Math.max(2,Ut):1,caption:Re?"Verified meetup":null,verified_at:Re?new Date().toISOString():null});if(ie)throw ie;ce("Moment captured."),vn(Ce=>Ce+1)}catch(oe){ce(oe.message||"Could not save moment.")}finally{X(!1),setTimeout(()=>ce(null),2e3)}}const Zi=()=>St.current?.click(),ea=()=>Te.current?.click();function ta(y){const G=encodeURIComponent(`Moment review request ${y.id}`),Q=u?`Reporter: ${u}`:"Reporter: anonymous",oe=encodeURIComponent([`Moment ID: ${y.id}`,`Group ID: ${y.group_id}`,`Group title: ${n?.title||""}`,`Created by: ${y.created_by}`,Q,"","Reason: "].join(`
`));window.location.href=`mailto:${Ct}?subject=${G}&body=${oe}`}async function sa(){!n||!u||window.confirm("Delete this group?")&&(await v.from("groups").delete().match({id:n.id,host_id:u}),e("/browse"))}async function _t(){if(l(null),!(!n||!f)){M(!0);try{const{error:y}=await v.from("groups").update({description:I}).eq("id",n.id);if(y)throw y;i(G=>G?{...G,description:I}:null),L(!1)}catch(y){l(y.message||"Failed to save description")}finally{M(!1)}}}async function na(){if(l(null),!n||!f)return;const{data:y}=await v.auth.getUser();if(!y?.user)return;let G=null;if(Fs==="custom")Is&&(G=new Date(Is).toISOString());else{const ve=new Date,kt=parseInt(Fs);ve.setTime(ve.getTime()+kt*60*60*1e3),G=ve.toISOString()}const Q=(sr||"").split(/\r?\n/).map(ve=>ve.trim()).filter(Boolean).slice(0,20);Q.some(ve=>ve.toLowerCase()==="not coming")||Q.push("Not Coming");const{data:oe,error:ie}=await v.from("group_polls").insert({group_id:n.id,title:(Gt||"Schedule").trim(),created_by:y.user.id,closes_at:G,status:"open"}).select("id").single();if(ie||!oe?.id){console.error("Poll create error:",ie),l(ie?.message||"Failed to create poll. Check permissions.");return}let Ce=!1,Ne=[];if(Q.length){const ve=Q.map(_n=>({poll_id:oe.id,label:_n})),{data:kt,error:$s}=await v.from("group_poll_options").insert(ve).select("*").order("created_at");$s?(console.error("Option create error:",$s),l("Poll created but failed to add options."),Ce=!0):Ne=kt??[]}j(!1),Ce||l(null),O({id:oe.id,group_id:n.id,title:Gt,status:"open",closes_at:G,created_by:y.user.id}),ae(Ne),te({}),Ue(0);try{const ve=pe.map(kt=>kt.user_id).filter(kt=>kt!==y.user.id);ve.length&&await v.functions.invoke("push-dispatch",{body:{userIds:ve,type:"poll_created",payload:{group_id:n.id,poll_id:oe.id,title:Gt}}})}catch{}}async function Cn(){if(l(null),!(!N||!f)&&window.confirm("End voting? Everyone who hasn't voted will be marked as 'Not Coming'.")){me("closing");try{const{data:y,error:G}=await v.rpc("resolve_poll",{p_poll_id:N.id});if(G)throw G;O(Q=>Q&&{...Q,status:"closed"}),Nt(y||null)}catch(y){l(y.message)}finally{me(null)}}}async function ra(){if(l(null),!N||!window.confirm("Delete this voting?"))return;const{error:y}=await v.from("group_polls").delete().eq("id",N.id);y?(l("Could not delete. Check database permissions."),console.error(y)):O(null)}async function ia(y){if(!N||Nn||N.status==="closed")return;me(y);const{data:G}=await v.auth.getUser();if(!G?.user){e("/login");return}const{error:Q}=await v.from("group_votes").upsert({poll_id:N.id,option_id:y,user_id:G.user.id},{onConflict:"poll_id,user_id"});if(Q){console.error(Q),l("Failed to save vote"),me(null);return}const{data:oe}=await v.from("group_votes").select("option_id,user_id").eq("poll_id",N.id),ie={},Ce=new Set;oe?.forEach(Ne=>{ie[Ne.option_id]=(ie[Ne.option_id]||0)+1,Ce.add(Ne.user_id)}),te(ie),Ue(Ce.size),me(null)}return o?r.jsx("div",{className:"p-20 flex justify-center",children:r.jsx("div",{className:"animate-spin h-8 w-8 border-2 border-neutral-300 border-t-black rounded-full"})}):n?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"transition-all duration-300 min-h-screen bg-[#FDFBF7] pb-24 "+(m&&!x?"lg:mr-[min(92vw,520px)]":""),children:[r.jsxs("div",{className:"bg-white border-b border-neutral-200 pt-8 pb-6 px-4 shadow-sm relative overflow-hidden",children:[r.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-gradient-to-br from-emerald-50 to-blue-50 rounded-full blur-3xl -z-10 opacity-60"}),r.jsxs("div",{className:"mx-auto max-w-5xl",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-4 text-sm text-neutral-500",children:[r.jsxs(we,{to:"/browse",className:"flex items-center gap-1 hover:text-black transition-colors",children:[r.jsx(Sd,{className:"h-4 w-4"})," Browse"]}),r.jsx("span",{children:"/"}),r.jsx("span",{className:"font-medium text-neutral-800",children:"Group Detail"})]}),r.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-6",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("h1",{className:"text-3xl md:text-4xl font-extrabold text-neutral-900 tracking-tight leading-tight mb-3",children:n.title}),r.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[r.jsx("div",{className:"inline-flex items-center gap-1.5 bg-neutral-100 text-neutral-700 px-3 py-1 rounded-full text-xs font-semibold uppercase tracking-wide",children:n.category||"General"}),n.game&&r.jsx("div",{className:"inline-flex items-center gap-1.5 bg-indigo-50 text-indigo-700 px-3 py-1 rounded-full text-xs font-bold",children:n.game}),n.city&&r.jsxs("div",{className:"inline-flex items-center gap-1.5 border border-neutral-200 text-neutral-600 px-3 py-1 rounded-full text-xs font-medium",children:[r.jsx(tn,{className:"h-3 w-3"})," ",n.city]}),n.code&&r.jsx("button",{type:"button",onClick:Xi,className:"inline-flex items-center gap-1.5 bg-neutral-900 text-white px-3 py-1 rounded-full text-xs font-mono cursor-pointer hover:bg-neutral-800 active:scale-95 transition-transform",title:$?"Copied":"Click to copy invite code",children:String(n.code).toUpperCase()}),(n.requires_verification_level??1)>1&&r.jsxs("div",{className:"inline-flex items-center gap-1.5 bg-emerald-50 text-emerald-700 px-3 py-1 rounded-full text-xs font-bold",children:["Verified L",n.requires_verification_level,"+ only"]}),r.jsxs("div",{className:"inline-flex items-center gap-1.5 border border-neutral-200 text-neutral-600 px-3 py-1 rounded-full text-xs font-medium",children:[r.jsx(Ds,{className:"h-3 w-3"})," ",ne," / ",n.capacity]})]})]}),r.jsx("div",{className:"flex flex-wrap items-center gap-3",children:le?r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:()=>g(!0),className:"h-10 px-5 rounded-full bg-white border border-neutral-200 text-neutral-800 text-sm font-bold shadow-sm hover:bg-neutral-50 hover:border-neutral-300 flex items-center gap-2 transition-all",children:[r.jsx(Ml,{className:"h-4 w-4"})," Chat"]}),f&&r.jsxs("button",{onClick:Ji,className:"h-10 px-5 rounded-full bg-white border border-neutral-200 text-neutral-800 text-sm font-bold shadow-sm hover:bg-neutral-50 hover:border-neutral-300 flex items-center gap-2 transition-all",children:[r.jsx(Zd,{className:"h-4 w-4"})," ",z?"...":K?"Copied":"Invite"]})]}):r.jsx("button",{onClick:ir,disabled:$e>=ye,className:"h-10 px-6 rounded-full bg-emerald-600 text-white text-sm font-bold shadow-md hover:bg-emerald-700 hover:shadow-lg active:scale-95 transition-all disabled:opacity-60 disabled:cursor-not-allowed",children:$e>=ye?"Limit Reached":"Join Group"})})]})]})]}),c&&!b&&r.jsx("div",{className:"mx-auto max-w-5xl px-4 mt-4",children:r.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl text-sm font-bold flex items-center gap-2 shadow-sm animate-in fade-in slide-in-from-top-2",children:[r.jsx(Ta,{className:"h-4 w-4"}),c,r.jsx("button",{onClick:()=>l(null),className:"ml-auto hover:bg-red-100 p-1 rounded-full",children:r.jsx(Ln,{className:"h-3 w-3"})})]})}),r.jsxs("div",{className:"mx-auto max-w-5xl px-4 py-8 grid gap-8 lg:grid-cols-[2fr_1fr]",children:[r.jsxs("div",{className:"space-y-8",children:[r.jsxs("section",{className:"bg-white rounded-2xl p-6 shadow-sm border border-neutral-200/60 relative",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("h2",{className:"text-lg font-bold text-neutral-900 flex items-center gap-2",children:"About this Circle"}),f&&!S&&r.jsx("button",{onClick:()=>L(!0),className:"p-1.5 rounded-full text-neutral-400 hover:bg-neutral-100 hover:text-neutral-900 transition-colors",children:r.jsx(Hd,{className:"h-4 w-4"})})]}),S?r.jsxs("div",{className:"animate-in fade-in duration-200",children:[r.jsx("textarea",{value:I,onChange:y=>Z(y.target.value),className:"w-full min-h-[120px] p-3 rounded-xl border border-neutral-300 text-sm focus:ring-2 focus:ring-emerald-500 focus:border-transparent outline-none resize-y mb-3",placeholder:"What's the plan?"}),r.jsxs("div",{className:"flex gap-2 justify-end",children:[r.jsx("button",{onClick:()=>L(!1),className:"px-3 py-1.5 rounded-lg border border-neutral-200 text-xs font-bold hover:bg-neutral-50 text-neutral-600",children:"Cancel"}),r.jsx("button",{onClick:_t,disabled:q,className:"px-3 py-1.5 rounded-lg bg-black text-white text-xs font-bold hover:bg-neutral-800 disabled:opacity-50",children:q?"Saving...":"Save Changes"})]})]}):r.jsx("p",{className:"text-sm text-neutral-600 leading-relaxed whitespace-pre-wrap",children:n.description||r.jsx("span",{className:"italic text-neutral-400",children:"No description provided."})})]}),r.jsxs("section",{className:"bg-white rounded-2xl p-6 shadow-sm border border-neutral-200/60 relative",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2",children:[r.jsx("h2",{className:"text-lg font-bold text-neutral-900 flex items-center gap-2",children:"Moments"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:Zi,disabled:!le||C,className:`text-xs font-bold px-3 py-1.5 rounded-full ${le?"bg-black text-white":"bg-neutral-200 text-neutral-500 cursor-not-allowed"} ${C?"opacity-70":""}`,children:C?"Saving...":"Add"}),r.jsx("button",{onClick:ea,disabled:!le||C,className:`text-xs font-bold px-3 py-1.5 rounded-full border ${le?"bg-white text-neutral-800 border-neutral-300":"bg-neutral-100 text-neutral-400 border-neutral-200 cursor-not-allowed"} ${C?"opacity-70":""}`,children:C?"...":"Take Photo"}),r.jsx("input",{ref:St,type:"file",accept:"image/*",className:"hidden",disabled:!le||C,onChange:y=>{or(y.target.files),y.target&&(y.target.value="")}}),r.jsx("input",{ref:Te,type:"file",accept:"image/*",capture:"environment",className:"hidden",disabled:!le||C,onChange:y=>{or(y.target.files),y.target&&(y.target.value="")}})]})]}),J&&r.jsx("div",{className:"mb-3 text-xs font-semibold text-emerald-700 bg-emerald-50 border border-emerald-100 rounded-lg px-3 py-2",children:J}),Re&&r.jsx("div",{className:"mb-3 rounded-lg border border-amber-200 bg-amber-50 px-3 py-2 text-xs font-bold text-amber-800",children:"You're all here! Take a group selfie to verify this meetup."}),r.jsx("div",{className:"grid grid-cols-2 gap-3",children:us.map(y=>{const G=!y.verified||Ut<(y.min_view_level??1);return r.jsxs("div",{className:"relative overflow-hidden rounded-xl border border-neutral-200 bg-neutral-50",children:[r.jsx("img",{src:y.photo_url,className:"h-32 w-full object-cover"}),r.jsxs("div",{className:"absolute top-2 left-2 rounded-full bg-black/70 text-white text-[10px] font-bold px-2 py-0.5",children:[y.verified?"Verified":"Unverified"," â€¢ ",y.id.slice(0,8)]}),G&&r.jsx("div",{className:"absolute inset-0 flex items-end justify-start p-2",children:r.jsx("button",{type:"button",onClick:()=>ta(y),className:"rounded-lg bg-white/90 text-[10px] font-bold text-neutral-800 px-3 py-1.5 shadow-sm border border-neutral-200 hover:bg-white",children:"Not yet reviewed â€” report if inappropriate"})})]},y.id)})}),us.length===0&&r.jsx("div",{className:"text-sm text-neutral-500",children:"No moments yet. Share your first meetup photo."})]}),r.jsxs("section",{className:"grid sm:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-neutral-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center gap-2 text-neutral-400 text-xs font-bold uppercase mb-1",children:[r.jsx(kl,{className:"h-3 w-3"})," Created"]}),r.jsx("div",{className:"text-sm font-semibold text-neutral-900",children:new Date(n.created_at).toLocaleDateString()})]}),r.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-neutral-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center gap-2 text-neutral-400 text-xs font-bold uppercase mb-1",children:[r.jsx(ci,{className:"h-3 w-3"})," Format"]}),r.jsx("div",{className:"text-sm font-semibold text-neutral-900",children:n.is_online?n.online_link?"Online (Link set)":"Online":"In Person"})]})]}),le&&f&&r.jsxs("button",{onClick:sa,className:"flex items-center gap-2 text-red-600 text-sm font-medium hover:text-red-700 transition-colors px-2",children:[r.jsx(rh,{className:"h-4 w-4"})," Delete this group"]}),le&&!f&&r.jsxs("button",{onClick:Yi,className:"flex items-center gap-2 text-neutral-500 text-sm font-medium hover:text-neutral-800 transition-colors px-2",children:[r.jsx($d,{className:"h-4 w-4"})," Leave group"]})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-white border border-neutral-200 rounded-2xl p-5 shadow-sm",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-base font-bold text-neutral-900 flex items-center gap-2",children:"Polls & Events"}),f&&r.jsx("button",{onClick:()=>{l(null),j(!0)},className:"p-1.5 bg-neutral-50 rounded-full text-neutral-600 shadow-sm hover:scale-105 active:scale-95 transition-all border border-neutral-200 hover:bg-white hover:border-neutral-300",children:r.jsx(qr,{className:"h-4 w-4"})})]}),N?r.jsxs("div",{className:"animate-in slide-in-from-bottom-2 duration-500",children:[r.jsxs("div",{className:"flex justify-between items-start mb-3",children:[r.jsx("h3",{className:"font-bold text-neutral-900",children:N.title}),r.jsx("div",{className:`text-[10px] font-bold px-2 py-1 rounded-full border ${N.status==="closed"?"bg-neutral-200 text-neutral-600 border-neutral-300":Nn?"bg-red-50 text-red-600 border-red-100":"bg-emerald-50 text-emerald-700 border-emerald-100"}`,children:rr(N.status,N.closes_at)})]}),r.jsx("div",{className:"space-y-2 mb-4",children:H.map(y=>{const G=W[y.id]??0,oe=y.label==="Not Coming"?G+(ne-Oe):G,ie=ne>0?Math.round(oe/ne*100):0;return r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute inset-0 bg-neutral-100 rounded-lg transition-all duration-500",style:{width:`${ie}%`}}),r.jsxs("div",{className:"relative flex items-center justify-between p-2.5 rounded-lg border border-neutral-100 hover:border-neutral-200 transition-colors",children:[r.jsx("span",{className:"text-sm font-medium text-neutral-800 z-10",children:y.label}),r.jsxs("div",{className:"flex items-center gap-3 z-10",children:[r.jsx("span",{className:"text-xs font-bold text-neutral-600",children:oe}),N.status==="open"&&!Nn&&r.jsx("button",{onClick:()=>ia(y.id),className:`h-6 w-6 rounded-full flex items-center justify-center border transition-all hover:scale-110 active:scale-95 ${k===y.id?"bg-black border-black text-white":"bg-white border-neutral-200 text-neutral-600"}`,children:k===y.id?r.jsx("div",{className:"animate-spin h-3 w-3 border-2 border-white border-t-transparent rounded-full"}):r.jsx(Pa,{className:"h-3 w-3"})})]})]})]},y.id)})}),Ye&&r.jsxs("div",{className:"mb-3 rounded-xl border border-emerald-100 bg-emerald-50 px-3 py-2",children:[r.jsx("div",{className:"text-xs font-bold text-emerald-800",children:"Confirmed Event"}),r.jsx("div",{className:"text-sm font-semibold text-neutral-900",children:Ye.title}),r.jsxs("div",{className:"text-xs text-neutral-600",children:[Wi(Ye.starts_at)," ",Ye.place?`â€¢ ${Ye.place}`:""]}),r.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:r.jsx("button",{onClick:()=>Qi(Ye),className:"text-xs font-bold rounded-lg bg-black text-white px-3 py-1.5 hover:bg-neutral-800",children:"Add to Calendar"})})]}),f&&r.jsxs("div",{className:"flex flex-col gap-2 pt-3 border-t border-neutral-100",children:[N.status==="open"&&r.jsxs("button",{onClick:Cn,className:"w-full bg-black text-white text-xs font-bold py-3 rounded-xl hover:bg-neutral-800 shadow-sm flex items-center justify-center gap-2",children:[r.jsx(Pa,{className:"h-4 w-4"})," End & Count Games"]}),N.status==="closed"&&r.jsxs("button",{onClick:()=>{l(null),j(!0)},className:"w-full bg-neutral-100 text-neutral-700 text-xs font-bold py-3 rounded-xl hover:bg-neutral-200 flex items-center justify-center gap-2",children:[r.jsx(qr,{className:"h-4 w-4"})," Create New Vote"]}),r.jsx("button",{onClick:ra,className:"w-full text-red-600 text-xs font-bold py-2 hover:bg-red-50 rounded-xl",children:"Delete Poll"})]})]}):r.jsxs("div",{className:"text-center py-8 px-4 bg-neutral-50 rounded-xl border border-dashed border-neutral-200",children:[r.jsx("p",{className:"text-sm text-neutral-400 mb-2 font-medium",children:"No active polls"}),f&&r.jsx("button",{onClick:()=>{l(null),j(!0)},className:"text-xs text-black font-bold hover:underline",children:"Create one"})]})]}),r.jsxs("div",{className:"bg-white border border-neutral-200 rounded-2xl p-5 shadow-sm",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsxs("h2",{className:"text-sm font-bold text-neutral-900",children:["Members (",ne,")"]}),r.jsx("button",{onClick:()=>A(!0),className:"text-xs font-medium text-emerald-600 hover:underline",children:"View All"})]}),r.jsxs("div",{className:"flex -space-x-2 overflow-hidden cursor-pointer",onClick:()=>A(!0),children:[pe.slice(0,5).map(y=>r.jsx("div",{className:"h-8 w-8 rounded-full ring-2 ring-white bg-neutral-100 flex items-center justify-center text-[10px] font-bold text-neutral-500",title:y.name||"User",children:y.avatar_url?r.jsx("img",{src:y.avatar_url,alt:"",className:"h-full w-full object-cover rounded-full"}):(y.name||"?").slice(0,1)},y.user_id)),ne>5&&r.jsxs("div",{className:"h-8 w-8 rounded-full ring-2 ring-white bg-neutral-50 flex items-center justify-center text-[10px] font-bold text-neutral-400",children:["+",ne-5]})]})]})]})]})]}),b&&r.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:r.jsxs("div",{className:"w-full max-w-md bg-white rounded-2xl p-6 shadow-2xl ring-1 ring-black/5",children:[r.jsxs("div",{className:"flex justify-between items-center mb-5",children:[r.jsx("h3",{className:"text-xl font-bold text-neutral-900",children:"New Vote"}),r.jsx("button",{onClick:()=>j(!1),className:"p-1 rounded-full hover:bg-neutral-100 text-neutral-500",children:r.jsx(Ln,{className:"h-5 w-5"})})]}),c&&r.jsxs("div",{className:"mb-4 p-3 bg-red-50 text-red-600 rounded-xl text-sm font-bold border border-red-100 flex items-center gap-2 animate-in slide-in-from-top-1",children:[r.jsx(Ta,{className:"h-4 w-4 shrink-0"}),r.jsx("span",{children:c})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-neutral-400 uppercase mb-1.5",children:"Topic"}),r.jsx("input",{value:Gt,onChange:y=>ut(y.target.value),className:"w-full border border-neutral-200 rounded-xl px-4 py-3 text-sm font-medium focus:ring-2 focus:ring-black outline-none transition-all",placeholder:"e.g. When to play?"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-neutral-400 uppercase mb-1.5",children:"Duration"}),r.jsxs("div",{className:"flex gap-3",children:[r.jsxs("select",{value:Fs,onChange:y=>jn(y.target.value),className:"border border-neutral-200 bg-neutral-50 rounded-xl px-4 py-3 text-sm font-medium flex-1 outline-none focus:ring-2 focus:ring-black",children:[r.jsx("option",{value:"1",children:"1 Hour"}),r.jsx("option",{value:"24",children:"24 Hours"}),r.jsx("option",{value:"48",children:"2 Days"}),r.jsx("option",{value:"custom",children:"Custom..."})]}),Fs==="custom"&&r.jsx("input",{type:"datetime-local",value:Is,onChange:y=>nr(y.target.value),className:"border border-neutral-200 bg-neutral-50 rounded-xl px-3 py-3 text-sm font-medium flex-[1.5] outline-none focus:ring-2 focus:ring-black"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-neutral-400 uppercase mb-1.5",children:"Options (one per line)"}),r.jsx("textarea",{value:sr,onChange:y=>wn(y.target.value),className:"w-full border border-neutral-200 rounded-xl px-4 py-3 text-sm font-medium focus:ring-2 focus:ring-black outline-none min-h-[100px]",placeholder:`Saturday 20:00
Sunday 14:00`}),r.jsx("p",{className:"text-[10px] text-neutral-400 mt-1 italic text-right",children:'"Not Coming" added automatically.'})]}),r.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[r.jsx("button",{onClick:()=>j(!1),className:"px-5 py-2.5 text-sm font-bold text-neutral-500 hover:bg-neutral-50 rounded-xl transition-colors",children:"Cancel"}),r.jsx("button",{onClick:na,className:"px-6 py-2.5 text-sm font-bold bg-black text-white rounded-xl shadow-lg hover:bg-neutral-800 active:scale-95 transition-all",children:"Create Vote"})]})]})]})}),T&&r.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:r.jsxs("div",{className:"w-full max-w-sm bg-white rounded-3xl p-6 shadow-2xl overflow-hidden flex flex-col max-h-[80vh]",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4 shrink-0",children:[r.jsxs("h3",{className:"text-xl font-bold text-neutral-900",children:["Members (",pe.length,")"]}),r.jsx("button",{onClick:()=>A(!1),className:"p-1 rounded-full hover:bg-neutral-100 text-neutral-500",children:r.jsx(Ln,{className:"h-5 w-5"})})]}),r.jsx("div",{className:"flex-1 overflow-y-auto pr-2 space-y-2",children:pe.map(y=>r.jsxs("div",{onClick:()=>{R(y.user_id),_(!0)},className:"flex items-center justify-between p-2 rounded-xl hover:bg-neutral-50 transition-colors cursor-pointer",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-10 w-10 rounded-full bg-neutral-200 flex items-center justify-center overflow-hidden",children:y.avatar_url?r.jsx("img",{src:y.avatar_url,className:"w-full h-full object-cover"}):r.jsx("span",{className:"text-sm font-bold text-neutral-500",children:(y.name||"?").slice(0,1)})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-bold text-neutral-900",children:y.name||"User"}),xe(y.user_id)?r.jsxs("div",{className:"flex items-center gap-1 mt-0.5 animate-in fade-in slide-in-from-left-1",children:[r.jsxs("span",{className:"relative flex h-2 w-2",children:[r.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"}),r.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-emerald-500"})]}),r.jsx("span",{className:"text-[10px] font-bold text-emerald-600",children:"Here with you"})]}):r.jsxs(r.Fragment,{children:[y.role==="host"&&r.jsx("div",{className:"text-[10px] text-amber-600 font-bold uppercase tracking-wide",children:"Host"}),y.role==="owner"&&r.jsx("div",{className:"text-[10px] text-amber-600 font-bold uppercase tracking-wide",children:"Owner"}),y.role!=="host"&&y.role!=="owner"&&r.jsx("div",{className:"text-xs text-neutral-500 capitalize",children:y.role})]})]})]}),f&&y.user_id!==n.host_id&&r.jsx("button",{onClick:G=>{G.stopPropagation(),ar(y.user_id)},className:"text-[10px] font-bold text-amber-700 border border-amber-200 px-2 py-1 rounded-lg hover:bg-amber-50 disabled:opacity-50",disabled:be===y.user_id,children:be===y.user_id?"...":"Pass Torch"})]},y.user_id))})]})}),r.jsx(di,{isOpen:B,onClose:()=>_(!1),viewUserId:D}),m&&n&&r.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center p-4 animate-in zoom-in-95 duration-200",children:[r.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>g(!1)}),r.jsx("div",{className:"relative w-full max-w-2xl h-[85vh] bg-white rounded-3xl shadow-2xl overflow-hidden ring-1 ring-black/10",children:r.jsx(d.Suspense,{fallback:r.jsx("div",{className:"flex h-full items-center justify-center",children:"Loading..."}),children:r.jsx(Fh,{groupId:n.id,onClose:()=>{g(!1),w(!1)},full:!0,setFull:()=>{}})})})]})]}):r.jsx("div",{className:"p-10 text-center",children:"Group not found."})}const dr=12,$h=new Set(["games","study","outdoors"]);function qh({category:t,search:e}){const{user:s}=Vs(),n=s?.id||null,[i,o]=d.useState([]),[a,c]=d.useState(!1),[l,u]=d.useState(null),[h,f]=d.useState(0),[m,g]=d.useState(!1),[x,w]=d.useState(!1),[b,j]=d.useState({}),[T,A]=d.useState({}),[D,R]=d.useState({}),B=!0,_=!0;d.useEffect(()=>{let q=!0;return(async()=>{const{data:M,error:z}=await v.from("allowed_games").select("id, category").eq("is_active",!0);if(!q)return;if(z){R({});return}const E={};(M??[]).forEach(K=>{const F=String(K.category||"").toLowerCase(),$=String(K.id||"").toLowerCase();!F||!$||(E[F]||(E[F]=[]),E[F].push($))}),R(E)})(),()=>{q=!1}},[]);const S=d.useCallback(async q=>{try{if(!n||!q.length)return;const{data:M,error:z}=await v.from("group_reads").select("group_id,last_read_at").eq("user_id",n).in("group_id",q);if(z)throw z;const E={};(M??[]).forEach(P=>{E[P.group_id]=P.last_read_at??null});const K=q.map(async P=>{const N=E[P]??"1970-01-01T00:00:00Z",{count:O,error:H}=await v.from("group_messages").select("id",{count:"exact",head:!0}).eq("group_id",P).gt("created_at",N);return H?[P,0]:[P,O??0]}),F=await Promise.all(K),$={};F.forEach(([P,N])=>{$[P]=N}),A(P=>({...P,...$}))}catch{}},[n]),L=d.useCallback(async q=>{if(n)try{await v.rpc("mark_group_read",{p_group_id:q}),A(M=>({...M,[q]:0})),await v.from("notifications").update({is_read:!0}).eq("user_id",n).eq("payload->>group_id",q).eq("is_read",!1)}catch(M){console.warn("[markGroupRead]",M)}},[n]);d.useEffect(()=>{if(!n)return;const q=v.channel(`reads:${n}`).on("postgres_changes",{event:"*",schema:"public",table:"group_reads",filter:`user_id=eq.${n}`},async M=>{const z=M.new?.group_id||M.old?.group_id;z&&await S([z])}).subscribe();return()=>{v.removeChannel(q)}},[n,S]),d.useEffect(()=>{if(!n)return;const q=()=>{const E=i.map(K=>K.id);E.length&&S(E)};window.addEventListener("focus",q);const M=()=>{document.visibilityState==="visible"&&q()};document.addEventListener("visibilitychange",M);const z=window.setInterval(q,2e4);return()=>{window.removeEventListener("focus",q),document.removeEventListener("visibilitychange",M),window.clearInterval(z)}},[n,i,S]);const I=d.useCallback(async(q,M)=>{try{if(M?(c(!0),o([]),f(0),g(!1)):w(!0),u(null),(B||_)&&!n){o([]),u("Please sign in to view your groups."),c(!1),w(!1);return}if(!n){o([]),u("Please sign in to view your groups."),c(!1),w(!1);return}let z=[];const E=q*dr,K=E+dr-1,[F,$]=await Promise.all([v.from("group_members").select("group_id").eq("user_id",n),v.from("groups").select("id").eq("host_id",n)]);if(F.error)throw F.error;if($.error)throw $.error;const P=(F.data??[]).map(W=>W.group_id),N=($.data??[]).map(W=>W.id),O=new Set([...P,...N]),H=Array.from(O),ae=W=>{let te=W;const ne=t?t.toLowerCase():"";if(ne)if($h.has(ne)){const re=D[ne]??[];if(re.length>0){const Oe=re.join(",");te=te.or(`game.in.(${Oe}),category.eq.${ne}`)}else te=te.eq("category",ne)}else{const re=ne.replace(/[^a-z0-9]+/g,"");te=te.or(`game.eq.${re},game.ilike.*${ne}*,title.ilike.*${ne}*`)}if(e.trim()){const re=e.trim();te=te.or(`title.ilike.*${re}*,game.ilike.*${re}*`)}return te};if(H.length>0){let W=v.from("groups").select("id, title, description, city, capacity, category, game, created_at, host_id").in("id",H).order("created_at",{ascending:!1}).range(E,K);const{data:te,error:ne}=await ae(W);if(ne)throw ne;z=te??[]}else z=[];if(o(M?z:W=>[...W,...z]),f(q),g(z.length===dr),(z??[]).length>0){const W=z.map(re=>re.id);n&&W.length>0&&await S(W);const{data:te}=await v.from("group_polls").select("group_id").in("group_id",W).eq("status","open"),ne={};(te??[]).forEach(re=>{ne[re.group_id]=!0}),j(re=>({...re,...ne}))}}catch(z){u(z?.message??"Failed to load groups")}finally{c(!1),w(!1)}},[n,t,e,D,S]);d.useEffect(()=>{n&&I(0,!0)},[n,t,e,D,I]);const Z=d.useCallback(async()=>{if(!n||x)return;const q=h+1;await I(q,!1)},[n,h,x,I]);return{me:n,groups:i,loading:a,err:l,hasMore:m,paging:x,unreadCounts:T,openPolls:b,loadMore:Z,markGroupRead:L}}function Bh(t){if(!t)return"";try{return new Date(t).toLocaleDateString()}catch{return""}}function Uh(){const t=qt();return d.useMemo(()=>new URLSearchParams(t.search),[t.search])}function Gh(){const t=Uh(),e=t.get("category")||"",s=t.get("q")||"",{me:n,groups:i,loading:o,err:a,hasMore:c,paging:l,unreadCounts:u,openPolls:h,loadMore:f,markGroupRead:m}=qh({category:e,search:s});return r.jsxs("main",{className:"mx-auto max-w-5xl px-4 py-8",children:[r.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-semibold",children:"My Groups"}),s&&r.jsxs("p",{className:"text-sm text-neutral-600",children:["Filtered by: â€œ",s,"â€"]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(we,{to:"/browse",className:"text-sm underline",children:"Back"}),r.jsx(we,{to:"/create",className:"rounded-md bg-emerald-700 px-3 py-1.5 text-sm text-white hover:brightness-110",children:"New Group"})]})]}),r.jsx("div",{className:"mt-6 rounded-2xl border border-black/10 bg-white/90 p-5 shadow-sm backdrop-blur",children:o&&i.length===0?r.jsx("ul",{className:"divide-y divide-black/5",children:Array.from({length:6}).map((x,w)=>r.jsxs("li",{className:"rounded-xl border border-black/10 bg-white p-4 shadow-sm",children:[r.jsx("div",{className:"h-5 w-48 animate-pulse rounded bg-neutral-200"}),r.jsx("div",{className:"mt-2 h-3 w-5/6 animate-pulse rounded bg-neutral-200"}),r.jsx("div",{className:"mt-1 h-3 w-2/3 animate-pulse rounded bg-neutral-200"}),r.jsxs("div",{className:"mt-4 flex gap-2",children:[r.jsx("div",{className:"h-8 w-24 animate-pulse rounded bg-neutral-200"}),r.jsx("div",{className:"h-8 w-28 animate-pulse rounded bg-neutral-200"})]})]},w))}):a?r.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 p-4 text-red-800",children:a}):i.length===0?r.jsxs("div",{className:"flex flex-col items-center justify-center gap-3 p-10 text-center text-neutral-600",children:[r.jsxs("svg",{width:"36",height:"36",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"opacity-70",children:[r.jsx("path",{d:"M8 21h8"}),r.jsx("path",{d:"M12 17v4"}),r.jsx("path",{d:"M7 3h10l4 7H3l4-7Z"})]}),r.jsx("div",{className:"text-lg font-medium",children:"No groups found"}),r.jsx("div",{className:"text-sm",children:"Try a different filter or create a new one."}),r.jsxs("div",{className:"mt-2 flex justify-center gap-2",children:[r.jsx(we,{to:"/browse",className:"rounded-md border border-black/10 bg-white px-3 py-1.5 text-sm hover:bg-black/[0.04]",children:"Back"}),r.jsx(we,{to:"/create",className:"rounded-md bg-emerald-700 px-3 py-1.5 text-sm text-white hover:brightness-110",children:"New Group"})]})]}):r.jsxs(r.Fragment,{children:[r.jsx("ul",{className:"divide-y divide-black/5",children:i.map(x=>r.jsx("li",{className:"group py-1 first:pt-0 last:pb-0",children:r.jsx("div",{className:"flex items-center",children:r.jsx(we,{to:`/group/${x.id}`,onClick:()=>m(x.id),className:"block flex-1 rounded-lg px-2 py-2 hover:bg-black/[0.03] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-500 focus-visible:ring-offset-2",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"flex h-9 w-9 select-none items-center justify-center rounded-full border border-black/10 bg-neutral-100 text-sm font-semibold text-neutral-700",children:(x.title||x.game||"G").slice(0,1).toUpperCase()}),r.jsxs("div",{className:"min-w-0 flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"truncate text-base font-medium text-neutral-900",children:x.title??"Untitled group"}),x.host_id&&x.host_id===n&&r.jsx("span",{className:"shrink-0 rounded-full border border-amber-300 bg-amber-50 px-2 py-0.5 text-[11px] text-amber-800",children:"Host"})]}),r.jsx("div",{className:"mt-0.5 line-clamp-1 text-xs text-neutral-600",children:x.description??"No description"}),r.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-1 text-[11px] text-neutral-700",children:[x.category&&r.jsxs("span",{className:"rounded-full border border-black/10 bg-neutral-50 px-2 py-0.5",children:["#",x.category]}),x.game&&r.jsx("span",{className:"rounded-full border border-black/10 bg-neutral-50 px-2 py-0.5",children:x.game}),x.city&&r.jsx("span",{className:"rounded-full border border-black/10 bg-neutral-50 px-2 py-0.5",children:x.city}),x.capacity&&r.jsxs("span",{className:"rounded-full border border-black/10 bg-neutral-50 px-2 py-0.5",children:[x.capacity," slots"]}),x.created_at&&r.jsx("span",{className:"rounded-full border border-black/10 bg-neutral-50 px-2 py-0.5",children:Bh(x.created_at)})]})]}),r.jsxs("div",{className:"ml-1 flex items-center gap-1",children:[h[x.id]&&r.jsx("span",{className:"inline-flex h-6 items-center justify-center rounded-full bg-blue-600 px-2 text-xs font-semibold text-white",title:"Open voting","aria-label":"Open voting",children:"Vote"}),typeof u[x.id]=="number"&&u[x.id]>0&&r.jsx("span",{className:"inline-flex h-6 min-w-[1.5rem] items-center justify-center rounded-full bg-emerald-600 px-1 text-xs font-semibold text-white",title:`${u[x.id]} new messages`,"aria-label":`${u[x.id]} new messages`,children:u[x.id]>99?"99+":u[x.id]})]})]})})})},x.id))}),c&&r.jsx("div",{className:"mt-5 border-t border-black/5 p-4 text-center",children:r.jsx("button",{onClick:f,className:"inline-flex items-center gap-2 rounded-md border border-black/10 bg-white px-3 py-1.5 text-sm hover:bg-black/[0.04]",disabled:l,children:l?r.jsxs(r.Fragment,{children:[r.jsxs("svg",{className:"h-4 w-4 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),"Loadingâ€¦"]}):r.jsx(r.Fragment,{children:"Load more"})})})]})})]})}const zh=t=>console.log("[ok]",t),Kh=t=>console.error("[err]",t);function Hh(t){if(!t)return"â€”";const e=new Date(t);if(isNaN(e.getTime()))return"â€”";const s=Date.now(),n=Math.floor((s-e.getTime())/1e3);return n<5?"now":n<60?`${n}s`:n<3600?`${Math.floor(n/60)}m`:n<86400?`${Math.floor(n/3600)}h`:`${Math.floor(n/86400)}d`}function Wh(t,e){const s=(e??"").toString().trim();if(s)return s.toUpperCase();let n=2166136261;for(let o=0;o<t.length;o++)n^=t.charCodeAt(o),n+=(n<<1)+(n<<4)+(n<<7)+(n<<8)+(n<<24);return(n>>>0).toString(16).toUpperCase().padStart(8,"0").slice(-8)}const Qh=(()=>{const{State:t,City:e}=window.countryStateCity||{State:null,City:null};if(!t||!e)return[];try{const s=t.getStatesOfCountry("DE")||[],n=[];for(const i of s){const o=e.getCitiesOfState("DE",i.isoCode)||[];for(const a of o)a&&typeof a.name=="string"&&a.name.trim()&&n.push(a.name.trim())}return Array.from(new Set(n)).sort((i,o)=>i.localeCompare(o,"de"))}catch(s){return console.warn("Could not load cities list",s),[]}})();function Va(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone||"UTC"}catch{return"UTC"}}function Fa(){const t=jt(),e=qt(),{userId:s}=fn(),{user:n}=Vs(),i=n?.id,{data:o,isLoading:a,error:c}=Al(i??null);d.useEffect(()=>{o&&(ct(o.groups_created||0),Nt(o.groups_joined||0))},[o]),d.useEffect(()=>{i&&(async()=>{const{count:V,error:Y}=await v.from("groups").select("id",{count:"exact",head:!0}).or(`creator_id.eq.${i},host_id.eq.${i}`);if(Y){console.warn("Failed to load created groups count",Y);return}ct(V??0)})()},[i]),d.useEffect(()=>{i&&(async()=>{const{count:V,error:Y}=await v.from("group_members").select("group_id",{count:"exact",head:!0}).eq("user_id",i).in("status",["active","accepted"]);if(Y){console.warn("Failed to load joined groups count",Y);return}Nt(V??0)})()},[i]);const[l,u]=d.useState(!1),[h,f]=d.useState(!1),[m,g]=d.useState(!1),[x,w]=d.useState(!1),[b,j]=d.useState(!1),T=d.useRef(null),A=d.useRef(null),D=!!s&&s!==i,[R,B]=d.useState(""),[_,S]=d.useState(""),[L,I]=d.useState("UTC"),[Z,q]=d.useState(""),[M,z]=d.useState("system"),[E,K]=d.useState(!1),[F,$]=d.useState(!1),[P,N]=d.useState(!0),[O,H]=d.useState(null),[ae,W]=d.useState(!1),[te,ne]=d.useState(!1),[re,Oe]=d.useState([]),[Ue,k]=d.useState(null),[me,pe]=d.useState([]),[Pe,le]=d.useState(!1),[Ve,ye]=d.useState(null),[$e,lt]=d.useState(""),[Ut,cs]=d.useState(!1),[Ae,ct]=d.useState(0),[Ye,Nt]=d.useState(0),[us,bn]=d.useState(0),[ds,vn]=d.useState([]),[C,X]=d.useState([]),[J,ce]=d.useState([]),[be,Fe]=d.useState("created"),[xe,Re]=d.useState([]),[St,Te]=d.useState(new Map),[Ct,Gt]=d.useState([]),[ut,sr]=d.useState([]),[wn,Fs]=d.useState([]),[jn,Is]=d.useState(null),[nr,Nn]=d.useState(""),[rr,Wi]=d.useState(null),[Sn,Qi]=d.useState(!0),[ir,Yi]=d.useState(0),[ar,Xi]=d.useState(0),[Ji,or]=d.useState(0),[Zi,ea]=d.useState(!1),[ta,sa]=d.useState(null),[_t,na]=d.useState(null),[Cn,ra]=d.useState(!1),[ia,y]=d.useState("none"),[G,Q]=d.useState(0),[oe,ie]=d.useState(0),[Ce,Ne]=d.useState(!1),[ve,kt]=d.useState(!1),[$s,_n]=d.useState(null),[zx,Kx]=d.useState(null),aa=D?nr||(s?s.slice(0,6):""):o?.name||n?.email||"",oa=D?rr:o?.avatar_url,la=D?ir:o?.rating_avg,ca=D?ar:o?.rating_count,ua=(aa||"?").slice(0,2).toUpperCase()??"?";d.useMemo(()=>Ct.length+ut.length+wn.length,[Ct,ut,wn]),d.useMemo(()=>{const V=new Map;re.forEach(fe=>V.set(fe.other_id,fe));const Y=[...re];return xe.map(fe=>fe.user_id_a===i?fe.user_id_b:fe.user_id_a).forEach(fe=>{if(V.has(fe)||!i)return;const De=St.get(fe);Y.push({other_id:fe,name:De?.name&&De.name.trim()?De.name:fe.slice(0,6),avatar_url:De?.avatar_url??null,last_body:"",last_at:new Date(0).toISOString(),last_from_me:!1,unread:!1})}),Y.sort((fe,De)=>De.last_at>fe.last_at?1:De.last_at<fe.last_at?-1:0),Y},[re,xe,St,i]),d.useMemo(()=>{if(be==="created")return C;if(be==="joined")return J;const V=new Map;for(const Y of C)Y?.id&&V.set(Y.id,Y);for(const Y of J)Y?.id&&!V.has(Y.id)&&V.set(Y.id,Y);return Array.from(V.values())},[be,C,J]),d.useMemo(()=>{if(be==="created")return Ae;if(be==="joined")return Ye;const V=new Set;return C.forEach(Y=>Y?.id&&V.add(Y.id)),J.forEach(Y=>Y?.id&&V.add(Y.id)),V.size},[be,Ae,Ye,C,J]),d.useMemo(()=>{if(!_t)return 0;const V=new Date(_t).getTime();return Math.max(0,Math.floor((V-Date.now())/1e3))},[_t]),d.useMemo(()=>_t?new Date(_t).getTime()>Date.now()&&!Cn:!1,[_t,Cn]),d.useEffect(()=>{i&&(async()=>{const{data:V,error:Y}=await v.from("friendships").select("id,user_id_a,user_id_b,status").or(`and(user_id_a.eq.${i},status.eq.accepted),and(user_id_b.eq.${i},status.eq.accepted)`);if(Y&&console.error("Friend load error:",Y),Re(V||[]),V){const Me=V.map(Xe=>Xe.user_id_a===i?Xe.user_id_b:Xe.user_id_a),{data:fe}=await v.from("profiles").select("user_id,name,avatar_url").in("user_id",Me),De=new Map;fe?.forEach(Xe=>De.set(Xe.user_id,{name:Xe.name,avatar_url:Xe.avatar_url})),Te(De)}})()},[i]),d.useLayoutEffect(()=>{e.hash==="#chat"&&u(!0)},[e.key,e.hash]),d.useEffect(()=>{const V=()=>u(!0);return window.addEventListener("open-chat",V),()=>window.removeEventListener("open-chat",V)},[]),d.useEffect(()=>{function V(Y){const Me=Y.target;h&&A.current&&!A.current.contains(Me)&&f(!1),l&&T.current&&!T.current.contains(Me)&&u(!1)}return document.addEventListener("mousedown",V),()=>document.removeEventListener("mousedown",V)},[h,l]),d.useCallback(async V=>{cs(!1),ye(null),le(!0),pe([]),k(V),Oe(Me=>Me.map(fe=>fe.other_id===V?{...fe,unread:!1,last_from_me:!0}:fe));const{data:Y}=await v.from("direct_messages").select("id,sender,receiver,content,created_at").or(`and(sender.eq.${i},receiver.eq.${V}),and(sender.eq.${V},receiver.eq.${i})`).order("created_at",{ascending:!0}).limit(200);pe(Y??[]),le(!1)},[i]);function da(V){b&&jn===V||(Is(V),j(!0))}d.useEffect(()=>{if(!m||!i)return;const V=localStorage.getItem("theme");V&&z(V);const Y=localStorage.getItem("emailNotifs");Y&&K(Y==="1");const Me=localStorage.getItem("pushNotifs");Me&&$(Me==="1"),(async()=>{const{data:fe,error:De}=await v.from("profiles").select("name, city, timezone, interests, avatar_url, allow_ratings").eq("user_id",i).maybeSingle();if(De){H(De.message);return}const Xe=fe?.name??"";B(Xe),S(fe?.city??""),I(fe?.timezone??Va());const qs=Array.isArray(fe?.interests)?fe.interests:[];q(qs.join(", ")),_n(fe?.avatar_url??null),N(fe?.allow_ratings??!0)})()},[m,i]);async function uu(){if(i){H(null),W(!0);try{const V=R.trim();if(!V){H("Name cannot be empty."),W(!1);return}const Y=_.trim();if(!Y){H("Please choose a city."),W(!1);return}const Me=L.trim()||"UTC",fe=Z.split(",").map(Xe=>Xe.trim()).filter(Boolean),{error:De}=await v.from("profiles").update({name:V,city:Y,timezone:Me,interests:fe,allow_ratings:P,onboarded:!0}).eq("user_id",i);if(De)throw De;localStorage.setItem("theme",M),localStorage.setItem("emailNotifs",E?"1":"0"),localStorage.setItem("pushNotifs",F?"1":"0"),fu(M),H("Saved."),zh("Profile saved"),Ne(!1),setTimeout(()=>{g(!1),H(null)},1e3)}catch(V){const Y=V?.message||"Failed to save";H(Y),Kh(Y)}finally{W(!1)}}}async function du(V){if(N(V),!!i)try{await v.from("profiles").update({allow_ratings:V}).eq("user_id",i)}catch{}}async function hu(V){const Y=V.target.files?.[0];if(!(!i||!Y))try{ne(!0);const Me=Y.name.split(".").pop()||"jpg",fe=`${i}/${Date.now()}.${Me}`,{error:De}=await v.storage.from("avatars").upload(fe,Y,{upsert:!0});if(De)throw De;const{data:Xe}=v.storage.from("avatars").getPublicUrl(fe),qs=Xe?.publicUrl||null;qs&&(await v.from("profiles").update({avatar_url:qs}).eq("user_id",i),_n(qs))}catch(Me){console.error(Me),H("Avatar upload failed")}finally{ne(!1)}}function fu(V){const Y=document.documentElement;Y.classList.remove("light","dark"),V==="light"?Y.classList.add("light"):V==="dark"&&Y.classList.add("dark")}async function mu(){try{await v.auth.signOut()}catch{}try{localStorage.removeItem("onboardingSeen"),sessionStorage.clear()}catch{}const V=`${window.location.origin}/circles/`;try{if("serviceWorker"in navigator){const Y=await navigator.serviceWorker.getRegistrations();await Promise.all(Y.map(Me=>Me.unregister()))}}catch{}window.location.replace(V)}return a?r.jsx("div",{className:"flex h-screen items-center justify-center text-neutral-500",children:"Loading..."}):c||!o?r.jsx("div",{className:"p-4 text-red-500",children:"Failed to load profile."}):r.jsxs("div",{className:"mx-auto max-w-6xl px-4 pt-16 md:pt-20 pb-0",children:[r.jsx("div",{className:"grid gap-6 lg:grid-cols-[1fr_360px]",children:r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"mb-6 flex items-center gap-4",children:[r.jsx("div",{className:"grid h-16 w-16 place-content-center rounded-full bg-emerald-100 text-emerald-800 ring-1 ring-emerald-300/60 overflow-hidden",children:oa?r.jsx("img",{src:oa,alt:"",className:"h-16 w-16 object-cover"}):r.jsx("span",{className:"text-2xl font-semibold tracking-wide",children:ua})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"text-lg font-semibold text-neutral-900",children:aa}),r.jsxs("div",{className:"mt-1 flex items-center gap-3 text-sm text-neutral-700",title:`${(la??0).toFixed(1)} / 6 from ${ca??0} ratings`,children:[r.jsxs("span",{className:"inline-flex items-center gap-1",children:[Array.from({length:6}).map((V,Y)=>r.jsx("span",{children:Y<Math.round(la||0)?"â˜…":"â˜†"},Y)),r.jsxs("span",{className:"ml-1 text-xs text-neutral-500",children:["(",ca||0,")"]})]}),D&&r.jsx("button",{onClick:()=>da(s),className:"text-xs text-emerald-700 hover:underline",children:"Rate"})]}),!D&&r.jsx("div",{className:"text-sm text-neutral-600",children:n?.email}),!D&&r.jsx("div",{className:"mt-2 flex items-center gap-2",children:r.jsx("button",{onClick:()=>g(!0),className:"ml-2 rounded-md border border-black/10 bg-white px-3 py-1.5 text-sm hover:bg-black/[0.04]",children:"Settings"})})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsx(hr,{label:"Groups Created",value:Ae,onClick:()=>t("/groups?filter=created")}),r.jsx(hr,{label:"Groups Joined",value:Ye,onClick:()=>t("/groups?filter=joined")}),r.jsx(hr,{label:"Games Played",value:us})]}),r.jsx(Ia,{title:"Game Activity",count:ds.length,empty:"No game history yet.",children:ds.map(V=>r.jsxs("li",{className:"flex justify-between py-2",children:[r.jsx("span",{className:"font-medium text-neutral-900",children:V.game}),r.jsx("span",{className:"text-neutral-600 text-sm",children:V.count})]},V.game))}),r.jsx(Ia,{title:"Friends",count:xe.length,empty:"No friends yet.",children:xe.map(V=>{const Y=V.user_id_a===i?V.user_id_b:V.user_id_a,Me=St.get(Y);return r.jsx(Yh,{_otherId:Y,name:Me?.name||Y.slice(0,6),avatarUrl:Me?.avatar_url??null,lastBody:"",lastAt:new Date().toISOString(),unread:!1,onView:()=>da(Y)},Y)})})]})}),m&&r.jsx("div",{className:"fixed inset-0 z-50 grid place-items-center bg-black/40",children:r.jsxs("form",{onSubmit:V=>{V.preventDefault(),uu()},className:"w-[560px] max-w-[92vw] rounded-2xl border border-black/10 bg-white shadow-xl max-h-[90vh] overflow-hidden flex flex-col",children:[r.jsxs("div",{className:"flex-1 overflow-y-auto px-5 py-4 space-y-4",children:[r.jsxs("div",{className:"relative mb-2",children:[r.jsx("div",{className:"text-base font-semibold text-neutral-900",children:"Edit Profile"}),r.jsx("button",{type:"button",onClick:()=>g(!1),className:"absolute top-3 right-3 text-neutral-500 hover:text-neutral-800 text-xl leading-none",children:"Ã—"})]}),r.jsxs("div",{className:"rounded-xl border border-black/5 bg-neutral-50/80 p-4 shadow-inner space-y-4",children:[r.jsx("div",{className:"text-sm font-semibold text-neutral-700",children:"Profile"}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-sm font-medium text-neutral-800",children:"Name"}),r.jsx("input",{value:R,onChange:V=>{B(V.target.value),Ne(!0)},className:"w-full rounded-lg border border-black/10 bg-white px-3 py-2 text-sm focus:border-emerald-600",placeholder:"Your name",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-sm font-medium text-neutral-800",children:"Avatar"}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-10 w-10 rounded-full bg-neutral-200 grid place-items-center overflow-hidden",children:$s?r.jsx("img",{src:$s,alt:"",className:"h-10 w-10 object-cover"}):r.jsx("span",{className:"text-xs",children:ua})}),r.jsx("input",{type:"file",accept:"image/*",onChange:hu,className:"text-sm"}),te&&r.jsx("span",{className:"text-xs text-neutral-600",children:"Uploadingâ€¦"})]})]}),r.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-sm font-medium text-neutral-800",children:"City"}),r.jsx("input",{value:_,onChange:V=>{S(V.target.value),Ne(!0)},onBlur:()=>{(!L||L==="UTC")&&I(Va())},className:"w-full rounded-lg border border-black/10 bg-white px-3 py-2 text-sm focus:border-emerald-600",placeholder:"Start typingâ€¦ e.g., Berlin",list:"cities-de",required:!0}),r.jsx("datalist",{id:"cities-de",children:Qh.map(V=>r.jsx("option",{value:V},V))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-sm font-medium text-neutral-800",children:"Timezone"}),r.jsx("input",{value:L,onChange:V=>{I(V.target.value),Ne(!0)},className:"w-full rounded-lg border border-black/10 bg-white px-3 py-2 text-sm focus:border-emerald-600",placeholder:"e.g., Europe/Berlin"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-sm font-medium text-neutral-800",children:"Interests"}),r.jsx("input",{value:Z,onChange:V=>{q(V.target.value),Ne(!0)},className:"w-full rounded-lg border border-black/10 bg-white px-3 py-2 text-sm focus:border-emerald-600",placeholder:"comma, separated, tags"})]})]}),r.jsxs("div",{className:"rounded-xl border border-black/5 bg-neutral-50/80 p-4 shadow-inner space-y-3",children:[r.jsx("div",{className:"text-sm font-semibold text-neutral-700",children:"Appearance & Privacy"}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-sm font-medium text-neutral-800",children:"Theme"}),r.jsxs("select",{value:M,onChange:V=>z(V.target.value),className:"w-full rounded-lg border border-black/10 bg-white px-3 py-2 text-sm focus:border-emerald-600",children:[r.jsx("option",{value:"system",children:"System"}),r.jsx("option",{value:"light",children:"Light"}),r.jsx("option",{value:"dark",children:"Dark"})]})]}),r.jsxs("div",{className:"flex items-center justify-between gap-2 rounded-lg border border-black/5 bg-white px-3 py-2",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-medium text-neutral-800",children:"Allow profile ratings"}),r.jsx("div",{className:"text-[11px] text-neutral-500",children:"Others can rate you when enabled."})]}),r.jsx("button",{type:"button",onClick:()=>du(!P),className:`h-7 w-12 rounded-full ${P?"bg-emerald-600":"bg-neutral-300"} relative`,children:r.jsx("span",{className:`absolute top-0.5 h-6 w-6 rounded-full bg-white transition ${P?"right-0.5":"left-0.5"}`})})]})]}),r.jsxs("div",{className:"rounded-xl border border-black/5 bg-neutral-50/80 p-4 shadow-inner space-y-3",children:[r.jsx("div",{className:"text-sm font-semibold text-neutral-700",children:"Notifications"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{id:"emailNotifs",type:"checkbox",checked:E,onChange:V=>K(V.target.checked),className:"h-4 w-4 rounded border-black/20"}),r.jsx("label",{htmlFor:"emailNotifs",className:"text-sm text-neutral-800",children:"Email notifications"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{id:"pushNotifs",type:"checkbox",checked:F,onChange:V=>$(V.target.checked),className:"h-4 w-4 rounded border-black/20"}),r.jsx("label",{htmlFor:"pushNotifs",className:"text-sm text-neutral-800",children:"Push notifications"})]})]}),O&&r.jsx("div",{className:`rounded-md border px-3 py-2 text-sm ${O==="Saved."?"border-emerald-200 bg-emerald-50 text-emerald-700":"border-red-200 bg-red-50 text-red-700"}`,children:O})]}),r.jsxs("div",{className:"shrink-0 px-5 py-3 border-t border-black/10 space-y-3",children:[r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx("button",{type:"button",onClick:()=>g(!1),className:"rounded-md border border-black/10 bg-white px-3 py-1.5 text-sm",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:ae,className:`rounded-md px-3 py-1.5 text-sm text-white ${ae?"bg-neutral-400":"bg-emerald-600 hover:bg-emerald-700"}`,children:ae?"Savingâ€¦":"Save"})]}),r.jsx("button",{type:"button",onClick:mu,className:"w-full rounded-md border border-red-300 bg-red-50 px-3 py-2 text-sm text-red-700 hover:bg-red-100",children:"Sign Out"})]})]})}),r.jsx(di,{isOpen:b,onClose:()=>j(!1),viewUserId:jn})]})}const hr=as.memo(function({label:e,value:s,onClick:n}){const i=r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-sm text-neutral-600",children:e}),r.jsx("div",{className:"mt-1 text-2xl font-semibold text-neutral-900",children:s})]});return n?r.jsx("button",{onClick:n,className:"w-full rounded-xl border border-black/10 bg-white p-4 text-left shadow-sm hover:shadow disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-sm",disabled:!n,children:i}):r.jsx("div",{className:"rounded-xl border border-black/10 bg-white p-4 shadow-sm",children:i})}),Ia=as.memo(function({title:e,count:s,empty:n,children:i}){return r.jsxs("div",{className:"rounded-xl border border-black/10 bg-white p-4 shadow-sm",children:[r.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[r.jsx("h3",{className:"text-base font-medium text-neutral-900",children:e}),r.jsx("span",{className:"text-xs text-neutral-600",children:s})]}),as.Children.count(i)===0?r.jsx("p",{className:"text-sm text-neutral-600",children:n}):r.jsx("ul",{className:"divide-y",children:i})]})});as.memo(function({id:e,title:s,meta:n,code:i}){const o=Wh(String(e),i);return r.jsxs("li",{className:"flex items-center justify-between py-2",children:[r.jsxs("div",{children:[r.jsx(we,{to:`/group/${e}`,className:"font-medium text-neutral-900 hover:underline",children:s}),r.jsx("div",{className:"text-xs text-neutral-600",children:n}),r.jsxs("div",{className:"text-[11px] text-neutral-500 tracking-wider",children:["Code: ",o]})]}),r.jsx(we,{to:`/group/${e}`,className:"text-sm text-emerald-700 hover:underline",children:"Open"})]})});const Yh=as.memo(function({_otherId:e,name:s,avatarUrl:n,lastBody:i,lastAt:o,unread:a,onView:c}){return r.jsxs("li",{className:"flex items-center justify-between py-2",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-9 w-9 rounded-full bg-neutral-200 grid place-items-center text-xs font-medium overflow-hidden",children:n?r.jsx("img",{src:n,alt:"",className:"h-9 w-9 rounded-full object-cover"}):s.slice(0,2).toUpperCase()}),r.jsxs("div",{children:[r.jsx("button",{onClick:c,className:"font-medium text-neutral-900 hover:underline text-left",children:s}),r.jsx("div",{className:"text-xs text-neutral-600 truncate max-w-[220px]",children:i})]})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:"text-[10px] text-neutral-500",children:Hh(o)}),a&&r.jsx("span",{className:"h-2 w-2 rounded-full bg-emerald-600"})]})]})});function Xh(){const[t,e]=d.useState(null),[s,n]=d.useState(!0);return d.useEffect(()=>{let i=!0;v.auth.getUser().then(({data:a,error:c})=>{i&&(c&&console.error("Error fetching auth user",c),e(a?.user??null),n(!1))});const{data:{subscription:o}}=v.auth.onAuthStateChange((a,c)=>{i&&(e(c?.user??null),n(!1))});return()=>{i=!1,o.unsubscribe()}},[]),{user:t,loading:s}}function Jh(){const{user:t}=Xh(),[e,s]=d.useState(""),[n,i]=d.useState(""),[o,a]=d.useState(""),[c,l]=d.useState(""),[u,h]=d.useState(""),[f,m]=d.useState(!1),[g,x]=d.useState(null);if(!t)return null;async function w(b){b.preventDefault(),m(!0),x(null);const{error:j}=await v.from("profiles").update({name:e,username:n,city:o||null,timezone:c||null,interests:u||null,onboarded:!0}).eq("user_id",t.id);if(m(!1),j){x(j.message);return}window.location.href="/profile"}return r.jsx("div",{className:"min-h-dvh flex items-center justify-center px-4 py-8 bg-neutral-50",children:r.jsxs("div",{className:"w-full max-w-md rounded-xl border border-black/10 bg-white p-6 shadow-sm",children:[r.jsx("h1",{className:"text-xl font-semibold mb-2",children:"Create your profile"}),r.jsx("p",{className:"text-sm text-neutral-600 mb-6",children:"Just a few details so Circles can find the best groups for you."}),r.jsxs("form",{onSubmit:w,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Full name"}),r.jsx("input",{type:"text",value:e,onChange:b=>s(b.target.value),className:"w-full rounded-md border border-neutral-300 px-3 py-2 text-sm outline-none focus:border-black focus:ring-1 focus:ring-black",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Username"}),r.jsx("input",{type:"text",value:n,onChange:b=>i(b.target.value),className:"w-full rounded-md border border-neutral-300 px-3 py-2 text-sm outline-none focus:border-black focus:ring-1 focus:ring-black",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"City / Location"}),r.jsx("input",{type:"text",value:o,onChange:b=>a(b.target.value),className:"w-full rounded-md border border-neutral-300 px-3 py-2 text-sm outline-none focus:border-black focus:ring-1 focus:ring-black",placeholder:"e.g., Toronto, Berlin"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Timezone"}),r.jsx("input",{type:"text",value:c,onChange:b=>l(b.target.value),className:"w-full rounded-md border border-neutral-300 px-3 py-2 text-sm outline-none focus:border-black focus:ring-1 focus:ring-black",placeholder:"e.g., UTC-5, CET, PST"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Interests"}),r.jsx("textarea",{value:u,onChange:b=>h(b.target.value),rows:3,className:"w-full rounded-md border border-neutral-300 px-3 py-2 text-sm outline-none focus:border-black focus:ring-1 focus:ring-black resize-none",placeholder:"Games, study topics, outdoor hobbiesâ€¦"})]}),g&&r.jsx("p",{className:"text-sm text-red-600",children:g}),r.jsx("button",{type:"submit",disabled:f,className:"mt-2 w-full rounded-md bg-black px-3 py-2 text-sm font-medium text-white hover:bg-black/90 disabled:opacity-60",children:f?"Savingâ€¦":"Save and continue"})]})]})})}function Zh(t){if(!t)return"";try{return new Date(t).toLocaleDateString()}catch{return""}}function fr(t){if(!t)return"";try{return t.normalize("NFKD").replace(/\p{Diacritic}/gu,"").toLowerCase().trim()}catch{return t.toLowerCase().trim()}}function ef(){const{user:t}=Vs(),e=t?.id||null,{game:s=""}=fn(),n=(s||"").toLowerCase().replace(/[^a-z0-9]+/g,"").trim(),i=(s||"").replace(/-/g," ").trim(),[o,a]=d.useState([]),[c,l]=d.useState(null),[u,h]=d.useState(!0),[f,m]=d.useState(new Set),[g,x]=d.useState(null),[w,b]=d.useState(0),[j,T]=d.useState(1),A=7,[D,R]=d.useState("new"),[B,_]=d.useState({}),[S,L]=d.useState(""),[I,Z]=d.useState("all"),[q,M]=d.useState(null),[z,E]=d.useState(!1);async function K(){try{E(!0);const{data:P}=await v.auth.getUser(),N=P?.user?.id??null;if(!N){M(null),E(!1);return}const{data:O}=await v.from("profiles").select("city").eq("user_id",N).maybeSingle(),H=O?.city||null,ae=H&&typeof H=="string"?H.trim():null;M(ae)}catch{M(null)}finally{E(!1)}}d.useEffect(()=>{let P=!0;return(async()=>{h(!0);let N=v.from("groups").select("*").order("created_at",{ascending:!1}).limit(100);N=N.or(`game_slug.eq.${n},game.ilike.${i}`);const{data:O,error:H}=await N;if(P){if(H)l(H.message);else{const ae=O??[];a(ae);try{const W=ae.map(te=>te.id).filter(Boolean);if(W.length){const te=new Date(Date.now()-3e5).toISOString(),{data:ne}=await v.from("group_reads").select("group_id").in("group_id",W).gt("last_read_at",te),re={};(ne??[]).forEach(Oe=>{const Ue=String(Oe.group_id);re[Ue]=(re[Ue]??0)+1}),_(re)}}catch(W){console.warn(W)}}h(!1)}})(),()=>{P=!1}},[n,i]),d.useEffect(()=>{let P=!0;return(async()=>{if(!e){m(new Set),b(0),T(1);return}try{const{data:ae}=await v.from("profiles").select("verification_level").eq("user_id",e).maybeSingle();P&&T(ae?.verification_level??1)}catch{P&&T(1)}const{data:N,count:O}=await v.from("group_members").select("group_id",{count:"exact"}).eq("user_id",e).eq("status","active");if(!P)return;const H=new Set((N??[]).map(ae=>ae.group_id));m(H),b(O??N?.length??0)})(),()=>{P=!1}},[e]);async function F(P){if(!e){l("Sign in required");return}if(w>=A){l("You can only be in 7 circles at a time. Leave one to join another.");return}const N=Number(P.requires_verification_level??1);if(j<N){l("This circle is for verified members only. Increase your verification level to join.");return}x(P.id);const{error:O}=await v.from("group_members").insert({group_id:P.id,user_id:e,role:"member",status:"active",last_joined_at:new Date().toISOString()});if(x(null),!O||O.code==="23505"){const H=new Set(f);H.add(P.id),m(H),b(ae=>Math.min(A,ae+(f.has(P.id)?0:1)))}else{const H=(O.message||"").toLowerCase();H.includes("group_join_limit")?l("You can only be in 7 circles at a time. Leave one to join another."):H.includes("verification")?l("This circle is for verified members only."):l(O.message)}}const $=d.useMemo(()=>{let P=[...o];if(I==="mine"&&q){const O=fr(q);P=P.filter(H=>fr(H.city).includes(O))}const N=S.trim().toLowerCase();return N&&(P=P.filter(O=>fr(O.city).includes(N)||O.code&&O.code.toLowerCase().includes(N)||O.title&&O.title.toLowerCase().includes(N))),D==="online"?P.sort((O,H)=>(B[H.id]??0)-(B[O.id]??0)):P.sort((O,H)=>new Date(H.created_at??"").getTime()-new Date(O.created_at??"").getTime()),P},[o,I,q,S,D,B]);return d.useEffect(()=>{I==="mine"&&!q&&!z&&K()},[I]),r.jsxs("main",{className:"mx-auto max-w-3xl px-4 py-6 pb-32",children:[r.jsxs("div",{className:"mb-8",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx(we,{to:"/browse",className:"flex h-8 w-8 items-center justify-center rounded-full bg-neutral-100 hover:bg-neutral-200 transition-colors",children:r.jsx(Ts,{className:"h-4 w-4 text-neutral-700"})}),r.jsx("span",{className:"text-sm font-semibold text-neutral-500 uppercase tracking-wider",children:"Game"})]}),r.jsx("h1",{className:"text-3xl font-extrabold tracking-tight text-neutral-900 capitalize",children:i}),r.jsxs("p",{className:"mt-2 text-neutral-600",children:[o.length," active group",o.length!==1&&"s"," found."]}),r.jsxs("p",{className:"mt-1 text-xs font-semibold text-neutral-500",children:["Joined ",w,"/",A," circles."]}),c&&r.jsxs("div",{className:"mt-3 inline-flex items-center gap-2 rounded-xl border border-red-200 bg-red-50 px-3 py-2 text-xs font-bold text-red-700",children:[c,r.jsx("button",{onClick:()=>l(null),className:"text-red-500 hover:text-red-700",children:"Ã—"})]})]}),r.jsxs("div",{className:"sticky top-0 z-20 mb-6 flex flex-col gap-3 bg-neutral-50/95 py-2 backdrop-blur-sm sm:flex-row sm:items-center",children:[r.jsxs("div",{className:"relative flex-1",children:[r.jsx(ui,{className:"absolute left-3 top-2.5 h-4 w-4 text-neutral-400"}),r.jsx("input",{value:S,onChange:P=>L(P.target.value),placeholder:"Search city, title, or code...",className:"w-full rounded-xl border border-neutral-200 bg-white py-2 pl-9 pr-4 text-sm outline-none focus:border-black focus:ring-1 focus:ring-black"})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("select",{value:I,onChange:P=>Z(P.target.value),className:"rounded-xl border border-neutral-200 bg-white px-3 py-2 text-sm font-medium outline-none focus:border-black",children:[r.jsx("option",{value:"all",children:"All Cities"}),r.jsxs("option",{value:"mine",children:["My City ",q?`(${q})`:""]})]}),r.jsxs("select",{value:D,onChange:P=>R(P.target.value),className:"rounded-xl border border-neutral-200 bg-white px-3 py-2 text-sm font-medium outline-none focus:border-black",children:[r.jsx("option",{value:"new",children:"Newest"}),r.jsx("option",{value:"online",children:"Active"})]})]})]}),r.jsx("ul",{className:"space-y-3",children:$.map(P=>r.jsx("li",{className:"group relative overflow-hidden rounded-2xl border border-neutral-100 bg-white p-4 shadow-sm transition-all hover:shadow-md active:scale-[0.99]",children:r.jsxs("div",{className:"flex items-start justify-between gap-4",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("h2",{className:"truncate text-base font-bold text-neutral-900",children:P.title||"Untitled Group"}),P.is_online&&r.jsx("span",{className:"inline-flex items-center rounded-full bg-blue-50 px-2 py-0.5 text-[10px] font-bold text-blue-700 border border-blue-100",children:"ONLINE"})]}),r.jsx("p",{className:"line-clamp-1 text-sm text-neutral-600 mb-3",children:P.description||"No description"}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs text-neutral-500 font-medium",children:[r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(tn,{className:"h-3 w-3"}),P.city||"Anywhere"]}),r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(ci,{className:"h-3 w-3"}),Zh(P.created_at)]}),P.code&&r.jsxs("span",{className:"rounded-md bg-neutral-100 px-1.5 py-0.5 font-mono text-neutral-600",children:["#",P.code]})]})]}),r.jsx("div",{className:"flex flex-col items-end gap-2",children:f.has(P.id)?r.jsx(we,{to:`/group/${P.id}`,className:"rounded-full border border-neutral-200 bg-white px-4 py-1.5 text-xs font-bold text-neutral-900 hover:bg-neutral-50 transition-colors",children:"Open"}):r.jsx("button",{onClick:()=>F(P),disabled:g===P.id||w>=A,className:"rounded-full bg-black px-4 py-1.5 text-xs font-bold text-white shadow-sm hover:bg-neutral-800 disabled:opacity-50 transition-all",children:g===P.id?"Joining...":w>=A?"Limit Reached":"Join"})})]})},P.id))}),!u&&!c&&$.length===0&&r.jsx("div",{className:"py-10 text-center text-neutral-500",children:"No groups found."})]})}function tf(t){if(!t)return"";try{return new Date(t).toLocaleDateString()}catch{return""}}function sf(){const[t,e]=d.useState([]),[s,n]=d.useState(!0),[i,o]=d.useState(null);return d.useEffect(()=>{let a=!0;return(async()=>{try{n(!0),o(null);const{data:{session:c}}=await v.auth.getSession(),l=c?.user?.id;if(!l){e([]);return}const{data:u,error:h}=await v.from("group_members").select("group_id").eq("user_id",l);if(h)throw h;const f=(u??[]).map(x=>x.group_id).filter(Boolean);if(f.length===0){e([]);return}const{data:m,error:g}=await v.from("groups").select("*").in("id",f).order("created_at",{ascending:!1});if(g)throw g;if(!a)return;e(m??[])}catch(c){if(!a)return;o(c?.message??"Failed to load your groups"),e([])}finally{a&&n(!1)}})(),()=>{a=!1}},[]),r.jsxs("main",{className:"mx-auto max-w-3xl px-4 py-8 pb-32",children:[r.jsxs("div",{className:"mb-8",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(we,{to:"/browse",className:"flex h-10 w-10 items-center justify-center rounded-full bg-neutral-100 hover:bg-neutral-200 transition-colors",children:r.jsx(Ts,{className:"h-5 w-5 text-neutral-700"})}),r.jsx("h1",{className:"text-2xl font-extrabold tracking-tight text-neutral-900",children:"My Groups"})]}),r.jsxs(we,{to:"/create",className:"flex items-center gap-2 rounded-full bg-black px-4 py-2 text-xs font-bold text-white shadow-lg hover:bg-neutral-800 transition-all active:scale-95",children:[r.jsx(qr,{className:"h-4 w-4"}),r.jsx("span",{children:"New"})]})]}),r.jsx("p",{className:"text-sm text-neutral-500 ml-13",children:"Groups youâ€™ve joined or created."})]}),s&&r.jsx("ul",{className:"space-y-3",children:[1,2,3].map(a=>r.jsx("li",{className:"h-24 w-full animate-pulse rounded-2xl bg-white shadow-sm"},a))}),!!i&&r.jsx("div",{className:"rounded-xl border border-red-100 bg-red-50 p-4 text-sm text-red-600 font-medium",children:i}),!s&&!i&&t.length===0&&r.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[r.jsx("div",{className:"inline-flex h-16 w-16 items-center justify-center rounded-full bg-neutral-100 mb-4",children:r.jsx(Ds,{className:"h-8 w-8 text-neutral-400"})}),r.jsx("h3",{className:"text-lg font-bold text-neutral-900",children:"No groups yet"}),r.jsx("p",{className:"text-sm text-neutral-500 max-w-xs mx-auto mt-1 mb-6",children:"You haven't joined any circles yet. Find a game or create your own!"}),r.jsx(we,{to:"/browse",className:"rounded-full bg-black px-6 py-3 text-sm font-bold text-white shadow-lg hover:bg-neutral-800 transition-all active:scale-95",children:"Browse Games"})]}),r.jsx("ul",{className:"space-y-3",children:t.map(a=>r.jsx("li",{children:r.jsx(we,{to:`/group/${a.id}`,className:"group block relative overflow-hidden rounded-2xl border border-neutral-100 bg-white p-4 shadow-sm transition-all hover:shadow-md hover:border-neutral-200 active:scale-[0.99]",children:r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{className:"flex-1 min-w-0 pr-4",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("h2",{className:"truncate text-base font-bold text-neutral-900",children:a.title||"Untitled Group"}),a.is_online&&r.jsx("span",{className:"inline-flex items-center rounded-full bg-blue-50 px-2 py-0.5 text-[10px] font-bold text-blue-700 border border-blue-100",children:"ONLINE"})]}),r.jsx("p",{className:"line-clamp-1 text-sm text-neutral-600 mb-3",children:a.description||"No description"}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs text-neutral-500 font-medium",children:[a.category&&r.jsx("span",{className:"capitalize text-emerald-700 bg-emerald-50 px-2 py-0.5 rounded-md font-bold",children:a.game||a.category}),r.jsxs("span",{className:"flex items-center gap-0.5",children:[r.jsx(tn,{className:"h-3 w-3"}),a.city||"Online"]}),r.jsxs("span",{className:"flex items-center gap-0.5",children:[r.jsx(ci,{className:"h-3 w-3"}),tf(a.created_at)]})]})]}),r.jsx("div",{className:"h-8 w-8 flex-shrink-0 rounded-full bg-neutral-50 flex items-center justify-center text-neutral-300 group-hover:bg-black group-hover:text-white transition-colors",children:r.jsx(Ts,{className:"h-4 w-4 rotate-180"})})]})})},a.id))})]})}const fi=d.createContext({});function mi(t){const e=d.useRef(null);return e.current===null&&(e.current=t()),e.current}const Yn=d.createContext(null),pi=d.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class nf extends d.Component{getSnapshotBeforeUpdate(e){const s=this.props.childRef.current;if(s&&e.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=s.offsetHeight||0,n.width=s.offsetWidth||0,n.top=s.offsetTop,n.left=s.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function rf({children:t,isPresent:e}){const s=d.useId(),n=d.useRef(null),i=d.useRef({width:0,height:0,top:0,left:0}),{nonce:o}=d.useContext(pi);return d.useInsertionEffect(()=>{const{width:a,height:c,top:l,left:u}=i.current;if(e||!n.current||!a||!c)return;n.current.dataset.motionPopId=s;const h=document.createElement("style");return o&&(h.nonce=o),document.head.appendChild(h),h.sheet&&h.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${c}px !important;
            top: ${l}px !important;
            left: ${u}px !important;
          }
        `),()=>{document.head.removeChild(h)}},[e]),r.jsx(nf,{isPresent:e,childRef:n,sizeRef:i,children:d.cloneElement(t,{ref:n})})}const af=({children:t,initial:e,isPresent:s,onExitComplete:n,custom:i,presenceAffectsLayout:o,mode:a})=>{const c=mi(of),l=d.useId(),u=d.useCallback(f=>{c.set(f,!0);for(const m of c.values())if(!m)return;n&&n()},[c,n]),h=d.useMemo(()=>({id:l,initial:e,isPresent:s,custom:i,onExitComplete:u,register:f=>(c.set(f,!1),()=>c.delete(f))}),o?[Math.random(),u]:[s,u]);return d.useMemo(()=>{c.forEach((f,m)=>c.set(m,!1))},[s]),d.useEffect(()=>{!s&&!c.size&&n&&n()},[s]),a==="popLayout"&&(t=r.jsx(rf,{isPresent:s,children:t})),r.jsx(Yn.Provider,{value:h,children:t})};function of(){return new Map}function Dl(t=!0){const e=d.useContext(Yn);if(e===null)return[!0,null];const{isPresent:s,onExitComplete:n,register:i}=e,o=d.useId();d.useEffect(()=>{t&&i(o)},[t]);const a=d.useCallback(()=>t&&n&&n(o),[o,n,t]);return!s&&n?[!1,a]:[!0]}const En=t=>t.key||"";function $a(t){const e=[];return d.Children.forEach(t,s=>{d.isValidElement(s)&&e.push(s)}),e}const gi=typeof window<"u",Ll=gi?d.useLayoutEffect:d.useEffect,lf=({children:t,custom:e,initial:s=!0,onExitComplete:n,presenceAffectsLayout:i=!0,mode:o="sync",propagate:a=!1})=>{const[c,l]=Dl(a),u=d.useMemo(()=>$a(t),[t]),h=a&&!c?[]:u.map(En),f=d.useRef(!0),m=d.useRef(u),g=mi(()=>new Map),[x,w]=d.useState(u),[b,j]=d.useState(u);Ll(()=>{f.current=!1,m.current=u;for(let D=0;D<b.length;D++){const R=En(b[D]);h.includes(R)?g.delete(R):g.get(R)!==!0&&g.set(R,!1)}},[b,h.length,h.join("-")]);const T=[];if(u!==x){let D=[...u];for(let R=0;R<b.length;R++){const B=b[R],_=En(B);h.includes(_)||(D.splice(R,0,B),T.push(B))}o==="wait"&&T.length&&(D=T),j($a(D)),w(u);return}const{forceRender:A}=d.useContext(fi);return r.jsx(r.Fragment,{children:b.map(D=>{const R=En(D),B=a&&!c?!1:u===b||h.includes(R),_=()=>{if(g.has(R))g.set(R,!0);else return;let S=!0;g.forEach(L=>{L||(S=!1)}),S&&(A?.(),j(m.current),a&&l?.(),n&&n())};return r.jsx(af,{isPresent:B,initial:!f.current||s?void 0:!1,custom:B?void 0:e,presenceAffectsLayout:i,mode:o,onExitComplete:B?void 0:_,children:D},R)})})},Je=t=>t;let Ol=Je;function xi(t){let e;return()=>(e===void 0&&(e=t()),e)}const Es=(t,e,s)=>{const n=e-t;return n===0?1:(s-t)/n},bt=t=>t*1e3,vt=t=>t/1e3,cf={useManualTiming:!1};function uf(t){let e=new Set,s=new Set,n=!1,i=!1;const o=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function c(u){o.has(u)&&(l.schedule(u),t()),u(a)}const l={schedule:(u,h=!1,f=!1)=>{const g=f&&n?e:s;return h&&o.add(u),g.has(u)||g.add(u),u},cancel:u=>{s.delete(u),o.delete(u)},process:u=>{if(a=u,n){i=!0;return}n=!0,[e,s]=[s,e],e.forEach(c),e.clear(),n=!1,i&&(i=!1,l.process(u))}};return l}const An=["read","resolveKeyframes","update","preRender","render","postRender"],df=40;function Vl(t,e){let s=!1,n=!0;const i={delta:0,timestamp:0,isProcessing:!1},o=()=>s=!0,a=An.reduce((j,T)=>(j[T]=uf(o),j),{}),{read:c,resolveKeyframes:l,update:u,preRender:h,render:f,postRender:m}=a,g=()=>{const j=performance.now();s=!1,i.delta=n?1e3/60:Math.max(Math.min(j-i.timestamp,df),1),i.timestamp=j,i.isProcessing=!0,c.process(i),l.process(i),u.process(i),h.process(i),f.process(i),m.process(i),i.isProcessing=!1,s&&e&&(n=!1,t(g))},x=()=>{s=!0,n=!0,i.isProcessing||t(g)};return{schedule:An.reduce((j,T)=>{const A=a[T];return j[T]=(D,R=!1,B=!1)=>(s||x(),A.schedule(D,R,B)),j},{}),cancel:j=>{for(let T=0;T<An.length;T++)a[An[T]].cancel(j)},state:i,steps:a}}const{schedule:je,cancel:It,state:qe,steps:mr}=Vl(typeof requestAnimationFrame<"u"?requestAnimationFrame:Je,!0),Fl=d.createContext({strict:!1}),qa={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},As={};for(const t in qa)As[t]={isEnabled:e=>qa[t].some(s=>!!e[s])};function hf(t){for(const e in t)As[e]={...As[e],...t[e]}}const ff=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function qn(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||ff.has(t)}let Il=t=>!qn(t);function mf(t){t&&(Il=e=>e.startsWith("on")?!qn(e):t(e))}try{mf(require("@emotion/is-prop-valid").default)}catch{}function pf(t,e,s){const n={};for(const i in t)i==="values"&&typeof t.values=="object"||(Il(i)||s===!0&&qn(i)||!e&&!qn(i)||t.draggable&&i.startsWith("onDrag"))&&(n[i]=t[i]);return n}function gf(t){if(typeof Proxy>"u")return t;const e=new Map,s=(...n)=>t(...n);return new Proxy(s,{get:(n,i)=>i==="create"?t:(e.has(i)||e.set(i,t(i)),e.get(i))})}const Xn=d.createContext({});function sn(t){return typeof t=="string"||Array.isArray(t)}function Jn(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const yi=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],bi=["initial",...yi];function Zn(t){return Jn(t.animate)||bi.some(e=>sn(t[e]))}function $l(t){return!!(Zn(t)||t.variants)}function xf(t,e){if(Zn(t)){const{initial:s,animate:n}=t;return{initial:s===!1||sn(s)?s:void 0,animate:sn(n)?n:void 0}}return t.inherit!==!1?e:{}}function yf(t){const{initial:e,animate:s}=xf(t,d.useContext(Xn));return d.useMemo(()=>({initial:e,animate:s}),[Ba(e),Ba(s)])}function Ba(t){return Array.isArray(t)?t.join(" "):t}const bf=Symbol.for("motionComponentSymbol");function hs(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function vf(t,e,s){return d.useCallback(n=>{n&&t.onMount&&t.onMount(n),e&&(n?e.mount(n):e.unmount()),s&&(typeof s=="function"?s(n):hs(s)&&(s.current=n))},[e])}const vi=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),wf="framerAppearId",ql="data-"+vi(wf),{schedule:wi}=Vl(queueMicrotask,!1),Bl=d.createContext({});function jf(t,e,s,n,i){var o,a;const{visualElement:c}=d.useContext(Xn),l=d.useContext(Fl),u=d.useContext(Yn),h=d.useContext(pi).reducedMotion,f=d.useRef(null);n=n||l.renderer,!f.current&&n&&(f.current=n(t,{visualState:e,parent:c,props:s,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:h}));const m=f.current,g=d.useContext(Bl);m&&!m.projection&&i&&(m.type==="html"||m.type==="svg")&&Nf(f.current,s,i,g);const x=d.useRef(!1);d.useInsertionEffect(()=>{m&&x.current&&m.update(s,u)});const w=s[ql],b=d.useRef(!!w&&!(!((o=window.MotionHandoffIsComplete)===null||o===void 0)&&o.call(window,w))&&((a=window.MotionHasOptimisedAnimation)===null||a===void 0?void 0:a.call(window,w)));return Ll(()=>{m&&(x.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),wi.render(m.render),b.current&&m.animationState&&m.animationState.animateChanges())}),d.useEffect(()=>{m&&(!b.current&&m.animationState&&m.animationState.animateChanges(),b.current&&(queueMicrotask(()=>{var j;(j=window.MotionHandoffMarkAsComplete)===null||j===void 0||j.call(window,w)}),b.current=!1))}),m}function Nf(t,e,s,n){const{layoutId:i,layout:o,drag:a,dragConstraints:c,layoutScroll:l,layoutRoot:u}=e;t.projection=new s(t.latestValues,e["data-framer-portal-id"]?void 0:Ul(t.parent)),t.projection.setOptions({layoutId:i,layout:o,alwaysMeasureLayout:!!a||c&&hs(c),visualElement:t,animationType:typeof o=="string"?o:"both",initialPromotionConfig:n,layoutScroll:l,layoutRoot:u})}function Ul(t){if(t)return t.options.allowProjection!==!1?t.projection:Ul(t.parent)}function Sf({preloadedFeatures:t,createVisualElement:e,useRender:s,useVisualState:n,Component:i}){var o,a;t&&hf(t);function c(u,h){let f;const m={...d.useContext(pi),...u,layoutId:Cf(u)},{isStatic:g}=m,x=yf(u),w=n(u,g);if(!g&&gi){_f();const b=kf(m);f=b.MeasureLayout,x.visualElement=jf(i,w,m,e,b.ProjectionNode)}return r.jsxs(Xn.Provider,{value:x,children:[f&&x.visualElement?r.jsx(f,{visualElement:x.visualElement,...m}):null,s(i,u,vf(w,x.visualElement,h),w,g,x.visualElement)]})}c.displayName=`motion.${typeof i=="string"?i:`create(${(a=(o=i.displayName)!==null&&o!==void 0?o:i.name)!==null&&a!==void 0?a:""})`}`;const l=d.forwardRef(c);return l[bf]=i,l}function Cf({layoutId:t}){const e=d.useContext(fi).id;return e&&t!==void 0?e+"-"+t:t}function _f(t,e){d.useContext(Fl).strict}function kf(t){const{drag:e,layout:s}=As;if(!e&&!s)return{};const n={...e,...s};return{MeasureLayout:e?.isEnabled(t)||s?.isEnabled(t)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}const Pf=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function ji(t){return typeof t!="string"||t.includes("-")?!1:!!(Pf.indexOf(t)>-1||/[A-Z]/u.test(t))}function Ua(t){const e=[{},{}];return t?.values.forEach((s,n)=>{e[0][n]=s.get(),e[1][n]=s.getVelocity()}),e}function Ni(t,e,s,n){if(typeof e=="function"){const[i,o]=Ua(n);e=e(s!==void 0?s:t.custom,i,o)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[i,o]=Ua(n);e=e(s!==void 0?s:t.custom,i,o)}return e}const Ur=t=>Array.isArray(t),Tf=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),Mf=t=>Ur(t)?t[t.length-1]||0:t,ze=t=>!!(t&&t.getVelocity);function On(t){const e=ze(t)?t.get():t;return Tf(e)?e.toValue():e}function Ef({scrapeMotionValuesFromProps:t,createRenderState:e,onUpdate:s},n,i,o){const a={latestValues:Af(n,i,o,t),renderState:e()};return s&&(a.onMount=c=>s({props:n,current:c,...a}),a.onUpdate=c=>s(c)),a}const Gl=t=>(e,s)=>{const n=d.useContext(Xn),i=d.useContext(Yn),o=()=>Ef(t,e,n,i);return s?o():mi(o)};function Af(t,e,s,n){const i={},o=n(t,{});for(const m in o)i[m]=On(o[m]);let{initial:a,animate:c}=t;const l=Zn(t),u=$l(t);e&&u&&!l&&t.inherit!==!1&&(a===void 0&&(a=e.initial),c===void 0&&(c=e.animate));let h=s?s.initial===!1:!1;h=h||a===!1;const f=h?c:a;if(f&&typeof f!="boolean"&&!Jn(f)){const m=Array.isArray(f)?f:[f];for(let g=0;g<m.length;g++){const x=Ni(t,m[g]);if(x){const{transitionEnd:w,transition:b,...j}=x;for(const T in j){let A=j[T];if(Array.isArray(A)){const D=h?A.length-1:0;A=A[D]}A!==null&&(i[T]=A)}for(const T in w)i[T]=w[T]}}}return i}const Ls=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],ls=new Set(Ls),zl=t=>e=>typeof e=="string"&&e.startsWith(t),Kl=zl("--"),Rf=zl("var(--"),Si=t=>Rf(t)?Df.test(t.split("/*")[0].trim()):!1,Df=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Hl=(t,e)=>e&&typeof t=="number"?e.transform(t):t,wt=(t,e,s)=>s>e?e:s<t?t:s,Os={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},nn={...Os,transform:t=>wt(0,1,t)},Rn={...Os,default:1},pn=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Tt=pn("deg"),mt=pn("%"),se=pn("px"),Lf=pn("vh"),Of=pn("vw"),Ga={...mt,parse:t=>mt.parse(t)/100,transform:t=>mt.transform(t*100)},Vf={borderWidth:se,borderTopWidth:se,borderRightWidth:se,borderBottomWidth:se,borderLeftWidth:se,borderRadius:se,radius:se,borderTopLeftRadius:se,borderTopRightRadius:se,borderBottomRightRadius:se,borderBottomLeftRadius:se,width:se,maxWidth:se,height:se,maxHeight:se,top:se,right:se,bottom:se,left:se,padding:se,paddingTop:se,paddingRight:se,paddingBottom:se,paddingLeft:se,margin:se,marginTop:se,marginRight:se,marginBottom:se,marginLeft:se,backgroundPositionX:se,backgroundPositionY:se},Ff={rotate:Tt,rotateX:Tt,rotateY:Tt,rotateZ:Tt,scale:Rn,scaleX:Rn,scaleY:Rn,scaleZ:Rn,skew:Tt,skewX:Tt,skewY:Tt,distance:se,translateX:se,translateY:se,translateZ:se,x:se,y:se,z:se,perspective:se,transformPerspective:se,opacity:nn,originX:Ga,originY:Ga,originZ:se},za={...Os,transform:Math.round},Ci={...Vf,...Ff,zIndex:za,size:se,fillOpacity:nn,strokeOpacity:nn,numOctaves:za},If={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},$f=Ls.length;function qf(t,e,s){let n="",i=!0;for(let o=0;o<$f;o++){const a=Ls[o],c=t[a];if(c===void 0)continue;let l=!0;if(typeof c=="number"?l=c===(a.startsWith("scale")?1:0):l=parseFloat(c)===0,!l||s){const u=Hl(c,Ci[a]);if(!l){i=!1;const h=If[a]||a;n+=`${h}(${u}) `}s&&(e[a]=u)}}return n=n.trim(),s?n=s(e,i?"":n):i&&(n="none"),n}function _i(t,e,s){const{style:n,vars:i,transformOrigin:o}=t;let a=!1,c=!1;for(const l in e){const u=e[l];if(ls.has(l)){a=!0;continue}else if(Kl(l)){i[l]=u;continue}else{const h=Hl(u,Ci[l]);l.startsWith("origin")?(c=!0,o[l]=h):n[l]=h}}if(e.transform||(a||s?n.transform=qf(e,t.transform,s):n.transform&&(n.transform="none")),c){const{originX:l="50%",originY:u="50%",originZ:h=0}=o;n.transformOrigin=`${l} ${u} ${h}`}}const Bf={offset:"stroke-dashoffset",array:"stroke-dasharray"},Uf={offset:"strokeDashoffset",array:"strokeDasharray"};function Gf(t,e,s=1,n=0,i=!0){t.pathLength=1;const o=i?Bf:Uf;t[o.offset]=se.transform(-n);const a=se.transform(e),c=se.transform(s);t[o.array]=`${a} ${c}`}function Ka(t,e,s){return typeof t=="string"?t:se.transform(e+s*t)}function zf(t,e,s){const n=Ka(e,t.x,t.width),i=Ka(s,t.y,t.height);return`${n} ${i}`}function ki(t,{attrX:e,attrY:s,attrScale:n,originX:i,originY:o,pathLength:a,pathSpacing:c=1,pathOffset:l=0,...u},h,f){if(_i(t,u,f),h){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:m,style:g,dimensions:x}=t;m.transform&&(x&&(g.transform=m.transform),delete m.transform),x&&(i!==void 0||o!==void 0||g.transform)&&(g.transformOrigin=zf(x,i!==void 0?i:.5,o!==void 0?o:.5)),e!==void 0&&(m.x=e),s!==void 0&&(m.y=s),n!==void 0&&(m.scale=n),a!==void 0&&Gf(m,a,c,l,!1)}const Pi=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),Wl=()=>({...Pi(),attrs:{}}),Ti=t=>typeof t=="string"&&t.toLowerCase()==="svg";function Ql(t,{style:e,vars:s},n,i){Object.assign(t.style,e,i&&i.getProjectionStyles(n));for(const o in s)t.style.setProperty(o,s[o])}const Yl=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Xl(t,e,s,n){Ql(t,e,void 0,n);for(const i in e.attrs)t.setAttribute(Yl.has(i)?i:vi(i),e.attrs[i])}const Bn={};function Kf(t){Object.assign(Bn,t)}function Jl(t,{layout:e,layoutId:s}){return ls.has(t)||t.startsWith("origin")||(e||s!==void 0)&&(!!Bn[t]||t==="opacity")}function Mi(t,e,s){var n;const{style:i}=t,o={};for(const a in i)(ze(i[a])||e.style&&ze(e.style[a])||Jl(a,t)||((n=s?.getValue(a))===null||n===void 0?void 0:n.liveStyle)!==void 0)&&(o[a]=i[a]);return o}function Zl(t,e,s){const n=Mi(t,e,s);for(const i in t)if(ze(t[i])||ze(e[i])){const o=Ls.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;n[o]=t[i]}return n}function Hf(t,e){try{e.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const Ha=["x","y","width","height","cx","cy","r"],Wf={useVisualState:Gl({scrapeMotionValuesFromProps:Zl,createRenderState:Wl,onUpdate:({props:t,prevProps:e,current:s,renderState:n,latestValues:i})=>{if(!s)return;let o=!!t.drag;if(!o){for(const c in i)if(ls.has(c)){o=!0;break}}if(!o)return;let a=!e;if(e)for(let c=0;c<Ha.length;c++){const l=Ha[c];t[l]!==e[l]&&(a=!0)}a&&je.read(()=>{Hf(s,n),je.render(()=>{ki(n,i,Ti(s.tagName),t.transformTemplate),Xl(s,n)})})}})},Qf={useVisualState:Gl({scrapeMotionValuesFromProps:Mi,createRenderState:Pi})};function ec(t,e,s){for(const n in e)!ze(e[n])&&!Jl(n,s)&&(t[n]=e[n])}function Yf({transformTemplate:t},e){return d.useMemo(()=>{const s=Pi();return _i(s,e,t),Object.assign({},s.vars,s.style)},[e])}function Xf(t,e){const s=t.style||{},n={};return ec(n,s,t),Object.assign(n,Yf(t,e)),n}function Jf(t,e){const s={},n=Xf(t,e);return t.drag&&t.dragListener!==!1&&(s.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(s.tabIndex=0),s.style=n,s}function Zf(t,e,s,n){const i=d.useMemo(()=>{const o=Wl();return ki(o,e,Ti(n),t.transformTemplate),{...o.attrs,style:{...o.style}}},[e]);if(t.style){const o={};ec(o,t.style,t),i.style={...o,...i.style}}return i}function em(t=!1){return(s,n,i,{latestValues:o},a)=>{const l=(ji(s)?Zf:Jf)(n,o,a,s),u=pf(n,typeof s=="string",t),h=s!==d.Fragment?{...u,...l,ref:i}:{},{children:f}=n,m=d.useMemo(()=>ze(f)?f.get():f,[f]);return d.createElement(s,{...h,children:m})}}function tm(t,e){return function(n,{forwardMotionProps:i}={forwardMotionProps:!1}){const a={...ji(n)?Wf:Qf,preloadedFeatures:t,useRender:em(i),createVisualElement:e,Component:n};return Sf(a)}}function tc(t,e){if(!Array.isArray(e))return!1;const s=e.length;if(s!==t.length)return!1;for(let n=0;n<s;n++)if(e[n]!==t[n])return!1;return!0}function er(t,e,s){const n=t.getProps();return Ni(n,e,s!==void 0?s:n.custom,t)}const sm=xi(()=>window.ScrollTimeline!==void 0);class nm{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,s){for(let n=0;n<this.animations.length;n++)this.animations[n][e]=s}attachTimeline(e,s){const n=this.animations.map(i=>{if(sm()&&i.attachTimeline)return i.attachTimeline(e);if(typeof s=="function")return s(i)});return()=>{n.forEach((i,o)=>{i&&i(),this.animations[o].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let s=0;s<this.animations.length;s++)e=Math.max(e,this.animations[s].duration);return e}runAll(e){this.animations.forEach(s=>s[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class rm extends nm{then(e,s){return Promise.all(this.animations).then(e).catch(s)}}function Ei(t,e){return t?t[e]||t.default||t:void 0}const Gr=2e4;function sc(t){let e=0;const s=50;let n=t.next(e);for(;!n.done&&e<Gr;)e+=s,n=t.next(e);return e>=Gr?1/0:e}function Ai(t){return typeof t=="function"}function Wa(t,e){t.timeline=e,t.onfinish=null}const Ri=t=>Array.isArray(t)&&typeof t[0]=="number",im={linearEasing:void 0};function am(t,e){const s=xi(t);return()=>{var n;return(n=im[e])!==null&&n!==void 0?n:s()}}const Un=am(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),nc=(t,e,s=10)=>{let n="";const i=Math.max(Math.round(e/s),2);for(let o=0;o<i;o++)n+=t(Es(0,i-1,o))+", ";return`linear(${n.substring(0,n.length-2)})`};function rc(t){return!!(typeof t=="function"&&Un()||!t||typeof t=="string"&&(t in zr||Un())||Ri(t)||Array.isArray(t)&&t.every(rc))}const zs=([t,e,s,n])=>`cubic-bezier(${t}, ${e}, ${s}, ${n})`,zr={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:zs([0,.65,.55,1]),circOut:zs([.55,0,1,.45]),backIn:zs([.31,.01,.66,-.59]),backOut:zs([.33,1.53,.69,.99])};function ic(t,e){if(t)return typeof t=="function"&&Un()?nc(t,e):Ri(t)?zs(t):Array.isArray(t)?t.map(s=>ic(s,e)||zr.easeOut):zr[t]}const it={x:!1,y:!1};function ac(){return it.x||it.y}function om(t,e,s){var n;if(t instanceof Element)return[t];if(typeof t=="string"){let i=document;const o=(n=void 0)!==null&&n!==void 0?n:i.querySelectorAll(t);return o?Array.from(o):[]}return Array.from(t)}function oc(t,e){const s=om(t),n=new AbortController,i={passive:!0,...e,signal:n.signal};return[s,i,()=>n.abort()]}function Qa(t){return e=>{e.pointerType==="touch"||ac()||t(e)}}function lm(t,e,s={}){const[n,i,o]=oc(t,s),a=Qa(c=>{const{target:l}=c,u=e(c);if(typeof u!="function"||!l)return;const h=Qa(f=>{u(f),l.removeEventListener("pointerleave",h)});l.addEventListener("pointerleave",h,i)});return n.forEach(c=>{c.addEventListener("pointerenter",a,i)}),o}const lc=(t,e)=>e?t===e?!0:lc(t,e.parentElement):!1,Di=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,cm=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function um(t){return cm.has(t.tagName)||t.tabIndex!==-1}const Ks=new WeakSet;function Ya(t){return e=>{e.key==="Enter"&&t(e)}}function pr(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const dm=(t,e)=>{const s=t.currentTarget;if(!s)return;const n=Ya(()=>{if(Ks.has(s))return;pr(s,"down");const i=Ya(()=>{pr(s,"up")}),o=()=>pr(s,"cancel");s.addEventListener("keyup",i,e),s.addEventListener("blur",o,e)});s.addEventListener("keydown",n,e),s.addEventListener("blur",()=>s.removeEventListener("keydown",n),e)};function Xa(t){return Di(t)&&!ac()}function hm(t,e,s={}){const[n,i,o]=oc(t,s),a=c=>{const l=c.currentTarget;if(!Xa(c)||Ks.has(l))return;Ks.add(l);const u=e(c),h=(g,x)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",m),!(!Xa(g)||!Ks.has(l))&&(Ks.delete(l),typeof u=="function"&&u(g,{success:x}))},f=g=>{h(g,s.useGlobalTarget||lc(l,g.target))},m=g=>{h(g,!1)};window.addEventListener("pointerup",f,i),window.addEventListener("pointercancel",m,i)};return n.forEach(c=>{!um(c)&&c.getAttribute("tabindex")===null&&(c.tabIndex=0),(s.useGlobalTarget?window:c).addEventListener("pointerdown",a,i),c.addEventListener("focus",u=>dm(u,i),i)}),o}function fm(t){return t==="x"||t==="y"?it[t]?null:(it[t]=!0,()=>{it[t]=!1}):it.x||it.y?null:(it.x=it.y=!0,()=>{it.x=it.y=!1})}const cc=new Set(["width","height","top","left","right","bottom",...Ls]);let Vn;function mm(){Vn=void 0}const pt={now:()=>(Vn===void 0&&pt.set(qe.isProcessing||cf.useManualTiming?qe.timestamp:performance.now()),Vn),set:t=>{Vn=t,queueMicrotask(mm)}};function Li(t,e){t.indexOf(e)===-1&&t.push(e)}function Oi(t,e){const s=t.indexOf(e);s>-1&&t.splice(s,1)}class Vi{constructor(){this.subscriptions=[]}add(e){return Li(this.subscriptions,e),()=>Oi(this.subscriptions,e)}notify(e,s,n){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,s,n);else for(let o=0;o<i;o++){const a=this.subscriptions[o];a&&a(e,s,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function uc(t,e){return e?t*(1e3/e):0}const Ja=30,pm=t=>!isNaN(parseFloat(t));class gm{constructor(e,s={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(n,i=!0)=>{const o=pt.now();this.updatedAt!==o&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=s.owner}setCurrent(e){this.current=e,this.updatedAt=pt.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=pm(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,s){this.events[e]||(this.events[e]=new Vi);const n=this.events[e].add(s);return e==="change"?()=>{n(),je.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,s){this.passiveEffect=e,this.stopPassiveEffect=s}set(e,s=!0){!s||!this.passiveEffect?this.updateAndNotify(e,s):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,s,n){this.set(s),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,s=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,s&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=pt.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>Ja)return 0;const s=Math.min(this.updatedAt-this.prevUpdatedAt,Ja);return uc(parseFloat(this.current)-parseFloat(this.prevFrameValue),s)}start(e){return this.stop(),new Promise(s=>{this.hasAnimated=!0,this.animation=e(s),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function rn(t,e){return new gm(t,e)}function xm(t,e,s){t.hasValue(e)?t.getValue(e).set(s):t.addValue(e,rn(s))}function ym(t,e){const s=er(t,e);let{transitionEnd:n={},transition:i={},...o}=s||{};o={...o,...n};for(const a in o){const c=Mf(o[a]);xm(t,a,c)}}function bm(t){return!!(ze(t)&&t.add)}function Kr(t,e){const s=t.getValue("willChange");if(bm(s))return s.add(e)}function dc(t){return t.props[ql]}const hc=(t,e,s)=>(((1-3*s+3*e)*t+(3*s-6*e))*t+3*e)*t,vm=1e-7,wm=12;function jm(t,e,s,n,i){let o,a,c=0;do a=e+(s-e)/2,o=hc(a,n,i)-t,o>0?s=a:e=a;while(Math.abs(o)>vm&&++c<wm);return a}function gn(t,e,s,n){if(t===e&&s===n)return Je;const i=o=>jm(o,0,1,t,s);return o=>o===0||o===1?o:hc(i(o),e,n)}const fc=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,mc=t=>e=>1-t(1-e),pc=gn(.33,1.53,.69,.99),Fi=mc(pc),gc=fc(Fi),xc=t=>(t*=2)<1?.5*Fi(t):.5*(2-Math.pow(2,-10*(t-1))),Ii=t=>1-Math.sin(Math.acos(t)),yc=mc(Ii),bc=fc(Ii),vc=t=>/^0[^.\s]+$/u.test(t);function Nm(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||vc(t):!0}const Ws=t=>Math.round(t*1e5)/1e5,$i=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Sm(t){return t==null}const Cm=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,qi=(t,e)=>s=>!!(typeof s=="string"&&Cm.test(s)&&s.startsWith(t)||e&&!Sm(s)&&Object.prototype.hasOwnProperty.call(s,e)),wc=(t,e,s)=>n=>{if(typeof n!="string")return n;const[i,o,a,c]=n.match($i);return{[t]:parseFloat(i),[e]:parseFloat(o),[s]:parseFloat(a),alpha:c!==void 0?parseFloat(c):1}},_m=t=>wt(0,255,t),gr={...Os,transform:t=>Math.round(_m(t))},Qt={test:qi("rgb","red"),parse:wc("red","green","blue"),transform:({red:t,green:e,blue:s,alpha:n=1})=>"rgba("+gr.transform(t)+", "+gr.transform(e)+", "+gr.transform(s)+", "+Ws(nn.transform(n))+")"};function km(t){let e="",s="",n="",i="";return t.length>5?(e=t.substring(1,3),s=t.substring(3,5),n=t.substring(5,7),i=t.substring(7,9)):(e=t.substring(1,2),s=t.substring(2,3),n=t.substring(3,4),i=t.substring(4,5),e+=e,s+=s,n+=n,i+=i),{red:parseInt(e,16),green:parseInt(s,16),blue:parseInt(n,16),alpha:i?parseInt(i,16)/255:1}}const Hr={test:qi("#"),parse:km,transform:Qt.transform},fs={test:qi("hsl","hue"),parse:wc("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:s,alpha:n=1})=>"hsla("+Math.round(t)+", "+mt.transform(Ws(e))+", "+mt.transform(Ws(s))+", "+Ws(nn.transform(n))+")"},Ge={test:t=>Qt.test(t)||Hr.test(t)||fs.test(t),parse:t=>Qt.test(t)?Qt.parse(t):fs.test(t)?fs.parse(t):Hr.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Qt.transform(t):fs.transform(t)},Pm=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Tm(t){var e,s;return isNaN(t)&&typeof t=="string"&&(((e=t.match($i))===null||e===void 0?void 0:e.length)||0)+(((s=t.match(Pm))===null||s===void 0?void 0:s.length)||0)>0}const jc="number",Nc="color",Mm="var",Em="var(",Za="${}",Am=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function an(t){const e=t.toString(),s=[],n={color:[],number:[],var:[]},i=[];let o=0;const c=e.replace(Am,l=>(Ge.test(l)?(n.color.push(o),i.push(Nc),s.push(Ge.parse(l))):l.startsWith(Em)?(n.var.push(o),i.push(Mm),s.push(l)):(n.number.push(o),i.push(jc),s.push(parseFloat(l))),++o,Za)).split(Za);return{values:s,split:c,indexes:n,types:i}}function Sc(t){return an(t).values}function Cc(t){const{split:e,types:s}=an(t),n=e.length;return i=>{let o="";for(let a=0;a<n;a++)if(o+=e[a],i[a]!==void 0){const c=s[a];c===jc?o+=Ws(i[a]):c===Nc?o+=Ge.transform(i[a]):o+=i[a]}return o}}const Rm=t=>typeof t=="number"?0:t;function Dm(t){const e=Sc(t);return Cc(t)(e.map(Rm))}const $t={test:Tm,parse:Sc,createTransformer:Cc,getAnimatableNone:Dm},Lm=new Set(["brightness","contrast","saturate","opacity"]);function Om(t){const[e,s]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[n]=s.match($i)||[];if(!n)return t;const i=s.replace(n,"");let o=Lm.has(e)?1:0;return n!==s&&(o*=100),e+"("+o+i+")"}const Vm=/\b([a-z-]*)\(.*?\)/gu,Wr={...$t,getAnimatableNone:t=>{const e=t.match(Vm);return e?e.map(Om).join(" "):t}},Fm={...Ci,color:Ge,backgroundColor:Ge,outlineColor:Ge,fill:Ge,stroke:Ge,borderColor:Ge,borderTopColor:Ge,borderRightColor:Ge,borderBottomColor:Ge,borderLeftColor:Ge,filter:Wr,WebkitFilter:Wr},Bi=t=>Fm[t];function _c(t,e){let s=Bi(t);return s!==Wr&&(s=$t),s.getAnimatableNone?s.getAnimatableNone(e):void 0}const Im=new Set(["auto","none","0"]);function $m(t,e,s){let n=0,i;for(;n<t.length&&!i;){const o=t[n];typeof o=="string"&&!Im.has(o)&&an(o).values.length&&(i=t[n]),n++}if(i&&s)for(const o of e)t[o]=_c(s,i)}const eo=t=>t===Os||t===se,to=(t,e)=>parseFloat(t.split(", ")[e]),so=(t,e)=>(s,{transform:n})=>{if(n==="none"||!n)return 0;const i=n.match(/^matrix3d\((.+)\)$/u);if(i)return to(i[1],e);{const o=n.match(/^matrix\((.+)\)$/u);return o?to(o[1],t):0}},qm=new Set(["x","y","z"]),Bm=Ls.filter(t=>!qm.has(t));function Um(t){const e=[];return Bm.forEach(s=>{const n=t.getValue(s);n!==void 0&&(e.push([s,n.get()]),n.set(s.startsWith("scale")?1:0))}),e}const Rs={width:({x:t},{paddingLeft:e="0",paddingRight:s="0"})=>t.max-t.min-parseFloat(e)-parseFloat(s),height:({y:t},{paddingTop:e="0",paddingBottom:s="0"})=>t.max-t.min-parseFloat(e)-parseFloat(s),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:so(4,13),y:so(5,14)};Rs.translateX=Rs.x;Rs.translateY=Rs.y;const is=new Set;let Qr=!1,Yr=!1;function kc(){if(Yr){const t=Array.from(is).filter(n=>n.needsMeasurement),e=new Set(t.map(n=>n.element)),s=new Map;e.forEach(n=>{const i=Um(n);i.length&&(s.set(n,i),n.render())}),t.forEach(n=>n.measureInitialState()),e.forEach(n=>{n.render();const i=s.get(n);i&&i.forEach(([o,a])=>{var c;(c=n.getValue(o))===null||c===void 0||c.set(a)})}),t.forEach(n=>n.measureEndState()),t.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}Yr=!1,Qr=!1,is.forEach(t=>t.complete()),is.clear()}function Pc(){is.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Yr=!0)})}function Gm(){Pc(),kc()}class Ui{constructor(e,s,n,i,o,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=s,this.name=n,this.motionValue=i,this.element=o,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(is.add(this),Qr||(Qr=!0,je.read(Pc),je.resolveKeyframes(kc))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:s,element:n,motionValue:i}=this;for(let o=0;o<e.length;o++)if(e[o]===null)if(o===0){const a=i?.get(),c=e[e.length-1];if(a!==void 0)e[0]=a;else if(n&&s){const l=n.readValue(s,c);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=c),i&&a===void 0&&i.set(e[0])}else e[o]=e[o-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),is.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,is.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const Tc=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),zm=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Km(t){const e=zm.exec(t);if(!e)return[,];const[,s,n,i]=e;return[`--${s??n}`,i]}function Mc(t,e,s=1){const[n,i]=Km(t);if(!n)return;const o=window.getComputedStyle(e).getPropertyValue(n);if(o){const a=o.trim();return Tc(a)?parseFloat(a):a}return Si(i)?Mc(i,e,s+1):i}const Ec=t=>e=>e.test(t),Hm={test:t=>t==="auto",parse:t=>t},Ac=[Os,se,mt,Tt,Of,Lf,Hm],no=t=>Ac.find(Ec(t));class Rc extends Ui{constructor(e,s,n,i,o){super(e,s,n,i,o,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:s,name:n}=this;if(!s||!s.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let u=e[l];if(typeof u=="string"&&(u=u.trim(),Si(u))){const h=Mc(u,s.current);h!==void 0&&(e[l]=h),l===e.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!cc.has(n)||e.length!==2)return;const[i,o]=e,a=no(i),c=no(o);if(a!==c)if(eo(a)&&eo(c))for(let l=0;l<e.length;l++){const u=e[l];typeof u=="string"&&(e[l]=parseFloat(u))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:s}=this,n=[];for(let i=0;i<e.length;i++)Nm(e[i])&&n.push(i);n.length&&$m(e,n,s)}measureInitialState(){const{element:e,unresolvedKeyframes:s,name:n}=this;if(!e||!e.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Rs[n](e.measureViewportBox(),window.getComputedStyle(e.current)),s[0]=this.measuredOrigin;const i=s[s.length-1];i!==void 0&&e.getValue(n,i).jump(i,!1)}measureEndState(){var e;const{element:s,name:n,unresolvedKeyframes:i}=this;if(!s||!s.current)return;const o=s.getValue(n);o&&o.jump(this.measuredOrigin,!1);const a=i.length-1,c=i[a];i[a]=Rs[n](s.measureViewportBox(),window.getComputedStyle(s.current)),c!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=c),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,u])=>{s.getValue(l).set(u)}),this.resolveNoneKeyframes()}}const ro=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&($t.test(t)||t==="0")&&!t.startsWith("url("));function Wm(t){const e=t[0];if(t.length===1)return!0;for(let s=0;s<t.length;s++)if(t[s]!==e)return!0}function Qm(t,e,s,n){const i=t[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const o=t[t.length-1],a=ro(i,e),c=ro(o,e);return!a||!c?!1:Wm(t)||(s==="spring"||Ai(s))&&n}const Ym=t=>t!==null;function tr(t,{repeat:e,repeatType:s="loop"},n){const i=t.filter(Ym),o=e&&s!=="loop"&&e%2===1?0:i.length-1;return!o||n===void 0?i[o]:n}const Xm=40;class Dc{constructor({autoplay:e=!0,delay:s=0,type:n="keyframes",repeat:i=0,repeatDelay:o=0,repeatType:a="loop",...c}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=pt.now(),this.options={autoplay:e,delay:s,type:n,repeat:i,repeatDelay:o,repeatType:a,...c},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>Xm?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&Gm(),this._resolved}onKeyframesResolved(e,s){this.resolvedAt=pt.now(),this.hasAttemptedResolve=!0;const{name:n,type:i,velocity:o,delay:a,onComplete:c,onUpdate:l,isGenerator:u}=this.options;if(!u&&!Qm(e,n,i,o))if(a)this.options.duration=0;else{l&&l(tr(e,this.options,s)),c&&c(),this.resolveFinishedPromise();return}const h=this.initPlayback(e,s);h!==!1&&(this._resolved={keyframes:e,finalKeyframe:s,...h},this.onPostResolved())}onPostResolved(){}then(e,s){return this.currentFinishedPromise.then(e,s)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Se=(t,e,s)=>t+(e-t)*s;function xr(t,e,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?t+(e-t)*6*s:s<1/2?e:s<2/3?t+(e-t)*(2/3-s)*6:t}function Jm({hue:t,saturation:e,lightness:s,alpha:n}){t/=360,e/=100,s/=100;let i=0,o=0,a=0;if(!e)i=o=a=s;else{const c=s<.5?s*(1+e):s+e-s*e,l=2*s-c;i=xr(l,c,t+1/3),o=xr(l,c,t),a=xr(l,c,t-1/3)}return{red:Math.round(i*255),green:Math.round(o*255),blue:Math.round(a*255),alpha:n}}function Gn(t,e){return s=>s>0?e:t}const yr=(t,e,s)=>{const n=t*t,i=s*(e*e-n)+n;return i<0?0:Math.sqrt(i)},Zm=[Hr,Qt,fs],ep=t=>Zm.find(e=>e.test(t));function io(t){const e=ep(t);if(!e)return!1;let s=e.parse(t);return e===fs&&(s=Jm(s)),s}const ao=(t,e)=>{const s=io(t),n=io(e);if(!s||!n)return Gn(t,e);const i={...s};return o=>(i.red=yr(s.red,n.red,o),i.green=yr(s.green,n.green,o),i.blue=yr(s.blue,n.blue,o),i.alpha=Se(s.alpha,n.alpha,o),Qt.transform(i))},tp=(t,e)=>s=>e(t(s)),xn=(...t)=>t.reduce(tp),Xr=new Set(["none","hidden"]);function sp(t,e){return Xr.has(t)?s=>s<=0?t:e:s=>s>=1?e:t}function np(t,e){return s=>Se(t,e,s)}function Gi(t){return typeof t=="number"?np:typeof t=="string"?Si(t)?Gn:Ge.test(t)?ao:ap:Array.isArray(t)?Lc:typeof t=="object"?Ge.test(t)?ao:rp:Gn}function Lc(t,e){const s=[...t],n=s.length,i=t.map((o,a)=>Gi(o)(o,e[a]));return o=>{for(let a=0;a<n;a++)s[a]=i[a](o);return s}}function rp(t,e){const s={...t,...e},n={};for(const i in s)t[i]!==void 0&&e[i]!==void 0&&(n[i]=Gi(t[i])(t[i],e[i]));return i=>{for(const o in n)s[o]=n[o](i);return s}}function ip(t,e){var s;const n=[],i={color:0,var:0,number:0};for(let o=0;o<e.values.length;o++){const a=e.types[o],c=t.indexes[a][i[a]],l=(s=t.values[c])!==null&&s!==void 0?s:0;n[o]=l,i[a]++}return n}const ap=(t,e)=>{const s=$t.createTransformer(e),n=an(t),i=an(e);return n.indexes.var.length===i.indexes.var.length&&n.indexes.color.length===i.indexes.color.length&&n.indexes.number.length>=i.indexes.number.length?Xr.has(t)&&!i.values.length||Xr.has(e)&&!n.values.length?sp(t,e):xn(Lc(ip(n,i),i.values),s):Gn(t,e)};function Oc(t,e,s){return typeof t=="number"&&typeof e=="number"&&typeof s=="number"?Se(t,e,s):Gi(t)(t,e)}const op=5;function Vc(t,e,s){const n=Math.max(e-op,0);return uc(s-t(n),e-n)}const ke={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},br=.001;function lp({duration:t=ke.duration,bounce:e=ke.bounce,velocity:s=ke.velocity,mass:n=ke.mass}){let i,o,a=1-e;a=wt(ke.minDamping,ke.maxDamping,a),t=wt(ke.minDuration,ke.maxDuration,vt(t)),a<1?(i=u=>{const h=u*a,f=h*t,m=h-s,g=Jr(u,a),x=Math.exp(-f);return br-m/g*x},o=u=>{const f=u*a*t,m=f*s+s,g=Math.pow(a,2)*Math.pow(u,2)*t,x=Math.exp(-f),w=Jr(Math.pow(u,2),a);return(-i(u)+br>0?-1:1)*((m-g)*x)/w}):(i=u=>{const h=Math.exp(-u*t),f=(u-s)*t+1;return-br+h*f},o=u=>{const h=Math.exp(-u*t),f=(s-u)*(t*t);return h*f});const c=5/t,l=up(i,o,c);if(t=bt(t),isNaN(l))return{stiffness:ke.stiffness,damping:ke.damping,duration:t};{const u=Math.pow(l,2)*n;return{stiffness:u,damping:a*2*Math.sqrt(n*u),duration:t}}}const cp=12;function up(t,e,s){let n=s;for(let i=1;i<cp;i++)n=n-t(n)/e(n);return n}function Jr(t,e){return t*Math.sqrt(1-e*e)}const dp=["duration","bounce"],hp=["stiffness","damping","mass"];function oo(t,e){return e.some(s=>t[s]!==void 0)}function fp(t){let e={velocity:ke.velocity,stiffness:ke.stiffness,damping:ke.damping,mass:ke.mass,isResolvedFromDuration:!1,...t};if(!oo(t,hp)&&oo(t,dp))if(t.visualDuration){const s=t.visualDuration,n=2*Math.PI/(s*1.2),i=n*n,o=2*wt(.05,1,1-(t.bounce||0))*Math.sqrt(i);e={...e,mass:ke.mass,stiffness:i,damping:o}}else{const s=lp(t);e={...e,...s,mass:ke.mass},e.isResolvedFromDuration=!0}return e}function Fc(t=ke.visualDuration,e=ke.bounce){const s=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:n,restDelta:i}=s;const o=s.keyframes[0],a=s.keyframes[s.keyframes.length-1],c={done:!1,value:o},{stiffness:l,damping:u,mass:h,duration:f,velocity:m,isResolvedFromDuration:g}=fp({...s,velocity:-vt(s.velocity||0)}),x=m||0,w=u/(2*Math.sqrt(l*h)),b=a-o,j=vt(Math.sqrt(l/h)),T=Math.abs(b)<5;n||(n=T?ke.restSpeed.granular:ke.restSpeed.default),i||(i=T?ke.restDelta.granular:ke.restDelta.default);let A;if(w<1){const R=Jr(j,w);A=B=>{const _=Math.exp(-w*j*B);return a-_*((x+w*j*b)/R*Math.sin(R*B)+b*Math.cos(R*B))}}else if(w===1)A=R=>a-Math.exp(-j*R)*(b+(x+j*b)*R);else{const R=j*Math.sqrt(w*w-1);A=B=>{const _=Math.exp(-w*j*B),S=Math.min(R*B,300);return a-_*((x+w*j*b)*Math.sinh(S)+R*b*Math.cosh(S))/R}}const D={calculatedDuration:g&&f||null,next:R=>{const B=A(R);if(g)c.done=R>=f;else{let _=0;w<1&&(_=R===0?bt(x):Vc(A,R,B));const S=Math.abs(_)<=n,L=Math.abs(a-B)<=i;c.done=S&&L}return c.value=c.done?a:B,c},toString:()=>{const R=Math.min(sc(D),Gr),B=nc(_=>D.next(R*_).value,R,30);return R+"ms "+B}};return D}function lo({keyframes:t,velocity:e=0,power:s=.8,timeConstant:n=325,bounceDamping:i=10,bounceStiffness:o=500,modifyTarget:a,min:c,max:l,restDelta:u=.5,restSpeed:h}){const f=t[0],m={done:!1,value:f},g=S=>c!==void 0&&S<c||l!==void 0&&S>l,x=S=>c===void 0?l:l===void 0||Math.abs(c-S)<Math.abs(l-S)?c:l;let w=s*e;const b=f+w,j=a===void 0?b:a(b);j!==b&&(w=j-f);const T=S=>-w*Math.exp(-S/n),A=S=>j+T(S),D=S=>{const L=T(S),I=A(S);m.done=Math.abs(L)<=u,m.value=m.done?j:I};let R,B;const _=S=>{g(m.value)&&(R=S,B=Fc({keyframes:[m.value,x(m.value)],velocity:Vc(A,S,m.value),damping:i,stiffness:o,restDelta:u,restSpeed:h}))};return _(0),{calculatedDuration:null,next:S=>{let L=!1;return!B&&R===void 0&&(L=!0,D(S),_(S)),R!==void 0&&S>=R?B.next(S-R):(!L&&D(S),m)}}}const mp=gn(.42,0,1,1),pp=gn(0,0,.58,1),Ic=gn(.42,0,.58,1),gp=t=>Array.isArray(t)&&typeof t[0]!="number",xp={linear:Je,easeIn:mp,easeInOut:Ic,easeOut:pp,circIn:Ii,circInOut:bc,circOut:yc,backIn:Fi,backInOut:gc,backOut:pc,anticipate:xc},co=t=>{if(Ri(t)){Ol(t.length===4);const[e,s,n,i]=t;return gn(e,s,n,i)}else if(typeof t=="string")return xp[t];return t};function yp(t,e,s){const n=[],i=s||Oc,o=t.length-1;for(let a=0;a<o;a++){let c=i(t[a],t[a+1]);if(e){const l=Array.isArray(e)?e[a]||Je:e;c=xn(l,c)}n.push(c)}return n}function bp(t,e,{clamp:s=!0,ease:n,mixer:i}={}){const o=t.length;if(Ol(o===e.length),o===1)return()=>e[0];if(o===2&&e[0]===e[1])return()=>e[1];const a=t[0]===t[1];t[0]>t[o-1]&&(t=[...t].reverse(),e=[...e].reverse());const c=yp(e,n,i),l=c.length,u=h=>{if(a&&h<t[0])return e[0];let f=0;if(l>1)for(;f<t.length-2&&!(h<t[f+1]);f++);const m=Es(t[f],t[f+1],h);return c[f](m)};return s?h=>u(wt(t[0],t[o-1],h)):u}function vp(t,e){const s=t[t.length-1];for(let n=1;n<=e;n++){const i=Es(0,e,n);t.push(Se(s,1,i))}}function wp(t){const e=[0];return vp(e,t.length-1),e}function jp(t,e){return t.map(s=>s*e)}function Np(t,e){return t.map(()=>e||Ic).splice(0,t.length-1)}function zn({duration:t=300,keyframes:e,times:s,ease:n="easeInOut"}){const i=gp(n)?n.map(co):co(n),o={done:!1,value:e[0]},a=jp(s&&s.length===e.length?s:wp(e),t),c=bp(a,e,{ease:Array.isArray(i)?i:Np(e,i)});return{calculatedDuration:t,next:l=>(o.value=c(l),o.done=l>=t,o)}}const Sp=t=>{const e=({timestamp:s})=>t(s);return{start:()=>je.update(e,!0),stop:()=>It(e),now:()=>qe.isProcessing?qe.timestamp:pt.now()}},Cp={decay:lo,inertia:lo,tween:zn,keyframes:zn,spring:Fc},_p=t=>t/100;class zi extends Dc{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:s,motionValue:n,element:i,keyframes:o}=this.options,a=i?.KeyframeResolver||Ui,c=(l,u)=>this.onKeyframesResolved(l,u);this.resolver=new a(o,c,s,n,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:s="keyframes",repeat:n=0,repeatDelay:i=0,repeatType:o,velocity:a=0}=this.options,c=Ai(s)?s:Cp[s]||zn;let l,u;c!==zn&&typeof e[0]!="number"&&(l=xn(_p,Oc(e[0],e[1])),e=[0,100]);const h=c({...this.options,keyframes:e});o==="mirror"&&(u=c({...this.options,keyframes:[...e].reverse(),velocity:-a})),h.calculatedDuration===null&&(h.calculatedDuration=sc(h));const{calculatedDuration:f}=h,m=f+i,g=m*(n+1)-i;return{generator:h,mirroredGenerator:u,mapPercentToKeyframes:l,calculatedDuration:f,resolvedDuration:m,totalDuration:g}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,s=!1){const{resolved:n}=this;if(!n){const{keyframes:S}=this.options;return{done:!0,value:S[S.length-1]}}const{finalKeyframe:i,generator:o,mirroredGenerator:a,mapPercentToKeyframes:c,keyframes:l,calculatedDuration:u,totalDuration:h,resolvedDuration:f}=n;if(this.startTime===null)return o.next(0);const{delay:m,repeat:g,repeatType:x,repeatDelay:w,onUpdate:b}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-h/this.speed,this.startTime)),s?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const j=this.currentTime-m*(this.speed>=0?1:-1),T=this.speed>=0?j<0:j>h;this.currentTime=Math.max(j,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=h);let A=this.currentTime,D=o;if(g){const S=Math.min(this.currentTime,h)/f;let L=Math.floor(S),I=S%1;!I&&S>=1&&(I=1),I===1&&L--,L=Math.min(L,g+1),!!(L%2)&&(x==="reverse"?(I=1-I,w&&(I-=w/f)):x==="mirror"&&(D=a)),A=wt(0,1,I)*f}const R=T?{done:!1,value:l[0]}:D.next(A);c&&(R.value=c(R.value));let{done:B}=R;!T&&u!==null&&(B=this.speed>=0?this.currentTime>=h:this.currentTime<=0);const _=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&B);return _&&i!==void 0&&(R.value=tr(l,this.options,i)),b&&b(R.value),_&&this.finish(),R}get duration(){const{resolved:e}=this;return e?vt(e.calculatedDuration):0}get time(){return vt(this.currentTime)}set time(e){e=bt(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const s=this.playbackSpeed!==e;this.playbackSpeed=e,s&&(this.time=vt(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=Sp,onPlay:s,startTime:n}=this.options;this.driver||(this.driver=e(o=>this.tick(o))),s&&s();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=n??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const kp=new Set(["opacity","clipPath","filter","transform"]);function Pp(t,e,s,{delay:n=0,duration:i=300,repeat:o=0,repeatType:a="loop",ease:c="easeInOut",times:l}={}){const u={[e]:s};l&&(u.offset=l);const h=ic(c,i);return Array.isArray(h)&&(u.easing=h),t.animate(u,{delay:n,duration:i,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:o+1,direction:a==="reverse"?"alternate":"normal"})}const Tp=xi(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Kn=10,Mp=2e4;function Ep(t){return Ai(t.type)||t.type==="spring"||!rc(t.ease)}function Ap(t,e){const s=new zi({...e,keyframes:t,repeat:0,delay:0,isGenerator:!0});let n={done:!1,value:t[0]};const i=[];let o=0;for(;!n.done&&o<Mp;)n=s.sample(o),i.push(n.value),o+=Kn;return{times:void 0,keyframes:i,duration:o-Kn,ease:"linear"}}const $c={anticipate:xc,backInOut:gc,circInOut:bc};function Rp(t){return t in $c}class uo extends Dc{constructor(e){super(e);const{name:s,motionValue:n,element:i,keyframes:o}=this.options;this.resolver=new Rc(o,(a,c)=>this.onKeyframesResolved(a,c),s,n,i),this.resolver.scheduleResolve()}initPlayback(e,s){let{duration:n=300,times:i,ease:o,type:a,motionValue:c,name:l,startTime:u}=this.options;if(!c.owner||!c.owner.current)return!1;if(typeof o=="string"&&Un()&&Rp(o)&&(o=$c[o]),Ep(this.options)){const{onComplete:f,onUpdate:m,motionValue:g,element:x,...w}=this.options,b=Ap(e,w);e=b.keyframes,e.length===1&&(e[1]=e[0]),n=b.duration,i=b.times,o=b.ease,a="keyframes"}const h=Pp(c.owner.current,l,e,{...this.options,duration:n,times:i,ease:o});return h.startTime=u??this.calcStartTime(),this.pendingTimeline?(Wa(h,this.pendingTimeline),this.pendingTimeline=void 0):h.onfinish=()=>{const{onComplete:f}=this.options;c.set(tr(e,this.options,s)),f&&f(),this.cancel(),this.resolveFinishedPromise()},{animation:h,duration:n,times:i,type:a,ease:o,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:s}=e;return vt(s)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:s}=e;return vt(s.currentTime||0)}set time(e){const{resolved:s}=this;if(!s)return;const{animation:n}=s;n.currentTime=bt(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:s}=e;return s.playbackRate}set speed(e){const{resolved:s}=this;if(!s)return;const{animation:n}=s;n.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:s}=e;return s.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:s}=e;return s.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:s}=this;if(!s)return Je;const{animation:n}=s;Wa(n,e)}return Je}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:s}=e;s.playState==="finished"&&this.updateFinishedPromise(),s.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:s}=e;s.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:s,keyframes:n,duration:i,type:o,ease:a,times:c}=e;if(s.playState==="idle"||s.playState==="finished")return;if(this.time){const{motionValue:u,onUpdate:h,onComplete:f,element:m,...g}=this.options,x=new zi({...g,keyframes:n,duration:i,type:o,ease:a,times:c,isGenerator:!0}),w=bt(this.time);u.setWithVelocity(x.sample(w-Kn).value,x.sample(w).value,Kn)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:s,name:n,repeatDelay:i,repeatType:o,damping:a,type:c}=e;if(!s||!s.owner||!(s.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:u}=s.owner.getProps();return Tp()&&n&&kp.has(n)&&!l&&!u&&!i&&o!=="mirror"&&a!==0&&c!=="inertia"}}const Dp={type:"spring",stiffness:500,damping:25,restSpeed:10},Lp=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),Op={type:"keyframes",duration:.8},Vp={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Fp=(t,{keyframes:e})=>e.length>2?Op:ls.has(t)?t.startsWith("scale")?Lp(e[1]):Dp:Vp;function Ip({when:t,delay:e,delayChildren:s,staggerChildren:n,staggerDirection:i,repeat:o,repeatType:a,repeatDelay:c,from:l,elapsed:u,...h}){return!!Object.keys(h).length}const Ki=(t,e,s,n={},i,o)=>a=>{const c=Ei(n,t)||{},l=c.delay||n.delay||0;let{elapsed:u=0}=n;u=u-bt(l);let h={keyframes:Array.isArray(s)?s:[null,s],ease:"easeOut",velocity:e.getVelocity(),...c,delay:-u,onUpdate:m=>{e.set(m),c.onUpdate&&c.onUpdate(m)},onComplete:()=>{a(),c.onComplete&&c.onComplete()},name:t,motionValue:e,element:o?void 0:i};Ip(c)||(h={...h,...Fp(t,h)}),h.duration&&(h.duration=bt(h.duration)),h.repeatDelay&&(h.repeatDelay=bt(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let f=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(h.duration=0,h.delay===0&&(f=!0)),f&&!o&&e.get()!==void 0){const m=tr(h.keyframes,c);if(m!==void 0)return je.update(()=>{h.onUpdate(m),h.onComplete()}),new rm([])}return!o&&uo.supports(h)?new uo(h):new zi(h)};function $p({protectedKeys:t,needsAnimating:e},s){const n=t.hasOwnProperty(s)&&e[s]!==!0;return e[s]=!1,n}function qc(t,e,{delay:s=0,transitionOverride:n,type:i}={}){var o;let{transition:a=t.getDefaultTransition(),transitionEnd:c,...l}=e;n&&(a=n);const u=[],h=i&&t.animationState&&t.animationState.getState()[i];for(const f in l){const m=t.getValue(f,(o=t.latestValues[f])!==null&&o!==void 0?o:null),g=l[f];if(g===void 0||h&&$p(h,f))continue;const x={delay:s,...Ei(a||{},f)};let w=!1;if(window.MotionHandoffAnimation){const j=dc(t);if(j){const T=window.MotionHandoffAnimation(j,f,je);T!==null&&(x.startTime=T,w=!0)}}Kr(t,f),m.start(Ki(f,m,g,t.shouldReduceMotion&&cc.has(f)?{type:!1}:x,t,w));const b=m.animation;b&&u.push(b)}return c&&Promise.all(u).then(()=>{je.update(()=>{c&&ym(t,c)})}),u}function Zr(t,e,s={}){var n;const i=er(t,e,s.type==="exit"?(n=t.presenceContext)===null||n===void 0?void 0:n.custom:void 0);let{transition:o=t.getDefaultTransition()||{}}=i||{};s.transitionOverride&&(o=s.transitionOverride);const a=i?()=>Promise.all(qc(t,i,s)):()=>Promise.resolve(),c=t.variantChildren&&t.variantChildren.size?(u=0)=>{const{delayChildren:h=0,staggerChildren:f,staggerDirection:m}=o;return qp(t,e,h+u,f,m,s)}:()=>Promise.resolve(),{when:l}=o;if(l){const[u,h]=l==="beforeChildren"?[a,c]:[c,a];return u().then(()=>h())}else return Promise.all([a(),c(s.delay)])}function qp(t,e,s=0,n=0,i=1,o){const a=[],c=(t.variantChildren.size-1)*n,l=i===1?(u=0)=>u*n:(u=0)=>c-u*n;return Array.from(t.variantChildren).sort(Bp).forEach((u,h)=>{u.notify("AnimationStart",e),a.push(Zr(u,e,{...o,delay:s+l(h)}).then(()=>u.notify("AnimationComplete",e)))}),Promise.all(a)}function Bp(t,e){return t.sortNodePosition(e)}function Up(t,e,s={}){t.notify("AnimationStart",e);let n;if(Array.isArray(e)){const i=e.map(o=>Zr(t,o,s));n=Promise.all(i)}else if(typeof e=="string")n=Zr(t,e,s);else{const i=typeof e=="function"?er(t,e,s.custom):e;n=Promise.all(qc(t,i,s))}return n.then(()=>{t.notify("AnimationComplete",e)})}const Gp=bi.length;function Bc(t){if(!t)return;if(!t.isControllingVariants){const s=t.parent?Bc(t.parent)||{}:{};return t.props.initial!==void 0&&(s.initial=t.props.initial),s}const e={};for(let s=0;s<Gp;s++){const n=bi[s],i=t.props[n];(sn(i)||i===!1)&&(e[n]=i)}return e}const zp=[...yi].reverse(),Kp=yi.length;function Hp(t){return e=>Promise.all(e.map(({animation:s,options:n})=>Up(t,s,n)))}function Wp(t){let e=Hp(t),s=ho(),n=!0;const i=l=>(u,h)=>{var f;const m=er(t,h,l==="exit"?(f=t.presenceContext)===null||f===void 0?void 0:f.custom:void 0);if(m){const{transition:g,transitionEnd:x,...w}=m;u={...u,...w,...x}}return u};function o(l){e=l(t)}function a(l){const{props:u}=t,h=Bc(t.parent)||{},f=[],m=new Set;let g={},x=1/0;for(let b=0;b<Kp;b++){const j=zp[b],T=s[j],A=u[j]!==void 0?u[j]:h[j],D=sn(A),R=j===l?T.isActive:null;R===!1&&(x=b);let B=A===h[j]&&A!==u[j]&&D;if(B&&n&&t.manuallyAnimateOnMount&&(B=!1),T.protectedKeys={...g},!T.isActive&&R===null||!A&&!T.prevProp||Jn(A)||typeof A=="boolean")continue;const _=Qp(T.prevProp,A);let S=_||j===l&&T.isActive&&!B&&D||b>x&&D,L=!1;const I=Array.isArray(A)?A:[A];let Z=I.reduce(i(j),{});R===!1&&(Z={});const{prevResolvedValues:q={}}=T,M={...q,...Z},z=F=>{S=!0,m.has(F)&&(L=!0,m.delete(F)),T.needsAnimating[F]=!0;const $=t.getValue(F);$&&($.liveStyle=!1)};for(const F in M){const $=Z[F],P=q[F];if(g.hasOwnProperty(F))continue;let N=!1;Ur($)&&Ur(P)?N=!tc($,P):N=$!==P,N?$!=null?z(F):m.add(F):$!==void 0&&m.has(F)?z(F):T.protectedKeys[F]=!0}T.prevProp=A,T.prevResolvedValues=Z,T.isActive&&(g={...g,...Z}),n&&t.blockInitialAnimation&&(S=!1),S&&(!(B&&_)||L)&&f.push(...I.map(F=>({animation:F,options:{type:j}})))}if(m.size){const b={};m.forEach(j=>{const T=t.getBaseTarget(j),A=t.getValue(j);A&&(A.liveStyle=!0),b[j]=T??null}),f.push({animation:b})}let w=!!f.length;return n&&(u.initial===!1||u.initial===u.animate)&&!t.manuallyAnimateOnMount&&(w=!1),n=!1,w?e(f):Promise.resolve()}function c(l,u){var h;if(s[l].isActive===u)return Promise.resolve();(h=t.variantChildren)===null||h===void 0||h.forEach(m=>{var g;return(g=m.animationState)===null||g===void 0?void 0:g.setActive(l,u)}),s[l].isActive=u;const f=a(l);for(const m in s)s[m].protectedKeys={};return f}return{animateChanges:a,setActive:c,setAnimateFunction:o,getState:()=>s,reset:()=>{s=ho(),n=!0}}}function Qp(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!tc(e,t):!1}function zt(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function ho(){return{animate:zt(!0),whileInView:zt(),whileHover:zt(),whileTap:zt(),whileDrag:zt(),whileFocus:zt(),exit:zt()}}class Bt{constructor(e){this.isMounted=!1,this.node=e}update(){}}class Yp extends Bt{constructor(e){super(e),e.animationState||(e.animationState=Wp(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Jn(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:s}=this.node.prevProps||{};e!==s&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let Xp=0;class Jp extends Bt{constructor(){super(...arguments),this.id=Xp++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:s}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const i=this.node.animationState.setActive("exit",!e);s&&!e&&i.then(()=>s(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const Zp={animation:{Feature:Yp},exit:{Feature:Jp}};function on(t,e,s,n={passive:!0}){return t.addEventListener(e,s,n),()=>t.removeEventListener(e,s)}function yn(t){return{point:{x:t.pageX,y:t.pageY}}}const eg=t=>e=>Di(e)&&t(e,yn(e));function Qs(t,e,s,n){return on(t,e,eg(s),n)}const fo=(t,e)=>Math.abs(t-e);function tg(t,e){const s=fo(t.x,e.x),n=fo(t.y,e.y);return Math.sqrt(s**2+n**2)}class Uc{constructor(e,s,{transformPagePoint:n,contextWindow:i,dragSnapToOrigin:o=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=wr(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,g=tg(f.offset,{x:0,y:0})>=3;if(!m&&!g)return;const{point:x}=f,{timestamp:w}=qe;this.history.push({...x,timestamp:w});const{onStart:b,onMove:j}=this.handlers;m||(b&&b(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),j&&j(this.lastMoveEvent,f)},this.handlePointerMove=(f,m)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=vr(m,this.transformPagePoint),je.update(this.updatePoint,!0)},this.handlePointerUp=(f,m)=>{this.end();const{onEnd:g,onSessionEnd:x,resumeAnimation:w}=this.handlers;if(this.dragSnapToOrigin&&w&&w(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const b=wr(f.type==="pointercancel"?this.lastMoveEventInfo:vr(m,this.transformPagePoint),this.history);this.startEvent&&g&&g(f,b),x&&x(f,b)},!Di(e))return;this.dragSnapToOrigin=o,this.handlers=s,this.transformPagePoint=n,this.contextWindow=i||window;const a=yn(e),c=vr(a,this.transformPagePoint),{point:l}=c,{timestamp:u}=qe;this.history=[{...l,timestamp:u}];const{onSessionStart:h}=s;h&&h(e,wr(c,this.history)),this.removeListeners=xn(Qs(this.contextWindow,"pointermove",this.handlePointerMove),Qs(this.contextWindow,"pointerup",this.handlePointerUp),Qs(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),It(this.updatePoint)}}function vr(t,e){return e?{point:e(t.point)}:t}function mo(t,e){return{x:t.x-e.x,y:t.y-e.y}}function wr({point:t},e){return{point:t,delta:mo(t,Gc(e)),offset:mo(t,sg(e)),velocity:ng(e,.1)}}function sg(t){return t[0]}function Gc(t){return t[t.length-1]}function ng(t,e){if(t.length<2)return{x:0,y:0};let s=t.length-1,n=null;const i=Gc(t);for(;s>=0&&(n=t[s],!(i.timestamp-n.timestamp>bt(e)));)s--;if(!n)return{x:0,y:0};const o=vt(i.timestamp-n.timestamp);if(o===0)return{x:0,y:0};const a={x:(i.x-n.x)/o,y:(i.y-n.y)/o};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}const zc=1e-4,rg=1-zc,ig=1+zc,Kc=.01,ag=0-Kc,og=0+Kc;function Ze(t){return t.max-t.min}function lg(t,e,s){return Math.abs(t-e)<=s}function po(t,e,s,n=.5){t.origin=n,t.originPoint=Se(e.min,e.max,t.origin),t.scale=Ze(s)/Ze(e),t.translate=Se(s.min,s.max,t.origin)-t.originPoint,(t.scale>=rg&&t.scale<=ig||isNaN(t.scale))&&(t.scale=1),(t.translate>=ag&&t.translate<=og||isNaN(t.translate))&&(t.translate=0)}function Ys(t,e,s,n){po(t.x,e.x,s.x,n?n.originX:void 0),po(t.y,e.y,s.y,n?n.originY:void 0)}function go(t,e,s){t.min=s.min+e.min,t.max=t.min+Ze(e)}function cg(t,e,s){go(t.x,e.x,s.x),go(t.y,e.y,s.y)}function xo(t,e,s){t.min=e.min-s.min,t.max=t.min+Ze(e)}function Xs(t,e,s){xo(t.x,e.x,s.x),xo(t.y,e.y,s.y)}function ug(t,{min:e,max:s},n){return e!==void 0&&t<e?t=n?Se(e,t,n.min):Math.max(t,e):s!==void 0&&t>s&&(t=n?Se(s,t,n.max):Math.min(t,s)),t}function yo(t,e,s){return{min:e!==void 0?t.min+e:void 0,max:s!==void 0?t.max+s-(t.max-t.min):void 0}}function dg(t,{top:e,left:s,bottom:n,right:i}){return{x:yo(t.x,s,i),y:yo(t.y,e,n)}}function bo(t,e){let s=e.min-t.min,n=e.max-t.max;return e.max-e.min<t.max-t.min&&([s,n]=[n,s]),{min:s,max:n}}function hg(t,e){return{x:bo(t.x,e.x),y:bo(t.y,e.y)}}function fg(t,e){let s=.5;const n=Ze(t),i=Ze(e);return i>n?s=Es(e.min,e.max-n,t.min):n>i&&(s=Es(t.min,t.max-i,e.min)),wt(0,1,s)}function mg(t,e){const s={};return e.min!==void 0&&(s.min=e.min-t.min),e.max!==void 0&&(s.max=e.max-t.min),s}const ei=.35;function pg(t=ei){return t===!1?t=0:t===!0&&(t=ei),{x:vo(t,"left","right"),y:vo(t,"top","bottom")}}function vo(t,e,s){return{min:wo(t,e),max:wo(t,s)}}function wo(t,e){return typeof t=="number"?t:t[e]||0}const jo=()=>({translate:0,scale:1,origin:0,originPoint:0}),ms=()=>({x:jo(),y:jo()}),No=()=>({min:0,max:0}),Ee=()=>({x:No(),y:No()});function st(t){return[t("x"),t("y")]}function Hc({top:t,left:e,right:s,bottom:n}){return{x:{min:e,max:s},y:{min:t,max:n}}}function gg({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function xg(t,e){if(!e)return t;const s=e({x:t.left,y:t.top}),n=e({x:t.right,y:t.bottom});return{top:s.y,left:s.x,bottom:n.y,right:n.x}}function jr(t){return t===void 0||t===1}function ti({scale:t,scaleX:e,scaleY:s}){return!jr(t)||!jr(e)||!jr(s)}function Kt(t){return ti(t)||Wc(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function Wc(t){return So(t.x)||So(t.y)}function So(t){return t&&t!=="0%"}function Hn(t,e,s){const n=t-s,i=e*n;return s+i}function Co(t,e,s,n,i){return i!==void 0&&(t=Hn(t,i,n)),Hn(t,s,n)+e}function si(t,e=0,s=1,n,i){t.min=Co(t.min,e,s,n,i),t.max=Co(t.max,e,s,n,i)}function Qc(t,{x:e,y:s}){si(t.x,e.translate,e.scale,e.originPoint),si(t.y,s.translate,s.scale,s.originPoint)}const _o=.999999999999,ko=1.0000000000001;function yg(t,e,s,n=!1){const i=s.length;if(!i)return;e.x=e.y=1;let o,a;for(let c=0;c<i;c++){o=s[c],a=o.projectionDelta;const{visualElement:l}=o.options;l&&l.props.style&&l.props.style.display==="contents"||(n&&o.options.layoutScroll&&o.scroll&&o!==o.root&&gs(t,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,Qc(t,a)),n&&Kt(o.latestValues)&&gs(t,o.latestValues))}e.x<ko&&e.x>_o&&(e.x=1),e.y<ko&&e.y>_o&&(e.y=1)}function ps(t,e){t.min=t.min+e,t.max=t.max+e}function Po(t,e,s,n,i=.5){const o=Se(t.min,t.max,i);si(t,e,s,o,n)}function gs(t,e){Po(t.x,e.x,e.scaleX,e.scale,e.originX),Po(t.y,e.y,e.scaleY,e.scale,e.originY)}function Yc(t,e){return Hc(xg(t.getBoundingClientRect(),e))}function bg(t,e,s){const n=Yc(t,s),{scroll:i}=e;return i&&(ps(n.x,i.offset.x),ps(n.y,i.offset.y)),n}const Xc=({current:t})=>t?t.ownerDocument.defaultView:null,vg=new WeakMap;class wg{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ee(),this.visualElement=e}start(e,{snapToCursor:s=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const i=h=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),s&&this.snapToCursor(yn(h).point)},o=(h,f)=>{const{drag:m,dragPropagation:g,onDragStart:x}=this.getProps();if(m&&!g&&(this.openDragLock&&this.openDragLock(),this.openDragLock=fm(m),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),st(b=>{let j=this.getAxisMotionValue(b).get()||0;if(mt.test(j)){const{projection:T}=this.visualElement;if(T&&T.layout){const A=T.layout.layoutBox[b];A&&(j=Ze(A)*(parseFloat(j)/100))}}this.originPoint[b]=j}),x&&je.postRender(()=>x(h,f)),Kr(this.visualElement,"transform");const{animationState:w}=this.visualElement;w&&w.setActive("whileDrag",!0)},a=(h,f)=>{const{dragPropagation:m,dragDirectionLock:g,onDirectionLock:x,onDrag:w}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:b}=f;if(g&&this.currentDirection===null){this.currentDirection=jg(b),this.currentDirection!==null&&x&&x(this.currentDirection);return}this.updateAxis("x",f.point,b),this.updateAxis("y",f.point,b),this.visualElement.render(),w&&w(h,f)},c=(h,f)=>this.stop(h,f),l=()=>st(h=>{var f;return this.getAnimationState(h)==="paused"&&((f=this.getAxisMotionValue(h).animation)===null||f===void 0?void 0:f.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new Uc(e,{onSessionStart:i,onStart:o,onMove:a,onSessionEnd:c,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:Xc(this.visualElement)})}stop(e,s){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:i}=s;this.startAnimation(i);const{onDragEnd:o}=this.getProps();o&&je.postRender(()=>o(e,s))}cancel(){this.isDragging=!1;const{projection:e,animationState:s}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),s&&s.setActive("whileDrag",!1)}updateAxis(e,s,n){const{drag:i}=this.getProps();if(!n||!Dn(e,i,this.currentDirection))return;const o=this.getAxisMotionValue(e);let a=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(a=ug(a,this.constraints[e],this.elastic[e])),o.set(a)}resolveConstraints(){var e;const{dragConstraints:s,dragElastic:n}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,o=this.constraints;s&&hs(s)?this.constraints||(this.constraints=this.resolveRefConstraints()):s&&i?this.constraints=dg(i.layoutBox,s):this.constraints=!1,this.elastic=pg(n),o!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&st(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=mg(i.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:s}=this.getProps();if(!e||!hs(e))return!1;const n=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const o=bg(n,i.root,this.visualElement.getTransformPagePoint());let a=hg(i.layout.layoutBox,o);if(s){const c=s(gg(a));this.hasMutatedConstraints=!!c,c&&(a=Hc(c))}return a}startAnimation(e){const{drag:s,dragMomentum:n,dragElastic:i,dragTransition:o,dragSnapToOrigin:a,onDragTransitionEnd:c}=this.getProps(),l=this.constraints||{},u=st(h=>{if(!Dn(h,s,this.currentDirection))return;let f=l&&l[h]||{};a&&(f={min:0,max:0});const m=i?200:1e6,g=i?40:1e7,x={type:"inertia",velocity:n?e[h]:0,bounceStiffness:m,bounceDamping:g,timeConstant:750,restDelta:1,restSpeed:10,...o,...f};return this.startAxisValueAnimation(h,x)});return Promise.all(u).then(c)}startAxisValueAnimation(e,s){const n=this.getAxisMotionValue(e);return Kr(this.visualElement,e),n.start(Ki(e,n,0,s,this.visualElement,!1))}stopAnimation(){st(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){st(e=>{var s;return(s=this.getAxisMotionValue(e).animation)===null||s===void 0?void 0:s.pause()})}getAnimationState(e){var s;return(s=this.getAxisMotionValue(e).animation)===null||s===void 0?void 0:s.state}getAxisMotionValue(e){const s=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),i=n[s];return i||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){st(s=>{const{drag:n}=this.getProps();if(!Dn(s,n,this.currentDirection))return;const{projection:i}=this.visualElement,o=this.getAxisMotionValue(s);if(i&&i.layout){const{min:a,max:c}=i.layout.layoutBox[s];o.set(e[s]-Se(a,c,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:s}=this.getProps(),{projection:n}=this.visualElement;if(!hs(s)||!n||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};st(a=>{const c=this.getAxisMotionValue(a);if(c&&this.constraints!==!1){const l=c.get();i[a]=fg({min:l,max:l},this.constraints[a])}});const{transformTemplate:o}=this.visualElement.getProps();this.visualElement.current.style.transform=o?o({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),st(a=>{if(!Dn(a,e,null))return;const c=this.getAxisMotionValue(a),{min:l,max:u}=this.constraints[a];c.set(Se(l,u,i[a]))})}addListeners(){if(!this.visualElement.current)return;vg.set(this.visualElement,this);const e=this.visualElement.current,s=Qs(e,"pointerdown",l=>{const{drag:u,dragListener:h=!0}=this.getProps();u&&h&&this.start(l)}),n=()=>{const{dragConstraints:l}=this.getProps();hs(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,o=i.addEventListener("measure",n);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),je.read(n);const a=on(window,"resize",()=>this.scalePositionWithinConstraints()),c=i.addEventListener("didUpdate",(({delta:l,hasLayoutChanged:u})=>{this.isDragging&&u&&(st(h=>{const f=this.getAxisMotionValue(h);f&&(this.originPoint[h]+=l[h].translate,f.set(f.get()+l[h].translate))}),this.visualElement.render())}));return()=>{a(),s(),o(),c&&c()}}getProps(){const e=this.visualElement.getProps(),{drag:s=!1,dragDirectionLock:n=!1,dragPropagation:i=!1,dragConstraints:o=!1,dragElastic:a=ei,dragMomentum:c=!0}=e;return{...e,drag:s,dragDirectionLock:n,dragPropagation:i,dragConstraints:o,dragElastic:a,dragMomentum:c}}}function Dn(t,e,s){return(e===!0||e===t)&&(s===null||s===t)}function jg(t,e=10){let s=null;return Math.abs(t.y)>e?s="y":Math.abs(t.x)>e&&(s="x"),s}class Ng extends Bt{constructor(e){super(e),this.removeGroupControls=Je,this.removeListeners=Je,this.controls=new wg(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Je}unmount(){this.removeGroupControls(),this.removeListeners()}}const To=t=>(e,s)=>{t&&je.postRender(()=>t(e,s))};class Sg extends Bt{constructor(){super(...arguments),this.removePointerDownListener=Je}onPointerDown(e){this.session=new Uc(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Xc(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:s,onPan:n,onPanEnd:i}=this.node.getProps();return{onSessionStart:To(e),onStart:To(s),onMove:n,onEnd:(o,a)=>{delete this.session,i&&je.postRender(()=>i(o,a))}}}mount(){this.removePointerDownListener=Qs(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Fn={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Mo(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Us={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(se.test(t))t=parseFloat(t);else return t;const s=Mo(t,e.target.x),n=Mo(t,e.target.y);return`${s}% ${n}%`}},Cg={correct:(t,{treeScale:e,projectionDelta:s})=>{const n=t,i=$t.parse(t);if(i.length>5)return n;const o=$t.createTransformer(t),a=typeof i[0]!="number"?1:0,c=s.x.scale*e.x,l=s.y.scale*e.y;i[0+a]/=c,i[1+a]/=l;const u=Se(c,l,.5);return typeof i[2+a]=="number"&&(i[2+a]/=u),typeof i[3+a]=="number"&&(i[3+a]/=u),o(i)}};class _g extends d.Component{componentDidMount(){const{visualElement:e,layoutGroup:s,switchLayoutGroup:n,layoutId:i}=this.props,{projection:o}=e;Kf(kg),o&&(s.group&&s.group.add(o),n&&n.register&&i&&n.register(o),o.root.didUpdate(),o.addEventListener("animationComplete",()=>{this.safeToRemove()}),o.setOptions({...o.options,onExitComplete:()=>this.safeToRemove()})),Fn.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:s,visualElement:n,drag:i,isPresent:o}=this.props,a=n.projection;return a&&(a.isPresent=o,i||e.layoutDependency!==s||s===void 0?a.willUpdate():this.safeToRemove(),e.isPresent!==o&&(o?a.promote():a.relegate()||je.postRender(()=>{const c=a.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),wi.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:s,switchLayoutGroup:n}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),s&&s.group&&s.group.remove(i),n&&n.deregister&&n.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function Jc(t){const[e,s]=Dl(),n=d.useContext(fi);return r.jsx(_g,{...t,layoutGroup:n,switchLayoutGroup:d.useContext(Bl),isPresent:e,safeToRemove:s})}const kg={borderRadius:{...Us,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Us,borderTopRightRadius:Us,borderBottomLeftRadius:Us,borderBottomRightRadius:Us,boxShadow:Cg};function Pg(t,e,s){const n=ze(t)?t:rn(t);return n.start(Ki("",n,e,s)),n.animation}function Tg(t){return t instanceof SVGElement&&t.tagName!=="svg"}const Mg=(t,e)=>t.depth-e.depth;class Eg{constructor(){this.children=[],this.isDirty=!1}add(e){Li(this.children,e),this.isDirty=!0}remove(e){Oi(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Mg),this.isDirty=!1,this.children.forEach(e)}}function Ag(t,e){const s=pt.now(),n=({timestamp:i})=>{const o=i-s;o>=e&&(It(n),t(o-e))};return je.read(n,!0),()=>It(n)}const Zc=["TopLeft","TopRight","BottomLeft","BottomRight"],Rg=Zc.length,Eo=t=>typeof t=="string"?parseFloat(t):t,Ao=t=>typeof t=="number"||se.test(t);function Dg(t,e,s,n,i,o){i?(t.opacity=Se(0,s.opacity!==void 0?s.opacity:1,Lg(n)),t.opacityExit=Se(e.opacity!==void 0?e.opacity:1,0,Og(n))):o&&(t.opacity=Se(e.opacity!==void 0?e.opacity:1,s.opacity!==void 0?s.opacity:1,n));for(let a=0;a<Rg;a++){const c=`border${Zc[a]}Radius`;let l=Ro(e,c),u=Ro(s,c);if(l===void 0&&u===void 0)continue;l||(l=0),u||(u=0),l===0||u===0||Ao(l)===Ao(u)?(t[c]=Math.max(Se(Eo(l),Eo(u),n),0),(mt.test(u)||mt.test(l))&&(t[c]+="%")):t[c]=u}(e.rotate||s.rotate)&&(t.rotate=Se(e.rotate||0,s.rotate||0,n))}function Ro(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const Lg=eu(0,.5,yc),Og=eu(.5,.95,Je);function eu(t,e,s){return n=>n<t?0:n>e?1:s(Es(t,e,n))}function Do(t,e){t.min=e.min,t.max=e.max}function et(t,e){Do(t.x,e.x),Do(t.y,e.y)}function Lo(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function Oo(t,e,s,n,i){return t-=e,t=Hn(t,1/s,n),i!==void 0&&(t=Hn(t,1/i,n)),t}function Vg(t,e=0,s=1,n=.5,i,o=t,a=t){if(mt.test(e)&&(e=parseFloat(e),e=Se(a.min,a.max,e/100)-a.min),typeof e!="number")return;let c=Se(o.min,o.max,n);t===o&&(c-=e),t.min=Oo(t.min,e,s,c,i),t.max=Oo(t.max,e,s,c,i)}function Vo(t,e,[s,n,i],o,a){Vg(t,e[s],e[n],e[i],e.scale,o,a)}const Fg=["x","scaleX","originX"],Ig=["y","scaleY","originY"];function Fo(t,e,s,n){Vo(t.x,e,Fg,s?s.x:void 0,n?n.x:void 0),Vo(t.y,e,Ig,s?s.y:void 0,n?n.y:void 0)}function Io(t){return t.translate===0&&t.scale===1}function tu(t){return Io(t.x)&&Io(t.y)}function $o(t,e){return t.min===e.min&&t.max===e.max}function $g(t,e){return $o(t.x,e.x)&&$o(t.y,e.y)}function qo(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function su(t,e){return qo(t.x,e.x)&&qo(t.y,e.y)}function Bo(t){return Ze(t.x)/Ze(t.y)}function Uo(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class qg{constructor(){this.members=[]}add(e){Li(this.members,e),e.scheduleRender()}remove(e){if(Oi(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const s=this.members[this.members.length-1];s&&this.promote(s)}}relegate(e){const s=this.members.findIndex(i=>e===i);if(s===0)return!1;let n;for(let i=s;i>=0;i--){const o=this.members[i];if(o.isPresent!==!1){n=o;break}}return n?(this.promote(n),!0):!1}promote(e,s){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,s&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:s,resumingFrom:n}=e;s.onExitComplete&&s.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Bg(t,e,s){let n="";const i=t.x.translate/e.x,o=t.y.translate/e.y,a=s?.z||0;if((i||o||a)&&(n=`translate3d(${i}px, ${o}px, ${a}px) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),s){const{transformPerspective:u,rotate:h,rotateX:f,rotateY:m,skewX:g,skewY:x}=s;u&&(n=`perspective(${u}px) ${n}`),h&&(n+=`rotate(${h}deg) `),f&&(n+=`rotateX(${f}deg) `),m&&(n+=`rotateY(${m}deg) `),g&&(n+=`skewX(${g}deg) `),x&&(n+=`skewY(${x}deg) `)}const c=t.x.scale*e.x,l=t.y.scale*e.y;return(c!==1||l!==1)&&(n+=`scale(${c}, ${l})`),n||"none"}const Ht={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},Hs=typeof window<"u"&&window.MotionDebug!==void 0,Nr=["","X","Y","Z"],Ug={visibility:"hidden"},Go=1e3;let Gg=0;function Sr(t,e,s,n){const{latestValues:i}=e;i[t]&&(s[t]=i[t],e.setStaticValue(t,0),n&&(n[t]=0))}function nu(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const s=dc(e);if(window.MotionHasOptimisedAnimation(s,"transform")){const{layout:i,layoutId:o}=t.options;window.MotionCancelOptimisedAnimation(s,"transform",je,!(i||o))}const{parent:n}=t;n&&!n.hasCheckedOptimisedAppear&&nu(n)}function ru({attachResizeListener:t,defaultParent:e,measureScroll:s,checkIsScrollRoot:n,resetTransform:i}){return class{constructor(a={},c=e?.()){this.id=Gg++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Hs&&(Ht.totalNodes=Ht.resolvedTargetDeltas=Ht.recalculatedProjection=0),this.nodes.forEach(Hg),this.nodes.forEach(Jg),this.nodes.forEach(Zg),this.nodes.forEach(Wg),Hs&&window.MotionDebug.record(Ht)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new Eg)}addEventListener(a,c){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new Vi),this.eventHandlers.get(a).add(c)}notifyListeners(a,...c){const l=this.eventHandlers.get(a);l&&l.notify(...c)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,c=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Tg(a),this.instance=a;const{layoutId:l,layout:u,visualElement:h}=this.options;if(h&&!h.current&&h.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),c&&(u||l)&&(this.isLayoutDirty=!0),t){let f;const m=()=>this.root.updateBlockedByResize=!1;t(a,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=Ag(m,250),Fn.hasAnimatedSinceResize&&(Fn.hasAnimatedSinceResize=!1,this.nodes.forEach(Ko))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&h&&(l||u)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:m,hasRelativeTargetChanged:g,layout:x})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const w=this.options.transition||h.getDefaultTransition()||rx,{onLayoutAnimationStart:b,onLayoutAnimationComplete:j}=h.getProps(),T=!this.targetLayout||!su(this.targetLayout,x)||g,A=!m&&g;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||A||m&&(T||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,A);const D={...Ei(w,"layout"),onPlay:b,onComplete:j};(h.shouldReduceMotion||this.options.layoutRoot)&&(D.delay=0,D.type=!1),this.startAnimation(D)}else m||Ko(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=x})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,It(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(ex),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&nu(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const f=this.path[h];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:c,layout:l}=this.options;if(c===void 0&&!l)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(zo);return}this.isUpdating||this.nodes.forEach(Yg),this.isUpdating=!1,this.nodes.forEach(Xg),this.nodes.forEach(zg),this.nodes.forEach(Kg),this.clearAllSnapshots();const c=pt.now();qe.delta=wt(0,1e3/60,c-qe.timestamp),qe.timestamp=c,qe.isProcessing=!0,mr.update.process(qe),mr.preRender.process(qe),mr.render.process(qe),qe.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,wi.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Qg),this.sharedNodes.forEach(tx)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,je.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){je.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ee(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(c=!1),c){const l=n(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:s(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!tu(this.projectionDelta),l=this.getTransformTemplate(),u=l?l(this.latestValues,""):void 0,h=u!==this.prevTransformTemplateValue;a&&(c||Kt(this.latestValues)||h)&&(i(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const c=this.measurePageBox();let l=this.removeElementScroll(c);return a&&(l=this.removeTransform(l)),ix(l),{animationId:this.root.animationId,measuredBox:c,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var a;const{visualElement:c}=this.options;if(!c)return Ee();const l=c.measureViewportBox();if(!(((a=this.scroll)===null||a===void 0?void 0:a.wasRoot)||this.path.some(ax))){const{scroll:h}=this.root;h&&(ps(l.x,h.offset.x),ps(l.y,h.offset.y))}return l}removeElementScroll(a){var c;const l=Ee();if(et(l,a),!((c=this.scroll)===null||c===void 0)&&c.wasRoot)return l;for(let u=0;u<this.path.length;u++){const h=this.path[u],{scroll:f,options:m}=h;h!==this.root&&f&&m.layoutScroll&&(f.wasRoot&&et(l,a),ps(l.x,f.offset.x),ps(l.y,f.offset.y))}return l}applyTransform(a,c=!1){const l=Ee();et(l,a);for(let u=0;u<this.path.length;u++){const h=this.path[u];!c&&h.options.layoutScroll&&h.scroll&&h!==h.root&&gs(l,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),Kt(h.latestValues)&&gs(l,h.latestValues)}return Kt(this.latestValues)&&gs(l,this.latestValues),l}removeTransform(a){const c=Ee();et(c,a);for(let l=0;l<this.path.length;l++){const u=this.path[l];if(!u.instance||!Kt(u.latestValues))continue;ti(u.latestValues)&&u.updateSnapshot();const h=Ee(),f=u.measurePageBox();et(h,f),Fo(c,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,h)}return Kt(this.latestValues)&&Fo(c,this.latestValues),c}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==qe.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var c;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==l;if(!(a||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((c=this.parent)===null||c===void 0)&&c.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:f,layoutId:m}=this.options;if(!(!this.layout||!(f||m))){if(this.resolvedRelativeTargetAt=qe.timestamp,!this.targetDelta&&!this.relativeTarget){const g=this.getClosestProjectingParent();g&&g.layout&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ee(),this.relativeTargetOrigin=Ee(),Xs(this.relativeTargetOrigin,this.layout.layoutBox,g.layout.layoutBox),et(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Ee(),this.targetWithTransforms=Ee()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),cg(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):et(this.target,this.layout.layoutBox),Qc(this.target,this.targetDelta)):et(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const g=this.getClosestProjectingParent();g&&!!g.resumingFrom==!!this.resumingFrom&&!g.options.layoutScroll&&g.target&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ee(),this.relativeTargetOrigin=Ee(),Xs(this.relativeTargetOrigin,this.target,g.target),et(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Hs&&Ht.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||ti(this.parent.latestValues)||Wc(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const c=this.getLead(),l=!!this.resumingFrom||this!==c;let u=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(u=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===qe.timestamp&&(u=!1),u)return;const{layout:h,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||f))return;et(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,g=this.treeScale.y;yg(this.layoutCorrected,this.treeScale,this.path,l),c.layout&&!c.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(c.target=c.layout.layoutBox,c.targetWithTransforms=Ee());const{target:x}=c;if(!x){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(Lo(this.prevProjectionDelta.x,this.projectionDelta.x),Lo(this.prevProjectionDelta.y,this.projectionDelta.y)),Ys(this.projectionDelta,this.layoutCorrected,x,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==g||!Uo(this.projectionDelta.x,this.prevProjectionDelta.x)||!Uo(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",x)),Hs&&Ht.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var c;if((c=this.options.visualElement)===null||c===void 0||c.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=ms(),this.projectionDelta=ms(),this.projectionDeltaWithTransform=ms()}setAnimationOrigin(a,c=!1){const l=this.snapshot,u=l?l.latestValues:{},h={...this.latestValues},f=ms();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const m=Ee(),g=l?l.source:void 0,x=this.layout?this.layout.source:void 0,w=g!==x,b=this.getStack(),j=!b||b.members.length<=1,T=!!(w&&!j&&this.options.crossfade===!0&&!this.path.some(nx));this.animationProgress=0;let A;this.mixTargetDelta=D=>{const R=D/1e3;Ho(f.x,a.x,R),Ho(f.y,a.y,R),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Xs(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),sx(this.relativeTarget,this.relativeTargetOrigin,m,R),A&&$g(this.relativeTarget,A)&&(this.isProjectionDirty=!1),A||(A=Ee()),et(A,this.relativeTarget)),w&&(this.animationValues=h,Dg(h,u,this.latestValues,R,T,j)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=R},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(It(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=je.update(()=>{Fn.hasAnimatedSinceResize=!0,this.currentAnimation=Pg(0,Go,{...a,onUpdate:c=>{this.mixTargetDelta(c),a.onUpdate&&a.onUpdate(c)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Go),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:c,target:l,layout:u,latestValues:h}=a;if(!(!c||!l||!u)){if(this!==a&&this.layout&&u&&iu(this.options.animationType,this.layout.layoutBox,u.layoutBox)){l=this.target||Ee();const f=Ze(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+f;const m=Ze(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+m}et(c,l),gs(c,h),Ys(this.projectionDeltaWithTransform,this.layoutCorrected,c,h)}}registerSharedNode(a,c){this.sharedNodes.has(a)||this.sharedNodes.set(a,new qg),this.sharedNodes.get(a).add(c);const u=c.options.initialPromotionConfig;c.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(c):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:c}=this.options;return c?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:c}=this.options;return c?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:c,preserveFollowOpacity:l}={}){const u=this.getStack();u&&u.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let c=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(c=!0),!c)return;const u={};l.z&&Sr("z",a,u,this.animationValues);for(let h=0;h<Nr.length;h++)Sr(`rotate${Nr[h]}`,a,u,this.animationValues),Sr(`skew${Nr[h]}`,a,u,this.animationValues);a.render();for(const h in u)a.setStaticValue(h,u[h]),this.animationValues&&(this.animationValues[h]=u[h]);a.scheduleRender()}getProjectionStyles(a){var c,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Ug;const u={visibility:""},h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=On(a?.pointerEvents)||"",u.transform=h?h(this.latestValues,""):"none",u;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const w={};return this.options.layoutId&&(w.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,w.pointerEvents=On(a?.pointerEvents)||""),this.hasProjected&&!Kt(this.latestValues)&&(w.transform=h?h({},""):"none",this.hasProjected=!1),w}const m=f.animationValues||f.latestValues;this.applyTransformsToTarget(),u.transform=Bg(this.projectionDeltaWithTransform,this.treeScale,m),h&&(u.transform=h(m,u.transform));const{x:g,y:x}=this.projectionDelta;u.transformOrigin=`${g.origin*100}% ${x.origin*100}% 0`,f.animationValues?u.opacity=f===this?(l=(c=m.opacity)!==null&&c!==void 0?c:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:u.opacity=f===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const w in Bn){if(m[w]===void 0)continue;const{correct:b,applyTo:j}=Bn[w],T=u.transform==="none"?m[w]:b(m[w],f);if(j){const A=j.length;for(let D=0;D<A;D++)u[j[D]]=T}else u[w]=T}return this.options.layoutId&&(u.pointerEvents=f===this?On(a?.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var c;return(c=a.currentAnimation)===null||c===void 0?void 0:c.stop()}),this.root.nodes.forEach(zo),this.root.sharedNodes.clear()}}}function zg(t){t.updateLayout()}function Kg(t){var e;const s=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&s&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:i}=t.layout,{animationType:o}=t.options,a=s.source!==t.layout.source;o==="size"?st(f=>{const m=a?s.measuredBox[f]:s.layoutBox[f],g=Ze(m);m.min=n[f].min,m.max=m.min+g}):iu(o,s.layoutBox,n)&&st(f=>{const m=a?s.measuredBox[f]:s.layoutBox[f],g=Ze(n[f]);m.max=m.min+g,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[f].max=t.relativeTarget[f].min+g)});const c=ms();Ys(c,n,s.layoutBox);const l=ms();a?Ys(l,t.applyTransform(i,!0),s.measuredBox):Ys(l,n,s.layoutBox);const u=!tu(c);let h=!1;if(!t.resumeFrom){const f=t.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:m,layout:g}=f;if(m&&g){const x=Ee();Xs(x,s.layoutBox,m.layoutBox);const w=Ee();Xs(w,n,g.layoutBox),su(x,w)||(h=!0),f.options.layoutRoot&&(t.relativeTarget=w,t.relativeTargetOrigin=x,t.relativeParent=f)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:s,delta:l,layoutDelta:c,hasLayoutChanged:u,hasRelativeTargetChanged:h})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function Hg(t){Hs&&Ht.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function Wg(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function Qg(t){t.clearSnapshot()}function zo(t){t.clearMeasurements()}function Yg(t){t.isLayoutDirty=!1}function Xg(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function Ko(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function Jg(t){t.resolveTargetDelta()}function Zg(t){t.calcProjection()}function ex(t){t.resetSkewAndRotation()}function tx(t){t.removeLeadSnapshot()}function Ho(t,e,s){t.translate=Se(e.translate,0,s),t.scale=Se(e.scale,1,s),t.origin=e.origin,t.originPoint=e.originPoint}function Wo(t,e,s,n){t.min=Se(e.min,s.min,n),t.max=Se(e.max,s.max,n)}function sx(t,e,s,n){Wo(t.x,e.x,s.x,n),Wo(t.y,e.y,s.y,n)}function nx(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const rx={duration:.45,ease:[.4,0,.1,1]},Qo=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),Yo=Qo("applewebkit/")&&!Qo("chrome/")?Math.round:Je;function Xo(t){t.min=Yo(t.min),t.max=Yo(t.max)}function ix(t){Xo(t.x),Xo(t.y)}function iu(t,e,s){return t==="position"||t==="preserve-aspect"&&!lg(Bo(e),Bo(s),.2)}function ax(t){var e;return t!==t.root&&((e=t.scroll)===null||e===void 0?void 0:e.wasRoot)}const ox=ru({attachResizeListener:(t,e)=>on(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Cr={current:void 0},au=ru({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!Cr.current){const t=new ox({});t.mount(window),t.setOptions({layoutScroll:!0}),Cr.current=t}return Cr.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),lx={pan:{Feature:Sg},drag:{Feature:Ng,ProjectionNode:au,MeasureLayout:Jc}};function Jo(t,e,s){const{props:n}=t;t.animationState&&n.whileHover&&t.animationState.setActive("whileHover",s==="Start");const i="onHover"+s,o=n[i];o&&je.postRender(()=>o(e,yn(e)))}class cx extends Bt{mount(){const{current:e}=this.node;e&&(this.unmount=lm(e,s=>(Jo(this.node,s,"Start"),n=>Jo(this.node,n,"End"))))}unmount(){}}class ux extends Bt{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=xn(on(this.node.current,"focus",()=>this.onFocus()),on(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Zo(t,e,s){const{props:n}=t;t.animationState&&n.whileTap&&t.animationState.setActive("whileTap",s==="Start");const i="onTap"+(s==="End"?"":s),o=n[i];o&&je.postRender(()=>o(e,yn(e)))}class dx extends Bt{mount(){const{current:e}=this.node;e&&(this.unmount=hm(e,s=>(Zo(this.node,s,"Start"),(n,{success:i})=>Zo(this.node,n,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const ni=new WeakMap,_r=new WeakMap,hx=t=>{const e=ni.get(t.target);e&&e(t)},fx=t=>{t.forEach(hx)};function mx({root:t,...e}){const s=t||document;_r.has(s)||_r.set(s,{});const n=_r.get(s),i=JSON.stringify(e);return n[i]||(n[i]=new IntersectionObserver(fx,{root:t,...e})),n[i]}function px(t,e,s){const n=mx(e);return ni.set(t,s),n.observe(t),()=>{ni.delete(t),n.unobserve(t)}}const gx={some:0,all:1};class xx extends Bt{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:s,margin:n,amount:i="some",once:o}=e,a={root:s?s.current:void 0,rootMargin:n,threshold:typeof i=="number"?i:gx[i]},c=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,o&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:h,onViewportLeave:f}=this.node.getProps(),m=u?h:f;m&&m(l)};return px(this.node.current,a,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:s}=this.node;["amount","margin","root"].some(yx(e,s))&&this.startObserver()}unmount(){}}function yx({viewport:t={}},{viewport:e={}}={}){return s=>t[s]!==e[s]}const bx={inView:{Feature:xx},tap:{Feature:dx},focus:{Feature:ux},hover:{Feature:cx}},vx={layout:{ProjectionNode:au,MeasureLayout:Jc}},Wn={current:null},Hi={current:!1};function ou(){if(Hi.current=!0,!!gi)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>Wn.current=t.matches;t.addListener(e),e()}else Wn.current=!1}const wx=[...Ac,Ge,$t],jx=t=>wx.find(Ec(t)),el=new WeakMap;function Nx(t,e,s){for(const n in e){const i=e[n],o=s[n];if(ze(i))t.addValue(n,i);else if(ze(o))t.addValue(n,rn(i,{owner:t}));else if(o!==i)if(t.hasValue(n)){const a=t.getValue(n);a.liveStyle===!0?a.jump(i):a.hasAnimated||a.set(i)}else{const a=t.getStaticValue(n);t.addValue(n,rn(a!==void 0?a:i,{owner:t}))}}for(const n in s)e[n]===void 0&&t.removeValue(n);return e}const tl=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Sx{scrapeMotionValuesFromProps(e,s,n){return{}}constructor({parent:e,props:s,presenceContext:n,reducedMotionConfig:i,blockInitialAnimation:o,visualState:a},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Ui,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const g=pt.now();this.renderScheduledAt<g&&(this.renderScheduledAt=g,je.render(this.render,!1,!0))};const{latestValues:l,renderState:u,onUpdate:h}=a;this.onUpdate=h,this.latestValues=l,this.baseTarget={...l},this.initialValues=s.initial?{...l}:{},this.renderState=u,this.parent=e,this.props=s,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=c,this.blockInitialAnimation=!!o,this.isControllingVariants=Zn(s),this.isVariantNode=$l(s),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:f,...m}=this.scrapeMotionValuesFromProps(s,{},this);for(const g in m){const x=m[g];l[g]!==void 0&&ze(x)&&x.set(l[g],!1)}}mount(e){this.current=e,el.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((s,n)=>this.bindToMotionValue(n,s)),Hi.current||ou(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Wn.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){el.delete(this.current),this.projection&&this.projection.unmount(),It(this.notifyUpdate),It(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const s=this.features[e];s&&(s.unmount(),s.isMounted=!1)}this.current=null}bindToMotionValue(e,s){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=ls.has(e),i=s.on("change",c=>{this.latestValues[e]=c,this.props.onUpdate&&je.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0)}),o=s.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,s)),this.valueSubscriptions.set(e,()=>{i(),o(),a&&a(),s.owner&&s.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in As){const s=As[e];if(!s)continue;const{isEnabled:n,Feature:i}=s;if(!this.features[e]&&i&&n(this.props)&&(this.features[e]=new i(this)),this.features[e]){const o=this.features[e];o.isMounted?o.update():(o.mount(),o.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ee()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,s){this.latestValues[e]=s}update(e,s){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=s;for(let n=0;n<tl.length;n++){const i=tl[n];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const o="on"+i,a=e[o];a&&(this.propEventSubscriptions[i]=this.on(i,a))}this.prevMotionValues=Nx(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const s=this.getClosestVariantNode();if(s)return s.variantChildren&&s.variantChildren.add(e),()=>s.variantChildren.delete(e)}addValue(e,s){const n=this.values.get(e);s!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,s),this.values.set(e,s),this.latestValues[e]=s.get())}removeValue(e){this.values.delete(e);const s=this.valueSubscriptions.get(e);s&&(s(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,s){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&s!==void 0&&(n=rn(s===null?void 0:s,{owner:this}),this.addValue(e,n)),n}readValue(e,s){var n;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(n=this.getBaseTargetFromProps(this.props,e))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(Tc(i)||vc(i))?i=parseFloat(i):!jx(i)&&$t.test(s)&&(i=_c(e,s)),this.setBaseTarget(e,ze(i)?i.get():i)),ze(i)?i.get():i}setBaseTarget(e,s){this.baseTarget[e]=s}getBaseTarget(e){var s;const{initial:n}=this.props;let i;if(typeof n=="string"||typeof n=="object"){const a=Ni(this.props,n,(s=this.presenceContext)===null||s===void 0?void 0:s.custom);a&&(i=a[e])}if(n&&i!==void 0)return i;const o=this.getBaseTargetFromProps(this.props,e);return o!==void 0&&!ze(o)?o:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,s){return this.events[e]||(this.events[e]=new Vi),this.events[e].add(s)}notify(e,...s){this.events[e]&&this.events[e].notify(...s)}}class lu extends Sx{constructor(){super(...arguments),this.KeyframeResolver=Rc}sortInstanceNodePosition(e,s){return e.compareDocumentPosition(s)&2?1:-1}getBaseTargetFromProps(e,s){return e.style?e.style[s]:void 0}removeValueFromRenderState(e,{vars:s,style:n}){delete s[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;ze(e)&&(this.childSubscription=e.on("change",s=>{this.current&&(this.current.textContent=`${s}`)}))}}function Cx(t){return window.getComputedStyle(t)}class _x extends lu{constructor(){super(...arguments),this.type="html",this.renderInstance=Ql}readValueFromInstance(e,s){if(ls.has(s)){const n=Bi(s);return n&&n.default||0}else{const n=Cx(e),i=(Kl(s)?n.getPropertyValue(s):n[s])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:s}){return Yc(e,s)}build(e,s,n){_i(e,s,n.transformTemplate)}scrapeMotionValuesFromProps(e,s,n){return Mi(e,s,n)}}class kx extends lu{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ee}getBaseTargetFromProps(e,s){return e[s]}readValueFromInstance(e,s){if(ls.has(s)){const n=Bi(s);return n&&n.default||0}return s=Yl.has(s)?s:vi(s),e.getAttribute(s)}scrapeMotionValuesFromProps(e,s,n){return Zl(e,s,n)}build(e,s,n){ki(e,s,this.isSVGTag,n.transformTemplate)}renderInstance(e,s,n,i){Xl(e,s,n,i)}mount(e){this.isSVGTag=Ti(e.tagName),super.mount(e)}}const Px=(t,e)=>ji(t)?new kx(e):new _x(e,{allowProjection:t!==d.Fragment}),Tx=tm({...Zp,...bx,...lx,...vx},Px),sl=gf(Tx);function Mx(){!Hi.current&&ou();const[t]=d.useState(Wn.current);return t}const tt=[{title:"Welcome to Circles",text:"Create and join micro-groups for games, study, and local meetups.",image:"/circles/image2.png"},{title:"Find Your People",text:"Match by interests. See active circles. Join in two taps.",image:"/circles/image3.png"},{title:"Chat & Organize",text:"Lightweight DMs, clean group chats, quick polls and events.",image:"/circles/image.png"},{title:"Privacy First",text:"You choose what to share. RLS-secured backend powered by Supabase.",image:"/circles/image4.png"},{title:"Join Circles Now",text:"Sign in to start connecting with others!",image:"/circles/image5.png"}];function Ex(){const[t,e]=d.useState(0),[s,n]=d.useState(null),[i,o]=d.useState(""),[a,c]=d.useState(null),[l,u]=d.useState(""),[h,f]=d.useState("signin"),[m,g]=d.useState(!1),[x,w]=d.useState(!1),{user:b}=Vs(),j=jt(),T=qt(),A=Mx(),D=d.useRef(null);d.useEffect(()=>{n(null)},[t]),d.useEffect(()=>{const{data:{subscription:N}}=v.auth.onAuthStateChange((O,H)=>{if(O!=="SIGNED_IN"||!H?.user)return;localStorage.setItem("onboardingSeen","1"),(async()=>{try{await v.from("profiles").update({onboarded:!0}).eq("user_id",H.user.id)}catch(ne){console.error("Failed to update onboarding:",ne)}})();const ae=T?.state?.from,W=localStorage.getItem("postLoginRedirect"),te=W||ae||"/profile";W&&localStorage.removeItem("postLoginRedirect"),T.pathname.includes("onboarding")?j("/profile",{replace:!0}):j(te,{replace:!0})});return()=>N.unsubscribe()},[T.pathname,T.state,j]);const R=t===tt.length-1,B=A?0:.45,_=d.useMemo(()=>({duration:B,ease:[.22,1,.36,1]}),[B]);function S(N){N<0||N>=tt.length||e(N)}function L(){R?g(!0):e(N=>Math.min(N+1,tt.length-1))}function I(){e(N=>Math.max(N-1,0))}d.useEffect(()=>{function N(O){O.key==="ArrowRight"&&L(),O.key==="ArrowLeft"&&I(),O.key.toLowerCase()==="escape"&&Z()}return window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)},[]);function Z(){localStorage.setItem("onboardingSeen","1"),e(tt.length-1),g(!0)}const q=90;function M(N,O){const H=O?.offset?.x??0;H<=-q?L():H>=q&&I()}const z=(t+1)/tt.length*100,E="/circles/".replace(/\/+$/,""),K=`${window.location.origin}${E}/auth/callback`;async function F(){try{c(null),localStorage.setItem("onboardingSeen","1");const{error:N}=await v.auth.signInWithOAuth({provider:"facebook",options:{redirectTo:K}});if(N)throw N}catch(N){c(N?.message??"Failed to start Facebook login")}}async function $(){try{c(null),localStorage.setItem("onboardingSeen","1");const{error:N}=await v.auth.signInWithOAuth({provider:"google",options:{redirectTo:K}});if(N)throw N}catch(N){c(N?.message??"Failed to start Google login")}}async function P(N){if(N.preventDefault(),c(null),!i.trim()||!l.trim()){c("Enter email and password");return}try{if(w(!0),localStorage.setItem("onboardingSeen","1"),h==="signup"){const{error:O}=await v.auth.signUp({email:i.trim(),password:l.trim()});if(O)throw O}else{const{error:O}=await v.auth.signInWithPassword({email:i.trim(),password:l.trim()});if(O)throw O}}catch(O){c(O?.message??"Authentication failed")}finally{w(!1)}}return r.jsxs("div",{ref:D,className:"min-h-dvh w-full bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 text-white flex flex-col","aria-label":"Onboarding",children:[r.jsx("div",{className:"flex-1 flex flex-col items-center justify-center px-6",children:r.jsx(lf,{mode:"wait",initial:!1,children:r.jsx(sl.div,{initial:{opacity:0,x:60},animate:{opacity:1,x:0},exit:{opacity:0,x:-60},transition:_,className:"w-full max-w-md",children:r.jsxs(sl.div,{drag:"x",dragConstraints:{left:0,right:0},onDragEnd:M,className:"text-center select-none",children:[s===!1?r.jsxs("div",{className:"mx-auto mb-6 w-64 h-64 flex items-center justify-center rounded-lg border border-white/40 bg-white/10 text-xs text-white/90 p-3",children:["Missing image:",r.jsx("span",{className:"ml-1 break-all",children:tt[t].image})]}):r.jsx("img",{src:tt[t].image,alt:tt[t].title,className:"mx-auto mb-6 w-full max-w-[28rem] md:max-w-[32rem] h-auto object-contain drop-shadow-2xl",draggable:!1,onLoad:()=>n(!0),onError:N=>{console.error("Onboarding image failed to load:",tt[t].image),n(!1)}}),r.jsx("h1",{className:"text-3xl font-extrabold mb-3",children:tt[t].title}),r.jsx("p",{className:"text-base/7 opacity-95",children:tt[t].text}),R&&r.jsxs("div",{className:"mt-6 w-full max-w-sm mx-auto",children:[m?r.jsxs("form",{onSubmit:P,className:"grid grid-cols-1 gap-3",children:[r.jsx("input",{type:"email",placeholder:"you@example.com",value:i,onChange:N=>o(N.target.value),className:"w-full rounded-lg border border-white/30 bg-white/10 px-3 py-3 text-white placeholder-white/70 outline-none focus:bg-white/15"}),r.jsx("input",{type:"password",placeholder:"Password (min 6)",value:l,onChange:N=>u(N.target.value),className:"w-full rounded-lg border border-white/30 bg-white/10 px-3 py-3 text-white placeholder-white/70 outline-none focus:bg-white/15"}),r.jsx("button",{type:"submit",disabled:x,className:`w-full rounded-lg px-4 py-3 font-semibold ${x?"bg-white/40":"bg-white text-indigo-700"}`,children:x?"Please waitâ€¦":h==="signup"?"Sign up":"Sign in"}),r.jsx("button",{type:"button",onClick:()=>f(h==="signup"?"signin":"signup"),className:"text-sm underline opacity-90",children:h==="signup"?"Have an account? Sign in":"No account? Sign up"}),r.jsx("button",{type:"button",onClick:()=>g(!1),className:"text-xs opacity-75 hover:opacity-100",children:"â† Back to options"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[r.jsx("button",{onClick:$,className:"w-full rounded-lg bg-white/90 px-4 py-3 font-semibold text-indigo-700 hover:bg-white",children:"Continue with Google"}),r.jsx("button",{onClick:()=>{g(!0),c(null)},className:"w-full rounded-lg bg-white text-indigo-700 px-4 py-3 font-semibold",children:"Continue with Email"}),r.jsx("button",{onClick:F,className:"w-full rounded-lg bg-[#1877F2] px-4 py-3 font-semibold text-white",children:"Continue with Facebook"})]}),r.jsxs("p",{className:"mt-4 text-center text-[10px] text-white/60",children:["By continuing, you agree to our"," ",r.jsx(we,{to:"/legal",className:"underline hover:text-white",children:"Terms & Privacy Policy"}),"."]})]}),a&&r.jsx("div",{className:"mt-3 rounded border border-red-200 bg-red-50/90 px-3 py-2 text-sm text-red-800",children:a})]})]})},t)})}),r.jsxs("div",{className:`px-6 pb-6 ${R&&m?"hidden":""}`,children:[r.jsxs("div",{className:"mb-5",children:[r.jsx("div",{className:"h-1.5 w-full bg-white/25 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-white rounded-full transition-all",style:{width:`${z}%`},"aria-hidden":!0})}),r.jsxs("div",{className:"sr-only",role:"status","aria-live":"polite",children:[Math.round(z)," percent complete"]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("button",{onClick:I,disabled:t===0,className:"px-4 py-2 rounded bg-white text-indigo-700 font-semibold disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-white/40","aria-label":"Previous",children:"Back"}),r.jsx("div",{className:"flex gap-2",children:tt.map((N,O)=>r.jsx("button",{"aria-label":`Go to slide ${O+1}`,onClick:()=>S(O),className:`w-3 h-3 rounded-full transition-opacity ${O===t?"bg-white":"bg-white/50 hover:bg-white/70"}`},O))}),r.jsx("button",{onClick:L,className:"px-4 py-2 rounded bg-white text-indigo-700 font-semibold focus:outline-none focus:ring-2 focus:ring-white/40","aria-label":R?"Login":"Next",children:R?"Login":"Next"})]})]})]})}const Ax=/^[A-Z0-9]{6,12}$/i;function Rx(){const{code:t}=fn(),e=jt(),[s,n]=d.useState("Joiningâ€¦"),i=d.useMemo(()=>t?`/invite/${t}`:"/invite/invalid",[t]),o=d.useRef(!1);return d.useEffect(()=>{let a=!1;if(!o.current)return o.current=!0,(async()=>{if(!t||!Ax.test(t)){a||n("Invalid or malformed link");return}const{data:c}=await v.auth.getUser();if(!c?.user){try{localStorage.setItem("postLoginRedirect",i)}catch{}e("/onboarding",{state:{redirect:i},replace:!0});return}try{const{data:l,error:u}=await v.rpc("join_via_code",{p_code:t});if(u){a||n(nl(u.message));return}if(!l){a||n("Invite not found or expired");return}e(`/group/${l}`,{replace:!0})}catch(l){a||n(nl(l?.message||String(l)))}})(),()=>{a=!0}},[t,i,e]),r.jsx("div",{className:"mx-auto max-w-md p-6 text-sm text-neutral-700","aria-live":"polite",children:s})}function nl(t){const e=(t||"").toLowerCase();return e.includes("permission")||e.includes("rls")?"You donâ€™t have permission to join this group.":e.includes("not found")||e.includes("no rows")?"Invite not found.":e.includes("expired")?"Invite expired.":e.includes("invalid input syntax for type uuid")?"Invalid invite code.":t}function Dx(){const t=jt(),{user:e}=Vs(),[s,n]=d.useState(!0),[i,o]=d.useState([]),[a,c]=d.useState([]),[l,u]=d.useState([]),[h,f]=d.useState([]),[m,g]=d.useState([]),[x,w]=d.useState(!1);d.useEffect(()=>{if(!e)return;const _=e.id;async function S(){n(!0);try{const{data:L}=await v.rpc("get_my_friend_requests"),I=(L||[]).map(F=>({id:F.id,user_id_a:F.sender_id,created_at:F.created_at,profiles:{name:F.sender_name,avatar_url:F.sender_avatar}})),{data:Z}=await v.from("group_members").select("group_id, created_at, groups(title)").eq("user_id",_).eq("status","invited").order("created_at",{ascending:!1}),{data:q}=await v.from("group_members").select("group_id").eq("user_id",_).in("status",["active","accepted"]),M=q?.map(F=>F.group_id)||[];let z=[],E=[],K=[];if(M.length>0){const{data:F}=await v.from("group_polls").select("id, title, group_id, created_at, groups(title)").in("group_id",M).eq("status","open").order("created_at",{ascending:!1});z=F||[];const{data:$}=await v.from("group_messages").select("group_id, created_at, groups(title)").in("group_id",M).neq("sender_id",_).order("created_at",{ascending:!1}).limit(50);E=$||[];const{data:P}=await v.from("group_votes").select("poll_id, option_id, created_at, group_polls(id, title, group_id, groups(title)), group_poll_options(id, label)").eq("user_id",_).order("created_at",{ascending:!1}).limit(200);K=P||[]}o(I||[]),c(Z||[]),u(z),f(E),g(K)}catch(L){console.error("Error loading notifications",L)}finally{n(!1)}}S()},[e]);const b=d.useMemo(()=>{const _=[],S=new Date;S.setHours(0,0,0,0),i.forEach(M=>{_.push({id:`fr-${M.id}`,type:"friend_req",date:new Date(M.created_at),data:M})}),a.forEach(M=>{_.push({id:`inv-${M.group_id}`,type:"invite",date:new Date(M.created_at),data:M})});const L=new Map;l.forEach(M=>{L.has(M.id)||L.set(M.id,M)}),Array.from(L.values()).forEach(M=>{_.push({id:`poll-${M.id}`,type:"poll",date:new Date(M.created_at),data:M})});const I={};h.forEach(M=>{const z=M.group_id;I[z]||(I[z]={count:0,latest:new Date(M.created_at),groupName:M.groups?.title||"Unknown Group"}),I[z].count++;const E=new Date(M.created_at);E>I[z].latest&&(I[z].latest=E)}),Object.keys(I).forEach(M=>{_.push({id:`msg-group-${M}`,type:"message_summary",date:I[M].latest,data:{group_id:M,title:I[M].groupName,count:I[M].count}})}),m.forEach(M=>{_.push({id:`vote-${M.poll_id}-${M.option_id}-${M.created_at}`,type:"vote",date:new Date(M.created_at),data:M})}),_.sort((M,z)=>z.date.getTime()-M.date.getTime());const Z=_.filter(M=>M.date.getTime()>=S.getTime()),q=_.filter(M=>M.date.getTime()<S.getTime());return{recent:Z,older:q}},[i,a,l,h,m]);async function j(_,S){await v.rpc("accept_friend",{from_id:S}),o(L=>L.filter(I=>I.id!==_))}async function T(_){if(!e)return;const{error:S}=await v.from("group_members").update({status:"accepted"}).eq("group_id",_).eq("user_id",e.id);if(S){console.error("Failed to join group from notifications",S);return}c(L=>L.filter(I=>I.group_id!==_)),t(`/group/${_}`)}const A=_=>{const S=Date.now()-_.date.getTime()<864e5;return r.jsxs("div",{className:"bg-white border border-neutral-100 p-3 rounded-2xl flex items-center gap-3 shadow-sm mb-3 animate-in fade-in slide-in-from-bottom-2",children:[r.jsxs("div",{className:`h-10 w-10 shrink-0 rounded-full flex items-center justify-center ${_.type==="friend_req"?"bg-purple-100 text-purple-600":_.type==="invite"?"bg-amber-100 text-amber-600":_.type==="poll"?"bg-blue-100 text-blue-600":(_.type==="vote","bg-emerald-100 text-emerald-600")}`,children:[_.type==="friend_req"&&r.jsx(El,{className:"h-5 w-5"}),_.type==="invite"&&r.jsx(Bd,{className:"h-5 w-5"}),_.type==="poll"&&r.jsx(Ea,{className:"h-5 w-5"}),_.type==="vote"&&r.jsx(Ea,{className:"h-5 w-5"}),_.type==="message_summary"&&r.jsx(Ml,{className:"h-5 w-5"})]}),r.jsxs("div",{className:"flex-1 min-w-0",children:[_.type==="friend_req"&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-sm font-bold text-neutral-900",children:_.data.profiles?.name||"User"}),r.jsx("div",{className:"text-xs text-neutral-500",children:"Sent you a friend request"}),r.jsx("div",{className:"mt-2 flex gap-2",children:r.jsx("button",{onClick:()=>j(_.data.id,_.data.user_id_a),className:"bg-black text-white px-3 py-1 rounded-full text-xs font-bold",children:"Accept"})})]}),_.type==="invite"&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-sm font-bold text-neutral-900",children:_.data.groups?.title}),r.jsx("div",{className:"text-xs text-neutral-500",children:"You were invited to join"}),r.jsx("div",{className:"mt-2 flex gap-2",children:r.jsx("button",{onClick:()=>T(_.data.group_id),className:"bg-black text-white px-3 py-1 rounded-full text-xs font-bold",children:"Join"})})]}),_.type==="poll"&&r.jsxs("div",{onClick:()=>t(`/group/${_.data.group_id}`),className:"cursor-pointer",children:[r.jsx("div",{className:"text-sm font-bold text-neutral-900",children:_.data.title}),r.jsxs("div",{className:"text-xs text-neutral-500 flex items-center gap-1",children:["Vote in ",r.jsx("span",{className:"font-medium text-neutral-700",children:_.data.groups?.title})]})]}),_.type==="vote"&&r.jsxs("div",{onClick:()=>t(`/group/${_.data.group_polls?.group_id||_.data.group_polls?.group_id}`),className:"cursor-pointer",children:[r.jsx("div",{className:"text-sm font-bold text-neutral-900",children:"You voted"}),r.jsx("div",{className:"text-xs text-neutral-500",children:_.data.group_polls?.title?`Poll: ${_.data.group_polls.title}`:"Poll"}),r.jsx("div",{className:"text-xs text-neutral-500",children:_.data.group_poll_options?.label?`Choice: ${_.data.group_poll_options.label}`:""}),r.jsx("div",{className:"text-xs text-neutral-500",children:_.data.group_polls?.groups?.title?`Group: ${_.data.group_polls.groups.title}`:""})]}),_.type==="message_summary"&&r.jsxs("div",{onClick:()=>t(`/group/${_.data.group_id}`),className:"cursor-pointer",children:[r.jsx("div",{className:"text-sm font-bold text-neutral-900",children:_.data.title}),r.jsxs("div",{className:"text-xs text-neutral-500 font-medium",children:[_.data.count," new message",_.data.count>1?"s":""]})]})]}),r.jsx("div",{className:"text-[10px] text-neutral-400 whitespace-nowrap self-start",children:S?_.date.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):_.date.toLocaleDateString()})]},_.id)};if(s)return r.jsx("div",{className:"pt-24 text-center text-neutral-400 text-sm",children:"Checking for updates..."});const{recent:D,older:R}=b,B=D.length===0&&R.length===0;return r.jsxs("div",{className:"mx-auto w-full max-w-xl px-4 py-8 pb-32",children:[r.jsx("h1",{className:"text-2xl font-extrabold text-neutral-900 mb-6",children:"Activity"}),B&&r.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[r.jsx("div",{className:"h-16 w-16 bg-neutral-100 rounded-full flex items-center justify-center mb-4",children:r.jsx("span",{className:"text-2xl",children:"ğŸ’¤"})}),r.jsx("h3",{className:"text-neutral-900 font-bold",children:"All caught up"}),r.jsx("p",{className:"text-neutral-500 text-sm",children:"No activity yet."})]}),D.length>0&&r.jsxs("div",{className:"mb-6",children:[r.jsx("h2",{className:"text-xs font-bold text-neutral-400 uppercase tracking-wider mb-3",children:"New"}),D.map(A)]}),R.length>0&&r.jsxs("div",{children:[r.jsxs("button",{onClick:()=>w(!x),className:"flex items-center gap-2 text-xs font-bold text-neutral-400 uppercase tracking-wider mb-3 hover:text-neutral-600 transition-colors w-full",children:[x?r.jsx(Tl,{className:"h-4 w-4"}):r.jsx(Pl,{className:"h-4 w-4"}),"Earlier (",R.length,")"]}),x&&r.jsx("div",{className:"animate-in slide-in-from-top-2 fade-in duration-300",children:R.map(A)})]})]})}function rl({size:t=20,className:e=""}){return r.jsxs("svg",{className:`animate-spin ${e}`,width:t,height:t,viewBox:"0 0 24 24",fill:"none",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]})}const Lx=d.lazy(()=>Qn(()=>import("./ChatPanel-Dfk8zaw2.js"),__vite__mapDeps([3,1,2])));function Ox(){const t=jt(),e=qt(),[s,n]=d.useState(null),[i,o]=d.useState([]),[a,c]=d.useState(!0),[l,u]=d.useState(null),[h,f]=d.useState(null),[m,g]=d.useState([]),[x,w]=d.useState(""),[b,j]=d.useState(!1),T=d.useRef(null),A=d.useRef(null),[D,R]=d.useState("all"),[B,_]=d.useState("");d.useEffect(()=>{async function E(){const{data:{user:K}}=await v.auth.getUser();if(!K)return;n(K.id);const F=new Set(JSON.parse(localStorage.getItem("chat_favorites")||"[]")),{data:$}=await v.from("group_members").select("group_id, groups(id, title, category)").eq("user_id",K.id).in("status",["active","accepted"]),{data:P}=await v.from("friendships").select("user_id_a, user_id_b").or(`user_id_a.eq.${K.id},user_id_b.eq.${K.id}`).eq("status","accepted"),N=[];if($&&$.forEach(O=>{O.groups&&N.push({type:"group",id:O.groups.id,name:O.groups.title||"Group",avatar_url:null,subtitle:O.groups.category||"Group",isFavorite:F.has(O.groups.id)})}),P){const O=P.map(H=>H.user_id_a===K.id?H.user_id_b:H.user_id_a);if(O.length>0){const{data:H}=await v.from("profiles").select("user_id, name, avatar_url").in("user_id",O);H?.forEach(ae=>{N.push({type:"dm",id:ae.user_id,name:ae.name||"User",avatar_url:ae.avatar_url,subtitle:"Direct Message",isFavorite:F.has(ae.user_id)})})}}N.sort((O,H)=>O.isFavorite&&!H.isFavorite?-1:!O.isFavorite&&H.isFavorite?1:O.name.localeCompare(H.name)),o(N),c(!1)}E()},[]);const S=E=>{const K=new Set(JSON.parse(localStorage.getItem("chat_favorites")||"[]"));let F=!1;K.has(E)?(K.delete(E),F=!1):(K.add(E),F=!0),localStorage.setItem("chat_favorites",JSON.stringify(Array.from(K))),o($=>$.map(P=>P.id===E?{...P,isFavorite:F}:P).sort((P,N)=>P.isFavorite&&!N.isFavorite?-1:!P.isFavorite&&N.isFavorite?1:P.name.localeCompare(N.name))),l&&l.id===E&&u($=>$?{...$,isFavorite:F}:null)};d.useEffect(()=>{const E=e.state?.openDmId;if(E&&i.length>0&&!l){const K=i.find(F=>F.id===E&&F.type==="dm");K?u(K):(async()=>{const{data:F}=await v.from("profiles").select("name, avatar_url").eq("user_id",E).single();if(F){const $=new Set(JSON.parse(localStorage.getItem("chat_favorites")||"[]")),P={type:"dm",id:E,name:F.name||"User",avatar_url:F.avatar_url,subtitle:"Direct Message",isFavorite:$.has(E)};o(N=>[P,...N]),u(P)}})(),window.history.replaceState({},"")}},[e.state,i,l]),d.useEffect(()=>{if(!s||!l||l.type!=="dm")return;let E=null,K=null;async function F(){j(!0);const $=l.id,{data:P}=await v.from("direct_messages").select("id, sender, receiver, content, created_at").or(`and(sender.eq.${s},receiver.eq.${$}),and(sender.eq.${$},receiver.eq.${s})`).order("created_at",{ascending:!0}).limit(100);g(P||[]),j(!1),setTimeout(()=>T.current?.scrollIntoView({behavior:"smooth"}),100),E=v.channel(`dm:${$}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"direct_messages",filter:`or(and(sender.eq.${s},receiver.eq.${$}),and(sender.eq.${$},receiver.eq.${s}))`},N=>{const O=N.new;(O.sender===s&&O.receiver===$||O.sender===$&&O.receiver===s)&&(g(ae=>[...ae,O]),setTimeout(()=>T.current?.scrollIntoView({behavior:"smooth"}),100))}).subscribe(),K=setInterval(async()=>{const{data:N}=await v.from("direct_messages").select("id, sender, receiver, content, created_at").or(`and(sender.eq.${s},receiver.eq.${$}),and(sender.eq.${$},receiver.eq.${s})`).order("created_at",{ascending:!0}).limit(100);N&&g(N)},5e3)}return F(),()=>{E&&v.removeChannel(E),K&&clearInterval(K)}},[l,s]),d.useEffect(()=>{l?.type==="dm"&&A.current?.focus()},[l]);const L=async()=>{if(!x.trim()||!s||!l||l.type!=="dm")return;const E=x.trim();w(""),A.current?.focus(),await v.from("direct_messages").insert({sender:s,receiver:l.id,content:E})},Z=i.filter(E=>!(D==="groups"&&E.type!=="group"||D==="private"&&E.type!=="dm"||D==="fav"&&!E.isFavorite||!E.name||!E.name.toLowerCase().includes(B.toLowerCase()))),q=({id:E,label:K})=>r.jsx("button",{onClick:()=>R(E),className:`
        whitespace-nowrap px-4 py-1.5 rounded-full text-xs font-semibold transition-all border
        ${D===E?"bg-neutral-900 text-white border-neutral-900 shadow-md transform scale-105":"bg-white text-neutral-600 border-neutral-200 hover:bg-neutral-50 hover:border-neutral-300"}
      `,children:K}),M=()=>r.jsxs("div",{className:`flex flex-col h-full bg-white border-r border-neutral-200 ${l?"hidden md:flex":"flex"} w-full md:w-80 lg:w-96`,children:[r.jsxs("div",{className:"p-5 border-b border-neutral-100 bg-white/80 backdrop-blur-md sticky top-0 z-10",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h1",{className:"text-2xl font-bold text-neutral-900 tracking-tight",children:"Chats"}),a&&r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-neutral-900"})]}),r.jsxs("div",{className:"relative mb-4 group",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-neutral-400 group-focus-within:text-emerald-600 transition-colors",children:r.jsx(ui,{className:"h-4 w-4"})}),r.jsx("input",{value:B,onChange:E=>_(E.target.value),placeholder:"Search conversations...",className:"block w-full pl-10 pr-3 py-2.5 border border-neutral-200 rounded-xl leading-5 bg-neutral-50 placeholder-neutral-400 focus:outline-none focus:bg-white focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 transition-all text-sm font-medium"})]}),r.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-1 scrollbar-hide",children:[r.jsx(q,{id:"all",label:"All"}),r.jsx(q,{id:"groups",label:"Groups"}),r.jsx(q,{id:"private",label:"Private"}),r.jsx(q,{id:"fav",label:"Favorites"})]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto",children:a?r.jsx("div",{className:"p-8 flex justify-center",children:r.jsx(rl,{})}):Z.length===0?r.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-neutral-400 px-6 text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-neutral-50 rounded-full flex items-center justify-center mb-4",children:r.jsx(Rd,{className:"h-6 w-6 opacity-30"})}),r.jsx("p",{className:"text-sm font-medium",children:"No chats found."}),r.jsx("p",{className:"text-xs mt-1 opacity-70",children:"Try adjusting your filters or search."})]}):r.jsx("div",{className:"px-2 py-2 space-y-1",children:Z.map(E=>r.jsxs("div",{className:"group relative",children:[r.jsxs("button",{onClick:()=>u(E),className:`
                    w-full flex items-center gap-3 p-3 rounded-xl text-left transition-all duration-200
                    ${l?.id===E.id?"bg-emerald-50 shadow-sm ring-1 ring-emerald-100":"hover:bg-neutral-50"}
                  `,children:[r.jsx("div",{className:`
                    h-12 w-12 rounded-full flex items-center justify-center text-lg font-bold shrink-0 shadow-sm
                    ${E.type==="group"?"bg-gradient-to-br from-indigo-100 to-indigo-200 text-indigo-700":"bg-gradient-to-br from-neutral-100 to-neutral-200 text-neutral-600"}
                  `,children:E.type==="dm"&&E.avatar_url?r.jsx("img",{src:E.avatar_url,alt:"",className:"h-full w-full object-cover rounded-full"}):E.type==="group"?r.jsx(Ds,{className:"h-5 w-5"}):E.name.slice(0,1).toUpperCase()}),r.jsxs("div",{className:"min-w-0 flex-1 pr-8",children:[r.jsx("div",{className:`font-semibold truncate ${l?.id===E.id?"text-emerald-900":"text-neutral-900"}`,children:E.name}),r.jsx("div",{className:"text-xs text-neutral-500 truncate mt-0.5",children:E.subtitle})]})]}),r.jsx("button",{onClick:K=>{K.stopPropagation(),S(E.id)},className:`
                    absolute right-3 top-1/2 -translate-y-1/2 p-2 rounded-full transition-all duration-200
                    hover:bg-white hover:shadow-sm
                    ${E.isFavorite?"opacity-100 text-rose-500":"opacity-0 group-hover:opacity-100 text-neutral-300 hover:text-rose-400"}
                  `,title:E.isFavorite?"Remove from Favorites":"Add to Favorites",children:r.jsx(Ma,{className:`h-4 w-4 ${E.isFavorite?"fill-current":""}`})})]},E.type+E.id))})})]}),z=()=>{if(!l)return r.jsxs("div",{className:"hidden md:flex flex-1 items-center justify-center bg-neutral-50/50 flex-col gap-6",children:[r.jsx("div",{className:"bg-white p-6 rounded-full shadow-sm ring-1 ring-black/5",children:r.jsx($n,{className:"h-12 w-12 text-emerald-500/50"})}),r.jsxs("div",{className:"text-center",children:[r.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:"Select a conversation"}),r.jsx("p",{className:"text-sm text-neutral-500 mt-1",children:"Choose a group or friend to start chatting"})]})]});const E=()=>{l.type==="group"?t(`/group/${l.id}`):l.type==="dm"&&f(l.id)};return r.jsxs("div",{className:"fixed inset-0 z-50 pb-20 md:pb-0 md:static md:inset-auto md:flex-1 bg-white flex flex-col h-full",children:[r.jsxs("div",{className:"h-[72px] border-b border-neutral-200 flex items-center px-4 gap-4 bg-white/95 backdrop-blur-sm shrink-0 shadow-sm z-20",children:[r.jsx("button",{onClick:()=>u(null),className:"md:hidden p-2 -ml-2 rounded-full hover:bg-neutral-100 transition-colors",children:r.jsx(Ts,{className:"h-5 w-5 text-neutral-600"})}),r.jsxs("div",{onClick:E,className:"flex items-center gap-4 flex-1 min-w-0 cursor-pointer hover:opacity-70 transition-opacity",title:`View ${l.type==="group"?"Group":"Profile"}`,children:[r.jsx("div",{className:`h-10 w-10 rounded-full flex items-center justify-center text-sm font-bold shadow-sm ${l.type==="group"?"bg-indigo-100 text-indigo-700":"bg-neutral-100 text-neutral-600"}`,children:l.type==="dm"&&l.avatar_url?r.jsx("img",{src:l.avatar_url,alt:"",className:"h-full w-full object-cover rounded-full"}):l.type==="group"?"#":l.name.slice(0,1)}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"font-bold text-neutral-900 truncate text-base",children:l.name}),r.jsxs("div",{className:"text-xs text-neutral-500 flex items-center gap-1",children:[r.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${l.type==="group"?"bg-indigo-500":"bg-emerald-500"}`}),l.type==="group"?"Group Chat":"Direct Message"]})]})]}),r.jsx("button",{onClick:()=>S(l.id),className:"p-2 rounded-full hover:bg-neutral-100 transition-colors focus:outline-none focus:ring-2 focus:ring-neutral-200",title:l.isFavorite?"Remove from Favorites":"Add to Favorites",children:r.jsx(Ma,{className:`h-5 w-5 transition-colors ${l.isFavorite?"fill-rose-500 text-rose-500":"text-neutral-400"}`})})]}),r.jsxs("div",{className:"flex-1 overflow-hidden relative bg-neutral-50",children:[r.jsx("div",{className:"absolute inset-0 opacity-[0.03] pointer-events-none",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='20' height='20' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23000000' fill-opacity='1' fill-rule='evenodd'%3E%3Ccircle cx='3' cy='3' r='1'/%3E%3C/g%3E%3C/svg%3E")`}}),l.type==="group"?r.jsx(d.Suspense,{fallback:r.jsx("div",{className:"h-full w-full flex items-center justify-center",children:r.jsx(rl,{})}),children:r.jsx("div",{className:"h-full w-full relative z-10",children:r.jsx(Lx,{groupId:l.id,onClose:()=>u(null),full:!0,setFull:()=>{},user:{id:s}})})}):r.jsxs("div",{className:"flex flex-col h-full relative z-10",children:[r.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[b&&r.jsx("div",{className:"flex justify-center py-4",children:r.jsx("div",{className:"bg-white/80 px-4 py-1.5 rounded-full text-xs font-medium text-neutral-500 shadow-sm border border-neutral-100",children:"Loading history..."})}),!b&&m.length===0&&r.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-neutral-400 space-y-3",children:[r.jsx("div",{className:"w-16 h-16 bg-white rounded-full shadow-sm flex items-center justify-center",children:r.jsx($n,{className:"h-8 w-8 text-neutral-200"})}),r.jsx("div",{className:"text-sm",children:"No messages yet. Say hi! ğŸ‘‹"})]}),m.map((K,F)=>{const $=K.sender===s,P=!$&&(F===0||m[F-1].sender!==K.sender);return r.jsx("div",{className:`flex ${$?"justify-end":"justify-start"} group animate-in fade-in slide-in-from-bottom-2 duration-300`,children:r.jsxs("div",{className:`flex max-w-[80%] md:max-w-[70%] ${$?"flex-row-reverse":"flex-row"} items-end gap-2`,children:[!$&&r.jsx("div",{className:"w-6 h-6 shrink-0 mb-1",children:P&&(l.avatar_url?r.jsx("img",{src:l.avatar_url,className:"w-6 h-6 rounded-full object-cover shadow-sm"}):r.jsx("div",{className:"w-6 h-6 rounded-full bg-neutral-200 flex items-center justify-center text-[9px] font-bold text-neutral-500",children:l.name.slice(0,1)}))}),r.jsxs("div",{className:`
                          px-4 py-2.5 text-sm shadow-sm relative
                          ${$?"bg-gradient-to-br from-emerald-500 to-emerald-600 text-white rounded-2xl rounded-tr-sm":"bg-white text-neutral-800 border border-neutral-100 rounded-2xl rounded-tl-sm"}
                        `,children:[K.content,r.jsx("div",{className:`text-[9px] mt-1 text-right opacity-70 ${$?"text-emerald-100":"text-neutral-400"}`,children:new Date(K.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})},K.id)}),r.jsx("div",{ref:T})]}),r.jsx("div",{className:"p-4 bg-white border-t border-neutral-200/80 backdrop-blur-md",children:r.jsxs("div",{className:"flex items-center gap-2 max-w-4xl mx-auto bg-neutral-50 border border-neutral-200 rounded-full px-2 py-2 focus-within:ring-2 focus-within:ring-emerald-500/20 focus-within:border-emerald-500 transition-all shadow-inner",children:[r.jsx("input",{ref:A,value:x,onChange:K=>w(K.target.value),onKeyDown:K=>K.key==="Enter"&&L(),autoFocus:!0,placeholder:"Type a message...",className:"flex-1 bg-transparent border-0 px-4 py-1 text-sm focus:ring-0 text-neutral-900 placeholder-neutral-400 outline-none"}),r.jsx("button",{onClick:L,disabled:!x.trim(),className:`
                      p-2.5 rounded-full transition-all duration-200 flex items-center justify-center shadow-sm
                      ${x.trim()?"bg-emerald-600 text-white hover:bg-emerald-700 hover:scale-105 active:scale-95":"bg-neutral-200 text-neutral-400 cursor-not-allowed"}
                    `,children:r.jsx(Xd,{className:"h-4 w-4 ml-0.5"})})]})})]})]})]})};return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex h-[calc(100vh-64px)] w-full overflow-hidden bg-white fixed top-0 left-0",children:[r.jsx(M,{}),r.jsx(z,{})]}),r.jsx(di,{isOpen:!!h,onClose:()=>f(null),viewUserId:h})]})}function Vx(){return r.jsxs("div",{className:"min-h-screen bg-white p-6 max-w-2xl mx-auto",children:[r.jsxs(we,{to:"/onboarding",className:"inline-flex items-center gap-2 text-neutral-600 mb-6 hover:text-black",children:[r.jsx(Ts,{className:"h-4 w-4"})," Back"]}),r.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Legal & Privacy"}),r.jsxs("section",{className:"mb-8 space-y-4",children:[r.jsx("h2",{className:"text-xl font-bold",children:"Privacy Policy"}),r.jsx("p",{className:"text-neutral-600 text-sm",children:"We respect your privacy. We only store the data necessary for the app to function (your profile, messages, and groups). We do not sell your data. You can delete your account and data at any time by contacting support."})]}),r.jsxs("section",{className:"mb-8 space-y-4",children:[r.jsx("h2",{className:"text-xl font-bold",children:"Terms of Service"}),r.jsx("p",{className:"text-neutral-600 text-sm",children:"By using Circles, you agree to be kind and respectful. We have zero tolerance for harassment, hate speech, or objectional content. Users posting such content will be banned. You are responsible for your own interactions."})]}),r.jsxs("section",{className:"mb-8 space-y-4",children:[r.jsx("h2",{className:"text-xl font-bold",children:"Contact"}),r.jsx("p",{className:"text-neutral-600 text-sm",children:"Questions? Email us at support@yourdomain.com"})]})]})}function Fx(){const t=jt();return d.useEffect(()=>{(async()=>(await v.auth.getSession(),t("/",{replace:!0})))()},[t]),null}const cu=d.createContext({user:null,loading:!0});function Vs(){return d.useContext(cu)}function Ix({children:t}){const[e,s]=d.useState(null),[n,i]=d.useState(!0);d.useEffect(()=>{let a=!0;v.auth.getSession().then(({data:l,error:u})=>{a&&(u&&console.warn("[auth] getSession error",u.message),s(l.session?.user??null),i(!1))});const{data:{subscription:c}}=v.auth.onAuthStateChange((l,u)=>{a&&(s(u?.user??null),i(!1))});return()=>{a=!1,c.unsubscribe()}},[]);const o=d.useMemo(()=>({user:e,loading:n}),[e,n]);return r.jsx(cu.Provider,{value:o,children:t})}function il({children:t}){const{user:e,loading:s}=Vs(),{data:n,isLoading:i}=Al(e?.id??null),o=qt();return s||e&&i?r.jsx("div",{className:"grid min-h-dvh place-items-center text-sm text-neutral-600",children:"Loadingâ€¦"}):e?(!n||n.onboarded===!1)&&o.pathname!=="/profile-creation"?r.jsx(Js,{to:"/profile-creation",replace:!0,state:{from:o.pathname}}):r.jsx(r.Fragment,{children:t}):r.jsx(Js,{to:"/onboarding",replace:!0,state:{from:o.pathname}})}class $x extends as.Component{constructor(e){super(e),this.state={error:null}}static getDerivedStateFromError(e){return{error:e}}render(){return this.state.error?r.jsx("div",{className:"grid min-h-screen place-items-center p-6",children:r.jsxs("div",{className:"max-w-md text-center",children:[r.jsx("h1",{className:"text-2xl font-bold",children:"Something broke"}),r.jsx("p",{className:"text-sm text-neutral-600 break-words mt-2",children:String(this.state.error?.message??this.state.error)}),r.jsx("button",{className:"mt-4 rounded-md border border-black/10 bg-white px-3 py-2 text-sm hover:bg-black/[0.04]",onClick:()=>location.reload(),children:"Reload"})]})}):this.props.children}}function qx(){const{id:t}=fn();return r.jsx(Js,{to:`/group/${t}`,replace:!0})}function Bx(){return r.jsx(Js,{to:"/onboarding",replace:!0})}function Ux(){d.useEffect(()=>{window.scrollTo(0,0)},[]),d.useEffect(()=>{try{"scrollRestoration"in history&&(history.scrollRestoration="manual")}catch{}},[]);const t=qt();return d.useEffect(()=>{window.scrollTo(0,0)},[t.pathname,t.search]),r.jsx("div",{id:"page-root",className:"min-h-dvh flow-root flex flex-col",children:r.jsxs(Ix,{children:[r.jsx("button",{onClick:()=>window.open("mailto:support@yourdomain.com?subject=Help%20with%20Circles%20App","_blank"),className:"fixed top-4 right-4 z-50 grid h-10 w-10 place-items-center rounded-full bg-white text-neutral-600 shadow-md ring-1 ring-black/5 transition-transform hover:scale-105 hover:text-black",title:"Support","aria-label":"Support",children:r.jsx(Pd,{className:"h-6 w-6"})}),r.jsx($x,{children:r.jsx(d.Suspense,{fallback:r.jsx("div",{className:"grid min-h-dvh place-items-center text-sm text-neutral-600",children:"Loadingâ€¦"}),children:r.jsxs(vu,{children:[r.jsx(Le,{path:"/",element:r.jsx(Bx,{})}),r.jsx(Le,{path:"/onboarding",element:r.jsx(Ex,{})}),r.jsx(Le,{path:"/legal",element:r.jsx(Vx,{})}),r.jsx(Le,{path:"/invite/:code",element:r.jsx(Rx,{})}),r.jsx(Le,{path:"/auth/callback",element:r.jsx(Fx,{})}),r.jsx(Le,{path:"/profile-creation",element:r.jsx(il,{children:r.jsx(Jh,{})})}),r.jsxs(Le,{element:r.jsx(il,{children:r.jsx(gh,{})}),children:[r.jsx(Le,{path:"/browse",element:r.jsx(yh,{})}),r.jsx(Le,{path:"/groups",element:r.jsx(Gh,{})}),r.jsx(Le,{path:"/notifications",element:r.jsx(Dx,{})}),r.jsx(Le,{path:"/profile",element:r.jsx(Fa,{})}),r.jsx(Le,{path:"/profile/:userId",element:r.jsx(Fa,{})}),r.jsx(Le,{path:"/create",element:r.jsx(jh,{})}),r.jsx(Le,{path:"/group/:id",element:r.jsx(Ih,{})}),r.jsx(Le,{path:"/groups/game/:game",element:r.jsx(ef,{})}),r.jsx(Le,{path:"/groups/mine",element:r.jsx(sf,{})}),r.jsx(Le,{path:"/chats",element:r.jsx(Ox,{})})]}),r.jsx(Le,{path:"/groups/:id",element:r.jsx(qx,{})}),r.jsx(Le,{path:"*",element:r.jsx(Js,{to:"/onboarding",replace:!0})})]})})})]})})}typeof window<"u"&&"serviceWorker"in navigator&&(navigator.serviceWorker.getRegistrations().then(t=>{t.forEach(e=>e.unregister())}).catch(()=>{}),"caches"in window&&caches.keys().then(t=>{t.forEach(e=>caches.delete(e))}).catch(()=>{}));const Gx=new Xu;ku.createRoot(document.getElementById("root")).render(r.jsx(as.StrictMode,{children:r.jsx(Zu,{client:Gx,children:r.jsx(wu,{basename:"/circles",children:r.jsx(Ux,{})})})}));export{tn as M,Xd as S,Rl as W,Ln as X,Oh as a,he as c,r as j,v as s,Vs as u};
