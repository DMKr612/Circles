const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/web-DNI2eyrO.js","assets/react-BWleWAQa.js","assets/supabase-Cx6s5QAw.js","assets/ChatPanel-CXNAhs57.js"])))=>i.map(i=>d[i]);
var qi=t=>{throw TypeError(t)};var zn=(t,e,s)=>e.has(t)||qi("Cannot "+s);var p=(t,e,s)=>(zn(t,e,"read from private field"),s?s.call(t):e.get(t)),Z=(t,e,s)=>e.has(t)?qi("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),B=(t,e,s,n)=>(zn(t,e,"write to private field"),n?n.call(t,s):e.set(t,s),s),re=(t,e,s)=>(zn(t,e,"access private method"),s);var pn=(t,e,s,n)=>({set _(i){B(t,e,i,s)},get _(){return p(t,e,n)}});import{r as Hc,b as Kc,a as Wc,c as d,u as Et,O as Qc,L as me,d as Yc,e as pt,f as an,R as Jt,h as Xc,i as ke,N as zs,B as Jc}from"./react-BWleWAQa.js";import{c as Zc}from"./supabase-Cx6s5QAw.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function s(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=s(i);fetch(i.href,o)}})();var Hn={exports:{}},Ls={};var $i;function eu(){if($i)return Ls;$i=1;var t=Hc(),e=Symbol.for("react.element"),s=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function a(c,l,u){var h,f={},m=null,g=null;u!==void 0&&(m=""+u),l.key!==void 0&&(m=""+l.key),l.ref!==void 0&&(g=l.ref);for(h in l)n.call(l,h)&&!o.hasOwnProperty(h)&&(f[h]=l[h]);if(c&&c.defaultProps)for(h in l=c.defaultProps,l)f[h]===void 0&&(f[h]=l[h]);return{$$typeof:e,type:c,key:m,ref:g,props:f,_owner:i.current}}return Ls.Fragment=s,Ls.jsx=a,Ls.jsxs=a,Ls}var Bi;function tu(){return Bi||(Bi=1,Hn.exports=eu()),Hn.exports}var r=tu(),gn={},Ui;function su(){if(Ui)return gn;Ui=1;var t=Kc();return gn.createRoot=t.createRoot,gn.hydrateRoot=t.hydrateRoot,gn}var nu=su();const ru=Wc(nu);var on=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},iu={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},bt,$r,Do,au=(Do=class{constructor(){Z(this,bt,iu);Z(this,$r,!1)}setTimeoutProvider(t){B(this,bt,t)}setTimeout(t,e){return p(this,bt).setTimeout(t,e)}clearTimeout(t){p(this,bt).clearTimeout(t)}setInterval(t,e){return p(this,bt).setInterval(t,e)}clearInterval(t){p(this,bt).clearInterval(t)}},bt=new WeakMap,$r=new WeakMap,Do),qt=new au;function ou(t){setTimeout(t,0)}var Zt=typeof window>"u"||"Deno"in globalThis;function qe(){}function lu(t,e){return typeof t=="function"?t(e):t}function ur(t){return typeof t=="number"&&t>=0&&t!==1/0}function Go(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Pt(t,e){return typeof t=="function"?t(e):t}function Je(t,e){return typeof t=="function"?t(e):t}function Gi(t,e){const{type:s="all",exact:n,fetchStatus:i,predicate:o,queryKey:a,stale:c}=t;if(a){if(n){if(e.queryHash!==Br(a,e.options))return!1}else if(!Ks(e.queryKey,a))return!1}if(s!=="all"){const l=e.isActive();if(s==="active"&&!l||s==="inactive"&&l)return!1}return!(typeof c=="boolean"&&e.isStale()!==c||i&&i!==e.state.fetchStatus||o&&!o(e))}function zi(t,e){const{exact:s,status:n,predicate:i,mutationKey:o}=t;if(o){if(!e.options.mutationKey)return!1;if(s){if(Hs(e.options.mutationKey)!==Hs(o))return!1}else if(!Ks(e.options.mutationKey,o))return!1}return!(n&&e.state.status!==n||i&&!i(e))}function Br(t,e){return(e?.queryKeyHashFn||Hs)(t)}function Hs(t){return JSON.stringify(t,(e,s)=>hr(s)?Object.keys(s).sort().reduce((n,i)=>(n[i]=s[i],n),{}):s)}function Ks(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(s=>Ks(t[s],e[s])):!1}var cu=Object.prototype.hasOwnProperty;function zo(t,e){if(t===e)return t;const s=Hi(t)&&Hi(e);if(!s&&!(hr(t)&&hr(e)))return e;const i=(s?t:Object.keys(t)).length,o=s?e:Object.keys(e),a=o.length,c=s?new Array(a):{};let l=0;for(let u=0;u<a;u++){const h=s?u:o[u],f=t[h],m=e[h];if(f===m){c[h]=f,(s?u<i:cu.call(t,h))&&l++;continue}if(f===null||m===null||typeof f!="object"||typeof m!="object"){c[h]=m;continue}const g=zo(f,m);c[h]=g,g===f&&l++}return i===a&&l===i?t:c}function dr(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const s in t)if(t[s]!==e[s])return!1;return!0}function Hi(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function hr(t){if(!Ki(t))return!1;const e=t.constructor;if(e===void 0)return!0;const s=e.prototype;return!(!Ki(s)||!s.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function Ki(t){return Object.prototype.toString.call(t)==="[object Object]"}function uu(t){return new Promise(e=>{qt.setTimeout(e,t)})}function fr(t,e,s){return typeof s.structuralSharing=="function"?s.structuralSharing(t,e):s.structuralSharing!==!1?zo(t,e):e}function du(t,e,s=0){const n=[...t,e];return s&&n.length>s?n.slice(1):n}function hu(t,e,s=0){const n=[e,...t];return s&&n.length>s?n.slice(0,-1):n}var Ur=Symbol();function Ho(t,e){return!t.queryFn&&e?.initialPromise?()=>e.initialPromise:!t.queryFn||t.queryFn===Ur?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function fu(t,e){return typeof t=="function"?t(...e):!!t}var Bt,wt,ds,Lo,mu=(Lo=class extends on{constructor(){super();Z(this,Bt);Z(this,wt);Z(this,ds);B(this,ds,e=>{if(!Zt&&window.addEventListener){const s=()=>e();return window.addEventListener("visibilitychange",s,!1),()=>{window.removeEventListener("visibilitychange",s)}}})}onSubscribe(){p(this,wt)||this.setEventListener(p(this,ds))}onUnsubscribe(){var e;this.hasListeners()||((e=p(this,wt))==null||e.call(this),B(this,wt,void 0))}setEventListener(e){var s;B(this,ds,e),(s=p(this,wt))==null||s.call(this),B(this,wt,e(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(e){p(this,Bt)!==e&&(B(this,Bt,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(s=>{s(e)})}isFocused(){return typeof p(this,Bt)=="boolean"?p(this,Bt):globalThis.document?.visibilityState!=="hidden"}},Bt=new WeakMap,wt=new WeakMap,ds=new WeakMap,Lo),Gr=new mu;function mr(){let t,e;const s=new Promise((i,o)=>{t=i,e=o});s.status="pending",s.catch(()=>{});function n(i){Object.assign(s,i),delete s.resolve,delete s.reject}return s.resolve=i=>{n({status:"fulfilled",value:i}),t(i)},s.reject=i=>{n({status:"rejected",reason:i}),e(i)},s}var pu=ou;function gu(){let t=[],e=0,s=c=>{c()},n=c=>{c()},i=pu;const o=c=>{e?t.push(c):i(()=>{s(c)})},a=()=>{const c=t;t=[],c.length&&i(()=>{n(()=>{c.forEach(l=>{s(l)})})})};return{batch:c=>{let l;e++;try{l=c()}finally{e--,e||a()}return l},batchCalls:c=>(...l)=>{o(()=>{c(...l)})},schedule:o,setNotifyFunction:c=>{s=c},setBatchNotifyFunction:c=>{n=c},setScheduler:c=>{i=c}}}var Ae=gu(),hs,jt,fs,Oo,xu=(Oo=class extends on{constructor(){super();Z(this,hs,!0);Z(this,jt);Z(this,fs);B(this,fs,e=>{if(!Zt&&window.addEventListener){const s=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",s,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",n)}}})}onSubscribe(){p(this,jt)||this.setEventListener(p(this,fs))}onUnsubscribe(){var e;this.hasListeners()||((e=p(this,jt))==null||e.call(this),B(this,jt,void 0))}setEventListener(e){var s;B(this,fs,e),(s=p(this,jt))==null||s.call(this),B(this,jt,e(this.setOnline.bind(this)))}setOnline(e){p(this,hs)!==e&&(B(this,hs,e),this.listeners.forEach(n=>{n(e)}))}isOnline(){return p(this,hs)}},hs=new WeakMap,jt=new WeakMap,fs=new WeakMap,Oo),kn=new xu;function yu(t){return Math.min(1e3*2**t,3e4)}function Ko(t){return(t??"online")==="online"?kn.isOnline():!0}var pr=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function Wo(t){let e=!1,s=0,n;const i=mr(),o=()=>i.status!=="pending",a=v=>{if(!o()){const y=new pr(v);m(y),t.onCancel?.(y)}},c=()=>{e=!0},l=()=>{e=!1},u=()=>Gr.isFocused()&&(t.networkMode==="always"||kn.isOnline())&&t.canRun(),h=()=>Ko(t.networkMode)&&t.canRun(),f=v=>{o()||(n?.(),i.resolve(v))},m=v=>{o()||(n?.(),i.reject(v))},g=()=>new Promise(v=>{n=y=>{(o()||u())&&v(y)},t.onPause?.()}).then(()=>{n=void 0,o()||t.onContinue?.()}),x=()=>{if(o())return;let v;const y=s===0?t.initialPromise:void 0;try{v=y??t.fn()}catch(j){v=Promise.reject(j)}Promise.resolve(v).then(f).catch(j=>{if(o())return;const A=t.retry??(Zt?0:3),E=t.retryDelay??yu,M=typeof E=="function"?E(s,j):E,_=A===!0||typeof A=="number"&&s<A||typeof A=="function"&&A(s,j);if(e||!_){m(j);return}s++,t.onFail?.(s,j),uu(M).then(()=>u()?void 0:g()).then(()=>{e?m(j):x()})})};return{promise:i,status:()=>i.status,cancel:a,continue:()=>(n?.(),i),cancelRetry:c,continueRetry:l,canStart:h,start:()=>(h()?x():g().then(x),i)}}var Ut,Fo,Qo=(Fo=class{constructor(){Z(this,Ut)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),ur(this.gcTime)&&B(this,Ut,qt.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Zt?1/0:300*1e3))}clearGcTimeout(){p(this,Ut)&&(qt.clearTimeout(p(this,Ut)),B(this,Ut,void 0))}},Ut=new WeakMap,Fo),Gt,ms,Xe,zt,Pe,en,Ht,tt,ct,Vo,vu=(Vo=class extends Qo{constructor(e){super();Z(this,tt);Z(this,Gt);Z(this,ms);Z(this,Xe);Z(this,zt);Z(this,Pe);Z(this,en);Z(this,Ht);B(this,Ht,!1),B(this,en,e.defaultOptions),this.setOptions(e.options),this.observers=[],B(this,zt,e.client),B(this,Xe,p(this,zt).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,B(this,Gt,Qi(this.options)),this.state=e.state??p(this,Gt),this.scheduleGc()}get meta(){return this.options.meta}get promise(){return p(this,Pe)?.promise}setOptions(e){if(this.options={...p(this,en),...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const s=Qi(this.options);s.data!==void 0&&(this.setState(Wi(s.data,s.dataUpdatedAt)),B(this,Gt,s))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&p(this,Xe).remove(this)}setData(e,s){const n=fr(this.state.data,e,this.options);return re(this,tt,ct).call(this,{data:n,type:"success",dataUpdatedAt:s?.updatedAt,manual:s?.manual}),n}setState(e,s){re(this,tt,ct).call(this,{type:"setState",state:e,setStateOptions:s})}cancel(e){const s=p(this,Pe)?.promise;return p(this,Pe)?.cancel(e),s?s.then(qe).catch(qe):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(p(this,Gt))}isActive(){return this.observers.some(e=>Je(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Ur||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>Pt(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!Go(this.state.dataUpdatedAt,e)}onFocus(){this.observers.find(s=>s.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),p(this,Pe)?.continue()}onOnline(){this.observers.find(s=>s.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),p(this,Pe)?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),p(this,Xe).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(s=>s!==e),this.observers.length||(p(this,Pe)&&(p(this,Ht)?p(this,Pe).cancel({revert:!0}):p(this,Pe).cancelRetry()),this.scheduleGc()),p(this,Xe).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||re(this,tt,ct).call(this,{type:"invalidate"})}async fetch(e,s){if(this.state.fetchStatus!=="idle"&&p(this,Pe)?.status()!=="rejected"){if(this.state.data!==void 0&&s?.cancelRefetch)this.cancel({silent:!0});else if(p(this,Pe))return p(this,Pe).continueRetry(),p(this,Pe).promise}if(e&&this.setOptions(e),!this.options.queryFn){const l=this.observers.find(u=>u.options.queryFn);l&&this.setOptions(l.options)}const n=new AbortController,i=l=>{Object.defineProperty(l,"signal",{enumerable:!0,get:()=>(B(this,Ht,!0),n.signal)})},o=()=>{const l=Ho(this.options,s),h=(()=>{const f={client:p(this,zt),queryKey:this.queryKey,meta:this.meta};return i(f),f})();return B(this,Ht,!1),this.options.persister?this.options.persister(l,h,this):l(h)},c=(()=>{const l={fetchOptions:s,options:this.options,queryKey:this.queryKey,client:p(this,zt),state:this.state,fetchFn:o};return i(l),l})();this.options.behavior?.onFetch(c,this),B(this,ms,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==c.fetchOptions?.meta)&&re(this,tt,ct).call(this,{type:"fetch",meta:c.fetchOptions?.meta}),B(this,Pe,Wo({initialPromise:s?.initialPromise,fn:c.fetchFn,onCancel:l=>{l instanceof pr&&l.revert&&this.setState({...p(this,ms),fetchStatus:"idle"}),n.abort()},onFail:(l,u)=>{re(this,tt,ct).call(this,{type:"failed",failureCount:l,error:u})},onPause:()=>{re(this,tt,ct).call(this,{type:"pause"})},onContinue:()=>{re(this,tt,ct).call(this,{type:"continue"})},retry:c.options.retry,retryDelay:c.options.retryDelay,networkMode:c.options.networkMode,canRun:()=>!0}));try{const l=await p(this,Pe).start();if(l===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(l),p(this,Xe).config.onSuccess?.(l,this),p(this,Xe).config.onSettled?.(l,this.state.error,this),l}catch(l){if(l instanceof pr){if(l.silent)return p(this,Pe).promise;if(l.revert){if(this.state.data===void 0)throw l;return this.state.data}}throw re(this,tt,ct).call(this,{type:"error",error:l}),p(this,Xe).config.onError?.(l,this),p(this,Xe).config.onSettled?.(this.state.data,l,this),l}finally{this.scheduleGc()}}},Gt=new WeakMap,ms=new WeakMap,Xe=new WeakMap,zt=new WeakMap,Pe=new WeakMap,en=new WeakMap,Ht=new WeakMap,tt=new WeakSet,ct=function(e){const s=n=>{switch(e.type){case"failed":return{...n,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...Yo(n.data,this.options),fetchMeta:e.meta??null};case"success":const i={...n,...Wi(e.data,e.dataUpdatedAt),dataUpdateCount:n.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return B(this,ms,e.manual?i:void 0),i;case"error":const o=e.error;return{...n,error:o,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...e.state}}};this.state=s(this.state),Ae.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),p(this,Xe).notify({query:this,type:"updated",action:e})})},Vo);function Yo(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Ko(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function Wi(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Qi(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,s=e!==void 0,n=s?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:s?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}var Ie,ie,tn,Le,Kt,ps,ut,Nt,sn,gs,xs,Wt,Qt,St,ys,de,Fs,gr,xr,yr,vr,br,wr,jr,Xo,Io,bu=(Io=class extends on{constructor(e,s){super();Z(this,de);Z(this,Ie);Z(this,ie);Z(this,tn);Z(this,Le);Z(this,Kt);Z(this,ps);Z(this,ut);Z(this,Nt);Z(this,sn);Z(this,gs);Z(this,xs);Z(this,Wt);Z(this,Qt);Z(this,St);Z(this,ys,new Set);this.options=s,B(this,Ie,e),B(this,Nt,null),B(this,ut,mr()),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(p(this,ie).addObserver(this),Yi(p(this,ie),this.options)?re(this,de,Fs).call(this):this.updateResult(),re(this,de,vr).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Nr(p(this,ie),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Nr(p(this,ie),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,re(this,de,br).call(this),re(this,de,wr).call(this),p(this,ie).removeObserver(this)}setOptions(e){const s=this.options,n=p(this,ie);if(this.options=p(this,Ie).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Je(this.options.enabled,p(this,ie))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");re(this,de,jr).call(this),p(this,ie).setOptions(this.options),s._defaulted&&!dr(this.options,s)&&p(this,Ie).getQueryCache().notify({type:"observerOptionsUpdated",query:p(this,ie),observer:this});const i=this.hasListeners();i&&Xi(p(this,ie),n,this.options,s)&&re(this,de,Fs).call(this),this.updateResult(),i&&(p(this,ie)!==n||Je(this.options.enabled,p(this,ie))!==Je(s.enabled,p(this,ie))||Pt(this.options.staleTime,p(this,ie))!==Pt(s.staleTime,p(this,ie)))&&re(this,de,gr).call(this);const o=re(this,de,xr).call(this);i&&(p(this,ie)!==n||Je(this.options.enabled,p(this,ie))!==Je(s.enabled,p(this,ie))||o!==p(this,St))&&re(this,de,yr).call(this,o)}getOptimisticResult(e){const s=p(this,Ie).getQueryCache().build(p(this,Ie),e),n=this.createResult(s,e);return ju(this,n)&&(B(this,Le,n),B(this,ps,this.options),B(this,Kt,p(this,ie).state)),n}getCurrentResult(){return p(this,Le)}trackResult(e,s){return new Proxy(e,{get:(n,i)=>(this.trackProp(i),s?.(i),i==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&p(this,ut).status==="pending"&&p(this,ut).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,i))})}trackProp(e){p(this,ys).add(e)}getCurrentQuery(){return p(this,ie)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const s=p(this,Ie).defaultQueryOptions(e),n=p(this,Ie).getQueryCache().build(p(this,Ie),s);return n.fetch().then(()=>this.createResult(n,s))}fetch(e){return re(this,de,Fs).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),p(this,Le)))}createResult(e,s){const n=p(this,ie),i=this.options,o=p(this,Le),a=p(this,Kt),c=p(this,ps),u=e!==n?e.state:p(this,tn),{state:h}=e;let f={...h},m=!1,g;if(s._optimisticResults){const R=this.hasListeners(),q=!R&&Yi(e,s),Q=R&&Xi(e,n,s,i);(q||Q)&&(f={...f,...Yo(h.data,e.options)}),s._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:x,errorUpdatedAt:v,status:y}=f;g=f.data;let j=!1;if(s.placeholderData!==void 0&&g===void 0&&y==="pending"){let R;o?.isPlaceholderData&&s.placeholderData===c?.placeholderData?(R=o.data,j=!0):R=typeof s.placeholderData=="function"?s.placeholderData(p(this,xs)?.state.data,p(this,xs)):s.placeholderData,R!==void 0&&(y="success",g=fr(o?.data,R,s),m=!0)}if(s.select&&g!==void 0&&!j)if(o&&g===a?.data&&s.select===p(this,sn))g=p(this,gs);else try{B(this,sn,s.select),g=s.select(g),g=fr(o?.data,g,s),B(this,gs,g),B(this,Nt,null)}catch(R){B(this,Nt,R)}p(this,Nt)&&(x=p(this,Nt),g=p(this,gs),v=Date.now(),y="error");const A=f.fetchStatus==="fetching",E=y==="pending",M=y==="error",_=E&&A,$=g!==void 0,C={status:y,fetchStatus:f.fetchStatus,isPending:E,isSuccess:y==="success",isError:M,isInitialLoading:_,isLoading:_,data:g,dataUpdatedAt:f.dataUpdatedAt,error:x,errorUpdatedAt:v,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>u.dataUpdateCount||f.errorUpdateCount>u.errorUpdateCount,isFetching:A,isRefetching:A&&!E,isLoadingError:M&&!$,isPaused:f.fetchStatus==="paused",isPlaceholderData:m,isRefetchError:M&&$,isStale:zr(e,s),refetch:this.refetch,promise:p(this,ut),isEnabled:Je(s.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const R=U=>{C.status==="error"?U.reject(C.error):C.data!==void 0&&U.resolve(C.data)},q=()=>{const U=B(this,ut,C.promise=mr());R(U)},Q=p(this,ut);switch(Q.status){case"pending":e.queryHash===n.queryHash&&R(Q);break;case"fulfilled":(C.status==="error"||C.data!==Q.value)&&q();break;case"rejected":(C.status!=="error"||C.error!==Q.reason)&&q();break}}return C}updateResult(){const e=p(this,Le),s=this.createResult(p(this,ie),this.options);if(B(this,Kt,p(this,ie).state),B(this,ps,this.options),p(this,Kt).data!==void 0&&B(this,xs,p(this,ie)),dr(s,e))return;B(this,Le,s);const n=()=>{if(!e)return!0;const{notifyOnChangeProps:i}=this.options,o=typeof i=="function"?i():i;if(o==="all"||!o&&!p(this,ys).size)return!0;const a=new Set(o??p(this,ys));return this.options.throwOnError&&a.add("error"),Object.keys(p(this,Le)).some(c=>{const l=c;return p(this,Le)[l]!==e[l]&&a.has(l)})};re(this,de,Xo).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&re(this,de,vr).call(this)}},Ie=new WeakMap,ie=new WeakMap,tn=new WeakMap,Le=new WeakMap,Kt=new WeakMap,ps=new WeakMap,ut=new WeakMap,Nt=new WeakMap,sn=new WeakMap,gs=new WeakMap,xs=new WeakMap,Wt=new WeakMap,Qt=new WeakMap,St=new WeakMap,ys=new WeakMap,de=new WeakSet,Fs=function(e){re(this,de,jr).call(this);let s=p(this,ie).fetch(this.options,e);return e?.throwOnError||(s=s.catch(qe)),s},gr=function(){re(this,de,br).call(this);const e=Pt(this.options.staleTime,p(this,ie));if(Zt||p(this,Le).isStale||!ur(e))return;const n=Go(p(this,Le).dataUpdatedAt,e)+1;B(this,Wt,qt.setTimeout(()=>{p(this,Le).isStale||this.updateResult()},n))},xr=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(p(this,ie)):this.options.refetchInterval)??!1},yr=function(e){re(this,de,wr).call(this),B(this,St,e),!(Zt||Je(this.options.enabled,p(this,ie))===!1||!ur(p(this,St))||p(this,St)===0)&&B(this,Qt,qt.setInterval(()=>{(this.options.refetchIntervalInBackground||Gr.isFocused())&&re(this,de,Fs).call(this)},p(this,St)))},vr=function(){re(this,de,gr).call(this),re(this,de,yr).call(this,re(this,de,xr).call(this))},br=function(){p(this,Wt)&&(qt.clearTimeout(p(this,Wt)),B(this,Wt,void 0))},wr=function(){p(this,Qt)&&(qt.clearInterval(p(this,Qt)),B(this,Qt,void 0))},jr=function(){const e=p(this,Ie).getQueryCache().build(p(this,Ie),this.options);if(e===p(this,ie))return;const s=p(this,ie);B(this,ie,e),B(this,tn,e.state),this.hasListeners()&&(s?.removeObserver(this),e.addObserver(this))},Xo=function(e){Ae.batch(()=>{e.listeners&&this.listeners.forEach(s=>{s(p(this,Le))}),p(this,Ie).getQueryCache().notify({query:p(this,ie),type:"observerResultsUpdated"})})},Io);function wu(t,e){return Je(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function Yi(t,e){return wu(t,e)||t.state.data!==void 0&&Nr(t,e,e.refetchOnMount)}function Nr(t,e,s){if(Je(e.enabled,t)!==!1&&Pt(e.staleTime,t)!=="static"){const n=typeof s=="function"?s(t):s;return n==="always"||n!==!1&&zr(t,e)}return!1}function Xi(t,e,s,n){return(t!==e||Je(n.enabled,t)===!1)&&(!s.suspense||t.state.status!=="error")&&zr(t,s)}function zr(t,e){return Je(e.enabled,t)!==!1&&t.isStaleByTime(Pt(e.staleTime,t))}function ju(t,e){return!dr(t.getCurrentResult(),e)}function Ji(t){return{onFetch:(e,s)=>{const n=e.options,i=e.fetchOptions?.meta?.fetchMore?.direction,o=e.state.data?.pages||[],a=e.state.data?.pageParams||[];let c={pages:[],pageParams:[]},l=0;const u=async()=>{let h=!1;const f=x=>{Object.defineProperty(x,"signal",{enumerable:!0,get:()=>(e.signal.aborted?h=!0:e.signal.addEventListener("abort",()=>{h=!0}),e.signal)})},m=Ho(e.options,e.fetchOptions),g=async(x,v,y)=>{if(h)return Promise.reject();if(v==null&&x.pages.length)return Promise.resolve(x);const A=(()=>{const $={client:e.client,queryKey:e.queryKey,pageParam:v,direction:y?"backward":"forward",meta:e.options.meta};return f($),$})(),E=await m(A),{maxPages:M}=e.options,_=y?hu:du;return{pages:_(x.pages,E,M),pageParams:_(x.pageParams,v,M)}};if(i&&o.length){const x=i==="backward",v=x?Nu:Zi,y={pages:o,pageParams:a},j=v(n,y);c=await g(y,j,x)}else{const x=t??o.length;do{const v=l===0?a[0]??n.initialPageParam:Zi(n,c);if(l>0&&v==null)break;c=await g(c,v),l++}while(l<x)}return c};e.options.persister?e.fetchFn=()=>e.options.persister?.(u,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},s):e.fetchFn=u}}}function Zi(t,{pages:e,pageParams:s}){const n=e.length-1;return e.length>0?t.getNextPageParam(e[n],e,s[n],s):void 0}function Nu(t,{pages:e,pageParams:s}){return e.length>0?t.getPreviousPageParam?.(e[0],e,s[0],s):void 0}var nn,rt,Oe,Yt,it,yt,qo,Su=(qo=class extends Qo{constructor(e){super();Z(this,it);Z(this,nn);Z(this,rt);Z(this,Oe);Z(this,Yt);B(this,nn,e.client),this.mutationId=e.mutationId,B(this,Oe,e.mutationCache),B(this,rt,[]),this.state=e.state||Cu(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){p(this,rt).includes(e)||(p(this,rt).push(e),this.clearGcTimeout(),p(this,Oe).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){B(this,rt,p(this,rt).filter(s=>s!==e)),this.scheduleGc(),p(this,Oe).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){p(this,rt).length||(this.state.status==="pending"?this.scheduleGc():p(this,Oe).remove(this))}continue(){return p(this,Yt)?.continue()??this.execute(this.state.variables)}async execute(e){const s=()=>{re(this,it,yt).call(this,{type:"continue"})},n={client:p(this,nn),meta:this.options.meta,mutationKey:this.options.mutationKey};B(this,Yt,Wo({fn:()=>this.options.mutationFn?this.options.mutationFn(e,n):Promise.reject(new Error("No mutationFn found")),onFail:(a,c)=>{re(this,it,yt).call(this,{type:"failed",failureCount:a,error:c})},onPause:()=>{re(this,it,yt).call(this,{type:"pause"})},onContinue:s,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>p(this,Oe).canRun(this)}));const i=this.state.status==="pending",o=!p(this,Yt).canStart();try{if(i)s();else{re(this,it,yt).call(this,{type:"pending",variables:e,isPaused:o}),await p(this,Oe).config.onMutate?.(e,this,n);const c=await this.options.onMutate?.(e,n);c!==this.state.context&&re(this,it,yt).call(this,{type:"pending",context:c,variables:e,isPaused:o})}const a=await p(this,Yt).start();return await p(this,Oe).config.onSuccess?.(a,e,this.state.context,this,n),await this.options.onSuccess?.(a,e,this.state.context,n),await p(this,Oe).config.onSettled?.(a,null,this.state.variables,this.state.context,this,n),await this.options.onSettled?.(a,null,e,this.state.context,n),re(this,it,yt).call(this,{type:"success",data:a}),a}catch(a){try{throw await p(this,Oe).config.onError?.(a,e,this.state.context,this,n),await this.options.onError?.(a,e,this.state.context,n),await p(this,Oe).config.onSettled?.(void 0,a,this.state.variables,this.state.context,this,n),await this.options.onSettled?.(void 0,a,e,this.state.context,n),a}finally{re(this,it,yt).call(this,{type:"error",error:a})}}finally{p(this,Oe).runNext(this)}}},nn=new WeakMap,rt=new WeakMap,Oe=new WeakMap,Yt=new WeakMap,it=new WeakSet,yt=function(e){const s=n=>{switch(e.type){case"failed":return{...n,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...n,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:e.error,failureCount:n.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=s(this.state),Ae.batch(()=>{p(this,rt).forEach(n=>{n.onMutationUpdate(e)}),p(this,Oe).notify({mutation:this,type:"updated",action:e})})},qo);function Cu(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var dt,st,rn,$o,_u=($o=class extends on{constructor(e={}){super();Z(this,dt);Z(this,st);Z(this,rn);this.config=e,B(this,dt,new Set),B(this,st,new Map),B(this,rn,0)}build(e,s,n){const i=new Su({client:e,mutationCache:this,mutationId:++pn(this,rn)._,options:e.defaultMutationOptions(s),state:n});return this.add(i),i}add(e){p(this,dt).add(e);const s=xn(e);if(typeof s=="string"){const n=p(this,st).get(s);n?n.push(e):p(this,st).set(s,[e])}this.notify({type:"added",mutation:e})}remove(e){if(p(this,dt).delete(e)){const s=xn(e);if(typeof s=="string"){const n=p(this,st).get(s);if(n)if(n.length>1){const i=n.indexOf(e);i!==-1&&n.splice(i,1)}else n[0]===e&&p(this,st).delete(s)}}this.notify({type:"removed",mutation:e})}canRun(e){const s=xn(e);if(typeof s=="string"){const i=p(this,st).get(s)?.find(o=>o.state.status==="pending");return!i||i===e}else return!0}runNext(e){const s=xn(e);return typeof s=="string"?p(this,st).get(s)?.find(i=>i!==e&&i.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){Ae.batch(()=>{p(this,dt).forEach(e=>{this.notify({type:"removed",mutation:e})}),p(this,dt).clear(),p(this,st).clear()})}getAll(){return Array.from(p(this,dt))}find(e){const s={exact:!0,...e};return this.getAll().find(n=>zi(s,n))}findAll(e={}){return this.getAll().filter(s=>zi(e,s))}notify(e){Ae.batch(()=>{this.listeners.forEach(s=>{s(e)})})}resumePausedMutations(){const e=this.getAll().filter(s=>s.state.isPaused);return Ae.batch(()=>Promise.all(e.map(s=>s.continue().catch(qe))))}},dt=new WeakMap,st=new WeakMap,rn=new WeakMap,$o);function xn(t){return t.options.scope?.id}var at,Bo,ku=(Bo=class extends on{constructor(e={}){super();Z(this,at);this.config=e,B(this,at,new Map)}build(e,s,n){const i=s.queryKey,o=s.queryHash??Br(i,s);let a=this.get(o);return a||(a=new vu({client:e,queryKey:i,queryHash:o,options:e.defaultQueryOptions(s),state:n,defaultOptions:e.getQueryDefaults(i)}),this.add(a)),a}add(e){p(this,at).has(e.queryHash)||(p(this,at).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const s=p(this,at).get(e.queryHash);s&&(e.destroy(),s===e&&p(this,at).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Ae.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return p(this,at).get(e)}getAll(){return[...p(this,at).values()]}find(e){const s={exact:!0,...e};return this.getAll().find(n=>Gi(s,n))}findAll(e={}){const s=this.getAll();return Object.keys(e).length>0?s.filter(n=>Gi(e,n)):s}notify(e){Ae.batch(()=>{this.listeners.forEach(s=>{s(e)})})}onFocus(){Ae.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Ae.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},at=new WeakMap,Bo),ve,Ct,_t,vs,bs,kt,ws,js,Uo,Pu=(Uo=class{constructor(t={}){Z(this,ve);Z(this,Ct);Z(this,_t);Z(this,vs);Z(this,bs);Z(this,kt);Z(this,ws);Z(this,js);B(this,ve,t.queryCache||new ku),B(this,Ct,t.mutationCache||new _u),B(this,_t,t.defaultOptions||{}),B(this,vs,new Map),B(this,bs,new Map),B(this,kt,0)}mount(){pn(this,kt)._++,p(this,kt)===1&&(B(this,ws,Gr.subscribe(async t=>{t&&(await this.resumePausedMutations(),p(this,ve).onFocus())})),B(this,js,kn.subscribe(async t=>{t&&(await this.resumePausedMutations(),p(this,ve).onOnline())})))}unmount(){var t,e;pn(this,kt)._--,p(this,kt)===0&&((t=p(this,ws))==null||t.call(this),B(this,ws,void 0),(e=p(this,js))==null||e.call(this),B(this,js,void 0))}isFetching(t){return p(this,ve).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return p(this,Ct).findAll({...t,status:"pending"}).length}getQueryData(t){const e=this.defaultQueryOptions({queryKey:t});return p(this,ve).get(e.queryHash)?.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),s=p(this,ve).build(this,e),n=s.state.data;return n===void 0?this.fetchQuery(t):(t.revalidateIfStale&&s.isStaleByTime(Pt(e.staleTime,s))&&this.prefetchQuery(e),Promise.resolve(n))}getQueriesData(t){return p(this,ve).findAll(t).map(({queryKey:e,state:s})=>{const n=s.data;return[e,n]})}setQueryData(t,e,s){const n=this.defaultQueryOptions({queryKey:t}),o=p(this,ve).get(n.queryHash)?.state.data,a=lu(e,o);if(a!==void 0)return p(this,ve).build(this,n).setData(a,{...s,manual:!0})}setQueriesData(t,e,s){return Ae.batch(()=>p(this,ve).findAll(t).map(({queryKey:n})=>[n,this.setQueryData(n,e,s)]))}getQueryState(t){const e=this.defaultQueryOptions({queryKey:t});return p(this,ve).get(e.queryHash)?.state}removeQueries(t){const e=p(this,ve);Ae.batch(()=>{e.findAll(t).forEach(s=>{e.remove(s)})})}resetQueries(t,e){const s=p(this,ve);return Ae.batch(()=>(s.findAll(t).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const s={revert:!0,...e},n=Ae.batch(()=>p(this,ve).findAll(t).map(i=>i.cancel(s)));return Promise.all(n).then(qe).catch(qe)}invalidateQueries(t,e={}){return Ae.batch(()=>(p(this,ve).findAll(t).forEach(s=>{s.invalidate()}),t?.refetchType==="none"?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},e)))}refetchQueries(t,e={}){const s={...e,cancelRefetch:e.cancelRefetch??!0},n=Ae.batch(()=>p(this,ve).findAll(t).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let o=i.fetch(void 0,s);return s.throwOnError||(o=o.catch(qe)),i.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(n).then(qe)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const s=p(this,ve).build(this,e);return s.isStaleByTime(Pt(e.staleTime,s))?s.fetch(e):Promise.resolve(s.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(qe).catch(qe)}fetchInfiniteQuery(t){return t.behavior=Ji(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(qe).catch(qe)}ensureInfiniteQueryData(t){return t.behavior=Ji(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return kn.isOnline()?p(this,Ct).resumePausedMutations():Promise.resolve()}getQueryCache(){return p(this,ve)}getMutationCache(){return p(this,Ct)}getDefaultOptions(){return p(this,_t)}setDefaultOptions(t){B(this,_t,t)}setQueryDefaults(t,e){p(this,vs).set(Hs(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...p(this,vs).values()],s={};return e.forEach(n=>{Ks(t,n.queryKey)&&Object.assign(s,n.defaultOptions)}),s}setMutationDefaults(t,e){p(this,bs).set(Hs(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...p(this,bs).values()],s={};return e.forEach(n=>{Ks(t,n.mutationKey)&&Object.assign(s,n.defaultOptions)}),s}defaultQueryOptions(t){if(t._defaulted)return t;const e={...p(this,_t).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Br(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Ur&&(e.enabled=!1),e}defaultMutationOptions(t){return t?._defaulted?t:{...p(this,_t).mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){p(this,ve).clear(),p(this,Ct).clear()}},ve=new WeakMap,Ct=new WeakMap,_t=new WeakMap,vs=new WeakMap,bs=new WeakMap,kt=new WeakMap,ws=new WeakMap,js=new WeakMap,Uo),Jo=d.createContext(void 0),Tu=t=>{const e=d.useContext(Jo);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},Au=({client:t,children:e})=>(d.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),r.jsx(Jo.Provider,{value:t,children:e})),Zo=d.createContext(!1),Eu=()=>d.useContext(Zo);Zo.Provider;function Mu(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var Ru=d.createContext(Mu()),Du=()=>d.useContext(Ru),Lu=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},Ou=t=>{d.useEffect(()=>{t.clearReset()},[t])},Fu=({result:t,errorResetBoundary:e,throwOnError:s,query:n,suspense:i})=>t.isError&&!e.isReset()&&!t.isFetching&&n&&(i&&t.data===void 0||fu(s,[t.error,n])),Vu=t=>{if(t.suspense){const s=i=>i==="static"?i:Math.max(i??1e3,1e3),n=t.staleTime;t.staleTime=typeof n=="function"?(...i)=>s(n(...i)):s(n),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},Iu=(t,e)=>t.isLoading&&t.isFetching&&!e,qu=(t,e)=>t?.suspense&&e.isPending,ea=(t,e,s)=>e.fetchOptimistic(t).catch(()=>{s.clearReset()});function $u(t,e,s){const n=Eu(),i=Du(),o=Tu(),a=o.defaultQueryOptions(t);o.getDefaultOptions().queries?._experimental_beforeQuery?.(a),a._optimisticResults=n?"isRestoring":"optimistic",Vu(a),Lu(a,i),Ou(i);const c=!o.getQueryCache().get(a.queryHash),[l]=d.useState(()=>new e(o,a)),u=l.getOptimisticResult(a),h=!n&&t.subscribed!==!1;if(d.useSyncExternalStore(d.useCallback(f=>{const m=h?l.subscribe(Ae.batchCalls(f)):qe;return l.updateResult(),m},[l,h]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),d.useEffect(()=>{l.setOptions(a)},[a,l]),qu(a,u))throw ea(a,l,i);if(Fu({result:u,errorResetBoundary:i,throwOnError:a.throwOnError,query:o.getQueryCache().get(a.queryHash),suspense:a.suspense}))throw u.error;return o.getDefaultOptions().queries?._experimental_afterQuery?.(a,u),a.experimental_prefetchInRender&&!Zt&&Iu(u,n)&&(c?ea(a,l,i):o.getQueryCache().get(a.queryHash)?.promise)?.catch(qe).finally(()=>{l.updateResult()}),a.notifyOnChangeProps?u:l.trackResult(u)}function Bu(t,e){return $u(t,bu)}const w=Zc("https://jjotzbghqifpnaldiyfp.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impqb3R6YmdocWlmcG5hbGRpeWZwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ3NzM4NTcsImV4cCI6MjA4MDM0OTg1N30.eaivVRDPFmXzw_9DLaymXj_MJS_Jewj1DAZ-9NAonHs",{auth:{persistSession:!0,autoRefreshToken:!0}});const Uu=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Gu=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,s,n)=>n?n.toUpperCase():s.toLowerCase()),ta=t=>{const e=Gu(t);return e.charAt(0).toUpperCase()+e.slice(1)},el=(...t)=>t.filter((e,s,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===s).join(" ").trim(),zu=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var Hu={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Ku=d.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:s=2,absoluteStrokeWidth:n,className:i="",children:o,iconNode:a,...c},l)=>d.createElement("svg",{ref:l,...Hu,width:e,height:e,stroke:t,strokeWidth:n?Number(s)*24/Number(e):s,className:el("lucide",i),...!o&&!zu(c)&&{"aria-hidden":"true"},...c},[...a.map(([u,h])=>d.createElement(u,h)),...Array.isArray(o)?o:[o]]));const ae=(t,e)=>{const s=d.forwardRef(({className:n,...i},o)=>d.createElement(Ku,{ref:o,iconNode:e,className:el(`lucide-${Uu(ta(t))}`,`lucide-${t}`,n),...i}));return s.displayName=ta(t),s};const Wu=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Ns=ae("arrow-left",Wu);const Qu=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Yu=ae("bell",Qu);const Xu=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],tl=ae("calendar",Xu);const Ju=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],sa=ae("check",Ju);const Zu=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],sl=ae("chevron-down",Zu);const ed=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],td=ae("chevron-left",ed);const sd=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],nl=ae("chevron-up",sd);const nd=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],na=ae("circle-alert",nd);const rd=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],id=ae("circle-question-mark",rd);const ad=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Hr=ae("clock",ad);const od=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ld=ae("compass",od);const cd=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],ud=ae("funnel",cd);const dd=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],hd=ae("globe",dd);const fd=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],ra=ae("heart",fd);const md=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],pd=ae("lock-open",md);const gd=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],xd=ae("log-out",gd);const yd=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],vd=ae("mail",yd);const bd=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Ws=ae("map-pin",bd);const wd=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],rl=ae("message-circle",wd);const jd=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],Pn=ae("message-square",jd);const Nd=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Sd=ae("pen",Nd);const Cd=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Sr=ae("plus",Cd);const _d=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Kr=ae("search",_d);const kd=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Pd=ae("send",kd);const Td=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Ad=ae("share-2",Td);const Ed=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ia=ae("square-check-big",Ed);const Md=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Rd=ae("tag",Md);const Dd=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Ld=ae("trash-2",Dd);const Od=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Fd=ae("triangle-alert",Od);const Vd=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Id=ae("user-check",Vd);const qd=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],$d=ae("user-minus",qd);const Bd=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],il=ae("user-plus",Bd);const Ud=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Gd=ae("user",Ud);const zd=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Ps=ae("users",zd);const Hd=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Nn=ae("x",Hd);function Kd(){const e=Et().pathname,s=i=>e===i||e.startsWith(`${i}/`),n=i=>`flex flex-col items-center p-2 transition-transform duration-150 ease-in-out active:scale-90 ${s(i)?"text-black scale-105 font-semibold":"text-gray-400 hover:text-gray-600"}`;return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"pb-[calc(64px+env(safe-area-inset-bottom))]",children:r.jsx(Qc,{})}),r.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-[100] border-t border-gray-200 bg-white/95 backdrop-blur-lg pb-[env(safe-area-inset-bottom)]",children:r.jsxs("div",{className:"mx-auto flex h-16 max-w-md items-center justify-around px-2",children:[r.jsxs(me,{to:"/chats",className:n("/chats"),children:[r.jsx(Pn,{className:"h-6 w-6"}),r.jsx("span",{className:"text-[10px] font-medium",children:"Chats"})]}),r.jsxs(me,{to:"/groups",className:n("/groups"),children:[r.jsx(Ps,{className:"h-6 w-6"}),r.jsx("span",{className:"text-[10px] font-medium",children:"Groups"})]}),r.jsxs(me,{to:"/browse",className:n("/browse"),children:[r.jsx("div",{className:`rounded-full p-1 -mt-1 transition-colors ${s("/browse")?"bg-gray-100":""}`,children:r.jsx(ld,{className:"h-7 w-7"})}),r.jsx("span",{className:"text-[10px] font-medium",children:"Browse"})]}),r.jsxs(me,{to:"/notifications",className:n("/notifications"),children:[r.jsx(Yu,{className:"h-6 w-6"}),r.jsx("span",{className:"text-[10px] font-medium",children:"Activity"})]}),r.jsxs(me,{to:"/profile",className:n("/profile"),children:[r.jsx(Gd,{className:"h-6 w-6"}),r.jsx("span",{className:"text-[10px] font-medium",children:"Profile"})]})]})})]})}function al(t){return Bu({queryKey:["profile",t],enabled:!!t,queryFn:async()=>{if(!t)throw new Error("No user ID");const e=await w.from("profiles").select("*").eq("user_id",t).maybeSingle();if(e.error&&e.error.code!=="PGRST116")throw e.error;let s=e.data;if(!s){const o=await w.from("profiles").insert({user_id:t,name:"",onboarded:!1}).select("*").single();if(o.error)throw o.error;s=o.data}const[n,i]=await Promise.all([w.from("group_members").select("group_id",{count:"exact",head:!0}).eq("user_id",t).in("role",["owner","host"]).in("status",["active","accepted"]),w.from("group_members").select("group_id",{count:"exact",head:!0}).eq("user_id",t).in("status",["active","accepted"])]);return{id:t,name:s.name||"",avatar_url:s.avatar_url,city:s.city,rating_avg:s.rating_avg||0,rating_count:s.rating_count||0,groups_created:n.count||0,groups_joined:i.count||0,onboarded:!!s.onboarded}}})}const Wd=["All","Games","Study","Outdoors"],aa=[{id:"hokm",name:"Hokm",blurb:"Classic Persian card game",tag:"Games",online:120,groups:8,image:"ğŸ´"},{id:"takhtenard",name:"Takhte Nard",blurb:"Traditional backgammon",tag:"Games",online:95,groups:6,image:"ğŸ²"},{id:"mafia",name:"Mafia",blurb:"Social deduction party game",tag:"Games",online:210,groups:12,image:"ğŸ•µï¸"},{id:"mono",name:"Monopoly",blurb:"Buy, sell, and trade properties",tag:"Games",online:180,groups:10,image:"ğŸ’°"},{id:"uno",name:"Uno",blurb:"Colorful card matching fun",tag:"Games",online:250,groups:15,image:"ğŸƒ"},{id:"chess",name:"Chess",blurb:"Classic strategy board game",tag:"Games",online:130,groups:9,image:"â™Ÿï¸"},{id:"mathematics",name:"Mathematics",blurb:"Study numbers",tag:"Study",online:75,groups:5,image:"ğŸ“"},{id:"biology",name:"Biology",blurb:"Explore life sciences",tag:"Study",online:60,groups:4,image:"ğŸ§¬"},{id:"chemistry",name:"Chemistry",blurb:"Chemicals and reactions",tag:"Study",online:50,groups:3,image:"âš—ï¸"},{id:"history",name:"History",blurb:"Past events and cultures",tag:"Study",online:45,groups:3,image:"ğŸ“œ"},{id:"hiking",name:"Hiking",blurb:"Join a hike up the mountain",tag:"Outdoors",online:40,groups:3,image:"â›°ï¸"},{id:"visit",name:"Visiting",blurb:"Cultural and city visits",tag:"Outdoors",online:55,groups:4,image:"ğŸ›ï¸"},{id:"camp",name:"Camping",blurb:"Overnight outdoor trips",tag:"Outdoors",online:35,groups:2,image:"ğŸ•ï¸"},{id:"kayak",name:"Kayaking",blurb:"Water adventures",tag:"Outdoors",online:30,groups:2,image:"ğŸ›¶"}];function Qd(){const[t,e]=Yc(),s=t.get("id"),n=t.get("code"),[i,o]=d.useState(t.get("q")??""),[a,c]=d.useState(t.get("category")??"All"),[l,u]=d.useState(!0),[h,f]=d.useState([]),[m,g]=d.useState(!1),[x,v]=d.useState(0),[y,j]=d.useState({}),[A,E]=d.useState({}),[M,_]=d.useState(0),[$,S]=d.useState(null),[C,R]=d.useState(!1),[q,Q]=d.useState(""),[U,P]=d.useState(""),[T,N]=d.useState(!1),[F,D]=d.useState(null);d.useEffect(()=>{const b=new URLSearchParams(t);a&&a!=="All"?b.set("category",a):b.delete("category"),i?b.set("q",i):b.delete("q"),b.toString()!==t.toString()&&e(b,{replace:!0})},[i,a,s,n]);const I=d.useMemo(()=>{const b=(i||"").trim().replace(/[^A-Za-z0-9]/g,"");return/^[A-Za-z0-9]{6,16}$/.test(b)?b.toUpperCase():null},[i]);d.useEffect(()=>{(async()=>{const{data:b}=await w.auth.getUser();if(!b.user)return;const{data:L}=await w.from("profiles").select("city").eq("user_id",b.user.id).maybeSingle();L?.city&&S(L.city)})()},[]),d.useEffect(()=>{let b=!0;async function L(){try{if(g(!0),f([]),n||I){const G=n||I,se=G.replace(/[^A-Za-z0-9]/g,"").toUpperCase(),{data:X,error:J}=await w.from("groups").select("id, title, description, city, category, game, capacity, created_at, code").or(`code.eq.${se},id.eq.${G}`).maybeSingle();if(!J&&X){b&&f([X]),g(!1),u(!0);return}}let H=w.from("groups").select("id, title, description, city, category, game, capacity, created_at, code").order("created_at",{ascending:!1}).limit(50);a&&a!=="All"&&(H=H.eq("category",a.toLowerCase())),i&&!I&&(H=H.ilike("title",`%${i}%`));const{data:ce}=await H;b&&f(ce||[])}catch(H){console.warn(H)}finally{b&&g(!1)}}return L(),()=>{b=!1}},[a,i,n,I,x]),d.useEffect(()=>{let b=!0;return(async()=>{const{data:L}=await w.from("group_members").select("user_id, group_id, groups(game)");if(!b||!L)return;const H={},ce={},G=new Set;L.forEach(X=>{const J=(X.groups?.game||"").toLowerCase(),Se=X.group_id;J&&Se&&(ce[J]=(ce[J]||0)+1,H[J]||(H[J]=new Set),H[J].add(Se)),X.user_id&&G.add(X.user_id)});const se={};Object.keys(H).forEach(X=>{se[X]=H[X].size}),j(se),E(ce),_(G.size)})(),()=>{b=!1}},[]);const z=d.useMemo(()=>{const b=a==="All"?aa:aa.filter(L=>L.tag===a);return i?b.filter(L=>L.name.toLowerCase().includes(i.toLowerCase())):b},[i,a]);return r.jsxs("div",{className:"mx-auto w-full max-w-3xl px-4 py-8 pb-32",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("h1",{className:"text-3xl font-extrabold text-neutral-900 tracking-tight",children:"Discover"}),r.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-emerald-600 bg-emerald-50 px-3 py-1 rounded-full",children:[r.jsxs("span",{className:"relative flex h-2 w-2",children:[r.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"}),r.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-emerald-500"})]}),M," Online Now"]}),r.jsx("button",{onClick:()=>R(!0),className:"text-sm font-semibold text-neutral-500 hover:text-black underline",children:"Request Game"})]})]}),r.jsxs("div",{className:"sticky top-0 z-30 bg-neutral-50/95 py-3 backdrop-blur-md mb-6 -mx-4 px-4 border-b border-neutral-100 transition-all",children:[r.jsxs("div",{className:"relative mb-3",children:[r.jsx(Kr,{className:"absolute left-3.5 top-3 h-5 w-5 text-neutral-400"}),r.jsx("input",{value:i,onChange:b=>o(b.target.value),placeholder:"Search groups, or invite codes...",className:"w-full h-11 rounded-xl border border-neutral-200 bg-white pl-11 pr-4 text-sm shadow-sm outline-none focus:border-black focus:ring-1 focus:ring-black transition-all placeholder:text-neutral-400"})]}),r.jsx("div",{className:"flex gap-2 overflow-x-auto pb-1 scrollbar-hide",children:Wd.map(b=>r.jsx("button",{onClick:()=>{c(b)},className:`whitespace-nowrap rounded-full px-4 py-1.5 text-sm font-medium transition-all ${a===b?"bg-neutral-900 text-white shadow-md scale-105":"bg-white text-neutral-600 border border-neutral-200 hover:bg-neutral-100"}`,children:b},b))})]}),r.jsxs("div",{className:"mb-8",children:[r.jsxs("button",{onClick:()=>u(!l),className:"w-full flex items-center justify-between bg-neutral-50 border border-neutral-200 rounded-2xl p-4 shadow-sm hover:bg-neutral-100 transition-all active:scale-[0.99]",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-10 w-10 flex items-center justify-center bg-white rounded-full text-emerald-600 shadow-sm",children:r.jsx(Ws,{className:"h-5 w-5"})}),r.jsxs("div",{className:"text-left",children:[r.jsx("div",{className:"text-xs font-bold text-neutral-400 uppercase tracking-wide",children:"Location"}),r.jsxs("div",{className:"text-base font-bold text-neutral-900 flex items-center gap-2",children:[$?`${$} & Nearby`:"All Locations",I&&r.jsx("span",{className:"text-xs bg-amber-100 text-amber-700 px-2 py-0.5 rounded-full",children:"Filtered"})]})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"text-xs font-bold text-neutral-400",children:[h.length," found"]}),l?r.jsx(nl,{className:"text-neutral-400"}):r.jsx(sl,{className:"text-neutral-400"})]})]}),l&&r.jsx("div",{className:"mt-4 animate-in slide-in-from-top-4 duration-300",children:m?r.jsx("div",{className:"space-y-3",children:[1,2,3].map(b=>r.jsx("div",{className:"h-24 w-full rounded-2xl bg-white animate-pulse shadow-sm"},b))}):h.length===0?r.jsxs("div",{className:"py-12 text-center rounded-3xl bg-neutral-50 border-2 border-dashed border-neutral-200",children:[r.jsx("div",{className:"inline-flex h-12 w-12 items-center justify-center rounded-full bg-white shadow-sm mb-3 text-2xl",children:"ğŸ”"}),r.jsx("h3",{className:"text-lg font-bold text-neutral-900",children:"No groups found"}),r.jsx("p",{className:"text-sm text-neutral-500 max-w-xs mx-auto mt-1 px-4",children:"Try adjusting your search or filters."}),r.jsx(me,{to:"/create",className:"mt-4 inline-block rounded-full bg-black px-6 py-2 text-sm font-bold text-white shadow-lg hover:bg-neutral-800 active:scale-95 transition-all",children:"Create New Group"})]}):r.jsx("div",{className:"grid gap-3",children:h.map(b=>r.jsx(me,{to:`/group/${b.id}`,className:"block group",children:r.jsxs("div",{className:"relative overflow-hidden rounded-2xl border border-neutral-100 bg-white p-4 shadow-sm transition-all hover:shadow-md hover:border-neutral-200 active:scale-[0.99]",children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{className:"flex-1 min-w-0 pr-4",children:[r.jsx("h3",{className:"font-bold text-neutral-900 text-base truncate",children:b.title}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-1 text-xs text-neutral-500 font-medium",children:[r.jsx("span",{className:"capitalize text-emerald-700 bg-emerald-50 px-2 py-0.5 rounded-md font-bold",children:b.game||b.category}),r.jsxs("span",{className:"flex items-center gap-0.5",children:[b.city?r.jsx(Ws,{className:"h-3 w-3"}):r.jsx(hd,{className:"h-3 w-3"}),b.city||"Online"]})]})]}),r.jsx("div",{className:"h-8 w-8 flex-shrink-0 rounded-full bg-neutral-50 flex items-center justify-center text-neutral-300 group-hover:bg-black group-hover:text-white transition-colors",children:r.jsx(Ns,{className:"h-4 w-4 rotate-180"})})]}),b.description&&r.jsx("p",{className:"mt-3 text-sm text-neutral-600 line-clamp-2 leading-relaxed",children:b.description}),b.code&&r.jsxs("div",{className:"mt-3 pt-3 border-t border-neutral-50 flex items-center gap-2",children:[r.jsx("span",{className:"text-[10px] font-bold text-neutral-400 uppercase tracking-wider",children:"Invite Code"}),r.jsx("span",{className:"font-mono text-xs font-bold text-neutral-700 bg-neutral-100 px-1.5 py-0.5 rounded",children:b.code})]})]})},b.id))})})]}),r.jsxs("section",{children:[r.jsx("h2",{className:"text-lg font-bold text-neutral-900 mb-4",children:"Browse by Category"}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:z.map(b=>r.jsx(me,{to:`/groups/game/${b.id}`,className:"block group",children:r.jsxs("div",{className:"flex items-center p-4 bg-white rounded-2xl border border-neutral-100 shadow-sm transition-all hover:shadow-md hover:border-neutral-200 active:scale-[0.98]",children:[r.jsx("div",{className:"h-14 w-14 flex items-center justify-center text-3xl bg-neutral-50 rounded-2xl mr-4 shadow-inner ring-1 ring-black/5",children:b.image}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"font-bold text-neutral-900 truncate",children:b.name}),r.jsx("span",{className:"text-[10px] font-bold bg-neutral-100 text-neutral-500 px-1.5 py-0.5 rounded uppercase tracking-wide",children:b.tag})]}),r.jsx("p",{className:"text-xs text-neutral-500 truncate mt-0.5",children:b.blurb}),r.jsxs("div",{className:"flex items-center gap-3 mt-2 text-[11px] font-medium text-neutral-400",children:[r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(Ps,{className:"h-3 w-3"})," ",A[b.id]||0]}),r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(Rd,{className:"h-3 w-3"})," ",y[b.id]||0," groups"]})]})]})]})},b.id))}),z.length===0&&r.jsx("div",{className:"py-12 text-center text-neutral-500",children:"No games found. Try a different search."})]}),C&&r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[r.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>R(!1)}),r.jsxs("div",{className:"relative w-full max-w-sm bg-white rounded-3xl p-6 shadow-2xl animate-in zoom-in-95 duration-200",children:[r.jsx("h3",{className:"text-xl font-bold text-neutral-900 mb-2",children:"Request Game"}),r.jsx("p",{className:"text-sm text-neutral-500 mb-6",children:"Don't see your favorite game? Let us know."}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-neutral-400 uppercase mb-1",children:"Game Name"}),r.jsx("input",{value:q,onChange:b=>Q(b.target.value),className:"w-full rounded-xl border-2 border-neutral-100 px-4 py-3 text-sm font-bold focus:border-black focus:ring-0 outline-none transition-colors",placeholder:"e.g. Catan"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-neutral-400 uppercase mb-1",children:"Why?"}),r.jsx("textarea",{value:U,onChange:b=>P(b.target.value),className:"w-full rounded-xl border-2 border-neutral-100 px-4 py-3 text-sm focus:border-black focus:ring-0 outline-none transition-colors resize-none",rows:3,placeholder:"It's super popular..."})]}),F&&r.jsx("p",{className:"text-sm font-medium text-emerald-600 text-center",children:F}),r.jsxs("div",{className:"flex gap-3 pt-2",children:[r.jsx("button",{onClick:()=>R(!1),className:"flex-1 rounded-xl font-bold text-neutral-500 hover:bg-neutral-50 py-3 text-sm transition-colors",children:"Cancel"}),r.jsx("button",{disabled:T||!q,onClick:async()=>{N(!0);const{data:b}=await w.auth.getUser();await w.from("category_requests").insert({name:q,note:U,requested_by:b.user?.id}),D("Request sent! Thanks."),setTimeout(()=>{R(!1),D(null),Q("")},1500),N(!1)},className:"flex-1 rounded-xl bg-black text-white font-bold py-3 text-sm shadow-lg active:scale-95 transition-all disabled:opacity-50 disabled:scale-100",children:T?"Sending...":"Submit"})]})]})]})]})]})}const Yd="modulepreload",Xd=function(t){return"/circles/"+t},oa={},Fn=function(e,s,n){let i=Promise.resolve();if(s&&s.length>0){let l=function(u){return Promise.all(u.map(h=>Promise.resolve(h).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),c=a?.nonce||a?.getAttribute("nonce");i=l(s.map(u=>{if(u=Xd(u),u in oa)return;oa[u]=!0;const h=u.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":Yd,h||(m.as="script"),m.crossOrigin="",m.href=u,c&&m.setAttribute("nonce",c),document.head.appendChild(m),h)return new Promise((g,x)=>{m.addEventListener("load",g),m.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${u}`)))})}))}function o(a){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=a,window.dispatchEvent(c),!c.defaultPrevented)throw a}return i.then(a=>{for(const c of a||[])c.status==="rejected"&&o(c.reason);return e().catch(o)})};function Jd(t,e){const s=t.trim().toLowerCase();if(!s)return null;const n=e.find(i=>i.toLowerCase()===s);return n||(e.find(i=>i.toLowerCase().startsWith(s))??null)}function Zd(){const[t,e]=d.useState([]),[s,n]=d.useState(!1),i=async()=>{if(s||t.length>0)return;const{State:k,City:W}=await Fn(async()=>{const{State:Ee,City:he}=await import("./index-D7rQSa_G.js");return{State:Ee,City:he}},[]),Y=k.getStatesOfCountry("DE")||[],ue=[];for(const Ee of Y){const he=W.getCitiesOfState("DE",Ee.isoCode)||[];for(const De of he)De&&typeof De.name=="string"&&De.name.trim()&&ue.push(De.name.trim())}const ge=Array.from(new Set(ue)).sort((Ee,he)=>Ee.localeCompare(he,"de"));e(ge),n(!0)},o=pt(),a="Games",c="",[l,u]=d.useState([]),[h,f]=d.useState([]),[m,g]=d.useState(!0),[x,v]=d.useState(""),[y,j]=d.useState([]),[A,E]=d.useState(!0),[M,_]=d.useState([]),[$,S]=d.useState("");d.useMemo(()=>new Map(y.map(k=>[k.id,k])),[y]),d.useMemo(()=>new Set(y.map(k=>k.id)),[y]),d.useMemo(()=>{const k=$.trim().toLowerCase();return k?y.filter(W=>(W.display_name||"").toLowerCase().includes(k)||(W.id||"").toLowerCase().includes(k)):y},[y,$]);async function C(k){E(!0);try{const[W,Y]=await Promise.all([w.from("friends").select("friend_id").eq("user_id",k).eq("status","accepted"),w.from("friends").select("user_id").eq("friend_id",k).eq("status","accepted")]),ue=[];!W.error&&Array.isArray(W.data)&&ue.push(...W.data.map(te=>te.friend_id).filter(Boolean)),!Y.error&&Array.isArray(Y.data)&&ue.push(...Y.data.map(te=>te.user_id).filter(Boolean));const ge=Array.from(new Set(ue));if(ge.length===0){const ne=await w.from("profiles").select("id, user_id, display_name, name, avatar_url").neq("id",k).neq("user_id",k).limit(12),we=(!ne.error&&Array.isArray(ne.data)?ne.data:[]).map(oe=>({id:oe.id||oe.user_id,display_name:(oe.display_name||oe.name)??null,avatar_url:oe.avatar_url??null}));j(we);return}const Ee="id, user_id, display_name, name, avatar_url";let he=[];const De=await w.from("profiles").select(Ee).in("id",ge);if(!De.error&&De.data?.length)he=De.data;else{const te=await w.from("profiles").select(Ee).in("user_id",ge);!te.error&&te.data?.length&&(he=te.data)}const O=(he||[]).map(te=>({id:te.id||te.user_id,display_name:(te.display_name||te.name)??null,avatar_url:te.avatar_url??null})).filter(te=>ge.includes(te.id));j(O)}finally{E(!1)}}d.useEffect(()=>{let k=!0;return(async()=>{const{data:W,error:Y}=await w.auth.getUser();if(!k)return;const ue=Y?void 0:W?.user?.id;ue&&(v(ue),await C(ue))})(),()=>{k=!1}},[]),d.useEffect(()=>{let k=!0;return(async()=>{g(!0);const{data:W}=await w.from("allowed_categories").select("name").eq("is_active",!0),{data:Y}=await w.from("allowed_games").select("id, name, category").eq("is_active",!0);k&&(u((W??[]).map(ue=>({name:ue.name}))),f((Y??[]).map(ue=>({id:ue.id,label:ue.name||ue.id,category:ue.category}))),g(!1))})(),()=>{k=!1}},[]),d.useEffect(()=>{function k(W){const Y=W.target,ue=document.getElementById("cat-combobox"),ge=document.getElementById("game-combobox");ue&&!ue.contains(Y)&&J(!1),ge&&!ge.contains(Y)&&Be(!1)}return document.addEventListener("mousedown",k),()=>document.removeEventListener("mousedown",k)},[]);const[R,q]=d.useState(""),[Q,U]=d.useState(""),[P,T]=d.useState(""),[N,F]=d.useState(!1),D=d.useMemo(()=>Jd(P,t),[P,t]),I=!!D,[z,b]=d.useState(!1),[L,H]=d.useState(-1),ce=d.useMemo(()=>{const k=P.trim().toLowerCase();return k?t.filter(W=>W.toLowerCase().includes(k)).slice(0,8):t.slice(0,8)},[P,t]),[G,se]=d.useState(3),[X,J]=d.useState(!1),[Se,Rt]=d.useState(""),[fe,gt]=d.useState("");d.useEffect(()=>{if(!l.length)return;const k=String(a),W=l.find(Y=>Y.name.toLowerCase()===k.toLowerCase());gt((W?.name||l[0].name).toLowerCase())},[l,a]);const[$e,Be]=d.useState(!1),[Ce,Ze]=d.useState(""),[Fe,xt]=d.useState("");d.useEffect(()=>{if(!h.length||!fe)return;const k="".toLowerCase().replace(/\s+/g,""),W=h.find(Y=>Y.id===k||Y.label.toLowerCase().replace(/\s+/g,"")===k);W&&xt(W.id)},[h,c,fe]);const Ms=d.useMemo(()=>{const k=Se.trim().toLowerCase(),W=l.map(Y=>Y.name);return k?W.filter(Y=>Y.toLowerCase().includes(k)):W},[Se,l]),ts=d.useMemo(()=>{const k=h.filter(Y=>Y.category.toLowerCase()===(fe||"").toLowerCase()),W=Ce.trim().toLowerCase();return W?k.filter(Y=>Y.label.toLowerCase().includes(W)||Y.id.includes(W)):k},[fe,Ce,h]),ss=!m&&R.trim().length>0&&fe&&Fe&&G>=3&&G<=16&&I,[ye,Dt]=d.useState(1),nt=R.trim().length>0&&!!fe&&!!Fe,Lt=I&&G>=3&&G<=16;function Ot(){ye===1&&!nt||ye===2&&!Lt||Dt(k=>Math.min(3,k+1))}function hn(){Dt(k=>Math.max(1,k-1))}async function ns(k,W){if(M.length){try{const{error:Y}=await w.rpc("send_group_invites",{p_group_id:k,p_recipient_ids:M});if(!Y){console.debug("[CreateGroup] send_group_invites RPC ok",{groupId:k,inviteeCount:M.length});return}console.warn("[CreateGroup] send_group_invites RPC failed, will fallback",Y?.message)}catch(Y){console.warn("[CreateGroup] send_group_invites RPC threw, will fallback",Y)}try{const Y=M.map(ge=>({group_id:k,inviter_id:W,recipient_id:ge,status:"pending"})),{error:ue}=await w.from("group_invitations").insert(Y);ue&&console.warn("[CreateGroup] group_invitations insert failed",ue.message)}catch{}try{let Y=null;try{const{data:he}=await w.from("groups").select("title").eq("id",k).maybeSingle();Y=he?.title??null}catch{}let ue=null;try{const{data:he}=await w.from("profiles").select("display_name,name").in("id",[W]).maybeSingle();ue=he?.display_name||he?.name||null}catch{}const ge=M.map(he=>({user_id:he,kind:"group_invite",payload:{group_id:k,group_title:Y,inviter_id:W,inviter_name:ue},is_read:!1})),{error:Ee}=await w.from("notifications").insert(ge);Ee&&console.warn("[CreateGroup] notifications insert likely blocked by RLS (expected). Use RPC send_group_invites.",Ee.message)}catch{}}}async function fn(){if(!ss)return;if(!I){F(!0);return}const{data:k,error:W}=await w.auth.getUser();if(W||!k?.user?.id){alert(W?.message||"Sign in required");return}const Y=k.user.id,ue=Math.max(3,Math.min(16,G)),ge=D??null,Ee={title:R.trim(),description:Q.trim().replace(/\s+$/,"")||null,category:(fe||"").toLowerCase(),game:Fe,city:ge,capacity:ue,visibility:"public",host_id:Y},{data:he,error:De}=await w.from("groups").insert([Ee]).select("id").maybeSingle();if(De){alert(String(De.message??"Unknown error"));return}if(!he?.id){alert("Group created but ID missing. Try refreshing.");return}ns(he.id,Y),o(`/group/${he.id}`)}return r.jsx("div",{className:"min-h-screen bg-neutral-50",children:r.jsxs("div",{className:"mx-auto w-full max-w-xl px-4 pb-10 pt-6",children:[r.jsxs("div",{className:"mb-6 flex items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-semibold tracking-tight",children:"Start a new Circle"}),r.jsx("p",{className:"mt-1 text-sm text-neutral-600",children:"A small, calm group for the right people. 3 quick steps."})]}),r.jsx(me,{to:"/browse",className:"shrink-0 rounded-full border border-neutral-200 px-3 py-1.5 text-xs font-medium text-neutral-700 hover:bg-neutral-100",children:"Back"})]}),r.jsx("div",{className:"mb-6 flex items-center justify-between text-xs font-medium text-neutral-600",children:[{id:1,label:"Basics"},{id:2,label:"Location"},{id:3,label:"Details"}].map(k=>{const W=ye===k.id,Y=ye>k.id;return r.jsxs("div",{className:"flex flex-1 items-center gap-2",children:[r.jsx("div",{className:["flex h-7 w-7 items-center justify-center rounded-full border text-[11px]",W?"border-emerald-600 bg-emerald-600 text-white":Y?"border-emerald-400 bg-emerald-50 text-emerald-700":"border-neutral-300 bg-white text-neutral-500"].join(" "),children:k.id}),r.jsx("span",{className:W?"text-neutral-900":"text-neutral-500",children:k.label})]},k.id)})}),r.jsxs("div",{className:"space-y-4",children:[ye===1&&r.jsxs("section",{className:"rounded-2xl border border-neutral-200 bg-white p-4 shadow-sm",children:[r.jsx("h2",{className:"mb-3 text-sm font-semibold text-neutral-800",children:"Basics"}),m&&r.jsx("div",{className:"mb-2 text-xs text-neutral-500",children:"Loading categoriesâ€¦"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-neutral-700",children:"Title"}),r.jsx("input",{value:R,onChange:k=>q(k.target.value),placeholder:"e.g., Friday Night Hokm",className:"mt-1 w-full rounded-lg border border-neutral-200 bg-white px-3 py-2 text-sm outline-none shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/30"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-neutral-700",children:"Category"}),r.jsxs("div",{id:"cat-combobox",className:"relative mt-1",children:[r.jsx("input",{value:X?Se:fe||"",onChange:k=>{J(!0),Rt(k.target.value)},onFocus:()=>J(!0),placeholder:"Search or choose categoryâ€¦",className:"w-full rounded-lg border border-neutral-200 bg-white px-3 py-2 text-sm outline-none shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/30",disabled:m}),X&&r.jsxs("div",{className:"absolute z-20 mt-1 max-h-56 w-full overflow-auto rounded-lg border bg-white shadow-lg",children:[Ms.length===0&&r.jsx("div",{className:"px-3 py-2 text-sm text-neutral-500",children:"No matches"}),Ms.map(k=>r.jsx("button",{type:"button",onClick:()=>{gt(k.toLowerCase()),J(!1),Rt(""),h.some(W=>W.category===k&&W.id===Fe)||xt("")},className:"block w-full px-3 py-2 text-left text-sm hover:bg-neutral-50",children:k},k))]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-neutral-700",children:"Game / Activity"}),r.jsxs("div",{id:"game-combobox",className:"relative mt-1",children:[r.jsx("input",{value:$e?Ce:h.find(k=>k.category.toLowerCase()===(fe||"").toLowerCase()&&k.id===Fe)?.label||"",onChange:k=>{Be(!0),Ze(k.target.value)},onFocus:()=>Be(!0),placeholder:"Search or choose game/activityâ€¦",className:"w-full rounded-lg border border-neutral-200 bg-white px-3 py-2 text-sm outline-none shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/30",disabled:m||!(fe&&fe.trim().length>0)}),$e&&r.jsxs("div",{className:"absolute z-20 mt-1 max-h-56 w-full overflow-auto rounded-lg border bg-white shadow-lg",children:[ts.length===0&&r.jsx("div",{className:"px-3 py-2 text-sm text-neutral-500",children:"No matches"}),ts.map(k=>r.jsx("button",{type:"button",onClick:()=>{xt(k.id),Be(!1),Ze("")},className:"block w-full px-3 py-2 text-left text-sm hover:bg-neutral-50",children:k.label},k.id))]})]})]})]})]}),ye===2&&r.jsxs("section",{className:"rounded-2xl border border-neutral-200 bg-white p-4 shadow-sm",children:[r.jsx("h2",{className:"mb-3 text-sm font-semibold text-neutral-800",children:"Location & size"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"relative",children:[r.jsxs("label",{className:"block text-xs font-medium text-neutral-700",children:["City ",r.jsx("span",{className:"text-red-600",children:"*"})]}),r.jsx("input",{value:P,onChange:k=>{T(k.target.value),b(!0),H(-1)},onFocus:async()=>{await i(),b(!0)},onBlur:()=>{setTimeout(()=>b(!1),120),F(!0)},onKeyDown:k=>{z&&(k.key==="ArrowDown"?(k.preventDefault(),H(W=>Math.min(ce.length-1,W+1))):k.key==="ArrowUp"?(k.preventDefault(),H(W=>Math.max(-1,W-1))):k.key==="Enter"&&L>=0&&ce[L]&&(k.preventDefault(),T(ce[L]),b(!1)))},placeholder:"Start typingâ€¦ e.g., Offenburg",className:["mt-1 w-full rounded-lg border border-neutral-200 bg-white px-3 py-2 text-sm outline-none shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/30",N&&!I?"border-red-400 focus:border-red-500":""].join(" "),"aria-autocomplete":"list","aria-expanded":z,"aria-controls":"city-suggest",role:"combobox"}),z&&ce.length>0&&r.jsx("div",{id:"city-suggest",className:"absolute z-20 mt-1 max-h-64 w-full overflow-auto rounded-lg border border-neutral-200 bg-white shadow-lg",role:"listbox",children:ce.map((k,W)=>r.jsx("button",{type:"button",onMouseDown:Y=>Y.preventDefault(),onClick:()=>{T(k),b(!1),H(-1)},className:["flex w-full items-center justify-between px-3 py-2 text-left text-sm hover:bg-emerald-50",W===L?"bg-emerald-50":""].join(" "),role:"option","aria-selected":W===L,children:r.jsx("span",{className:"truncate",children:k})},k+W))}),!I&&N&&r.jsx("p",{className:"mt-1 text-xs text-red-600",children:"Choose a city from suggestions."}),I&&N&&D!==P&&r.jsxs("p",{className:"mt-1 text-xs text-neutral-500",children:["Using â€œ",D,"â€."]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-neutral-700",children:"Capacity"}),r.jsx("div",{className:"mt-1 flex items-center gap-3",children:r.jsx("input",{type:"number",value:G===0?"":G,onChange:k=>{const W=k.target.value;if(W===""){se(0);return}const Y=Number(W);se(Y)},placeholder:"3â€“16",className:"w-24 rounded-lg border border-neutral-200 bg-white px-3 py-2 text-sm outline-none shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/30"})}),(G<3||G>16)&&G!==0&&r.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Capacity must be between 3 and 16."})]})]})]}),ye===3&&r.jsxs("section",{className:"rounded-2xl border border-neutral-200 bg-white p-4 shadow-sm",children:[r.jsx("h2",{className:"mb-3 text-sm font-semibold text-neutral-800",children:"Details & preview"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-neutral-700",children:"Description"}),r.jsx("textarea",{value:Q,onChange:k=>U(k.target.value),placeholder:"Tell people what this circle is aboutâ€¦",rows:4,className:"mt-1 w-full rounded-lg border border-neutral-200 bg-white px-3 py-2 text-sm outline-none shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/30"})]}),r.jsxs("div",{className:"rounded-xl border border-dashed border-neutral-200 bg-neutral-50 p-3 text-xs text-neutral-700",children:[r.jsx("div",{className:"mb-1 text-[11px] font-semibold uppercase tracking-wide text-neutral-500",children:"Preview"}),r.jsx("div",{className:"text-sm font-semibold text-neutral-900",children:R||"Untitled Circle"}),r.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-2 text-[11px] text-neutral-600",children:[fe&&r.jsx("span",{className:"rounded-full bg-white px-2 py-0.5",children:fe}),Fe&&r.jsx("span",{className:"rounded-full bg-white px-2 py-0.5",children:h.find(k=>k.id===Fe)?.label||Fe}),D&&r.jsxs("span",{className:"rounded-full bg-white px-2 py-0.5 flex items-center gap-1",children:[r.jsx("span",{children:"ğŸ“"}),D]}),r.jsxs("span",{className:"rounded-full bg-white px-2 py-0.5",children:[G," spots"]})]}),Q&&r.jsx("p",{className:"mt-2 line-clamp-3 text-xs text-neutral-700",children:Q})]})]})]})]}),r.jsxs("div",{className:"mt-6 flex items-center justify-between gap-3",children:[r.jsx("button",{type:"button",onClick:ye===1?()=>o("/browse"):hn,className:"rounded-full border border-neutral-200 px-3 py-1.5 text-xs font-medium text-neutral-700 hover:bg-neutral-100",children:ye===1?"Cancel":"Back"}),r.jsxs("div",{className:"flex gap-2",children:[ye<3&&r.jsx("button",{type:"button",onClick:Ot,disabled:ye===1&&!nt||ye===2&&!Lt||m,className:"rounded-full bg-emerald-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-emerald-700 disabled:opacity-60",children:"Next"}),ye===3&&r.jsx("button",{type:"button",disabled:!ss,onClick:fn,className:"rounded-full bg-emerald-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-emerald-700 disabled:opacity-60",children:"Create Circle"})]})]})]})})}const la=t=>alert(t);function Wr({isOpen:t,onClose:e,viewUserId:s}){const n=pt(),[i,o]=d.useState(null),[a,c]=d.useState(""),[l,u]=d.useState(null),[h,f]=d.useState(!0),[m,g]=d.useState(0),[x,v]=d.useState(0),[y,j]=d.useState(0),[A,E]=d.useState(0),[M,_]=d.useState([]),[$,S]=d.useState([]),[C,R]=d.useState(0),[q,Q]=d.useState(!1),[U,P]=d.useState(null),[T,N]=d.useState("none"),[F,D]=d.useState(null),[I,z]=d.useState(!1);d.useEffect(()=>{(async()=>{const{data:G}=await w.auth.getUser();o(G.user?.id||null)})()},[]),d.useEffect(()=>{if(!t||!s||!i)return;D(null),Q(!1),P(null),z(!1);async function G(){const{data:se}=await w.from("profiles").select("name,avatar_url,allow_ratings,rating_avg,rating_count").eq("user_id",s).maybeSingle();c(se?.name??"User"),u(se?.avatar_url??null),f(!!(se?.allow_ratings??!0)),g(Number(se?.rating_avg??0)),v(Number(se?.rating_count??0));const{data:X}=await w.from("rating_pairs").select("stars").eq("rater_id",i).eq("ratee_id",s).maybeSingle();R(Number(X?.stars??0));const{data:J}=await w.from("friendships").select("status,requested_by").or(`and(user_id_a.eq.${i},user_id_b.eq.${s}),and(user_id_a.eq.${s},user_id_b.eq.${i})`).maybeSingle();let Se="none";J&&(J.status==="accepted"?Se="accepted":J.status==="blocked"?Se="blocked":J.status==="pending"&&(Se=J.requested_by===i?"pending_out":"pending_in")),N(Se);const{data:Rt}=await w.from("group_members").select("group_id").eq("user_id",s).eq("status","active"),fe=(Rt||[]).map(Ce=>Ce.group_id);if(j(fe.length),fe.length>0){const{data:Ce}=await w.from("groups").select("title").in("id",fe).limit(12);S((Ce||[]).map(Ze=>Ze.title))}else S([]);const{data:gt}=await w.from("group_members").select("group_id").eq("user_id",i).eq("status","active"),$e=new Set((gt||[]).map(Ce=>Ce.group_id)),Be=fe.filter(Ce=>$e.has(Ce));if(E(Be.length),Be.length>0){const{data:Ce}=await w.from("groups").select("title").in("id",Be).limit(3);_((Ce||[]).map(Ze=>Ze.title))}else _([])}G()},[t,s,i]);async function b(G){if(s)try{G==="add"?(await w.rpc("request_friend",{target_id:s}),N("pending_out")):G==="accept"?(await w.rpc("accept_friend",{from_id:s}),N("accepted")):(await w.rpc("remove_friend",{other_id:s}),N("none"))}catch{}}async function L(){if(!(!i||!s)&&window.confirm("Are you sure you want to report and block this user? They will not be able to contact you.")){z(!0);try{const{error:G}=await w.from("reports").insert({reporter_id:i,reported_id:s,reason:"User Reported via Profile"});if(G)throw G;const{error:se}=await w.rpc("block_user",{target_id:s});if(se)throw se;la("User reported and blocked."),N("blocked"),e()}catch{la("Failed to report user.")}finally{z(!1)}}}async function H(G){if(!i||!s||q||!h)return;Q(!0);const se=C;R(G);try{const{error:X}=await w.rpc("submit_rating",{p_ratee:s,p_stars:G});if(X)throw X;const{data:J}=await w.from("profiles").select("rating_avg,rating_count").eq("user_id",s).single();J&&(g(J.rating_avg),v(J.rating_count))}catch{R(se),D("Failed to rate.")}finally{Q(!1)}}function ce(){s&&(e(),n("/chats",{state:{openDmId:s}}))}return t?r.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[r.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:e}),r.jsxs("div",{className:"relative w-full max-w-sm bg-white rounded-3xl p-6 shadow-2xl overflow-y-auto max-h-[90vh]",children:[r.jsx("button",{onClick:e,className:"absolute top-4 right-4 p-2 rounded-full bg-white text-neutral-500",children:r.jsx(Nn,{className:"h-5 w-5"})}),r.jsxs("div",{className:"flex flex-col items-center mb-6",children:[r.jsx("div",{className:"h-24 w-24 rounded-full bg-neutral-200 overflow-hidden shadow-sm",children:l?r.jsx("img",{src:l,alt:"Avatar",className:"h-full w-full object-cover"}):r.jsx("div",{className:"h-full w-full flex items-center justify-center text-3xl font-bold text-neutral-500",children:a.slice(0,1).toUpperCase()})}),r.jsx("h2",{className:"text-xl font-bold mt-3",children:a})]}),r.jsxs("div",{className:"flex gap-3 mb-6",children:[r.jsxs("button",{onClick:ce,className:"flex-1 py-2 rounded-xl bg-indigo-600 text-white text-sm font-bold flex items-center justify-center gap-2",children:[r.jsx(Pn,{className:"h-4 w-4"})," Message"]}),T==="none"&&r.jsxs("button",{onClick:()=>b("add"),className:"flex-1 py-2 rounded-xl bg-black text-white text-sm font-bold flex items-center justify-center gap-2",children:[r.jsx(il,{className:"h-4 w-4"})," Add"]}),T==="pending_in"&&r.jsxs("button",{onClick:()=>b("accept"),className:"flex-1 py-2 rounded-xl bg-emerald-600 text-white text-sm font-bold flex items-center justify-center gap-2",children:[r.jsx(Id,{className:"h-4 w-4"})," Accept"]}),T==="accepted"&&r.jsxs("button",{onClick:()=>{window.confirm("Are you sure you want to unfriend this user?")&&b("remove")},className:"flex-1 py-2 rounded-xl bg-neutral-100 text-red-600 hover:bg-red-50 border border-transparent hover:border-red-200 text-sm font-bold flex items-center justify-center gap-2 transition-all",children:[r.jsx($d,{className:"h-4 w-4"})," Unfriend"]}),T==="blocked"&&r.jsxs("button",{onClick:()=>{window.confirm("Unblock this user? They will be able to request you again.")&&b("remove")},className:"flex-1 py-2 rounded-xl bg-neutral-800 text-white text-sm font-bold flex items-center justify-center gap-2 hover:bg-neutral-900 transition-all",children:[r.jsx(pd,{className:"h-4 w-4"})," Unblock"]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-6",children:[r.jsxs("div",{className:"p-3 rounded-xl bg-neutral-50 text-center",children:[r.jsx("div",{className:"text-xl font-bold",children:y}),r.jsxs("div",{className:"text-[10px] uppercase font-bold text-neutral-500 mt-1 flex items-center justify-center gap-1",children:[r.jsx(tl,{className:"h-3 w-3"})," Groups Joined"]})]}),r.jsxs("div",{className:"p-3 rounded-xl bg-blue-50 text-center",children:[r.jsx("div",{className:"text-xl font-bold text-blue-600",children:A}),r.jsxs("div",{className:"text-[10px] uppercase font-bold text-blue-400 mt-1 flex items-center justify-center gap-1",children:[r.jsx(Ps,{className:"h-3 w-3"})," Mutual Groups"]})]})]}),r.jsxs("div",{className:"mb-6 bg-neutral-50 rounded-xl p-3 border border-neutral-100",children:[r.jsx("div",{className:"text-[10px] font-bold text-neutral-400 uppercase mb-2",children:"Groups they joined:"}),$.length===0?r.jsx("div",{className:"text-xs text-neutral-400",children:"No groups found."}):r.jsx("div",{className:"flex flex-wrap gap-1.5",children:$.map((G,se)=>r.jsx("span",{className:"px-2 py-0.5 bg-white border border-neutral-200 rounded-md text-xs font-medium text-neutral-700",children:G},se))})]}),M.length>0&&r.jsxs("div",{className:"mb-6 bg-neutral-50 rounded-xl p-3 border border-neutral-100",children:[r.jsx("div",{className:"text-[10px] font-bold text-neutral-400 uppercase mb-2",children:"You are both in:"}),r.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[M.map((G,se)=>r.jsx("span",{className:"px-2 py-0.5 bg-white border border-neutral-200 rounded-md text-xs font-medium text-neutral-700",children:G},se)),A>3&&r.jsxs("span",{className:"px-2 py-0.5 text-xs text-neutral-400",children:["+",A-3," more"]})]})]}),h&&T!=="blocked"&&r.jsxs("div",{className:"pt-3 border-t border-neutral-100",children:[r.jsx("div",{className:"text-center text-xs font-medium text-neutral-400 mb-2",children:"Rate this player"}),r.jsx("div",{className:"flex justify-center gap-1",children:Array.from({length:6}).map((G,se)=>{const X=se+1,J=(U??C)>=X;return r.jsx("button",{disabled:q,onMouseEnter:()=>P(X),onMouseLeave:()=>P(null),onClick:()=>H(X),className:`text-2xl transition-transform hover:scale-110 ${J?"text-amber-400":"text-neutral-200"}`,"aria-label":`Rate ${X} star${X>1?"s":""}`,children:"â˜…"},X)})}),F&&r.jsx("div",{className:"text-center text-[10px] text-red-500 mt-1",children:F})]}),T!=="blocked"&&r.jsx("div",{className:"mt-6 flex justify-center",children:r.jsxs("button",{onClick:L,disabled:I,className:"flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white py-2 px-4 rounded-xl text-sm font-bold disabled:opacity-50 disabled:cursor-not-allowed",children:[r.jsx(Fd,{className:"h-4 w-4"}),I?"Reporting...":"Report & Block User"]})})]})]}):null}var Ss;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(Ss||(Ss={}));class Kn extends Error{constructor(e,s,n){super(e),this.message=e,this.code=s,this.data=n}}const eh=t=>{var e,s;return t?.androidBridge?"android":!((s=(e=t?.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||s===void 0)&&s.bridge?"ios":"web"},th=t=>{const e=t.CapacitorCustomPlatform||null,s=t.Capacitor||{},n=s.Plugins=s.Plugins||{},i=()=>e!==null?e.name:eh(t),o=()=>i()!=="web",a=f=>{const m=u.get(f);return!!(m?.platforms.has(i())||c(f))},c=f=>{var m;return(m=s.PluginHeaders)===null||m===void 0?void 0:m.find(g=>g.name===f)},l=f=>t.console.error(f),u=new Map,h=(f,m={})=>{const g=u.get(f);if(g)return console.warn(`Capacitor plugin "${f}" already registered. Cannot register plugins twice.`),g.proxy;const x=i(),v=c(f);let y;const j=async()=>(!y&&x in m?y=typeof m[x]=="function"?y=await m[x]():y=m[x]:e!==null&&!y&&"web"in m&&(y=typeof m.web=="function"?y=await m.web():y=m.web),y),A=(C,R)=>{var q,Q;if(v){const U=v?.methods.find(P=>R===P.name);if(U)return U.rtype==="promise"?P=>s.nativePromise(f,R.toString(),P):(P,T)=>s.nativeCallback(f,R.toString(),P,T);if(C)return(q=C[R])===null||q===void 0?void 0:q.bind(C)}else{if(C)return(Q=C[R])===null||Q===void 0?void 0:Q.bind(C);throw new Kn(`"${f}" plugin is not implemented on ${x}`,Ss.Unimplemented)}},E=C=>{let R;const q=(...Q)=>{const U=j().then(P=>{const T=A(P,C);if(T){const N=T(...Q);return R=N?.remove,N}else throw new Kn(`"${f}.${C}()" is not implemented on ${x}`,Ss.Unimplemented)});return C==="addListener"&&(U.remove=async()=>R()),U};return q.toString=()=>`${C.toString()}() { [capacitor code] }`,Object.defineProperty(q,"name",{value:C,writable:!1,configurable:!1}),q},M=E("addListener"),_=E("removeListener"),$=(C,R)=>{const q=M({eventName:C},R),Q=async()=>{const P=await q;_({eventName:C,callbackId:P},R)},U=new Promise(P=>q.then(()=>P({remove:Q})));return U.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await Q()},U},S=new Proxy({},{get(C,R){switch(R){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return v?$:M;case"removeListener":return _;default:return E(R)}}});return n[f]=S,u.set(f,{name:f,proxy:S,platforms:new Set([...Object.keys(m),...v?[x]:[]])}),S};return s.convertFileSrc||(s.convertFileSrc=f=>f),s.getPlatform=i,s.handleError=l,s.isNativePlatform=o,s.isPluginAvailable=a,s.registerPlugin=h,s.Exception=Kn,s.DEBUG=!!s.DEBUG,s.isLoggingEnabled=!!s.isLoggingEnabled,s},sh=t=>t.Capacitor=th(t),Cr=sh(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Qr=Cr.registerPlugin;class ol{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,s){let n=!1;this.listeners[e]||(this.listeners[e]=[],n=!0),this.listeners[e].push(s);const o=this.windowListeners[e];o&&!o.registered&&this.addWindowListener(o),n&&this.sendRetainedArgumentsForEvent(e);const a=async()=>this.removeListener(e,s);return Promise.resolve({remove:a})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,s,n){const i=this.listeners[e];if(!i){if(n){let o=this.retainedEventArguments[e];o||(o=[]),o.push(s),this.retainedEventArguments[e]=o}return}i.forEach(o=>o(s))}hasListeners(e){var s;return!!(!((s=this.listeners[e])===null||s===void 0)&&s.length)}registerWindowListener(e,s){this.windowListeners[s]={registered:!1,windowEventName:e,pluginEventName:s,handler:n=>{this.notifyListeners(s,n)}}}unimplemented(e="not implemented"){return new Cr.Exception(e,Ss.Unimplemented)}unavailable(e="not available"){return new Cr.Exception(e,Ss.Unavailable)}async removeListener(e,s){const n=this.listeners[e];if(!n)return;const i=n.indexOf(s);this.listeners[e].splice(i,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const s=this.retainedEventArguments[e];s&&(delete this.retainedEventArguments[e],s.forEach(n=>{this.notifyListeners(e,n)}))}}const ca=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),ua=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class nh extends ol{async getCookies(){const e=document.cookie,s={};return e.split(";").forEach(n=>{if(n.length<=0)return;let[i,o]=n.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");i=ua(i).trim(),o=ua(o).trim(),s[i]=o}),s}async setCookie(e){try{const s=ca(e.key),n=ca(e.value),i=`; expires=${(e.expires||"").replace("expires=","")}`,o=(e.path||"/").replace("path=",""),a=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${s}=${n||""}${i}; path=${o}; ${a};`}catch(s){return Promise.reject(s)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(s){return Promise.reject(s)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const s of e)document.cookie=s.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}Qr("CapacitorCookies",{web:()=>new nh});const rh=async t=>new Promise((e,s)=>{const n=new FileReader;n.onload=()=>{const i=n.result;e(i.indexOf(",")>=0?i.split(",")[1]:i)},n.onerror=i=>s(i),n.readAsDataURL(t)}),ih=(t={})=>{const e=Object.keys(t);return Object.keys(t).map(i=>i.toLocaleLowerCase()).reduce((i,o,a)=>(i[o]=t[e[a]],i),{})},ah=(t,e=!0)=>t?Object.entries(t).reduce((n,i)=>{const[o,a]=i;let c,l;return Array.isArray(a)?(l="",a.forEach(u=>{c=e?encodeURIComponent(u):u,l+=`${o}=${c}&`}),l.slice(0,-1)):(c=e?encodeURIComponent(a):a,l=`${o}=${c}`),`${n}&${l}`},"").substr(1):null,oh=(t,e={})=>{const s=Object.assign({method:t.method||"GET",headers:t.headers},e),i=ih(t.headers)["content-type"]||"";if(typeof t.data=="string")s.body=t.data;else if(i.includes("application/x-www-form-urlencoded")){const o=new URLSearchParams;for(const[a,c]of Object.entries(t.data||{}))o.set(a,c);s.body=o.toString()}else if(i.includes("multipart/form-data")||t.data instanceof FormData){const o=new FormData;if(t.data instanceof FormData)t.data.forEach((c,l)=>{o.append(l,c)});else for(const c of Object.keys(t.data))o.append(c,t.data[c]);s.body=o;const a=new Headers(s.headers);a.delete("content-type"),s.headers=a}else(i.includes("application/json")||typeof t.data=="object")&&(s.body=JSON.stringify(t.data));return s};class lh extends ol{async request(e){const s=oh(e,e.webFetchExtra),n=ah(e.params,e.shouldEncodeUrlParams),i=n?`${e.url}?${n}`:e.url,o=await fetch(i,s),a=o.headers.get("content-type")||"";let{responseType:c="text"}=o.ok?e:{};a.includes("application/json")&&(c="json");let l,u;switch(c){case"arraybuffer":case"blob":u=await o.blob(),l=await rh(u);break;case"json":l=await o.json();break;case"document":case"text":default:l=await o.text()}const h={};return o.headers.forEach((f,m)=>{h[m]=f}),{data:l,headers:h,status:o.status,url:o.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}Qr("CapacitorHttp",{web:()=>new lh});function ch(t){t.CapacitorUtils.Synapse=new Proxy({},{get(e,s){return new Proxy({},{get(n,i){return(o,a,c)=>{const l=t.Capacitor.Plugins[s];if(l===void 0){c(new Error(`Capacitor plugin ${s} not found`));return}if(typeof l[i]!="function"){c(new Error(`Method ${i} not found in Capacitor plugin ${s}`));return}(async()=>{try{const u=await l[i](o);a(u)}catch(u){c(u)}})()}}})}})}function uh(t){t.CapacitorUtils.Synapse=new Proxy({},{get(e,s){return t.cordova.plugins[s]}})}function dh(t=!1){typeof window>"u"||(window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!t?ch(window):window.cordova!==void 0&&uh(window))}const hh=Qr("Geolocation",{web:()=>Fn(()=>import("./web-DNI2eyrO.js"),__vite__mapDeps([0,1,2])).then(t=>new t.GeolocationWeb)});dh();function fh(t,e){const[s,n]=d.useState({});d.useEffect(()=>{if(!t||!e)return;const o=async()=>{try{const c=await hh.getCurrentPosition({enableHighAccuracy:!0}),{latitude:l,longitude:u}=c.coords;await w.from("group_members").upsert({group_id:t,user_id:e,role:"member",status:"active"},{onConflict:"group_id,user_id"}),await w.from("group_live_locations").upsert({user_id:e,group_id:t,lat:l,long:u,updated_at:new Date().toISOString()})}catch{}};o();const a=setInterval(o,15e3);return()=>clearInterval(a)},[t,e]),d.useEffect(()=>{if(!t)return;w.from("group_live_locations").select("user_id, lat, long").eq("group_id",t).then(({data:a})=>{if(a){const c={};a.forEach(l=>{c[l.user_id]={lat:l.lat,long:l.long}}),n(c)}});const o=w.channel(`presence:${t}`).on("postgres_changes",{event:"*",schema:"public",table:"group_live_locations",filter:`group_id=eq.${t}`},a=>{const c=a.new;c&&c.user_id&&n(l=>({...l,[c.user_id]:{lat:c.lat,long:c.long}}))}).subscribe();return()=>{w.removeChannel(o)}},[t]);function i(o){if(!e||!s[e]||!s[o]||o===e)return!1;const a=s[e],c=s[o];return mh(a.lat,a.long,c.lat,c.long)<.05}return{isTogether:i}}function mh(t,e,s,n){const o=yn(s-t),a=yn(n-e),c=Math.sin(o/2)*Math.sin(o/2)+Math.cos(yn(t))*Math.cos(yn(s))*Math.sin(a/2)*Math.sin(a/2);return 6371*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))}function yn(t){return t*(Math.PI/180)}const ph=d.lazy(()=>Fn(()=>import("./ChatPanel-CXNAhs57.js"),__vite__mapDeps([3,1,2])));function gh(){const{id:t=""}=an(),e=pt(),s=Et(),[n,i]=d.useState(null),[o,a]=d.useState(!0),[c,l]=d.useState(null),[u,h]=d.useState(null),{isTogether:f}=fh(t,u??void 0),[m,g]=d.useState(!1),x=!!(u&&n&&(u===n.host_id||(n?.creator_id??null)===u)),[v,y]=d.useState(!1),[j,A]=d.useState(!1),[E,M]=d.useState(!1),[_,$]=d.useState(!1),[S,C]=d.useState(null),[R,q]=d.useState(!1),[Q,U]=d.useState(!1),[P,T]=d.useState(""),[N,F]=d.useState(!1),[D,I]=d.useState(!1),[z,b]=d.useState(!1),[L,H]=d.useState(null),[ce,G]=d.useState([]),[se,X]=d.useState({}),[J,Se]=d.useState(0),[Rt,fe]=d.useState(0),[gt,$e]=d.useState(null),[Be,Ce]=d.useState([]),[Ze,Fe]=d.useState(!1),[xt,Ms]=d.useState("Schedule"),[ts,ss]=d.useState(""),[ye,Dt]=d.useState("24h"),[nt,Lt]=d.useState(""),Ot=d.useMemo(()=>L?.closes_at?new Date(L.closes_at)<new Date:!1,[L]);function hn(O,te){if(O==="closed")return"Voting Closed";if(!te)return"Open";const ne=new Date(te).getTime()-Date.now();if(ne<=0)return"Time Expired";const we=Math.floor(ne/(1e3*60*60*24)),oe=Math.floor(ne%(1e3*60*60*24)/(1e3*60*60)),Ue=Math.floor(ne%(1e3*60*60)/(1e3*60));return we>0?`${we}d ${oe}h left`:oe>0?`${oe}h ${Ue}m left`:`${Ue}m left`}d.useEffect(()=>{s.hash==="#chat"&&y(!0)},[s.hash]),d.useEffect(()=>{let O=!1;return(async()=>{a(!0);const{data:te}=await w.auth.getUser();O||h(te.user?.id??null);const ne=await w.from("groups").select("*").eq("id",t).maybeSingle();if(O||i(ne.data??null),ne.data&&T(ne.data.description||""),ne.data?.id){const{count:we}=await w.from("group_members").select("*",{count:"exact",head:!0}).eq("group_id",ne.data.id).eq("status","active");O||Se(we??0)}a(!1)})(),()=>{O=!0}},[t]),d.useEffect(()=>{let O=!1;return(async()=>{if(!n?.id){Ce([]);return}const{data:te}=await w.from("group_members").select("user_id, role, created_at, status, group_id, profiles(name, avatar_url)").eq("group_id",n.id).eq("status","active").order("created_at",{ascending:!0}),ne=(te??[]).map(oe=>({user_id:oe.user_id,role:oe.user_id===n.host_id?"host":oe.role,created_at:oe.created_at,group_id:n.id,status:oe.status??"active",name:oe.profiles?.name??"User",avatar_url:oe.profiles?.avatar_url??null}));if(O)return;Ce(ne);const we=(await w.auth.getUser()).data.user?.id||null;we&&Fe(ne.some(oe=>oe.user_id===we))})(),()=>{O=!0}},[n?.id]),d.useEffect(()=>{let O=!1;return(async()=>{if(!n?.id)return;const{data:te}=await w.from("group_polls").select("*").eq("group_id",n.id).order("created_at",{ascending:!1}).limit(1);if(O)return;const ne=te&&te[0];if(H(ne||null),!ne){G([]),X({}),fe(0);return}const{data:we}=await w.from("group_poll_options").select("*").eq("poll_id",ne.id).order("created_at");if(O)return;G(we||[]);const{data:oe}=await w.from("group_votes").select("option_id,user_id").eq("poll_id",ne.id);if(O)return;const Ue={},Ke=new Set;oe?.forEach(Ve=>{Ue[Ve.option_id]=(Ue[Ve.option_id]||0)+1,Ke.add(Ve.user_id)}),X(Ue),fe(Ke.size)})(),()=>{O=!0}},[n?.id]);async function ns(){l(null);const{data:O}=await w.auth.getUser();if(!O.user){l("Please sign in.");return}await w.from("group_members").upsert({group_id:t,user_id:O.user.id,role:"member",status:"active"},{onConflict:"group_id,user_id"}),Fe(!0),Se(te=>te+1)}async function fn(){if(l(null),!(!n||!u)){if(u===n.host_id){l("Host cannot leave their own group.");return}await w.from("group_members").delete().match({group_id:n.id,user_id:u}),Fe(!1),Se(O=>Math.max(0,O-1))}}async function k(){n?.code&&(navigator.clipboard.writeText(n.code),g(!0),setTimeout(()=>g(!1),1500))}async function W(){if(l(null),!!n?.id){I(!0);try{const{data:O,error:te}=await w.rpc("make_group_invite",{p_group_id:n.id,p_hours:168,p_max_uses:null});if(te)throw te;const ne=`${window.location.origin}/invite/${O}`;await navigator.clipboard.writeText(ne),b(!0),setTimeout(()=>b(!1),1500)}catch(O){l(O.message)}finally{I(!1)}}}async function Y(){!n||!u||window.confirm("Delete this group?")&&(await w.from("groups").delete().match({id:n.id,host_id:u}),e("/browse"))}async function ue(){if(l(null),!(!n||!x)){F(!0);try{const{error:O}=await w.from("groups").update({description:P}).eq("id",n.id);if(O)throw O;i(te=>te?{...te,description:P}:null),U(!1)}catch(O){l(O.message||"Failed to save description")}finally{F(!1)}}}async function ge(){if(l(null),!n||!x)return;const{data:O}=await w.auth.getUser();if(!O?.user)return;let te=null;if(ye==="custom")nt&&(te=new Date(nt).toISOString());else{const Ve=new Date,rs=parseInt(ye);Ve.setTime(Ve.getTime()+rs*60*60*1e3),te=Ve.toISOString()}const ne=(ts||"").split(/\r?\n/).map(Ve=>Ve.trim()).filter(Boolean).slice(0,20);ne.some(Ve=>Ve.toLowerCase()==="not coming")||ne.push("Not Coming");const{data:we,error:oe}=await w.from("group_polls").insert({group_id:n.id,title:(xt||"Schedule").trim(),created_by:O.user.id,closes_at:te,status:"open"}).select("id").single();if(oe||!we?.id){console.error("Poll create error:",oe),l(oe?.message||"Failed to create poll. Check permissions.");return}let Ue=!1,Ke=[];if(ne.length){const Ve=ne.map(Gn=>({poll_id:we.id,label:Gn})),{data:rs,error:mn}=await w.from("group_poll_options").insert(Ve).select("*").order("created_at");mn?(console.error("Option create error:",mn),l("Poll created but failed to add options."),Ue=!0):Ke=rs??[]}M(!1),Ue||l(null),H({id:we.id,group_id:n.id,title:xt,status:"open",closes_at:te,created_by:O.user.id}),G(Ke),X({}),fe(0)}async function Ee(){if(l(null),!(!L||!x)&&window.confirm("End voting? Everyone who hasn't voted will be marked as 'Not Coming'.")){$e("closing");try{await w.rpc("resolve_poll",{p_poll_id:L.id}),H(O=>O&&{...O,status:"closed"})}catch(O){l(O.message)}finally{$e(null)}}}async function he(){if(l(null),!L||!window.confirm("Delete this voting?"))return;const{error:O}=await w.from("group_polls").delete().eq("id",L.id);O?(l("Could not delete. Check database permissions."),console.error(O)):H(null)}async function De(O){if(!L||Ot||L.status==="closed")return;$e(O);const{data:te}=await w.auth.getUser();if(!te?.user){e("/login");return}const{error:ne}=await w.from("group_votes").upsert({poll_id:L.id,option_id:O,user_id:te.user.id},{onConflict:"poll_id,user_id"});if(ne){console.error(ne),l("Failed to save vote"),$e(null);return}const{data:we}=await w.from("group_votes").select("option_id,user_id").eq("poll_id",L.id),oe={},Ue=new Set;we?.forEach(Ke=>{oe[Ke.option_id]=(oe[Ke.option_id]||0)+1,Ue.add(Ke.user_id)}),X(oe),fe(Ue.size),$e(null)}return o?r.jsx("div",{className:"p-20 flex justify-center",children:r.jsx("div",{className:"animate-spin h-8 w-8 border-2 border-neutral-300 border-t-black rounded-full"})}):n?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"transition-all duration-300 min-h-screen bg-[#FDFBF7] pb-24 "+(v&&!j?"lg:mr-[min(92vw,520px)]":""),children:[r.jsxs("div",{className:"bg-white border-b border-neutral-200 pt-8 pb-6 px-4 shadow-sm relative overflow-hidden",children:[r.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-gradient-to-br from-emerald-50 to-blue-50 rounded-full blur-3xl -z-10 opacity-60"}),r.jsxs("div",{className:"mx-auto max-w-5xl",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-4 text-sm text-neutral-500",children:[r.jsxs(me,{to:"/browse",className:"flex items-center gap-1 hover:text-black transition-colors",children:[r.jsx(td,{className:"h-4 w-4"})," Browse"]}),r.jsx("span",{children:"/"}),r.jsx("span",{className:"font-medium text-neutral-800",children:"Group Detail"})]}),r.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-6",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("h1",{className:"text-3xl md:text-4xl font-extrabold text-neutral-900 tracking-tight leading-tight mb-3",children:n.title}),r.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[r.jsx("div",{className:"inline-flex items-center gap-1.5 bg-neutral-100 text-neutral-700 px-3 py-1 rounded-full text-xs font-semibold uppercase tracking-wide",children:n.category||"General"}),n.game&&r.jsx("div",{className:"inline-flex items-center gap-1.5 bg-indigo-50 text-indigo-700 px-3 py-1 rounded-full text-xs font-bold",children:n.game}),n.city&&r.jsxs("div",{className:"inline-flex items-center gap-1.5 border border-neutral-200 text-neutral-600 px-3 py-1 rounded-full text-xs font-medium",children:[r.jsx(Ws,{className:"h-3 w-3"})," ",n.city]}),n.code&&r.jsx("button",{type:"button",onClick:k,className:"inline-flex items-center gap-1.5 bg-neutral-900 text-white px-3 py-1 rounded-full text-xs font-mono cursor-pointer hover:bg-neutral-800 active:scale-95 transition-transform",title:m?"Copied":"Click to copy invite code",children:String(n.code).toUpperCase()}),r.jsxs("div",{className:"inline-flex items-center gap-1.5 border border-neutral-200 text-neutral-600 px-3 py-1 rounded-full text-xs font-medium",children:[r.jsx(Ps,{className:"h-3 w-3"})," ",J," / ",n.capacity]})]})]}),r.jsx("div",{className:"flex flex-wrap items-center gap-3",children:Ze?r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:()=>y(!0),className:"h-10 px-5 rounded-full bg-white border border-neutral-200 text-neutral-800 text-sm font-bold shadow-sm hover:bg-neutral-50 hover:border-neutral-300 flex items-center gap-2 transition-all",children:[r.jsx(rl,{className:"h-4 w-4"})," Chat"]}),x&&r.jsxs("button",{onClick:W,className:"h-10 px-5 rounded-full bg-white border border-neutral-200 text-neutral-800 text-sm font-bold shadow-sm hover:bg-neutral-50 hover:border-neutral-300 flex items-center gap-2 transition-all",children:[r.jsx(Ad,{className:"h-4 w-4"})," ",D?"...":z?"Copied":"Invite"]})]}):r.jsx("button",{onClick:ns,className:"h-10 px-6 rounded-full bg-emerald-600 text-white text-sm font-bold shadow-md hover:bg-emerald-700 hover:shadow-lg active:scale-95 transition-all",children:"Join Group"})})]})]})]}),c&&!E&&r.jsx("div",{className:"mx-auto max-w-5xl px-4 mt-4",children:r.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl text-sm font-bold flex items-center gap-2 shadow-sm animate-in fade-in slide-in-from-top-2",children:[r.jsx(na,{className:"h-4 w-4"}),c,r.jsx("button",{onClick:()=>l(null),className:"ml-auto hover:bg-red-100 p-1 rounded-full",children:r.jsx(Nn,{className:"h-3 w-3"})})]})}),r.jsxs("div",{className:"mx-auto max-w-5xl px-4 py-8 grid gap-8 lg:grid-cols-[2fr_1fr]",children:[r.jsxs("div",{className:"space-y-8",children:[r.jsxs("section",{className:"bg-white rounded-2xl p-6 shadow-sm border border-neutral-200/60 relative",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("h2",{className:"text-lg font-bold text-neutral-900 flex items-center gap-2",children:"About this Circle"}),x&&!Q&&r.jsx("button",{onClick:()=>U(!0),className:"p-1.5 rounded-full text-neutral-400 hover:bg-neutral-100 hover:text-neutral-900 transition-colors",children:r.jsx(Sd,{className:"h-4 w-4"})})]}),Q?r.jsxs("div",{className:"animate-in fade-in duration-200",children:[r.jsx("textarea",{value:P,onChange:O=>T(O.target.value),className:"w-full min-h-[120px] p-3 rounded-xl border border-neutral-300 text-sm focus:ring-2 focus:ring-emerald-500 focus:border-transparent outline-none resize-y mb-3",placeholder:"What's the plan?"}),r.jsxs("div",{className:"flex gap-2 justify-end",children:[r.jsx("button",{onClick:()=>U(!1),className:"px-3 py-1.5 rounded-lg border border-neutral-200 text-xs font-bold hover:bg-neutral-50 text-neutral-600",children:"Cancel"}),r.jsx("button",{onClick:ue,disabled:N,className:"px-3 py-1.5 rounded-lg bg-black text-white text-xs font-bold hover:bg-neutral-800 disabled:opacity-50",children:N?"Saving...":"Save Changes"})]})]}):r.jsx("p",{className:"text-sm text-neutral-600 leading-relaxed whitespace-pre-wrap",children:n.description||r.jsx("span",{className:"italic text-neutral-400",children:"No description provided."})})]}),r.jsxs("section",{className:"grid sm:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-neutral-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center gap-2 text-neutral-400 text-xs font-bold uppercase mb-1",children:[r.jsx(tl,{className:"h-3 w-3"})," Created"]}),r.jsx("div",{className:"text-sm font-semibold text-neutral-900",children:new Date(n.created_at).toLocaleDateString()})]}),r.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-neutral-200/60 shadow-sm",children:[r.jsxs("div",{className:"flex items-center gap-2 text-neutral-400 text-xs font-bold uppercase mb-1",children:[r.jsx(Hr,{className:"h-3 w-3"})," Format"]}),r.jsx("div",{className:"text-sm font-semibold text-neutral-900",children:n.is_online?n.online_link?"Online (Link set)":"Online":"In Person"})]})]}),Ze&&x&&r.jsxs("button",{onClick:Y,className:"flex items-center gap-2 text-red-600 text-sm font-medium hover:text-red-700 transition-colors px-2",children:[r.jsx(Ld,{className:"h-4 w-4"})," Delete this group"]}),Ze&&!x&&r.jsxs("button",{onClick:fn,className:"flex items-center gap-2 text-neutral-500 text-sm font-medium hover:text-neutral-800 transition-colors px-2",children:[r.jsx(xd,{className:"h-4 w-4"})," Leave group"]})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-white border border-neutral-200 rounded-2xl p-5 shadow-sm",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-base font-bold text-neutral-900 flex items-center gap-2",children:"Polls & Events"}),x&&r.jsx("button",{onClick:()=>{l(null),M(!0)},className:"p-1.5 bg-neutral-50 rounded-full text-neutral-600 shadow-sm hover:scale-105 active:scale-95 transition-all border border-neutral-200 hover:bg-white hover:border-neutral-300",children:r.jsx(Sr,{className:"h-4 w-4"})})]}),L?r.jsxs("div",{className:"animate-in slide-in-from-bottom-2 duration-500",children:[r.jsxs("div",{className:"flex justify-between items-start mb-3",children:[r.jsx("h3",{className:"font-bold text-neutral-900",children:L.title}),r.jsx("div",{className:`text-[10px] font-bold px-2 py-1 rounded-full border ${L.status==="closed"?"bg-neutral-200 text-neutral-600 border-neutral-300":Ot?"bg-red-50 text-red-600 border-red-100":"bg-emerald-50 text-emerald-700 border-emerald-100"}`,children:hn(L.status,L.closes_at)})]}),r.jsx("div",{className:"space-y-2 mb-4",children:ce.map(O=>{const te=se[O.id]??0,we=O.label==="Not Coming"?te+(J-Rt):te,oe=J>0?Math.round(we/J*100):0;return r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute inset-0 bg-neutral-100 rounded-lg transition-all duration-500",style:{width:`${oe}%`}}),r.jsxs("div",{className:"relative flex items-center justify-between p-2.5 rounded-lg border border-neutral-100 hover:border-neutral-200 transition-colors",children:[r.jsx("span",{className:"text-sm font-medium text-neutral-800 z-10",children:O.label}),r.jsxs("div",{className:"flex items-center gap-3 z-10",children:[r.jsx("span",{className:"text-xs font-bold text-neutral-600",children:we}),L.status==="open"&&!Ot&&r.jsx("button",{onClick:()=>De(O.id),className:`h-6 w-6 rounded-full flex items-center justify-center border transition-all hover:scale-110 active:scale-95 ${gt===O.id?"bg-black border-black text-white":"bg-white border-neutral-200 text-neutral-600"}`,children:gt===O.id?r.jsx("div",{className:"animate-spin h-3 w-3 border-2 border-white border-t-transparent rounded-full"}):r.jsx(sa,{className:"h-3 w-3"})})]})]})]},O.id)})}),x&&r.jsxs("div",{className:"flex flex-col gap-2 pt-3 border-t border-neutral-100",children:[L.status==="open"&&r.jsxs("button",{onClick:Ee,className:"w-full bg-black text-white text-xs font-bold py-3 rounded-xl hover:bg-neutral-800 shadow-sm flex items-center justify-center gap-2",children:[r.jsx(sa,{className:"h-4 w-4"})," End & Count Games"]}),L.status==="closed"&&r.jsxs("button",{onClick:()=>{l(null),M(!0)},className:"w-full bg-neutral-100 text-neutral-700 text-xs font-bold py-3 rounded-xl hover:bg-neutral-200 flex items-center justify-center gap-2",children:[r.jsx(Sr,{className:"h-4 w-4"})," Create New Vote"]}),r.jsx("button",{onClick:he,className:"w-full text-red-600 text-xs font-bold py-2 hover:bg-red-50 rounded-xl",children:"Delete Poll"})]})]}):r.jsxs("div",{className:"text-center py-8 px-4 bg-neutral-50 rounded-xl border border-dashed border-neutral-200",children:[r.jsx("p",{className:"text-sm text-neutral-400 mb-2 font-medium",children:"No active polls"}),x&&r.jsx("button",{onClick:()=>{l(null),M(!0)},className:"text-xs text-black font-bold hover:underline",children:"Create one"})]})]}),r.jsxs("div",{className:"bg-white border border-neutral-200 rounded-2xl p-5 shadow-sm",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsxs("h2",{className:"text-sm font-bold text-neutral-900",children:["Members (",J,")"]}),r.jsx("button",{onClick:()=>$(!0),className:"text-xs font-medium text-emerald-600 hover:underline",children:"View All"})]}),r.jsxs("div",{className:"flex -space-x-2 overflow-hidden cursor-pointer",onClick:()=>$(!0),children:[Be.slice(0,5).map(O=>r.jsx("div",{className:"h-8 w-8 rounded-full ring-2 ring-white bg-neutral-100 flex items-center justify-center text-[10px] font-bold text-neutral-500",title:O.name||"User",children:O.avatar_url?r.jsx("img",{src:O.avatar_url,alt:"",className:"h-full w-full object-cover rounded-full"}):(O.name||"?").slice(0,1)},O.user_id)),J>5&&r.jsxs("div",{className:"h-8 w-8 rounded-full ring-2 ring-white bg-neutral-50 flex items-center justify-center text-[10px] font-bold text-neutral-400",children:["+",J-5]})]})]})]})]})]}),E&&r.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:r.jsxs("div",{className:"w-full max-w-md bg-white rounded-2xl p-6 shadow-2xl ring-1 ring-black/5",children:[r.jsxs("div",{className:"flex justify-between items-center mb-5",children:[r.jsx("h3",{className:"text-xl font-bold text-neutral-900",children:"New Vote"}),r.jsx("button",{onClick:()=>M(!1),className:"p-1 rounded-full hover:bg-neutral-100 text-neutral-500",children:r.jsx(Nn,{className:"h-5 w-5"})})]}),c&&r.jsxs("div",{className:"mb-4 p-3 bg-red-50 text-red-600 rounded-xl text-sm font-bold border border-red-100 flex items-center gap-2 animate-in slide-in-from-top-1",children:[r.jsx(na,{className:"h-4 w-4 shrink-0"}),r.jsx("span",{children:c})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-neutral-400 uppercase mb-1.5",children:"Topic"}),r.jsx("input",{value:xt,onChange:O=>Ms(O.target.value),className:"w-full border border-neutral-200 rounded-xl px-4 py-3 text-sm font-medium focus:ring-2 focus:ring-black outline-none transition-all",placeholder:"e.g. When to play?"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-neutral-400 uppercase mb-1.5",children:"Duration"}),r.jsxs("div",{className:"flex gap-3",children:[r.jsxs("select",{value:ye,onChange:O=>Dt(O.target.value),className:"border border-neutral-200 bg-neutral-50 rounded-xl px-4 py-3 text-sm font-medium flex-1 outline-none focus:ring-2 focus:ring-black",children:[r.jsx("option",{value:"1",children:"1 Hour"}),r.jsx("option",{value:"24",children:"24 Hours"}),r.jsx("option",{value:"48",children:"2 Days"}),r.jsx("option",{value:"custom",children:"Custom..."})]}),ye==="custom"&&r.jsx("input",{type:"datetime-local",value:nt,onChange:O=>Lt(O.target.value),className:"border border-neutral-200 bg-neutral-50 rounded-xl px-3 py-3 text-sm font-medium flex-[1.5] outline-none focus:ring-2 focus:ring-black"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-neutral-400 uppercase mb-1.5",children:"Options (one per line)"}),r.jsx("textarea",{value:ts,onChange:O=>ss(O.target.value),className:"w-full border border-neutral-200 rounded-xl px-4 py-3 text-sm font-medium focus:ring-2 focus:ring-black outline-none min-h-[100px]",placeholder:`Saturday 20:00
Sunday 14:00`}),r.jsx("p",{className:"text-[10px] text-neutral-400 mt-1 italic text-right",children:'"Not Coming" added automatically.'})]}),r.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[r.jsx("button",{onClick:()=>M(!1),className:"px-5 py-2.5 text-sm font-bold text-neutral-500 hover:bg-neutral-50 rounded-xl transition-colors",children:"Cancel"}),r.jsx("button",{onClick:ge,className:"px-6 py-2.5 text-sm font-bold bg-black text-white rounded-xl shadow-lg hover:bg-neutral-800 active:scale-95 transition-all",children:"Create Vote"})]})]})]})}),_&&r.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:r.jsxs("div",{className:"w-full max-w-sm bg-white rounded-3xl p-6 shadow-2xl overflow-hidden flex flex-col max-h-[80vh]",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4 shrink-0",children:[r.jsxs("h3",{className:"text-xl font-bold text-neutral-900",children:["Members (",Be.length,")"]}),r.jsx("button",{onClick:()=>$(!1),className:"p-1 rounded-full hover:bg-neutral-100 text-neutral-500",children:r.jsx(Nn,{className:"h-5 w-5"})})]}),r.jsx("div",{className:"flex-1 overflow-y-auto pr-2 space-y-2",children:Be.map(O=>r.jsx("div",{onClick:()=>{C(O.user_id),q(!0)},className:"flex items-center justify-between p-2 rounded-xl hover:bg-neutral-50 transition-colors cursor-pointer",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-10 w-10 rounded-full bg-neutral-200 flex items-center justify-center overflow-hidden",children:O.avatar_url?r.jsx("img",{src:O.avatar_url,className:"w-full h-full object-cover"}):r.jsx("span",{className:"text-sm font-bold text-neutral-500",children:(O.name||"?").slice(0,1)})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-bold text-neutral-900",children:O.name||"User"}),f(O.user_id)?r.jsxs("div",{className:"flex items-center gap-1 mt-0.5 animate-in fade-in slide-in-from-left-1",children:[r.jsxs("span",{className:"relative flex h-2 w-2",children:[r.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"}),r.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-emerald-500"})]}),r.jsx("span",{className:"text-[10px] font-bold text-emerald-600",children:"Here with you"})]}):r.jsxs(r.Fragment,{children:[O.role==="host"&&r.jsx("div",{className:"text-[10px] text-amber-600 font-bold uppercase tracking-wide",children:"Host"}),O.role==="owner"&&r.jsx("div",{className:"text-[10px] text-amber-600 font-bold uppercase tracking-wide",children:"Owner"}),O.role!=="host"&&O.role!=="owner"&&r.jsx("div",{className:"text-xs text-neutral-500 capitalize",children:O.role})]})]})]})},O.user_id))})]})}),r.jsx(Wr,{isOpen:R,onClose:()=>q(!1),viewUserId:S}),v&&n&&r.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center p-4 animate-in zoom-in-95 duration-200",children:[r.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>y(!1)}),r.jsx("div",{className:"relative w-full max-w-2xl h-[85vh] bg-white rounded-3xl shadow-2xl overflow-hidden ring-1 ring-black/10",children:r.jsx(d.Suspense,{fallback:r.jsx("div",{className:"flex h-full items-center justify-center",children:"Loading..."}),children:r.jsx(ph,{groupId:n.id,onClose:()=>{y(!1),A(!1)},full:!0,setFull:()=>{}})})})]})]}):r.jsx("div",{className:"p-10 text-center",children:"Group not found."})}const Wn=12,xh=new Set(["games","study","outdoors"]);function yh({category:t,search:e}){const{user:s}=Es(),n=s?.id||null,[i,o]=d.useState([]),[a,c]=d.useState(!1),[l,u]=d.useState(null),[h,f]=d.useState(0),[m,g]=d.useState(!1),[x,v]=d.useState(!1),[y,j]=d.useState({}),[A,E]=d.useState({}),[M,_]=d.useState({}),$=!0,S=!0;d.useEffect(()=>{let U=!0;return(async()=>{const{data:P,error:T}=await w.from("allowed_games").select("id, category").eq("is_active",!0);if(!U)return;if(T){_({});return}const N={};(P??[]).forEach(F=>{const D=String(F.category||"").toLowerCase(),I=String(F.id||"").toLowerCase();!D||!I||(N[D]||(N[D]=[]),N[D].push(I))}),_(N)})(),()=>{U=!1}},[]);const C=d.useCallback(async U=>{try{if(!n||!U.length)return;const{data:P,error:T}=await w.from("group_reads").select("group_id,last_read_at").eq("user_id",n).in("group_id",U);if(T)throw T;const N={};(P??[]).forEach(z=>{N[z.group_id]=z.last_read_at??null});const F=U.map(async z=>{const b=N[z]??"1970-01-01T00:00:00Z",{count:L,error:H}=await w.from("group_messages").select("id",{count:"exact",head:!0}).eq("group_id",z).gt("created_at",b);return H?[z,0]:[z,L??0]}),D=await Promise.all(F),I={};D.forEach(([z,b])=>{I[z]=b}),E(z=>({...z,...I}))}catch{}},[n]),R=d.useCallback(async U=>{if(n)try{await w.rpc("mark_group_read",{p_group_id:U}),E(P=>({...P,[U]:0})),await w.from("notifications").update({is_read:!0}).eq("user_id",n).eq("payload->>group_id",U).eq("is_read",!1)}catch(P){console.warn("[markGroupRead]",P)}},[n]);d.useEffect(()=>{if(!n)return;const U=w.channel(`reads:${n}`).on("postgres_changes",{event:"*",schema:"public",table:"group_reads",filter:`user_id=eq.${n}`},async P=>{const T=P.new?.group_id||P.old?.group_id;T&&await C([T])}).subscribe();return()=>{w.removeChannel(U)}},[n,C]),d.useEffect(()=>{if(!n)return;const U=()=>{const N=i.map(F=>F.id);N.length&&C(N)};window.addEventListener("focus",U);const P=()=>{document.visibilityState==="visible"&&U()};document.addEventListener("visibilitychange",P);const T=window.setInterval(U,2e4);return()=>{window.removeEventListener("focus",U),document.removeEventListener("visibilitychange",P),window.clearInterval(T)}},[n,i,C]);const q=d.useCallback(async(U,P)=>{try{if(P?(c(!0),o([]),f(0),g(!1)):v(!0),u(null),($||S)&&!n){o([]),u("Please sign in to view your groups."),c(!1),v(!1);return}if(!n){o([]),u("Please sign in to view your groups."),c(!1),v(!1);return}let T=[];const N=U*Wn,F=N+Wn-1,[D,I]=await Promise.all([w.from("group_members").select("group_id").eq("user_id",n),w.from("groups").select("id").eq("host_id",n)]);if(D.error)throw D.error;if(I.error)throw I.error;const z=(D.data??[]).map(G=>G.group_id),b=(I.data??[]).map(G=>G.id),L=new Set([...z,...b]),H=Array.from(L),ce=G=>{let se=G;const X=t?t.toLowerCase():"";if(X)if(xh.has(X)){const J=M[X]??[];if(J.length>0){const Se=J.join(",");se=se.or(`game.in.(${Se}),category.eq.${X}`)}else se=se.eq("category",X)}else{const J=X.replace(/[^a-z0-9]+/g,"");se=se.or(`game.eq.${J},game.ilike.*${X}*,title.ilike.*${X}*`)}if(e.trim()){const J=e.trim();se=se.or(`title.ilike.*${J}*,game.ilike.*${J}*`)}return se};if(H.length>0){let G=w.from("groups").select("id, title, description, city, capacity, category, game, created_at, host_id").in("id",H).order("created_at",{ascending:!1}).range(N,F);const{data:se,error:X}=await ce(G);if(X)throw X;T=se??[]}else T=[];if(o(P?T:G=>[...G,...T]),f(U),g(T.length===Wn),(T??[]).length>0){const G=T.map(J=>J.id);n&&G.length>0&&await C(G);const{data:se}=await w.from("group_polls").select("group_id").in("group_id",G).eq("status","open"),X={};(se??[]).forEach(J=>{X[J.group_id]=!0}),j(J=>({...J,...X}))}}catch(T){u(T?.message??"Failed to load groups")}finally{c(!1),v(!1)}},[n,t,e,M,C]);d.useEffect(()=>{n&&q(0,!0)},[n,t,e,M,q]);const Q=d.useCallback(async()=>{if(!n||x)return;const U=h+1;await q(U,!1)},[n,h,x,q]);return{me:n,groups:i,loading:a,err:l,hasMore:m,paging:x,unreadCounts:A,openPolls:y,loadMore:Q,markGroupRead:R}}function vh(t){if(!t)return"";try{return new Date(t).toLocaleDateString()}catch{return""}}function bh(){const t=Et();return d.useMemo(()=>new URLSearchParams(t.search),[t.search])}function wh(){const t=bh(),e=t.get("category")||"",s=t.get("q")||"",{me:n,groups:i,loading:o,err:a,hasMore:c,paging:l,unreadCounts:u,openPolls:h,loadMore:f,markGroupRead:m}=yh({category:e,search:s});return r.jsxs("main",{className:"mx-auto max-w-5xl px-4 py-8",children:[r.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-semibold",children:"My Groups"}),s&&r.jsxs("p",{className:"text-sm text-neutral-600",children:["Filtered by: â€œ",s,"â€"]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(me,{to:"/browse",className:"text-sm underline",children:"Back"}),r.jsx(me,{to:"/create",className:"rounded-md bg-emerald-700 px-3 py-1.5 text-sm text-white hover:brightness-110",children:"New Group"})]})]}),r.jsx("div",{className:"mt-6 rounded-2xl border border-black/10 bg-white/90 p-5 shadow-sm backdrop-blur",children:o&&i.length===0?r.jsx("ul",{className:"divide-y divide-black/5",children:Array.from({length:6}).map((x,v)=>r.jsxs("li",{className:"rounded-xl border border-black/10 bg-white p-4 shadow-sm",children:[r.jsx("div",{className:"h-5 w-48 animate-pulse rounded bg-neutral-200"}),r.jsx("div",{className:"mt-2 h-3 w-5/6 animate-pulse rounded bg-neutral-200"}),r.jsx("div",{className:"mt-1 h-3 w-2/3 animate-pulse rounded bg-neutral-200"}),r.jsxs("div",{className:"mt-4 flex gap-2",children:[r.jsx("div",{className:"h-8 w-24 animate-pulse rounded bg-neutral-200"}),r.jsx("div",{className:"h-8 w-28 animate-pulse rounded bg-neutral-200"})]})]},v))}):a?r.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 p-4 text-red-800",children:a}):i.length===0?r.jsxs("div",{className:"flex flex-col items-center justify-center gap-3 p-10 text-center text-neutral-600",children:[r.jsxs("svg",{width:"36",height:"36",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"opacity-70",children:[r.jsx("path",{d:"M8 21h8"}),r.jsx("path",{d:"M12 17v4"}),r.jsx("path",{d:"M7 3h10l4 7H3l4-7Z"})]}),r.jsx("div",{className:"text-lg font-medium",children:"No groups found"}),r.jsx("div",{className:"text-sm",children:"Try a different filter or create a new one."}),r.jsxs("div",{className:"mt-2 flex justify-center gap-2",children:[r.jsx(me,{to:"/browse",className:"rounded-md border border-black/10 bg-white px-3 py-1.5 text-sm hover:bg-black/[0.04]",children:"Back"}),r.jsx(me,{to:"/create",className:"rounded-md bg-emerald-700 px-3 py-1.5 text-sm text-white hover:brightness-110",children:"New Group"})]})]}):r.jsxs(r.Fragment,{children:[r.jsx("ul",{className:"divide-y divide-black/5",children:i.map(x=>r.jsx("li",{className:"group py-1 first:pt-0 last:pb-0",children:r.jsx("div",{className:"flex items-center",children:r.jsx(me,{to:`/group/${x.id}`,onClick:()=>m(x.id),className:"block flex-1 rounded-lg px-2 py-2 hover:bg-black/[0.03] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-500 focus-visible:ring-offset-2",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"flex h-9 w-9 select-none items-center justify-center rounded-full border border-black/10 bg-neutral-100 text-sm font-semibold text-neutral-700",children:(x.title||x.game||"G").slice(0,1).toUpperCase()}),r.jsxs("div",{className:"min-w-0 flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"truncate text-base font-medium text-neutral-900",children:x.title??"Untitled group"}),x.host_id&&x.host_id===n&&r.jsx("span",{className:"shrink-0 rounded-full border border-amber-300 bg-amber-50 px-2 py-0.5 text-[11px] text-amber-800",children:"Host"})]}),r.jsx("div",{className:"mt-0.5 line-clamp-1 text-xs text-neutral-600",children:x.description??"No description"}),r.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-1 text-[11px] text-neutral-700",children:[x.category&&r.jsxs("span",{className:"rounded-full border border-black/10 bg-neutral-50 px-2 py-0.5",children:["#",x.category]}),x.game&&r.jsx("span",{className:"rounded-full border border-black/10 bg-neutral-50 px-2 py-0.5",children:x.game}),x.city&&r.jsx("span",{className:"rounded-full border border-black/10 bg-neutral-50 px-2 py-0.5",children:x.city}),x.capacity&&r.jsxs("span",{className:"rounded-full border border-black/10 bg-neutral-50 px-2 py-0.5",children:[x.capacity," slots"]}),x.created_at&&r.jsx("span",{className:"rounded-full border border-black/10 bg-neutral-50 px-2 py-0.5",children:vh(x.created_at)})]})]}),r.jsxs("div",{className:"ml-1 flex items-center gap-1",children:[h[x.id]&&r.jsx("span",{className:"inline-flex h-6 items-center justify-center rounded-full bg-blue-600 px-2 text-xs font-semibold text-white",title:"Open voting","aria-label":"Open voting",children:"Vote"}),typeof u[x.id]=="number"&&u[x.id]>0&&r.jsx("span",{className:"inline-flex h-6 min-w-[1.5rem] items-center justify-center rounded-full bg-emerald-600 px-1 text-xs font-semibold text-white",title:`${u[x.id]} new messages`,"aria-label":`${u[x.id]} new messages`,children:u[x.id]>99?"99+":u[x.id]})]})]})})})},x.id))}),c&&r.jsx("div",{className:"mt-5 border-t border-black/5 p-4 text-center",children:r.jsx("button",{onClick:f,className:"inline-flex items-center gap-2 rounded-md border border-black/10 bg-white px-3 py-1.5 text-sm hover:bg-black/[0.04]",disabled:l,children:l?r.jsxs(r.Fragment,{children:[r.jsxs("svg",{className:"h-4 w-4 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),"Loadingâ€¦"]}):r.jsx(r.Fragment,{children:"Load more"})})})]})})]})}const jh=t=>console.log("[ok]",t),Nh=t=>console.error("[err]",t);function Sh(t){if(!t)return"â€”";const e=new Date(t);if(isNaN(e.getTime()))return"â€”";const s=Date.now(),n=Math.floor((s-e.getTime())/1e3);return n<5?"now":n<60?`${n}s`:n<3600?`${Math.floor(n/60)}m`:n<86400?`${Math.floor(n/3600)}h`:`${Math.floor(n/86400)}d`}function Ch(t,e){const s=(e??"").toString().trim();if(s)return s.toUpperCase();let n=2166136261;for(let o=0;o<t.length;o++)n^=t.charCodeAt(o),n+=(n<<1)+(n<<4)+(n<<7)+(n<<8)+(n<<24);return(n>>>0).toString(16).toUpperCase().padStart(8,"0").slice(-8)}const _h=(()=>{const{State:t,City:e}=window.countryStateCity||{State:null,City:null};if(!t||!e)return[];try{const s=t.getStatesOfCountry("DE")||[],n=[];for(const i of s){const o=e.getCitiesOfState("DE",i.isoCode)||[];for(const a of o)a&&typeof a.name=="string"&&a.name.trim()&&n.push(a.name.trim())}return Array.from(new Set(n)).sort((i,o)=>i.localeCompare(o,"de"))}catch(s){return console.warn("Could not load cities list",s),[]}})();function da(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone||"UTC"}catch{return"UTC"}}function ha(){const t=pt(),e=Et(),{userId:s}=an(),{user:n}=Es(),i=n?.id,{data:o,isLoading:a,error:c}=al(i??null);d.useEffect(()=>{o&&(Dt(o.groups_created||0),Lt(o.groups_joined||0))},[o]),d.useEffect(()=>{i&&(async()=>{const{count:V,error:K}=await w.from("groups").select("id",{count:"exact",head:!0}).or(`creator_id.eq.${i},host_id.eq.${i}`);if(K){console.warn("Failed to load created groups count",K);return}Dt(V??0)})()},[i]),d.useEffect(()=>{i&&(async()=>{const{count:V,error:K}=await w.from("group_members").select("group_id",{count:"exact",head:!0}).eq("user_id",i).in("status",["active","accepted"]);if(K){console.warn("Failed to load joined groups count",K);return}Lt(V??0)})()},[i]);const[l,u]=d.useState(!1),[h,f]=d.useState(!1),[m,g]=d.useState(!1),[x,v]=d.useState(!1),[y,j]=d.useState(!1),A=d.useRef(null),E=d.useRef(null),M=!!s&&s!==i,[_,$]=d.useState(""),[S,C]=d.useState(""),[R,q]=d.useState("UTC"),[Q,U]=d.useState(""),[P,T]=d.useState("system"),[N,F]=d.useState(!1),[D,I]=d.useState(!1),[z,b]=d.useState(!0),[L,H]=d.useState(null),[ce,G]=d.useState(!1),[se,X]=d.useState(!1),[J,Se]=d.useState([]),[Rt,fe]=d.useState(null),[gt,$e]=d.useState([]),[Be,Ce]=d.useState(!1),[Ze,Fe]=d.useState(null),[xt,Ms]=d.useState(""),[ts,ss]=d.useState(!1),[ye,Dt]=d.useState(0),[nt,Lt]=d.useState(0),[Ot,hn]=d.useState(0),[ns,fn]=d.useState([]),[k,W]=d.useState([]),[Y,ue]=d.useState([]),[ge,Ee]=d.useState("created"),[he,De]=d.useState([]),[O,te]=d.useState(new Map),[ne,we]=d.useState([]),[oe,Ue]=d.useState([]),[Ke,Ve]=d.useState([]),[rs,mn]=d.useState(null),[Gn,jx]=d.useState(""),[Vc,Nx]=d.useState(null),[Sx,Cx]=d.useState(!0),[Ic,_x]=d.useState(0),[qc,kx]=d.useState(0),[Px,Tx]=d.useState(0),[Ax,Ex]=d.useState(!1),[Mx,Rx]=d.useState(null),[is,Dx]=d.useState(null),[Ei,Lx]=d.useState(!1),[Ox,Fx]=d.useState("none"),[Vx,Ix]=d.useState(0),[qx,$x]=d.useState(0),[Bx,Rs]=d.useState(!1),[Ux,Gx]=d.useState(!1),[Mi,Ri]=d.useState(null),[zx,Hx]=d.useState(null),Di=M?Gn||(s?s.slice(0,6):""):o?.name||n?.email||"",Li=M?Vc:o?.avatar_url,Oi=M?Ic:o?.rating_avg,Fi=M?qc:o?.rating_count,Vi=(Di||"?").slice(0,2).toUpperCase()??"?";d.useMemo(()=>ne.length+oe.length+Ke.length,[ne,oe,Ke]),d.useMemo(()=>{const V=new Map;J.forEach(le=>V.set(le.other_id,le));const K=[...J];return he.map(le=>le.user_id_a===i?le.user_id_b:le.user_id_a).forEach(le=>{if(V.has(le)||!i)return;const _e=O.get(le);K.push({other_id:le,name:_e?.name&&_e.name.trim()?_e.name:le.slice(0,6),avatar_url:_e?.avatar_url??null,last_body:"",last_at:new Date(0).toISOString(),last_from_me:!1,unread:!1})}),K.sort((le,_e)=>_e.last_at>le.last_at?1:_e.last_at<le.last_at?-1:0),K},[J,he,O,i]),d.useMemo(()=>{if(ge==="created")return k;if(ge==="joined")return Y;const V=new Map;for(const K of k)K?.id&&V.set(K.id,K);for(const K of Y)K?.id&&!V.has(K.id)&&V.set(K.id,K);return Array.from(V.values())},[ge,k,Y]),d.useMemo(()=>{if(ge==="created")return ye;if(ge==="joined")return nt;const V=new Set;return k.forEach(K=>K?.id&&V.add(K.id)),Y.forEach(K=>K?.id&&V.add(K.id)),V.size},[ge,ye,nt,k,Y]),d.useMemo(()=>{if(!is)return 0;const V=new Date(is).getTime();return Math.max(0,Math.floor((V-Date.now())/1e3))},[is]),d.useMemo(()=>is?new Date(is).getTime()>Date.now()&&!Ei:!1,[is,Ei]),d.useEffect(()=>{i&&(async()=>{const{data:V,error:K}=await w.from("friendships").select("id,user_id_a,user_id_b,status").or(`and(user_id_a.eq.${i},status.eq.accepted),and(user_id_b.eq.${i},status.eq.accepted)`);if(K&&console.error("Friend load error:",K),De(V||[]),V){const je=V.map(Ge=>Ge.user_id_a===i?Ge.user_id_b:Ge.user_id_a),{data:le}=await w.from("profiles").select("user_id,name,avatar_url").in("user_id",je),_e=new Map;le?.forEach(Ge=>_e.set(Ge.user_id,{name:Ge.name,avatar_url:Ge.avatar_url})),te(_e)}})()},[i]),d.useLayoutEffect(()=>{e.hash==="#chat"&&u(!0)},[e.key,e.hash]),d.useEffect(()=>{const V=()=>u(!0);return window.addEventListener("open-chat",V),()=>window.removeEventListener("open-chat",V)},[]),d.useEffect(()=>{function V(K){const je=K.target;h&&E.current&&!E.current.contains(je)&&f(!1),l&&A.current&&!A.current.contains(je)&&u(!1)}return document.addEventListener("mousedown",V),()=>document.removeEventListener("mousedown",V)},[h,l]),d.useCallback(async V=>{ss(!1),Fe(null),Ce(!0),$e([]),fe(V),Se(je=>je.map(le=>le.other_id===V?{...le,unread:!1,last_from_me:!0}:le));const{data:K}=await w.from("direct_messages").select("id,sender,receiver,content,created_at").or(`and(sender.eq.${i},receiver.eq.${V}),and(sender.eq.${V},receiver.eq.${i})`).order("created_at",{ascending:!0}).limit(200);$e(K??[]),Ce(!1)},[i]);function Ii(V){y&&rs===V||(mn(V),j(!0))}d.useEffect(()=>{if(!m||!i)return;const V=localStorage.getItem("theme");V&&T(V);const K=localStorage.getItem("emailNotifs");K&&F(K==="1");const je=localStorage.getItem("pushNotifs");je&&I(je==="1"),(async()=>{const{data:le,error:_e}=await w.from("profiles").select("name, city, timezone, interests, avatar_url, allow_ratings").eq("user_id",i).maybeSingle();if(_e){H(_e.message);return}const Ge=le?.name??"";$(Ge),C(le?.city??""),q(le?.timezone??da());const Ds=Array.isArray(le?.interests)?le.interests:[];U(Ds.join(", ")),Ri(le?.avatar_url??null),b(le?.allow_ratings??!0)})()},[m,i]);async function $c(){if(i){H(null),G(!0);try{const V=_.trim();if(!V){H("Name cannot be empty."),G(!1);return}const K=S.trim();if(!K){H("Please choose a city."),G(!1);return}const je=R.trim()||"UTC",le=Q.split(",").map(Ge=>Ge.trim()).filter(Boolean),{error:_e}=await w.from("profiles").update({name:V,city:K,timezone:je,interests:le,allow_ratings:z,onboarded:!0}).eq("user_id",i);if(_e)throw _e;localStorage.setItem("theme",P),localStorage.setItem("emailNotifs",N?"1":"0"),localStorage.setItem("pushNotifs",D?"1":"0"),Gc(P),H("Saved."),jh("Profile saved"),Rs(!1),setTimeout(()=>{g(!1),H(null)},1e3)}catch(V){const K=V?.message||"Failed to save";H(K),Nh(K)}finally{G(!1)}}}async function Bc(V){if(b(V),!!i)try{await w.from("profiles").update({allow_ratings:V}).eq("user_id",i)}catch{}}async function Uc(V){const K=V.target.files?.[0];if(!(!i||!K))try{X(!0);const je=K.name.split(".").pop()||"jpg",le=`${i}/${Date.now()}.${je}`,{error:_e}=await w.storage.from("avatars").upload(le,K,{upsert:!0});if(_e)throw _e;const{data:Ge}=w.storage.from("avatars").getPublicUrl(le),Ds=Ge?.publicUrl||null;Ds&&(await w.from("profiles").update({avatar_url:Ds}).eq("user_id",i),Ri(Ds))}catch(je){console.error(je),H("Avatar upload failed")}finally{X(!1)}}function Gc(V){const K=document.documentElement;K.classList.remove("light","dark"),V==="light"?K.classList.add("light"):V==="dark"&&K.classList.add("dark")}async function zc(){try{await w.auth.signOut()}catch{}try{localStorage.removeItem("onboardingSeen"),sessionStorage.clear()}catch{}const V=`${window.location.origin}/circles/`;try{if("serviceWorker"in navigator){const K=await navigator.serviceWorker.getRegistrations();await Promise.all(K.map(je=>je.unregister()))}}catch{}window.location.replace(V)}return a?r.jsx("div",{className:"flex h-screen items-center justify-center text-neutral-500",children:"Loading..."}):c||!o?r.jsx("div",{className:"p-4 text-red-500",children:"Failed to load profile."}):r.jsxs("div",{className:"mx-auto max-w-6xl px-4 pt-16 md:pt-20 pb-0",children:[r.jsx("div",{className:"grid gap-6 lg:grid-cols-[1fr_360px]",children:r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"mb-6 flex items-center gap-4",children:[r.jsx("div",{className:"grid h-16 w-16 place-content-center rounded-full bg-emerald-100 text-emerald-800 ring-1 ring-emerald-300/60 overflow-hidden",children:Li?r.jsx("img",{src:Li,alt:"",className:"h-16 w-16 object-cover"}):r.jsx("span",{className:"text-2xl font-semibold tracking-wide",children:Vi})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("div",{className:"text-lg font-semibold text-neutral-900",children:Di}),r.jsxs("div",{className:"mt-1 flex items-center gap-3 text-sm text-neutral-700",title:`${(Oi??0).toFixed(1)} / 6 from ${Fi??0} ratings`,children:[r.jsxs("span",{className:"inline-flex items-center gap-1",children:[Array.from({length:6}).map((V,K)=>r.jsx("span",{children:K<Math.round(Oi||0)?"â˜…":"â˜†"},K)),r.jsxs("span",{className:"ml-1 text-xs text-neutral-500",children:["(",Fi||0,")"]})]}),M&&r.jsx("button",{onClick:()=>Ii(s),className:"text-xs text-emerald-700 hover:underline",children:"Rate"})]}),!M&&r.jsx("div",{className:"text-sm text-neutral-600",children:n?.email}),!M&&r.jsx("div",{className:"mt-2 flex items-center gap-2",children:r.jsx("button",{onClick:()=>g(!0),className:"ml-2 rounded-md border border-black/10 bg-white px-3 py-1.5 text-sm hover:bg-black/[0.04]",children:"Settings"})})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsx(Qn,{label:"Groups Created",value:ye,onClick:()=>t("/groups?filter=created")}),r.jsx(Qn,{label:"Groups Joined",value:nt,onClick:()=>t("/groups?filter=joined")}),r.jsx(Qn,{label:"Games Played",value:Ot})]}),r.jsx(fa,{title:"Game Activity",count:ns.length,empty:"No game history yet.",children:ns.map(V=>r.jsxs("li",{className:"flex justify-between py-2",children:[r.jsx("span",{className:"font-medium text-neutral-900",children:V.game}),r.jsx("span",{className:"text-neutral-600 text-sm",children:V.count})]},V.game))}),r.jsx(fa,{title:"Friends",count:he.length,empty:"No friends yet.",children:he.map(V=>{const K=V.user_id_a===i?V.user_id_b:V.user_id_a,je=O.get(K);return r.jsx(kh,{_otherId:K,name:je?.name||K.slice(0,6),avatarUrl:je?.avatar_url??null,lastBody:"",lastAt:new Date().toISOString(),unread:!1,onView:()=>Ii(K)},K)})})]})}),m&&r.jsx("div",{className:"fixed inset-0 z-50 grid place-items-center bg-black/40",children:r.jsxs("form",{onSubmit:V=>{V.preventDefault(),$c()},className:"w-[560px] max-w-[92vw] rounded-2xl border border-black/10 bg-white shadow-xl max-h-[90vh] overflow-hidden flex flex-col",children:[r.jsxs("div",{className:"flex-1 overflow-y-auto px-5 py-4 space-y-4",children:[r.jsxs("div",{className:"relative mb-2",children:[r.jsx("div",{className:"text-base font-semibold text-neutral-900",children:"Edit Profile"}),r.jsx("button",{type:"button",onClick:()=>g(!1),className:"absolute top-3 right-3 text-neutral-500 hover:text-neutral-800 text-xl leading-none",children:"Ã—"})]}),r.jsxs("div",{className:"rounded-xl border border-black/5 bg-neutral-50/80 p-4 shadow-inner space-y-4",children:[r.jsx("div",{className:"text-sm font-semibold text-neutral-700",children:"Profile"}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-sm font-medium text-neutral-800",children:"Name"}),r.jsx("input",{value:_,onChange:V=>{$(V.target.value),Rs(!0)},className:"w-full rounded-lg border border-black/10 bg-white px-3 py-2 text-sm focus:border-emerald-600",placeholder:"Your name",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-sm font-medium text-neutral-800",children:"Avatar"}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-10 w-10 rounded-full bg-neutral-200 grid place-items-center overflow-hidden",children:Mi?r.jsx("img",{src:Mi,alt:"",className:"h-10 w-10 object-cover"}):r.jsx("span",{className:"text-xs",children:Vi})}),r.jsx("input",{type:"file",accept:"image/*",onChange:Uc,className:"text-sm"}),se&&r.jsx("span",{className:"text-xs text-neutral-600",children:"Uploadingâ€¦"})]})]}),r.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-sm font-medium text-neutral-800",children:"City"}),r.jsx("input",{value:S,onChange:V=>{C(V.target.value),Rs(!0)},onBlur:()=>{(!R||R==="UTC")&&q(da())},className:"w-full rounded-lg border border-black/10 bg-white px-3 py-2 text-sm focus:border-emerald-600",placeholder:"Start typingâ€¦ e.g., Berlin",list:"cities-de",required:!0}),r.jsx("datalist",{id:"cities-de",children:_h.map(V=>r.jsx("option",{value:V},V))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-sm font-medium text-neutral-800",children:"Timezone"}),r.jsx("input",{value:R,onChange:V=>{q(V.target.value),Rs(!0)},className:"w-full rounded-lg border border-black/10 bg-white px-3 py-2 text-sm focus:border-emerald-600",placeholder:"e.g., Europe/Berlin"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-sm font-medium text-neutral-800",children:"Interests"}),r.jsx("input",{value:Q,onChange:V=>{U(V.target.value),Rs(!0)},className:"w-full rounded-lg border border-black/10 bg-white px-3 py-2 text-sm focus:border-emerald-600",placeholder:"comma, separated, tags"})]})]}),r.jsxs("div",{className:"rounded-xl border border-black/5 bg-neutral-50/80 p-4 shadow-inner space-y-3",children:[r.jsx("div",{className:"text-sm font-semibold text-neutral-700",children:"Appearance & Privacy"}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-1 block text-sm font-medium text-neutral-800",children:"Theme"}),r.jsxs("select",{value:P,onChange:V=>T(V.target.value),className:"w-full rounded-lg border border-black/10 bg-white px-3 py-2 text-sm focus:border-emerald-600",children:[r.jsx("option",{value:"system",children:"System"}),r.jsx("option",{value:"light",children:"Light"}),r.jsx("option",{value:"dark",children:"Dark"})]})]}),r.jsxs("div",{className:"flex items-center justify-between gap-2 rounded-lg border border-black/5 bg-white px-3 py-2",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-medium text-neutral-800",children:"Allow profile ratings"}),r.jsx("div",{className:"text-[11px] text-neutral-500",children:"Others can rate you when enabled."})]}),r.jsx("button",{type:"button",onClick:()=>Bc(!z),className:`h-7 w-12 rounded-full ${z?"bg-emerald-600":"bg-neutral-300"} relative`,children:r.jsx("span",{className:`absolute top-0.5 h-6 w-6 rounded-full bg-white transition ${z?"right-0.5":"left-0.5"}`})})]})]}),r.jsxs("div",{className:"rounded-xl border border-black/5 bg-neutral-50/80 p-4 shadow-inner space-y-3",children:[r.jsx("div",{className:"text-sm font-semibold text-neutral-700",children:"Notifications"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{id:"emailNotifs",type:"checkbox",checked:N,onChange:V=>F(V.target.checked),className:"h-4 w-4 rounded border-black/20"}),r.jsx("label",{htmlFor:"emailNotifs",className:"text-sm text-neutral-800",children:"Email notifications"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{id:"pushNotifs",type:"checkbox",checked:D,onChange:V=>I(V.target.checked),className:"h-4 w-4 rounded border-black/20"}),r.jsx("label",{htmlFor:"pushNotifs",className:"text-sm text-neutral-800",children:"Push notifications"})]})]}),L&&r.jsx("div",{className:`rounded-md border px-3 py-2 text-sm ${L==="Saved."?"border-emerald-200 bg-emerald-50 text-emerald-700":"border-red-200 bg-red-50 text-red-700"}`,children:L})]}),r.jsxs("div",{className:"shrink-0 px-5 py-3 border-t border-black/10 space-y-3",children:[r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx("button",{type:"button",onClick:()=>g(!1),className:"rounded-md border border-black/10 bg-white px-3 py-1.5 text-sm",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:ce,className:`rounded-md px-3 py-1.5 text-sm text-white ${ce?"bg-neutral-400":"bg-emerald-600 hover:bg-emerald-700"}`,children:ce?"Savingâ€¦":"Save"})]}),r.jsx("button",{type:"button",onClick:zc,className:"w-full rounded-md border border-red-300 bg-red-50 px-3 py-2 text-sm text-red-700 hover:bg-red-100",children:"Sign Out"})]})]})}),r.jsx(Wr,{isOpen:y,onClose:()=>j(!1),viewUserId:rs})]})}const Qn=Jt.memo(function({label:e,value:s,onClick:n}){const i=r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-sm text-neutral-600",children:e}),r.jsx("div",{className:"mt-1 text-2xl font-semibold text-neutral-900",children:s})]});return n?r.jsx("button",{onClick:n,className:"w-full rounded-xl border border-black/10 bg-white p-4 text-left shadow-sm hover:shadow disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-sm",disabled:!n,children:i}):r.jsx("div",{className:"rounded-xl border border-black/10 bg-white p-4 shadow-sm",children:i})}),fa=Jt.memo(function({title:e,count:s,empty:n,children:i}){return r.jsxs("div",{className:"rounded-xl border border-black/10 bg-white p-4 shadow-sm",children:[r.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[r.jsx("h3",{className:"text-base font-medium text-neutral-900",children:e}),r.jsx("span",{className:"text-xs text-neutral-600",children:s})]}),Jt.Children.count(i)===0?r.jsx("p",{className:"text-sm text-neutral-600",children:n}):r.jsx("ul",{className:"divide-y",children:i})]})});Jt.memo(function({id:e,title:s,meta:n,code:i}){const o=Ch(String(e),i);return r.jsxs("li",{className:"flex items-center justify-between py-2",children:[r.jsxs("div",{children:[r.jsx(me,{to:`/group/${e}`,className:"font-medium text-neutral-900 hover:underline",children:s}),r.jsx("div",{className:"text-xs text-neutral-600",children:n}),r.jsxs("div",{className:"text-[11px] text-neutral-500 tracking-wider",children:["Code: ",o]})]}),r.jsx(me,{to:`/group/${e}`,className:"text-sm text-emerald-700 hover:underline",children:"Open"})]})});const kh=Jt.memo(function({_otherId:e,name:s,avatarUrl:n,lastBody:i,lastAt:o,unread:a,onView:c}){return r.jsxs("li",{className:"flex items-center justify-between py-2",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-9 w-9 rounded-full bg-neutral-200 grid place-items-center text-xs font-medium overflow-hidden",children:n?r.jsx("img",{src:n,alt:"",className:"h-9 w-9 rounded-full object-cover"}):s.slice(0,2).toUpperCase()}),r.jsxs("div",{children:[r.jsx("button",{onClick:c,className:"font-medium text-neutral-900 hover:underline text-left",children:s}),r.jsx("div",{className:"text-xs text-neutral-600 truncate max-w-[220px]",children:i})]})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:"text-[10px] text-neutral-500",children:Sh(o)}),a&&r.jsx("span",{className:"h-2 w-2 rounded-full bg-emerald-600"})]})]})});function Ph(){const[t,e]=d.useState(null),[s,n]=d.useState(!0);return d.useEffect(()=>{let i=!0;w.auth.getUser().then(({data:a,error:c})=>{i&&(c&&console.error("Error fetching auth user",c),e(a?.user??null),n(!1))});const{data:{subscription:o}}=w.auth.onAuthStateChange((a,c)=>{i&&(e(c?.user??null),n(!1))});return()=>{i=!1,o.unsubscribe()}},[]),{user:t,loading:s}}function Th(){const{user:t}=Ph(),[e,s]=d.useState(""),[n,i]=d.useState(""),[o,a]=d.useState(""),[c,l]=d.useState(""),[u,h]=d.useState(""),[f,m]=d.useState(!1),[g,x]=d.useState(null);if(!t)return null;async function v(y){y.preventDefault(),m(!0),x(null);const{error:j}=await w.from("profiles").update({name:e,username:n,city:o||null,timezone:c||null,interests:u||null,onboarded:!0}).eq("user_id",t.id);if(m(!1),j){x(j.message);return}window.location.href="/profile"}return r.jsx("div",{className:"min-h-dvh flex items-center justify-center px-4 py-8 bg-neutral-50",children:r.jsxs("div",{className:"w-full max-w-md rounded-xl border border-black/10 bg-white p-6 shadow-sm",children:[r.jsx("h1",{className:"text-xl font-semibold mb-2",children:"Create your profile"}),r.jsx("p",{className:"text-sm text-neutral-600 mb-6",children:"Just a few details so Circles can find the best groups for you."}),r.jsxs("form",{onSubmit:v,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Full name"}),r.jsx("input",{type:"text",value:e,onChange:y=>s(y.target.value),className:"w-full rounded-md border border-neutral-300 px-3 py-2 text-sm outline-none focus:border-black focus:ring-1 focus:ring-black",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Username"}),r.jsx("input",{type:"text",value:n,onChange:y=>i(y.target.value),className:"w-full rounded-md border border-neutral-300 px-3 py-2 text-sm outline-none focus:border-black focus:ring-1 focus:ring-black",required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"City / Location"}),r.jsx("input",{type:"text",value:o,onChange:y=>a(y.target.value),className:"w-full rounded-md border border-neutral-300 px-3 py-2 text-sm outline-none focus:border-black focus:ring-1 focus:ring-black",placeholder:"e.g., Toronto, Berlin"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Timezone"}),r.jsx("input",{type:"text",value:c,onChange:y=>l(y.target.value),className:"w-full rounded-md border border-neutral-300 px-3 py-2 text-sm outline-none focus:border-black focus:ring-1 focus:ring-black",placeholder:"e.g., UTC-5, CET, PST"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-1",children:"Interests"}),r.jsx("textarea",{value:u,onChange:y=>h(y.target.value),rows:3,className:"w-full rounded-md border border-neutral-300 px-3 py-2 text-sm outline-none focus:border-black focus:ring-1 focus:ring-black resize-none",placeholder:"Games, study topics, outdoor hobbiesâ€¦"})]}),g&&r.jsx("p",{className:"text-sm text-red-600",children:g}),r.jsx("button",{type:"submit",disabled:f,className:"mt-2 w-full rounded-md bg-black px-3 py-2 text-sm font-medium text-white hover:bg-black/90 disabled:opacity-60",children:f?"Savingâ€¦":"Save and continue"})]})]})})}function Ah(t){if(!t)return"";try{return new Date(t).toLocaleDateString()}catch{return""}}function Yn(t){if(!t)return"";try{return t.normalize("NFKD").replace(/\p{Diacritic}/gu,"").toLowerCase().trim()}catch{return t.toLowerCase().trim()}}function Eh(){const{user:t}=Es(),e=t?.id||null,{game:s=""}=an(),n=(s||"").toLowerCase().replace(/[^a-z0-9]+/g,"").trim(),i=(s||"").replace(/-/g," ").trim(),[o,a]=d.useState([]),[c,l]=d.useState(null),[u,h]=d.useState(!0),[f,m]=d.useState(new Set),[g,x]=d.useState(null),[v,y]=d.useState("new"),[j,A]=d.useState({}),[E,M]=d.useState(""),[_,$]=d.useState("all"),[S,C]=d.useState(null),[R,q]=d.useState(!1);async function Q(){try{q(!0);const{data:T}=await w.auth.getUser(),N=T?.user?.id??null;if(!N){C(null),q(!1);return}const{data:F}=await w.from("profiles").select("city").eq("user_id",N).maybeSingle(),D=F?.city||null,I=D&&typeof D=="string"?D.trim():null;C(I)}catch{C(null)}finally{q(!1)}}d.useEffect(()=>{let T=!0;return(async()=>{h(!0);let N=w.from("groups").select("*").order("created_at",{ascending:!1}).limit(100);N=N.or(`game_slug.eq.${n},game.ilike.${i}`);const{data:F,error:D}=await N;if(T){if(D)l(D.message);else{const I=F??[];a(I);try{const z=I.map(b=>b.id).filter(Boolean);if(z.length){const b=new Date(Date.now()-3e5).toISOString(),{data:L}=await w.from("group_reads").select("group_id").in("group_id",z).gt("last_read_at",b),H={};(L??[]).forEach(ce=>{const G=String(ce.group_id);H[G]=(H[G]??0)+1}),A(H)}}catch(z){console.warn(z)}}h(!1)}})(),()=>{T=!1}},[n,i]);async function U(T){if(!e){l("Sign in required");return}x(T);const{error:N}=await w.from("group_members").insert({group_id:T,user_id:e,role:"member"});if(x(null),!N||N.code==="23505"){const F=new Set(f);F.add(T),m(F)}else l(N.message)}const P=d.useMemo(()=>{let T=[...o];if(_==="mine"&&S){const F=Yn(S);T=T.filter(D=>Yn(D.city).includes(F))}const N=E.trim().toLowerCase();return N&&(T=T.filter(F=>Yn(F.city).includes(N)||F.code&&F.code.toLowerCase().includes(N)||F.title&&F.title.toLowerCase().includes(N))),v==="online"?T.sort((F,D)=>(j[D.id]??0)-(j[F.id]??0)):T.sort((F,D)=>new Date(D.created_at??"").getTime()-new Date(F.created_at??"").getTime()),T},[o,_,S,E,v,j]);return d.useEffect(()=>{_==="mine"&&!S&&!R&&Q()},[_]),r.jsxs("main",{className:"mx-auto max-w-3xl px-4 py-6 pb-32",children:[r.jsxs("div",{className:"mb-8",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx(me,{to:"/browse",className:"flex h-8 w-8 items-center justify-center rounded-full bg-neutral-100 hover:bg-neutral-200 transition-colors",children:r.jsx(Ns,{className:"h-4 w-4 text-neutral-700"})}),r.jsx("span",{className:"text-sm font-semibold text-neutral-500 uppercase tracking-wider",children:"Game"})]}),r.jsx("h1",{className:"text-3xl font-extrabold tracking-tight text-neutral-900 capitalize",children:i}),r.jsxs("p",{className:"mt-2 text-neutral-600",children:[o.length," active group",o.length!==1&&"s"," found."]})]}),r.jsxs("div",{className:"sticky top-0 z-20 mb-6 flex flex-col gap-3 bg-neutral-50/95 py-2 backdrop-blur-sm sm:flex-row sm:items-center",children:[r.jsxs("div",{className:"relative flex-1",children:[r.jsx(Kr,{className:"absolute left-3 top-2.5 h-4 w-4 text-neutral-400"}),r.jsx("input",{value:E,onChange:T=>M(T.target.value),placeholder:"Search city, title, or code...",className:"w-full rounded-xl border border-neutral-200 bg-white py-2 pl-9 pr-4 text-sm outline-none focus:border-black focus:ring-1 focus:ring-black"})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("select",{value:_,onChange:T=>$(T.target.value),className:"rounded-xl border border-neutral-200 bg-white px-3 py-2 text-sm font-medium outline-none focus:border-black",children:[r.jsx("option",{value:"all",children:"All Cities"}),r.jsxs("option",{value:"mine",children:["My City ",S?`(${S})`:""]})]}),r.jsxs("select",{value:v,onChange:T=>y(T.target.value),className:"rounded-xl border border-neutral-200 bg-white px-3 py-2 text-sm font-medium outline-none focus:border-black",children:[r.jsx("option",{value:"new",children:"Newest"}),r.jsx("option",{value:"online",children:"Active"})]})]})]}),r.jsx("ul",{className:"space-y-3",children:P.map(T=>r.jsx("li",{className:"group relative overflow-hidden rounded-2xl border border-neutral-100 bg-white p-4 shadow-sm transition-all hover:shadow-md active:scale-[0.99]",children:r.jsxs("div",{className:"flex items-start justify-between gap-4",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("h2",{className:"truncate text-base font-bold text-neutral-900",children:T.title||"Untitled Group"}),T.is_online&&r.jsx("span",{className:"inline-flex items-center rounded-full bg-blue-50 px-2 py-0.5 text-[10px] font-bold text-blue-700 border border-blue-100",children:"ONLINE"})]}),r.jsx("p",{className:"line-clamp-1 text-sm text-neutral-600 mb-3",children:T.description||"No description"}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs text-neutral-500 font-medium",children:[r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(Ws,{className:"h-3 w-3"}),T.city||"Anywhere"]}),r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(Hr,{className:"h-3 w-3"}),Ah(T.created_at)]}),T.code&&r.jsxs("span",{className:"rounded-md bg-neutral-100 px-1.5 py-0.5 font-mono text-neutral-600",children:["#",T.code]})]})]}),r.jsx("div",{className:"flex flex-col items-end gap-2",children:f.has(T.id)?r.jsx(me,{to:`/group/${T.id}`,className:"rounded-full border border-neutral-200 bg-white px-4 py-1.5 text-xs font-bold text-neutral-900 hover:bg-neutral-50 transition-colors",children:"Open"}):r.jsx("button",{onClick:()=>U(T.id),disabled:g===T.id,className:"rounded-full bg-black px-4 py-1.5 text-xs font-bold text-white shadow-sm hover:bg-neutral-800 disabled:opacity-50 transition-all",children:g===T.id?"Joining...":"Join"})})]})},T.id))}),!u&&!c&&P.length===0&&r.jsx("div",{className:"py-10 text-center text-neutral-500",children:"No groups found."})]})}function Mh(t){if(!t)return"";try{return new Date(t).toLocaleDateString()}catch{return""}}function Rh(){const[t,e]=d.useState([]),[s,n]=d.useState(!0),[i,o]=d.useState(null);return d.useEffect(()=>{let a=!0;return(async()=>{try{n(!0),o(null);const{data:{session:c}}=await w.auth.getSession(),l=c?.user?.id;if(!l){e([]);return}const{data:u,error:h}=await w.from("group_members").select("group_id").eq("user_id",l);if(h)throw h;const f=(u??[]).map(x=>x.group_id).filter(Boolean);if(f.length===0){e([]);return}const{data:m,error:g}=await w.from("groups").select("*").in("id",f).order("created_at",{ascending:!1});if(g)throw g;if(!a)return;e(m??[])}catch(c){if(!a)return;o(c?.message??"Failed to load your groups"),e([])}finally{a&&n(!1)}})(),()=>{a=!1}},[]),r.jsxs("main",{className:"mx-auto max-w-3xl px-4 py-8 pb-32",children:[r.jsxs("div",{className:"mb-8",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(me,{to:"/browse",className:"flex h-10 w-10 items-center justify-center rounded-full bg-neutral-100 hover:bg-neutral-200 transition-colors",children:r.jsx(Ns,{className:"h-5 w-5 text-neutral-700"})}),r.jsx("h1",{className:"text-2xl font-extrabold tracking-tight text-neutral-900",children:"My Groups"})]}),r.jsxs(me,{to:"/create",className:"flex items-center gap-2 rounded-full bg-black px-4 py-2 text-xs font-bold text-white shadow-lg hover:bg-neutral-800 transition-all active:scale-95",children:[r.jsx(Sr,{className:"h-4 w-4"}),r.jsx("span",{children:"New"})]})]}),r.jsx("p",{className:"text-sm text-neutral-500 ml-13",children:"Groups youâ€™ve joined or created."})]}),s&&r.jsx("ul",{className:"space-y-3",children:[1,2,3].map(a=>r.jsx("li",{className:"h-24 w-full animate-pulse rounded-2xl bg-white shadow-sm"},a))}),!!i&&r.jsx("div",{className:"rounded-xl border border-red-100 bg-red-50 p-4 text-sm text-red-600 font-medium",children:i}),!s&&!i&&t.length===0&&r.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[r.jsx("div",{className:"inline-flex h-16 w-16 items-center justify-center rounded-full bg-neutral-100 mb-4",children:r.jsx(Ps,{className:"h-8 w-8 text-neutral-400"})}),r.jsx("h3",{className:"text-lg font-bold text-neutral-900",children:"No groups yet"}),r.jsx("p",{className:"text-sm text-neutral-500 max-w-xs mx-auto mt-1 mb-6",children:"You haven't joined any circles yet. Find a game or create your own!"}),r.jsx(me,{to:"/browse",className:"rounded-full bg-black px-6 py-3 text-sm font-bold text-white shadow-lg hover:bg-neutral-800 transition-all active:scale-95",children:"Browse Games"})]}),r.jsx("ul",{className:"space-y-3",children:t.map(a=>r.jsx("li",{children:r.jsx(me,{to:`/group/${a.id}`,className:"group block relative overflow-hidden rounded-2xl border border-neutral-100 bg-white p-4 shadow-sm transition-all hover:shadow-md hover:border-neutral-200 active:scale-[0.99]",children:r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{className:"flex-1 min-w-0 pr-4",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("h2",{className:"truncate text-base font-bold text-neutral-900",children:a.title||"Untitled Group"}),a.is_online&&r.jsx("span",{className:"inline-flex items-center rounded-full bg-blue-50 px-2 py-0.5 text-[10px] font-bold text-blue-700 border border-blue-100",children:"ONLINE"})]}),r.jsx("p",{className:"line-clamp-1 text-sm text-neutral-600 mb-3",children:a.description||"No description"}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs text-neutral-500 font-medium",children:[a.category&&r.jsx("span",{className:"capitalize text-emerald-700 bg-emerald-50 px-2 py-0.5 rounded-md font-bold",children:a.game||a.category}),r.jsxs("span",{className:"flex items-center gap-0.5",children:[r.jsx(Ws,{className:"h-3 w-3"}),a.city||"Online"]}),r.jsxs("span",{className:"flex items-center gap-0.5",children:[r.jsx(Hr,{className:"h-3 w-3"}),Mh(a.created_at)]})]})]}),r.jsx("div",{className:"h-8 w-8 flex-shrink-0 rounded-full bg-neutral-50 flex items-center justify-center text-neutral-300 group-hover:bg-black group-hover:text-white transition-colors",children:r.jsx(Ns,{className:"h-4 w-4 rotate-180"})})]})})},a.id))})]})}const Yr=d.createContext({});function Xr(t){const e=d.useRef(null);return e.current===null&&(e.current=t()),e.current}const Vn=d.createContext(null),Jr=d.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class Dh extends d.Component{getSnapshotBeforeUpdate(e){const s=this.props.childRef.current;if(s&&e.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=s.offsetHeight||0,n.width=s.offsetWidth||0,n.top=s.offsetTop,n.left=s.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Lh({children:t,isPresent:e}){const s=d.useId(),n=d.useRef(null),i=d.useRef({width:0,height:0,top:0,left:0}),{nonce:o}=d.useContext(Jr);return d.useInsertionEffect(()=>{const{width:a,height:c,top:l,left:u}=i.current;if(e||!n.current||!a||!c)return;n.current.dataset.motionPopId=s;const h=document.createElement("style");return o&&(h.nonce=o),document.head.appendChild(h),h.sheet&&h.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${c}px !important;
            top: ${l}px !important;
            left: ${u}px !important;
          }
        `),()=>{document.head.removeChild(h)}},[e]),r.jsx(Dh,{isPresent:e,childRef:n,sizeRef:i,children:d.cloneElement(t,{ref:n})})}const Oh=({children:t,initial:e,isPresent:s,onExitComplete:n,custom:i,presenceAffectsLayout:o,mode:a})=>{const c=Xr(Fh),l=d.useId(),u=d.useCallback(f=>{c.set(f,!0);for(const m of c.values())if(!m)return;n&&n()},[c,n]),h=d.useMemo(()=>({id:l,initial:e,isPresent:s,custom:i,onExitComplete:u,register:f=>(c.set(f,!1),()=>c.delete(f))}),o?[Math.random(),u]:[s,u]);return d.useMemo(()=>{c.forEach((f,m)=>c.set(m,!1))},[s]),d.useEffect(()=>{!s&&!c.size&&n&&n()},[s]),a==="popLayout"&&(t=r.jsx(Lh,{isPresent:s,children:t})),r.jsx(Vn.Provider,{value:h,children:t})};function Fh(){return new Map}function ll(t=!0){const e=d.useContext(Vn);if(e===null)return[!0,null];const{isPresent:s,onExitComplete:n,register:i}=e,o=d.useId();d.useEffect(()=>{t&&i(o)},[t]);const a=d.useCallback(()=>t&&n&&n(o),[o,n,t]);return!s&&n?[!1,a]:[!0]}const vn=t=>t.key||"";function ma(t){const e=[];return d.Children.forEach(t,s=>{d.isValidElement(s)&&e.push(s)}),e}const Zr=typeof window<"u",cl=Zr?d.useLayoutEffect:d.useEffect,Vh=({children:t,custom:e,initial:s=!0,onExitComplete:n,presenceAffectsLayout:i=!0,mode:o="sync",propagate:a=!1})=>{const[c,l]=ll(a),u=d.useMemo(()=>ma(t),[t]),h=a&&!c?[]:u.map(vn),f=d.useRef(!0),m=d.useRef(u),g=Xr(()=>new Map),[x,v]=d.useState(u),[y,j]=d.useState(u);cl(()=>{f.current=!1,m.current=u;for(let M=0;M<y.length;M++){const _=vn(y[M]);h.includes(_)?g.delete(_):g.get(_)!==!0&&g.set(_,!1)}},[y,h.length,h.join("-")]);const A=[];if(u!==x){let M=[...u];for(let _=0;_<y.length;_++){const $=y[_],S=vn($);h.includes(S)||(M.splice(_,0,$),A.push($))}o==="wait"&&A.length&&(M=A),j(ma(M)),v(u);return}const{forceRender:E}=d.useContext(Yr);return r.jsx(r.Fragment,{children:y.map(M=>{const _=vn(M),$=a&&!c?!1:u===y||h.includes(_),S=()=>{if(g.has(_))g.set(_,!0);else return;let C=!0;g.forEach(R=>{R||(C=!1)}),C&&(E?.(),j(m.current),a&&l?.(),n&&n())};return r.jsx(Oh,{isPresent:$,initial:!f.current||s?void 0:!1,custom:$?void 0:e,presenceAffectsLayout:i,mode:o,onExitComplete:$?void 0:S,children:M},_)})})},ze=t=>t;let ul=ze;function ei(t){let e;return()=>(e===void 0&&(e=t()),e)}const Cs=(t,e,s)=>{const n=e-t;return n===0?1:(s-t)/n},ht=t=>t*1e3,ft=t=>t/1e3,Ih={useManualTiming:!1};function qh(t){let e=new Set,s=new Set,n=!1,i=!1;const o=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function c(u){o.has(u)&&(l.schedule(u),t()),u(a)}const l={schedule:(u,h=!1,f=!1)=>{const g=f&&n?e:s;return h&&o.add(u),g.has(u)||g.add(u),u},cancel:u=>{s.delete(u),o.delete(u)},process:u=>{if(a=u,n){i=!0;return}n=!0,[e,s]=[s,e],e.forEach(c),e.clear(),n=!1,i&&(i=!1,l.process(u))}};return l}const bn=["read","resolveKeyframes","update","preRender","render","postRender"],$h=40;function dl(t,e){let s=!1,n=!0;const i={delta:0,timestamp:0,isProcessing:!1},o=()=>s=!0,a=bn.reduce((j,A)=>(j[A]=qh(o),j),{}),{read:c,resolveKeyframes:l,update:u,preRender:h,render:f,postRender:m}=a,g=()=>{const j=performance.now();s=!1,i.delta=n?1e3/60:Math.max(Math.min(j-i.timestamp,$h),1),i.timestamp=j,i.isProcessing=!0,c.process(i),l.process(i),u.process(i),h.process(i),f.process(i),m.process(i),i.isProcessing=!1,s&&e&&(n=!1,t(g))},x=()=>{s=!0,n=!0,i.isProcessing||t(g)};return{schedule:bn.reduce((j,A)=>{const E=a[A];return j[A]=(M,_=!1,$=!1)=>(s||x(),E.schedule(M,_,$)),j},{}),cancel:j=>{for(let A=0;A<bn.length;A++)a[bn[A]].cancel(j)},state:i,steps:a}}const{schedule:pe,cancel:Tt,state:Te,steps:Xn}=dl(typeof requestAnimationFrame<"u"?requestAnimationFrame:ze,!0),hl=d.createContext({strict:!1}),pa={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},_s={};for(const t in pa)_s[t]={isEnabled:e=>pa[t].some(s=>!!e[s])};function Bh(t){for(const e in t)_s[e]={..._s[e],...t[e]}}const Uh=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Tn(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||Uh.has(t)}let fl=t=>!Tn(t);function Gh(t){t&&(fl=e=>e.startsWith("on")?!Tn(e):t(e))}try{Gh(require("@emotion/is-prop-valid").default)}catch{}function zh(t,e,s){const n={};for(const i in t)i==="values"&&typeof t.values=="object"||(fl(i)||s===!0&&Tn(i)||!e&&!Tn(i)||t.draggable&&i.startsWith("onDrag"))&&(n[i]=t[i]);return n}function Hh(t){if(typeof Proxy>"u")return t;const e=new Map,s=(...n)=>t(...n);return new Proxy(s,{get:(n,i)=>i==="create"?t:(e.has(i)||e.set(i,t(i)),e.get(i))})}const In=d.createContext({});function Qs(t){return typeof t=="string"||Array.isArray(t)}function qn(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const ti=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],si=["initial",...ti];function $n(t){return qn(t.animate)||si.some(e=>Qs(t[e]))}function ml(t){return!!($n(t)||t.variants)}function Kh(t,e){if($n(t)){const{initial:s,animate:n}=t;return{initial:s===!1||Qs(s)?s:void 0,animate:Qs(n)?n:void 0}}return t.inherit!==!1?e:{}}function Wh(t){const{initial:e,animate:s}=Kh(t,d.useContext(In));return d.useMemo(()=>({initial:e,animate:s}),[ga(e),ga(s)])}function ga(t){return Array.isArray(t)?t.join(" "):t}const Qh=Symbol.for("motionComponentSymbol");function as(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function Yh(t,e,s){return d.useCallback(n=>{n&&t.onMount&&t.onMount(n),e&&(n?e.mount(n):e.unmount()),s&&(typeof s=="function"?s(n):as(s)&&(s.current=n))},[e])}const ni=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Xh="framerAppearId",pl="data-"+ni(Xh),{schedule:ri}=dl(queueMicrotask,!1),gl=d.createContext({});function Jh(t,e,s,n,i){var o,a;const{visualElement:c}=d.useContext(In),l=d.useContext(hl),u=d.useContext(Vn),h=d.useContext(Jr).reducedMotion,f=d.useRef(null);n=n||l.renderer,!f.current&&n&&(f.current=n(t,{visualState:e,parent:c,props:s,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:h}));const m=f.current,g=d.useContext(gl);m&&!m.projection&&i&&(m.type==="html"||m.type==="svg")&&Zh(f.current,s,i,g);const x=d.useRef(!1);d.useInsertionEffect(()=>{m&&x.current&&m.update(s,u)});const v=s[pl],y=d.useRef(!!v&&!(!((o=window.MotionHandoffIsComplete)===null||o===void 0)&&o.call(window,v))&&((a=window.MotionHasOptimisedAnimation)===null||a===void 0?void 0:a.call(window,v)));return cl(()=>{m&&(x.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),ri.render(m.render),y.current&&m.animationState&&m.animationState.animateChanges())}),d.useEffect(()=>{m&&(!y.current&&m.animationState&&m.animationState.animateChanges(),y.current&&(queueMicrotask(()=>{var j;(j=window.MotionHandoffMarkAsComplete)===null||j===void 0||j.call(window,v)}),y.current=!1))}),m}function Zh(t,e,s,n){const{layoutId:i,layout:o,drag:a,dragConstraints:c,layoutScroll:l,layoutRoot:u}=e;t.projection=new s(t.latestValues,e["data-framer-portal-id"]?void 0:xl(t.parent)),t.projection.setOptions({layoutId:i,layout:o,alwaysMeasureLayout:!!a||c&&as(c),visualElement:t,animationType:typeof o=="string"?o:"both",initialPromotionConfig:n,layoutScroll:l,layoutRoot:u})}function xl(t){if(t)return t.options.allowProjection!==!1?t.projection:xl(t.parent)}function ef({preloadedFeatures:t,createVisualElement:e,useRender:s,useVisualState:n,Component:i}){var o,a;t&&Bh(t);function c(u,h){let f;const m={...d.useContext(Jr),...u,layoutId:tf(u)},{isStatic:g}=m,x=Wh(u),v=n(u,g);if(!g&&Zr){sf();const y=nf(m);f=y.MeasureLayout,x.visualElement=Jh(i,v,m,e,y.ProjectionNode)}return r.jsxs(In.Provider,{value:x,children:[f&&x.visualElement?r.jsx(f,{visualElement:x.visualElement,...m}):null,s(i,u,Yh(v,x.visualElement,h),v,g,x.visualElement)]})}c.displayName=`motion.${typeof i=="string"?i:`create(${(a=(o=i.displayName)!==null&&o!==void 0?o:i.name)!==null&&a!==void 0?a:""})`}`;const l=d.forwardRef(c);return l[Qh]=i,l}function tf({layoutId:t}){const e=d.useContext(Yr).id;return e&&t!==void 0?e+"-"+t:t}function sf(t,e){d.useContext(hl).strict}function nf(t){const{drag:e,layout:s}=_s;if(!e&&!s)return{};const n={...e,...s};return{MeasureLayout:e?.isEnabled(t)||s?.isEnabled(t)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}const rf=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function ii(t){return typeof t!="string"||t.includes("-")?!1:!!(rf.indexOf(t)>-1||/[A-Z]/u.test(t))}function xa(t){const e=[{},{}];return t?.values.forEach((s,n)=>{e[0][n]=s.get(),e[1][n]=s.getVelocity()}),e}function ai(t,e,s,n){if(typeof e=="function"){const[i,o]=xa(n);e=e(s!==void 0?s:t.custom,i,o)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[i,o]=xa(n);e=e(s!==void 0?s:t.custom,i,o)}return e}const _r=t=>Array.isArray(t),af=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),of=t=>_r(t)?t[t.length-1]||0:t,Re=t=>!!(t&&t.getVelocity);function Sn(t){const e=Re(t)?t.get():t;return af(e)?e.toValue():e}function lf({scrapeMotionValuesFromProps:t,createRenderState:e,onUpdate:s},n,i,o){const a={latestValues:cf(n,i,o,t),renderState:e()};return s&&(a.onMount=c=>s({props:n,current:c,...a}),a.onUpdate=c=>s(c)),a}const yl=t=>(e,s)=>{const n=d.useContext(In),i=d.useContext(Vn),o=()=>lf(t,e,n,i);return s?o():Xr(o)};function cf(t,e,s,n){const i={},o=n(t,{});for(const m in o)i[m]=Sn(o[m]);let{initial:a,animate:c}=t;const l=$n(t),u=ml(t);e&&u&&!l&&t.inherit!==!1&&(a===void 0&&(a=e.initial),c===void 0&&(c=e.animate));let h=s?s.initial===!1:!1;h=h||a===!1;const f=h?c:a;if(f&&typeof f!="boolean"&&!qn(f)){const m=Array.isArray(f)?f:[f];for(let g=0;g<m.length;g++){const x=ai(t,m[g]);if(x){const{transitionEnd:v,transition:y,...j}=x;for(const A in j){let E=j[A];if(Array.isArray(E)){const M=h?E.length-1:0;E=E[M]}E!==null&&(i[A]=E)}for(const A in v)i[A]=v[A]}}}return i}const Ts=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],es=new Set(Ts),vl=t=>e=>typeof e=="string"&&e.startsWith(t),bl=vl("--"),uf=vl("var(--"),oi=t=>uf(t)?df.test(t.split("/*")[0].trim()):!1,df=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,wl=(t,e)=>e&&typeof t=="number"?e.transform(t):t,mt=(t,e,s)=>s>e?e:s<t?t:s,As={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Ys={...As,transform:t=>mt(0,1,t)},wn={...As,default:1},ln=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),vt=ln("deg"),ot=ln("%"),ee=ln("px"),hf=ln("vh"),ff=ln("vw"),ya={...ot,parse:t=>ot.parse(t)/100,transform:t=>ot.transform(t*100)},mf={borderWidth:ee,borderTopWidth:ee,borderRightWidth:ee,borderBottomWidth:ee,borderLeftWidth:ee,borderRadius:ee,radius:ee,borderTopLeftRadius:ee,borderTopRightRadius:ee,borderBottomRightRadius:ee,borderBottomLeftRadius:ee,width:ee,maxWidth:ee,height:ee,maxHeight:ee,top:ee,right:ee,bottom:ee,left:ee,padding:ee,paddingTop:ee,paddingRight:ee,paddingBottom:ee,paddingLeft:ee,margin:ee,marginTop:ee,marginRight:ee,marginBottom:ee,marginLeft:ee,backgroundPositionX:ee,backgroundPositionY:ee},pf={rotate:vt,rotateX:vt,rotateY:vt,rotateZ:vt,scale:wn,scaleX:wn,scaleY:wn,scaleZ:wn,skew:vt,skewX:vt,skewY:vt,distance:ee,translateX:ee,translateY:ee,translateZ:ee,x:ee,y:ee,z:ee,perspective:ee,transformPerspective:ee,opacity:Ys,originX:ya,originY:ya,originZ:ee},va={...As,transform:Math.round},li={...mf,...pf,zIndex:va,size:ee,fillOpacity:Ys,strokeOpacity:Ys,numOctaves:va},gf={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},xf=Ts.length;function yf(t,e,s){let n="",i=!0;for(let o=0;o<xf;o++){const a=Ts[o],c=t[a];if(c===void 0)continue;let l=!0;if(typeof c=="number"?l=c===(a.startsWith("scale")?1:0):l=parseFloat(c)===0,!l||s){const u=wl(c,li[a]);if(!l){i=!1;const h=gf[a]||a;n+=`${h}(${u}) `}s&&(e[a]=u)}}return n=n.trim(),s?n=s(e,i?"":n):i&&(n="none"),n}function ci(t,e,s){const{style:n,vars:i,transformOrigin:o}=t;let a=!1,c=!1;for(const l in e){const u=e[l];if(es.has(l)){a=!0;continue}else if(bl(l)){i[l]=u;continue}else{const h=wl(u,li[l]);l.startsWith("origin")?(c=!0,o[l]=h):n[l]=h}}if(e.transform||(a||s?n.transform=yf(e,t.transform,s):n.transform&&(n.transform="none")),c){const{originX:l="50%",originY:u="50%",originZ:h=0}=o;n.transformOrigin=`${l} ${u} ${h}`}}const vf={offset:"stroke-dashoffset",array:"stroke-dasharray"},bf={offset:"strokeDashoffset",array:"strokeDasharray"};function wf(t,e,s=1,n=0,i=!0){t.pathLength=1;const o=i?vf:bf;t[o.offset]=ee.transform(-n);const a=ee.transform(e),c=ee.transform(s);t[o.array]=`${a} ${c}`}function ba(t,e,s){return typeof t=="string"?t:ee.transform(e+s*t)}function jf(t,e,s){const n=ba(e,t.x,t.width),i=ba(s,t.y,t.height);return`${n} ${i}`}function ui(t,{attrX:e,attrY:s,attrScale:n,originX:i,originY:o,pathLength:a,pathSpacing:c=1,pathOffset:l=0,...u},h,f){if(ci(t,u,f),h){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:m,style:g,dimensions:x}=t;m.transform&&(x&&(g.transform=m.transform),delete m.transform),x&&(i!==void 0||o!==void 0||g.transform)&&(g.transformOrigin=jf(x,i!==void 0?i:.5,o!==void 0?o:.5)),e!==void 0&&(m.x=e),s!==void 0&&(m.y=s),n!==void 0&&(m.scale=n),a!==void 0&&wf(m,a,c,l,!1)}const di=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),jl=()=>({...di(),attrs:{}}),hi=t=>typeof t=="string"&&t.toLowerCase()==="svg";function Nl(t,{style:e,vars:s},n,i){Object.assign(t.style,e,i&&i.getProjectionStyles(n));for(const o in s)t.style.setProperty(o,s[o])}const Sl=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Cl(t,e,s,n){Nl(t,e,void 0,n);for(const i in e.attrs)t.setAttribute(Sl.has(i)?i:ni(i),e.attrs[i])}const An={};function Nf(t){Object.assign(An,t)}function _l(t,{layout:e,layoutId:s}){return es.has(t)||t.startsWith("origin")||(e||s!==void 0)&&(!!An[t]||t==="opacity")}function fi(t,e,s){var n;const{style:i}=t,o={};for(const a in i)(Re(i[a])||e.style&&Re(e.style[a])||_l(a,t)||((n=s?.getValue(a))===null||n===void 0?void 0:n.liveStyle)!==void 0)&&(o[a]=i[a]);return o}function kl(t,e,s){const n=fi(t,e,s);for(const i in t)if(Re(t[i])||Re(e[i])){const o=Ts.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;n[o]=t[i]}return n}function Sf(t,e){try{e.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const wa=["x","y","width","height","cx","cy","r"],Cf={useVisualState:yl({scrapeMotionValuesFromProps:kl,createRenderState:jl,onUpdate:({props:t,prevProps:e,current:s,renderState:n,latestValues:i})=>{if(!s)return;let o=!!t.drag;if(!o){for(const c in i)if(es.has(c)){o=!0;break}}if(!o)return;let a=!e;if(e)for(let c=0;c<wa.length;c++){const l=wa[c];t[l]!==e[l]&&(a=!0)}a&&pe.read(()=>{Sf(s,n),pe.render(()=>{ui(n,i,hi(s.tagName),t.transformTemplate),Cl(s,n)})})}})},_f={useVisualState:yl({scrapeMotionValuesFromProps:fi,createRenderState:di})};function Pl(t,e,s){for(const n in e)!Re(e[n])&&!_l(n,s)&&(t[n]=e[n])}function kf({transformTemplate:t},e){return d.useMemo(()=>{const s=di();return ci(s,e,t),Object.assign({},s.vars,s.style)},[e])}function Pf(t,e){const s=t.style||{},n={};return Pl(n,s,t),Object.assign(n,kf(t,e)),n}function Tf(t,e){const s={},n=Pf(t,e);return t.drag&&t.dragListener!==!1&&(s.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(s.tabIndex=0),s.style=n,s}function Af(t,e,s,n){const i=d.useMemo(()=>{const o=jl();return ui(o,e,hi(n),t.transformTemplate),{...o.attrs,style:{...o.style}}},[e]);if(t.style){const o={};Pl(o,t.style,t),i.style={...o,...i.style}}return i}function Ef(t=!1){return(s,n,i,{latestValues:o},a)=>{const l=(ii(s)?Af:Tf)(n,o,a,s),u=zh(n,typeof s=="string",t),h=s!==d.Fragment?{...u,...l,ref:i}:{},{children:f}=n,m=d.useMemo(()=>Re(f)?f.get():f,[f]);return d.createElement(s,{...h,children:m})}}function Mf(t,e){return function(n,{forwardMotionProps:i}={forwardMotionProps:!1}){const a={...ii(n)?Cf:_f,preloadedFeatures:t,useRender:Ef(i),createVisualElement:e,Component:n};return ef(a)}}function Tl(t,e){if(!Array.isArray(e))return!1;const s=e.length;if(s!==t.length)return!1;for(let n=0;n<s;n++)if(e[n]!==t[n])return!1;return!0}function Bn(t,e,s){const n=t.getProps();return ai(n,e,s!==void 0?s:n.custom,t)}const Rf=ei(()=>window.ScrollTimeline!==void 0);class Df{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,s){for(let n=0;n<this.animations.length;n++)this.animations[n][e]=s}attachTimeline(e,s){const n=this.animations.map(i=>{if(Rf()&&i.attachTimeline)return i.attachTimeline(e);if(typeof s=="function")return s(i)});return()=>{n.forEach((i,o)=>{i&&i(),this.animations[o].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let s=0;s<this.animations.length;s++)e=Math.max(e,this.animations[s].duration);return e}runAll(e){this.animations.forEach(s=>s[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class Lf extends Df{then(e,s){return Promise.all(this.animations).then(e).catch(s)}}function mi(t,e){return t?t[e]||t.default||t:void 0}const kr=2e4;function Al(t){let e=0;const s=50;let n=t.next(e);for(;!n.done&&e<kr;)e+=s,n=t.next(e);return e>=kr?1/0:e}function pi(t){return typeof t=="function"}function ja(t,e){t.timeline=e,t.onfinish=null}const gi=t=>Array.isArray(t)&&typeof t[0]=="number",Of={linearEasing:void 0};function Ff(t,e){const s=ei(t);return()=>{var n;return(n=Of[e])!==null&&n!==void 0?n:s()}}const En=Ff(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),El=(t,e,s=10)=>{let n="";const i=Math.max(Math.round(e/s),2);for(let o=0;o<i;o++)n+=t(Cs(0,i-1,o))+", ";return`linear(${n.substring(0,n.length-2)})`};function Ml(t){return!!(typeof t=="function"&&En()||!t||typeof t=="string"&&(t in Pr||En())||gi(t)||Array.isArray(t)&&t.every(Ml))}const Vs=([t,e,s,n])=>`cubic-bezier(${t}, ${e}, ${s}, ${n})`,Pr={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Vs([0,.65,.55,1]),circOut:Vs([.55,0,1,.45]),backIn:Vs([.31,.01,.66,-.59]),backOut:Vs([.33,1.53,.69,.99])};function Rl(t,e){if(t)return typeof t=="function"&&En()?El(t,e):gi(t)?Vs(t):Array.isArray(t)?t.map(s=>Rl(s,e)||Pr.easeOut):Pr[t]}const et={x:!1,y:!1};function Dl(){return et.x||et.y}function Vf(t,e,s){var n;if(t instanceof Element)return[t];if(typeof t=="string"){let i=document;const o=(n=void 0)!==null&&n!==void 0?n:i.querySelectorAll(t);return o?Array.from(o):[]}return Array.from(t)}function Ll(t,e){const s=Vf(t),n=new AbortController,i={passive:!0,...e,signal:n.signal};return[s,i,()=>n.abort()]}function Na(t){return e=>{e.pointerType==="touch"||Dl()||t(e)}}function If(t,e,s={}){const[n,i,o]=Ll(t,s),a=Na(c=>{const{target:l}=c,u=e(c);if(typeof u!="function"||!l)return;const h=Na(f=>{u(f),l.removeEventListener("pointerleave",h)});l.addEventListener("pointerleave",h,i)});return n.forEach(c=>{c.addEventListener("pointerenter",a,i)}),o}const Ol=(t,e)=>e?t===e?!0:Ol(t,e.parentElement):!1,xi=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,qf=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function $f(t){return qf.has(t.tagName)||t.tabIndex!==-1}const Is=new WeakSet;function Sa(t){return e=>{e.key==="Enter"&&t(e)}}function Jn(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const Bf=(t,e)=>{const s=t.currentTarget;if(!s)return;const n=Sa(()=>{if(Is.has(s))return;Jn(s,"down");const i=Sa(()=>{Jn(s,"up")}),o=()=>Jn(s,"cancel");s.addEventListener("keyup",i,e),s.addEventListener("blur",o,e)});s.addEventListener("keydown",n,e),s.addEventListener("blur",()=>s.removeEventListener("keydown",n),e)};function Ca(t){return xi(t)&&!Dl()}function Uf(t,e,s={}){const[n,i,o]=Ll(t,s),a=c=>{const l=c.currentTarget;if(!Ca(c)||Is.has(l))return;Is.add(l);const u=e(c),h=(g,x)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",m),!(!Ca(g)||!Is.has(l))&&(Is.delete(l),typeof u=="function"&&u(g,{success:x}))},f=g=>{h(g,s.useGlobalTarget||Ol(l,g.target))},m=g=>{h(g,!1)};window.addEventListener("pointerup",f,i),window.addEventListener("pointercancel",m,i)};return n.forEach(c=>{!$f(c)&&c.getAttribute("tabindex")===null&&(c.tabIndex=0),(s.useGlobalTarget?window:c).addEventListener("pointerdown",a,i),c.addEventListener("focus",u=>Bf(u,i),i)}),o}function Gf(t){return t==="x"||t==="y"?et[t]?null:(et[t]=!0,()=>{et[t]=!1}):et.x||et.y?null:(et.x=et.y=!0,()=>{et.x=et.y=!1})}const Fl=new Set(["width","height","top","left","right","bottom",...Ts]);let Cn;function zf(){Cn=void 0}const lt={now:()=>(Cn===void 0&&lt.set(Te.isProcessing||Ih.useManualTiming?Te.timestamp:performance.now()),Cn),set:t=>{Cn=t,queueMicrotask(zf)}};function yi(t,e){t.indexOf(e)===-1&&t.push(e)}function vi(t,e){const s=t.indexOf(e);s>-1&&t.splice(s,1)}class bi{constructor(){this.subscriptions=[]}add(e){return yi(this.subscriptions,e),()=>vi(this.subscriptions,e)}notify(e,s,n){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,s,n);else for(let o=0;o<i;o++){const a=this.subscriptions[o];a&&a(e,s,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function Vl(t,e){return e?t*(1e3/e):0}const _a=30,Hf=t=>!isNaN(parseFloat(t));class Kf{constructor(e,s={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(n,i=!0)=>{const o=lt.now();this.updatedAt!==o&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=s.owner}setCurrent(e){this.current=e,this.updatedAt=lt.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=Hf(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,s){this.events[e]||(this.events[e]=new bi);const n=this.events[e].add(s);return e==="change"?()=>{n(),pe.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,s){this.passiveEffect=e,this.stopPassiveEffect=s}set(e,s=!0){!s||!this.passiveEffect?this.updateAndNotify(e,s):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,s,n){this.set(s),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,s=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,s&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=lt.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>_a)return 0;const s=Math.min(this.updatedAt-this.prevUpdatedAt,_a);return Vl(parseFloat(this.current)-parseFloat(this.prevFrameValue),s)}start(e){return this.stop(),new Promise(s=>{this.hasAnimated=!0,this.animation=e(s),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Xs(t,e){return new Kf(t,e)}function Wf(t,e,s){t.hasValue(e)?t.getValue(e).set(s):t.addValue(e,Xs(s))}function Qf(t,e){const s=Bn(t,e);let{transitionEnd:n={},transition:i={},...o}=s||{};o={...o,...n};for(const a in o){const c=of(o[a]);Wf(t,a,c)}}function Yf(t){return!!(Re(t)&&t.add)}function Tr(t,e){const s=t.getValue("willChange");if(Yf(s))return s.add(e)}function Il(t){return t.props[pl]}const ql=(t,e,s)=>(((1-3*s+3*e)*t+(3*s-6*e))*t+3*e)*t,Xf=1e-7,Jf=12;function Zf(t,e,s,n,i){let o,a,c=0;do a=e+(s-e)/2,o=ql(a,n,i)-t,o>0?s=a:e=a;while(Math.abs(o)>Xf&&++c<Jf);return a}function cn(t,e,s,n){if(t===e&&s===n)return ze;const i=o=>Zf(o,0,1,t,s);return o=>o===0||o===1?o:ql(i(o),e,n)}const $l=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,Bl=t=>e=>1-t(1-e),Ul=cn(.33,1.53,.69,.99),wi=Bl(Ul),Gl=$l(wi),zl=t=>(t*=2)<1?.5*wi(t):.5*(2-Math.pow(2,-10*(t-1))),ji=t=>1-Math.sin(Math.acos(t)),Hl=Bl(ji),Kl=$l(ji),Wl=t=>/^0[^.\s]+$/u.test(t);function em(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||Wl(t):!0}const $s=t=>Math.round(t*1e5)/1e5,Ni=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function tm(t){return t==null}const sm=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Si=(t,e)=>s=>!!(typeof s=="string"&&sm.test(s)&&s.startsWith(t)||e&&!tm(s)&&Object.prototype.hasOwnProperty.call(s,e)),Ql=(t,e,s)=>n=>{if(typeof n!="string")return n;const[i,o,a,c]=n.match(Ni);return{[t]:parseFloat(i),[e]:parseFloat(o),[s]:parseFloat(a),alpha:c!==void 0?parseFloat(c):1}},nm=t=>mt(0,255,t),Zn={...As,transform:t=>Math.round(nm(t))},$t={test:Si("rgb","red"),parse:Ql("red","green","blue"),transform:({red:t,green:e,blue:s,alpha:n=1})=>"rgba("+Zn.transform(t)+", "+Zn.transform(e)+", "+Zn.transform(s)+", "+$s(Ys.transform(n))+")"};function rm(t){let e="",s="",n="",i="";return t.length>5?(e=t.substring(1,3),s=t.substring(3,5),n=t.substring(5,7),i=t.substring(7,9)):(e=t.substring(1,2),s=t.substring(2,3),n=t.substring(3,4),i=t.substring(4,5),e+=e,s+=s,n+=n,i+=i),{red:parseInt(e,16),green:parseInt(s,16),blue:parseInt(n,16),alpha:i?parseInt(i,16)/255:1}}const Ar={test:Si("#"),parse:rm,transform:$t.transform},os={test:Si("hsl","hue"),parse:Ql("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:s,alpha:n=1})=>"hsla("+Math.round(t)+", "+ot.transform($s(e))+", "+ot.transform($s(s))+", "+$s(Ys.transform(n))+")"},Me={test:t=>$t.test(t)||Ar.test(t)||os.test(t),parse:t=>$t.test(t)?$t.parse(t):os.test(t)?os.parse(t):Ar.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?$t.transform(t):os.transform(t)},im=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function am(t){var e,s;return isNaN(t)&&typeof t=="string"&&(((e=t.match(Ni))===null||e===void 0?void 0:e.length)||0)+(((s=t.match(im))===null||s===void 0?void 0:s.length)||0)>0}const Yl="number",Xl="color",om="var",lm="var(",ka="${}",cm=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Js(t){const e=t.toString(),s=[],n={color:[],number:[],var:[]},i=[];let o=0;const c=e.replace(cm,l=>(Me.test(l)?(n.color.push(o),i.push(Xl),s.push(Me.parse(l))):l.startsWith(lm)?(n.var.push(o),i.push(om),s.push(l)):(n.number.push(o),i.push(Yl),s.push(parseFloat(l))),++o,ka)).split(ka);return{values:s,split:c,indexes:n,types:i}}function Jl(t){return Js(t).values}function Zl(t){const{split:e,types:s}=Js(t),n=e.length;return i=>{let o="";for(let a=0;a<n;a++)if(o+=e[a],i[a]!==void 0){const c=s[a];c===Yl?o+=$s(i[a]):c===Xl?o+=Me.transform(i[a]):o+=i[a]}return o}}const um=t=>typeof t=="number"?0:t;function dm(t){const e=Jl(t);return Zl(t)(e.map(um))}const At={test:am,parse:Jl,createTransformer:Zl,getAnimatableNone:dm},hm=new Set(["brightness","contrast","saturate","opacity"]);function fm(t){const[e,s]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[n]=s.match(Ni)||[];if(!n)return t;const i=s.replace(n,"");let o=hm.has(e)?1:0;return n!==s&&(o*=100),e+"("+o+i+")"}const mm=/\b([a-z-]*)\(.*?\)/gu,Er={...At,getAnimatableNone:t=>{const e=t.match(mm);return e?e.map(fm).join(" "):t}},pm={...li,color:Me,backgroundColor:Me,outlineColor:Me,fill:Me,stroke:Me,borderColor:Me,borderTopColor:Me,borderRightColor:Me,borderBottomColor:Me,borderLeftColor:Me,filter:Er,WebkitFilter:Er},Ci=t=>pm[t];function ec(t,e){let s=Ci(t);return s!==Er&&(s=At),s.getAnimatableNone?s.getAnimatableNone(e):void 0}const gm=new Set(["auto","none","0"]);function xm(t,e,s){let n=0,i;for(;n<t.length&&!i;){const o=t[n];typeof o=="string"&&!gm.has(o)&&Js(o).values.length&&(i=t[n]),n++}if(i&&s)for(const o of e)t[o]=ec(s,i)}const Pa=t=>t===As||t===ee,Ta=(t,e)=>parseFloat(t.split(", ")[e]),Aa=(t,e)=>(s,{transform:n})=>{if(n==="none"||!n)return 0;const i=n.match(/^matrix3d\((.+)\)$/u);if(i)return Ta(i[1],e);{const o=n.match(/^matrix\((.+)\)$/u);return o?Ta(o[1],t):0}},ym=new Set(["x","y","z"]),vm=Ts.filter(t=>!ym.has(t));function bm(t){const e=[];return vm.forEach(s=>{const n=t.getValue(s);n!==void 0&&(e.push([s,n.get()]),n.set(s.startsWith("scale")?1:0))}),e}const ks={width:({x:t},{paddingLeft:e="0",paddingRight:s="0"})=>t.max-t.min-parseFloat(e)-parseFloat(s),height:({y:t},{paddingTop:e="0",paddingBottom:s="0"})=>t.max-t.min-parseFloat(e)-parseFloat(s),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:Aa(4,13),y:Aa(5,14)};ks.translateX=ks.x;ks.translateY=ks.y;const Xt=new Set;let Mr=!1,Rr=!1;function tc(){if(Rr){const t=Array.from(Xt).filter(n=>n.needsMeasurement),e=new Set(t.map(n=>n.element)),s=new Map;e.forEach(n=>{const i=bm(n);i.length&&(s.set(n,i),n.render())}),t.forEach(n=>n.measureInitialState()),e.forEach(n=>{n.render();const i=s.get(n);i&&i.forEach(([o,a])=>{var c;(c=n.getValue(o))===null||c===void 0||c.set(a)})}),t.forEach(n=>n.measureEndState()),t.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}Rr=!1,Mr=!1,Xt.forEach(t=>t.complete()),Xt.clear()}function sc(){Xt.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Rr=!0)})}function wm(){sc(),tc()}class _i{constructor(e,s,n,i,o,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=s,this.name=n,this.motionValue=i,this.element=o,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Xt.add(this),Mr||(Mr=!0,pe.read(sc),pe.resolveKeyframes(tc))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:s,element:n,motionValue:i}=this;for(let o=0;o<e.length;o++)if(e[o]===null)if(o===0){const a=i?.get(),c=e[e.length-1];if(a!==void 0)e[0]=a;else if(n&&s){const l=n.readValue(s,c);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=c),i&&a===void 0&&i.set(e[0])}else e[o]=e[o-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Xt.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Xt.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const nc=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),jm=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Nm(t){const e=jm.exec(t);if(!e)return[,];const[,s,n,i]=e;return[`--${s??n}`,i]}function rc(t,e,s=1){const[n,i]=Nm(t);if(!n)return;const o=window.getComputedStyle(e).getPropertyValue(n);if(o){const a=o.trim();return nc(a)?parseFloat(a):a}return oi(i)?rc(i,e,s+1):i}const ic=t=>e=>e.test(t),Sm={test:t=>t==="auto",parse:t=>t},ac=[As,ee,ot,vt,ff,hf,Sm],Ea=t=>ac.find(ic(t));class oc extends _i{constructor(e,s,n,i,o){super(e,s,n,i,o,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:s,name:n}=this;if(!s||!s.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let u=e[l];if(typeof u=="string"&&(u=u.trim(),oi(u))){const h=rc(u,s.current);h!==void 0&&(e[l]=h),l===e.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!Fl.has(n)||e.length!==2)return;const[i,o]=e,a=Ea(i),c=Ea(o);if(a!==c)if(Pa(a)&&Pa(c))for(let l=0;l<e.length;l++){const u=e[l];typeof u=="string"&&(e[l]=parseFloat(u))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:s}=this,n=[];for(let i=0;i<e.length;i++)em(e[i])&&n.push(i);n.length&&xm(e,n,s)}measureInitialState(){const{element:e,unresolvedKeyframes:s,name:n}=this;if(!e||!e.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=ks[n](e.measureViewportBox(),window.getComputedStyle(e.current)),s[0]=this.measuredOrigin;const i=s[s.length-1];i!==void 0&&e.getValue(n,i).jump(i,!1)}measureEndState(){var e;const{element:s,name:n,unresolvedKeyframes:i}=this;if(!s||!s.current)return;const o=s.getValue(n);o&&o.jump(this.measuredOrigin,!1);const a=i.length-1,c=i[a];i[a]=ks[n](s.measureViewportBox(),window.getComputedStyle(s.current)),c!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=c),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,u])=>{s.getValue(l).set(u)}),this.resolveNoneKeyframes()}}const Ma=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(At.test(t)||t==="0")&&!t.startsWith("url("));function Cm(t){const e=t[0];if(t.length===1)return!0;for(let s=0;s<t.length;s++)if(t[s]!==e)return!0}function _m(t,e,s,n){const i=t[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const o=t[t.length-1],a=Ma(i,e),c=Ma(o,e);return!a||!c?!1:Cm(t)||(s==="spring"||pi(s))&&n}const km=t=>t!==null;function Un(t,{repeat:e,repeatType:s="loop"},n){const i=t.filter(km),o=e&&s!=="loop"&&e%2===1?0:i.length-1;return!o||n===void 0?i[o]:n}const Pm=40;class lc{constructor({autoplay:e=!0,delay:s=0,type:n="keyframes",repeat:i=0,repeatDelay:o=0,repeatType:a="loop",...c}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=lt.now(),this.options={autoplay:e,delay:s,type:n,repeat:i,repeatDelay:o,repeatType:a,...c},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>Pm?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&wm(),this._resolved}onKeyframesResolved(e,s){this.resolvedAt=lt.now(),this.hasAttemptedResolve=!0;const{name:n,type:i,velocity:o,delay:a,onComplete:c,onUpdate:l,isGenerator:u}=this.options;if(!u&&!_m(e,n,i,o))if(a)this.options.duration=0;else{l&&l(Un(e,this.options,s)),c&&c(),this.resolveFinishedPromise();return}const h=this.initPlayback(e,s);h!==!1&&(this._resolved={keyframes:e,finalKeyframe:s,...h},this.onPostResolved())}onPostResolved(){}then(e,s){return this.currentFinishedPromise.then(e,s)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const xe=(t,e,s)=>t+(e-t)*s;function er(t,e,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?t+(e-t)*6*s:s<1/2?e:s<2/3?t+(e-t)*(2/3-s)*6:t}function Tm({hue:t,saturation:e,lightness:s,alpha:n}){t/=360,e/=100,s/=100;let i=0,o=0,a=0;if(!e)i=o=a=s;else{const c=s<.5?s*(1+e):s+e-s*e,l=2*s-c;i=er(l,c,t+1/3),o=er(l,c,t),a=er(l,c,t-1/3)}return{red:Math.round(i*255),green:Math.round(o*255),blue:Math.round(a*255),alpha:n}}function Mn(t,e){return s=>s>0?e:t}const tr=(t,e,s)=>{const n=t*t,i=s*(e*e-n)+n;return i<0?0:Math.sqrt(i)},Am=[Ar,$t,os],Em=t=>Am.find(e=>e.test(t));function Ra(t){const e=Em(t);if(!e)return!1;let s=e.parse(t);return e===os&&(s=Tm(s)),s}const Da=(t,e)=>{const s=Ra(t),n=Ra(e);if(!s||!n)return Mn(t,e);const i={...s};return o=>(i.red=tr(s.red,n.red,o),i.green=tr(s.green,n.green,o),i.blue=tr(s.blue,n.blue,o),i.alpha=xe(s.alpha,n.alpha,o),$t.transform(i))},Mm=(t,e)=>s=>e(t(s)),un=(...t)=>t.reduce(Mm),Dr=new Set(["none","hidden"]);function Rm(t,e){return Dr.has(t)?s=>s<=0?t:e:s=>s>=1?e:t}function Dm(t,e){return s=>xe(t,e,s)}function ki(t){return typeof t=="number"?Dm:typeof t=="string"?oi(t)?Mn:Me.test(t)?Da:Fm:Array.isArray(t)?cc:typeof t=="object"?Me.test(t)?Da:Lm:Mn}function cc(t,e){const s=[...t],n=s.length,i=t.map((o,a)=>ki(o)(o,e[a]));return o=>{for(let a=0;a<n;a++)s[a]=i[a](o);return s}}function Lm(t,e){const s={...t,...e},n={};for(const i in s)t[i]!==void 0&&e[i]!==void 0&&(n[i]=ki(t[i])(t[i],e[i]));return i=>{for(const o in n)s[o]=n[o](i);return s}}function Om(t,e){var s;const n=[],i={color:0,var:0,number:0};for(let o=0;o<e.values.length;o++){const a=e.types[o],c=t.indexes[a][i[a]],l=(s=t.values[c])!==null&&s!==void 0?s:0;n[o]=l,i[a]++}return n}const Fm=(t,e)=>{const s=At.createTransformer(e),n=Js(t),i=Js(e);return n.indexes.var.length===i.indexes.var.length&&n.indexes.color.length===i.indexes.color.length&&n.indexes.number.length>=i.indexes.number.length?Dr.has(t)&&!i.values.length||Dr.has(e)&&!n.values.length?Rm(t,e):un(cc(Om(n,i),i.values),s):Mn(t,e)};function uc(t,e,s){return typeof t=="number"&&typeof e=="number"&&typeof s=="number"?xe(t,e,s):ki(t)(t,e)}const Vm=5;function dc(t,e,s){const n=Math.max(e-Vm,0);return Vl(s-t(n),e-n)}const be={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},sr=.001;function Im({duration:t=be.duration,bounce:e=be.bounce,velocity:s=be.velocity,mass:n=be.mass}){let i,o,a=1-e;a=mt(be.minDamping,be.maxDamping,a),t=mt(be.minDuration,be.maxDuration,ft(t)),a<1?(i=u=>{const h=u*a,f=h*t,m=h-s,g=Lr(u,a),x=Math.exp(-f);return sr-m/g*x},o=u=>{const f=u*a*t,m=f*s+s,g=Math.pow(a,2)*Math.pow(u,2)*t,x=Math.exp(-f),v=Lr(Math.pow(u,2),a);return(-i(u)+sr>0?-1:1)*((m-g)*x)/v}):(i=u=>{const h=Math.exp(-u*t),f=(u-s)*t+1;return-sr+h*f},o=u=>{const h=Math.exp(-u*t),f=(s-u)*(t*t);return h*f});const c=5/t,l=$m(i,o,c);if(t=ht(t),isNaN(l))return{stiffness:be.stiffness,damping:be.damping,duration:t};{const u=Math.pow(l,2)*n;return{stiffness:u,damping:a*2*Math.sqrt(n*u),duration:t}}}const qm=12;function $m(t,e,s){let n=s;for(let i=1;i<qm;i++)n=n-t(n)/e(n);return n}function Lr(t,e){return t*Math.sqrt(1-e*e)}const Bm=["duration","bounce"],Um=["stiffness","damping","mass"];function La(t,e){return e.some(s=>t[s]!==void 0)}function Gm(t){let e={velocity:be.velocity,stiffness:be.stiffness,damping:be.damping,mass:be.mass,isResolvedFromDuration:!1,...t};if(!La(t,Um)&&La(t,Bm))if(t.visualDuration){const s=t.visualDuration,n=2*Math.PI/(s*1.2),i=n*n,o=2*mt(.05,1,1-(t.bounce||0))*Math.sqrt(i);e={...e,mass:be.mass,stiffness:i,damping:o}}else{const s=Im(t);e={...e,...s,mass:be.mass},e.isResolvedFromDuration=!0}return e}function hc(t=be.visualDuration,e=be.bounce){const s=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:n,restDelta:i}=s;const o=s.keyframes[0],a=s.keyframes[s.keyframes.length-1],c={done:!1,value:o},{stiffness:l,damping:u,mass:h,duration:f,velocity:m,isResolvedFromDuration:g}=Gm({...s,velocity:-ft(s.velocity||0)}),x=m||0,v=u/(2*Math.sqrt(l*h)),y=a-o,j=ft(Math.sqrt(l/h)),A=Math.abs(y)<5;n||(n=A?be.restSpeed.granular:be.restSpeed.default),i||(i=A?be.restDelta.granular:be.restDelta.default);let E;if(v<1){const _=Lr(j,v);E=$=>{const S=Math.exp(-v*j*$);return a-S*((x+v*j*y)/_*Math.sin(_*$)+y*Math.cos(_*$))}}else if(v===1)E=_=>a-Math.exp(-j*_)*(y+(x+j*y)*_);else{const _=j*Math.sqrt(v*v-1);E=$=>{const S=Math.exp(-v*j*$),C=Math.min(_*$,300);return a-S*((x+v*j*y)*Math.sinh(C)+_*y*Math.cosh(C))/_}}const M={calculatedDuration:g&&f||null,next:_=>{const $=E(_);if(g)c.done=_>=f;else{let S=0;v<1&&(S=_===0?ht(x):dc(E,_,$));const C=Math.abs(S)<=n,R=Math.abs(a-$)<=i;c.done=C&&R}return c.value=c.done?a:$,c},toString:()=>{const _=Math.min(Al(M),kr),$=El(S=>M.next(_*S).value,_,30);return _+"ms "+$}};return M}function Oa({keyframes:t,velocity:e=0,power:s=.8,timeConstant:n=325,bounceDamping:i=10,bounceStiffness:o=500,modifyTarget:a,min:c,max:l,restDelta:u=.5,restSpeed:h}){const f=t[0],m={done:!1,value:f},g=C=>c!==void 0&&C<c||l!==void 0&&C>l,x=C=>c===void 0?l:l===void 0||Math.abs(c-C)<Math.abs(l-C)?c:l;let v=s*e;const y=f+v,j=a===void 0?y:a(y);j!==y&&(v=j-f);const A=C=>-v*Math.exp(-C/n),E=C=>j+A(C),M=C=>{const R=A(C),q=E(C);m.done=Math.abs(R)<=u,m.value=m.done?j:q};let _,$;const S=C=>{g(m.value)&&(_=C,$=hc({keyframes:[m.value,x(m.value)],velocity:dc(E,C,m.value),damping:i,stiffness:o,restDelta:u,restSpeed:h}))};return S(0),{calculatedDuration:null,next:C=>{let R=!1;return!$&&_===void 0&&(R=!0,M(C),S(C)),_!==void 0&&C>=_?$.next(C-_):(!R&&M(C),m)}}}const zm=cn(.42,0,1,1),Hm=cn(0,0,.58,1),fc=cn(.42,0,.58,1),Km=t=>Array.isArray(t)&&typeof t[0]!="number",Wm={linear:ze,easeIn:zm,easeInOut:fc,easeOut:Hm,circIn:ji,circInOut:Kl,circOut:Hl,backIn:wi,backInOut:Gl,backOut:Ul,anticipate:zl},Fa=t=>{if(gi(t)){ul(t.length===4);const[e,s,n,i]=t;return cn(e,s,n,i)}else if(typeof t=="string")return Wm[t];return t};function Qm(t,e,s){const n=[],i=s||uc,o=t.length-1;for(let a=0;a<o;a++){let c=i(t[a],t[a+1]);if(e){const l=Array.isArray(e)?e[a]||ze:e;c=un(l,c)}n.push(c)}return n}function Ym(t,e,{clamp:s=!0,ease:n,mixer:i}={}){const o=t.length;if(ul(o===e.length),o===1)return()=>e[0];if(o===2&&e[0]===e[1])return()=>e[1];const a=t[0]===t[1];t[0]>t[o-1]&&(t=[...t].reverse(),e=[...e].reverse());const c=Qm(e,n,i),l=c.length,u=h=>{if(a&&h<t[0])return e[0];let f=0;if(l>1)for(;f<t.length-2&&!(h<t[f+1]);f++);const m=Cs(t[f],t[f+1],h);return c[f](m)};return s?h=>u(mt(t[0],t[o-1],h)):u}function Xm(t,e){const s=t[t.length-1];for(let n=1;n<=e;n++){const i=Cs(0,e,n);t.push(xe(s,1,i))}}function Jm(t){const e=[0];return Xm(e,t.length-1),e}function Zm(t,e){return t.map(s=>s*e)}function ep(t,e){return t.map(()=>e||fc).splice(0,t.length-1)}function Rn({duration:t=300,keyframes:e,times:s,ease:n="easeInOut"}){const i=Km(n)?n.map(Fa):Fa(n),o={done:!1,value:e[0]},a=Zm(s&&s.length===e.length?s:Jm(e),t),c=Ym(a,e,{ease:Array.isArray(i)?i:ep(e,i)});return{calculatedDuration:t,next:l=>(o.value=c(l),o.done=l>=t,o)}}const tp=t=>{const e=({timestamp:s})=>t(s);return{start:()=>pe.update(e,!0),stop:()=>Tt(e),now:()=>Te.isProcessing?Te.timestamp:lt.now()}},sp={decay:Oa,inertia:Oa,tween:Rn,keyframes:Rn,spring:hc},np=t=>t/100;class Pi extends lc{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:s,motionValue:n,element:i,keyframes:o}=this.options,a=i?.KeyframeResolver||_i,c=(l,u)=>this.onKeyframesResolved(l,u);this.resolver=new a(o,c,s,n,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:s="keyframes",repeat:n=0,repeatDelay:i=0,repeatType:o,velocity:a=0}=this.options,c=pi(s)?s:sp[s]||Rn;let l,u;c!==Rn&&typeof e[0]!="number"&&(l=un(np,uc(e[0],e[1])),e=[0,100]);const h=c({...this.options,keyframes:e});o==="mirror"&&(u=c({...this.options,keyframes:[...e].reverse(),velocity:-a})),h.calculatedDuration===null&&(h.calculatedDuration=Al(h));const{calculatedDuration:f}=h,m=f+i,g=m*(n+1)-i;return{generator:h,mirroredGenerator:u,mapPercentToKeyframes:l,calculatedDuration:f,resolvedDuration:m,totalDuration:g}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,s=!1){const{resolved:n}=this;if(!n){const{keyframes:C}=this.options;return{done:!0,value:C[C.length-1]}}const{finalKeyframe:i,generator:o,mirroredGenerator:a,mapPercentToKeyframes:c,keyframes:l,calculatedDuration:u,totalDuration:h,resolvedDuration:f}=n;if(this.startTime===null)return o.next(0);const{delay:m,repeat:g,repeatType:x,repeatDelay:v,onUpdate:y}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-h/this.speed,this.startTime)),s?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const j=this.currentTime-m*(this.speed>=0?1:-1),A=this.speed>=0?j<0:j>h;this.currentTime=Math.max(j,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=h);let E=this.currentTime,M=o;if(g){const C=Math.min(this.currentTime,h)/f;let R=Math.floor(C),q=C%1;!q&&C>=1&&(q=1),q===1&&R--,R=Math.min(R,g+1),!!(R%2)&&(x==="reverse"?(q=1-q,v&&(q-=v/f)):x==="mirror"&&(M=a)),E=mt(0,1,q)*f}const _=A?{done:!1,value:l[0]}:M.next(E);c&&(_.value=c(_.value));let{done:$}=_;!A&&u!==null&&($=this.speed>=0?this.currentTime>=h:this.currentTime<=0);const S=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&$);return S&&i!==void 0&&(_.value=Un(l,this.options,i)),y&&y(_.value),S&&this.finish(),_}get duration(){const{resolved:e}=this;return e?ft(e.calculatedDuration):0}get time(){return ft(this.currentTime)}set time(e){e=ht(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const s=this.playbackSpeed!==e;this.playbackSpeed=e,s&&(this.time=ft(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=tp,onPlay:s,startTime:n}=this.options;this.driver||(this.driver=e(o=>this.tick(o))),s&&s();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=n??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const rp=new Set(["opacity","clipPath","filter","transform"]);function ip(t,e,s,{delay:n=0,duration:i=300,repeat:o=0,repeatType:a="loop",ease:c="easeInOut",times:l}={}){const u={[e]:s};l&&(u.offset=l);const h=Rl(c,i);return Array.isArray(h)&&(u.easing=h),t.animate(u,{delay:n,duration:i,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:o+1,direction:a==="reverse"?"alternate":"normal"})}const ap=ei(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Dn=10,op=2e4;function lp(t){return pi(t.type)||t.type==="spring"||!Ml(t.ease)}function cp(t,e){const s=new Pi({...e,keyframes:t,repeat:0,delay:0,isGenerator:!0});let n={done:!1,value:t[0]};const i=[];let o=0;for(;!n.done&&o<op;)n=s.sample(o),i.push(n.value),o+=Dn;return{times:void 0,keyframes:i,duration:o-Dn,ease:"linear"}}const mc={anticipate:zl,backInOut:Gl,circInOut:Kl};function up(t){return t in mc}class Va extends lc{constructor(e){super(e);const{name:s,motionValue:n,element:i,keyframes:o}=this.options;this.resolver=new oc(o,(a,c)=>this.onKeyframesResolved(a,c),s,n,i),this.resolver.scheduleResolve()}initPlayback(e,s){let{duration:n=300,times:i,ease:o,type:a,motionValue:c,name:l,startTime:u}=this.options;if(!c.owner||!c.owner.current)return!1;if(typeof o=="string"&&En()&&up(o)&&(o=mc[o]),lp(this.options)){const{onComplete:f,onUpdate:m,motionValue:g,element:x,...v}=this.options,y=cp(e,v);e=y.keyframes,e.length===1&&(e[1]=e[0]),n=y.duration,i=y.times,o=y.ease,a="keyframes"}const h=ip(c.owner.current,l,e,{...this.options,duration:n,times:i,ease:o});return h.startTime=u??this.calcStartTime(),this.pendingTimeline?(ja(h,this.pendingTimeline),this.pendingTimeline=void 0):h.onfinish=()=>{const{onComplete:f}=this.options;c.set(Un(e,this.options,s)),f&&f(),this.cancel(),this.resolveFinishedPromise()},{animation:h,duration:n,times:i,type:a,ease:o,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:s}=e;return ft(s)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:s}=e;return ft(s.currentTime||0)}set time(e){const{resolved:s}=this;if(!s)return;const{animation:n}=s;n.currentTime=ht(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:s}=e;return s.playbackRate}set speed(e){const{resolved:s}=this;if(!s)return;const{animation:n}=s;n.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:s}=e;return s.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:s}=e;return s.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:s}=this;if(!s)return ze;const{animation:n}=s;ja(n,e)}return ze}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:s}=e;s.playState==="finished"&&this.updateFinishedPromise(),s.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:s}=e;s.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:s,keyframes:n,duration:i,type:o,ease:a,times:c}=e;if(s.playState==="idle"||s.playState==="finished")return;if(this.time){const{motionValue:u,onUpdate:h,onComplete:f,element:m,...g}=this.options,x=new Pi({...g,keyframes:n,duration:i,type:o,ease:a,times:c,isGenerator:!0}),v=ht(this.time);u.setWithVelocity(x.sample(v-Dn).value,x.sample(v).value,Dn)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:s,name:n,repeatDelay:i,repeatType:o,damping:a,type:c}=e;if(!s||!s.owner||!(s.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:u}=s.owner.getProps();return ap()&&n&&rp.has(n)&&!l&&!u&&!i&&o!=="mirror"&&a!==0&&c!=="inertia"}}const dp={type:"spring",stiffness:500,damping:25,restSpeed:10},hp=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),fp={type:"keyframes",duration:.8},mp={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},pp=(t,{keyframes:e})=>e.length>2?fp:es.has(t)?t.startsWith("scale")?hp(e[1]):dp:mp;function gp({when:t,delay:e,delayChildren:s,staggerChildren:n,staggerDirection:i,repeat:o,repeatType:a,repeatDelay:c,from:l,elapsed:u,...h}){return!!Object.keys(h).length}const Ti=(t,e,s,n={},i,o)=>a=>{const c=mi(n,t)||{},l=c.delay||n.delay||0;let{elapsed:u=0}=n;u=u-ht(l);let h={keyframes:Array.isArray(s)?s:[null,s],ease:"easeOut",velocity:e.getVelocity(),...c,delay:-u,onUpdate:m=>{e.set(m),c.onUpdate&&c.onUpdate(m)},onComplete:()=>{a(),c.onComplete&&c.onComplete()},name:t,motionValue:e,element:o?void 0:i};gp(c)||(h={...h,...pp(t,h)}),h.duration&&(h.duration=ht(h.duration)),h.repeatDelay&&(h.repeatDelay=ht(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let f=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(h.duration=0,h.delay===0&&(f=!0)),f&&!o&&e.get()!==void 0){const m=Un(h.keyframes,c);if(m!==void 0)return pe.update(()=>{h.onUpdate(m),h.onComplete()}),new Lf([])}return!o&&Va.supports(h)?new Va(h):new Pi(h)};function xp({protectedKeys:t,needsAnimating:e},s){const n=t.hasOwnProperty(s)&&e[s]!==!0;return e[s]=!1,n}function pc(t,e,{delay:s=0,transitionOverride:n,type:i}={}){var o;let{transition:a=t.getDefaultTransition(),transitionEnd:c,...l}=e;n&&(a=n);const u=[],h=i&&t.animationState&&t.animationState.getState()[i];for(const f in l){const m=t.getValue(f,(o=t.latestValues[f])!==null&&o!==void 0?o:null),g=l[f];if(g===void 0||h&&xp(h,f))continue;const x={delay:s,...mi(a||{},f)};let v=!1;if(window.MotionHandoffAnimation){const j=Il(t);if(j){const A=window.MotionHandoffAnimation(j,f,pe);A!==null&&(x.startTime=A,v=!0)}}Tr(t,f),m.start(Ti(f,m,g,t.shouldReduceMotion&&Fl.has(f)?{type:!1}:x,t,v));const y=m.animation;y&&u.push(y)}return c&&Promise.all(u).then(()=>{pe.update(()=>{c&&Qf(t,c)})}),u}function Or(t,e,s={}){var n;const i=Bn(t,e,s.type==="exit"?(n=t.presenceContext)===null||n===void 0?void 0:n.custom:void 0);let{transition:o=t.getDefaultTransition()||{}}=i||{};s.transitionOverride&&(o=s.transitionOverride);const a=i?()=>Promise.all(pc(t,i,s)):()=>Promise.resolve(),c=t.variantChildren&&t.variantChildren.size?(u=0)=>{const{delayChildren:h=0,staggerChildren:f,staggerDirection:m}=o;return yp(t,e,h+u,f,m,s)}:()=>Promise.resolve(),{when:l}=o;if(l){const[u,h]=l==="beforeChildren"?[a,c]:[c,a];return u().then(()=>h())}else return Promise.all([a(),c(s.delay)])}function yp(t,e,s=0,n=0,i=1,o){const a=[],c=(t.variantChildren.size-1)*n,l=i===1?(u=0)=>u*n:(u=0)=>c-u*n;return Array.from(t.variantChildren).sort(vp).forEach((u,h)=>{u.notify("AnimationStart",e),a.push(Or(u,e,{...o,delay:s+l(h)}).then(()=>u.notify("AnimationComplete",e)))}),Promise.all(a)}function vp(t,e){return t.sortNodePosition(e)}function bp(t,e,s={}){t.notify("AnimationStart",e);let n;if(Array.isArray(e)){const i=e.map(o=>Or(t,o,s));n=Promise.all(i)}else if(typeof e=="string")n=Or(t,e,s);else{const i=typeof e=="function"?Bn(t,e,s.custom):e;n=Promise.all(pc(t,i,s))}return n.then(()=>{t.notify("AnimationComplete",e)})}const wp=si.length;function gc(t){if(!t)return;if(!t.isControllingVariants){const s=t.parent?gc(t.parent)||{}:{};return t.props.initial!==void 0&&(s.initial=t.props.initial),s}const e={};for(let s=0;s<wp;s++){const n=si[s],i=t.props[n];(Qs(i)||i===!1)&&(e[n]=i)}return e}const jp=[...ti].reverse(),Np=ti.length;function Sp(t){return e=>Promise.all(e.map(({animation:s,options:n})=>bp(t,s,n)))}function Cp(t){let e=Sp(t),s=Ia(),n=!0;const i=l=>(u,h)=>{var f;const m=Bn(t,h,l==="exit"?(f=t.presenceContext)===null||f===void 0?void 0:f.custom:void 0);if(m){const{transition:g,transitionEnd:x,...v}=m;u={...u,...v,...x}}return u};function o(l){e=l(t)}function a(l){const{props:u}=t,h=gc(t.parent)||{},f=[],m=new Set;let g={},x=1/0;for(let y=0;y<Np;y++){const j=jp[y],A=s[j],E=u[j]!==void 0?u[j]:h[j],M=Qs(E),_=j===l?A.isActive:null;_===!1&&(x=y);let $=E===h[j]&&E!==u[j]&&M;if($&&n&&t.manuallyAnimateOnMount&&($=!1),A.protectedKeys={...g},!A.isActive&&_===null||!E&&!A.prevProp||qn(E)||typeof E=="boolean")continue;const S=_p(A.prevProp,E);let C=S||j===l&&A.isActive&&!$&&M||y>x&&M,R=!1;const q=Array.isArray(E)?E:[E];let Q=q.reduce(i(j),{});_===!1&&(Q={});const{prevResolvedValues:U={}}=A,P={...U,...Q},T=D=>{C=!0,m.has(D)&&(R=!0,m.delete(D)),A.needsAnimating[D]=!0;const I=t.getValue(D);I&&(I.liveStyle=!1)};for(const D in P){const I=Q[D],z=U[D];if(g.hasOwnProperty(D))continue;let b=!1;_r(I)&&_r(z)?b=!Tl(I,z):b=I!==z,b?I!=null?T(D):m.add(D):I!==void 0&&m.has(D)?T(D):A.protectedKeys[D]=!0}A.prevProp=E,A.prevResolvedValues=Q,A.isActive&&(g={...g,...Q}),n&&t.blockInitialAnimation&&(C=!1),C&&(!($&&S)||R)&&f.push(...q.map(D=>({animation:D,options:{type:j}})))}if(m.size){const y={};m.forEach(j=>{const A=t.getBaseTarget(j),E=t.getValue(j);E&&(E.liveStyle=!0),y[j]=A??null}),f.push({animation:y})}let v=!!f.length;return n&&(u.initial===!1||u.initial===u.animate)&&!t.manuallyAnimateOnMount&&(v=!1),n=!1,v?e(f):Promise.resolve()}function c(l,u){var h;if(s[l].isActive===u)return Promise.resolve();(h=t.variantChildren)===null||h===void 0||h.forEach(m=>{var g;return(g=m.animationState)===null||g===void 0?void 0:g.setActive(l,u)}),s[l].isActive=u;const f=a(l);for(const m in s)s[m].protectedKeys={};return f}return{animateChanges:a,setActive:c,setAnimateFunction:o,getState:()=>s,reset:()=>{s=Ia(),n=!0}}}function _p(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!Tl(e,t):!1}function Ft(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Ia(){return{animate:Ft(!0),whileInView:Ft(),whileHover:Ft(),whileTap:Ft(),whileDrag:Ft(),whileFocus:Ft(),exit:Ft()}}class Mt{constructor(e){this.isMounted=!1,this.node=e}update(){}}class kp extends Mt{constructor(e){super(e),e.animationState||(e.animationState=Cp(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();qn(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:s}=this.node.prevProps||{};e!==s&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let Pp=0;class Tp extends Mt{constructor(){super(...arguments),this.id=Pp++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:s}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const i=this.node.animationState.setActive("exit",!e);s&&!e&&i.then(()=>s(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const Ap={animation:{Feature:kp},exit:{Feature:Tp}};function Zs(t,e,s,n={passive:!0}){return t.addEventListener(e,s,n),()=>t.removeEventListener(e,s)}function dn(t){return{point:{x:t.pageX,y:t.pageY}}}const Ep=t=>e=>xi(e)&&t(e,dn(e));function Bs(t,e,s,n){return Zs(t,e,Ep(s),n)}const qa=(t,e)=>Math.abs(t-e);function Mp(t,e){const s=qa(t.x,e.x),n=qa(t.y,e.y);return Math.sqrt(s**2+n**2)}class xc{constructor(e,s,{transformPagePoint:n,contextWindow:i,dragSnapToOrigin:o=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=rr(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,g=Mp(f.offset,{x:0,y:0})>=3;if(!m&&!g)return;const{point:x}=f,{timestamp:v}=Te;this.history.push({...x,timestamp:v});const{onStart:y,onMove:j}=this.handlers;m||(y&&y(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),j&&j(this.lastMoveEvent,f)},this.handlePointerMove=(f,m)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=nr(m,this.transformPagePoint),pe.update(this.updatePoint,!0)},this.handlePointerUp=(f,m)=>{this.end();const{onEnd:g,onSessionEnd:x,resumeAnimation:v}=this.handlers;if(this.dragSnapToOrigin&&v&&v(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const y=rr(f.type==="pointercancel"?this.lastMoveEventInfo:nr(m,this.transformPagePoint),this.history);this.startEvent&&g&&g(f,y),x&&x(f,y)},!xi(e))return;this.dragSnapToOrigin=o,this.handlers=s,this.transformPagePoint=n,this.contextWindow=i||window;const a=dn(e),c=nr(a,this.transformPagePoint),{point:l}=c,{timestamp:u}=Te;this.history=[{...l,timestamp:u}];const{onSessionStart:h}=s;h&&h(e,rr(c,this.history)),this.removeListeners=un(Bs(this.contextWindow,"pointermove",this.handlePointerMove),Bs(this.contextWindow,"pointerup",this.handlePointerUp),Bs(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Tt(this.updatePoint)}}function nr(t,e){return e?{point:e(t.point)}:t}function $a(t,e){return{x:t.x-e.x,y:t.y-e.y}}function rr({point:t},e){return{point:t,delta:$a(t,yc(e)),offset:$a(t,Rp(e)),velocity:Dp(e,.1)}}function Rp(t){return t[0]}function yc(t){return t[t.length-1]}function Dp(t,e){if(t.length<2)return{x:0,y:0};let s=t.length-1,n=null;const i=yc(t);for(;s>=0&&(n=t[s],!(i.timestamp-n.timestamp>ht(e)));)s--;if(!n)return{x:0,y:0};const o=ft(i.timestamp-n.timestamp);if(o===0)return{x:0,y:0};const a={x:(i.x-n.x)/o,y:(i.y-n.y)/o};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}const vc=1e-4,Lp=1-vc,Op=1+vc,bc=.01,Fp=0-bc,Vp=0+bc;function He(t){return t.max-t.min}function Ip(t,e,s){return Math.abs(t-e)<=s}function Ba(t,e,s,n=.5){t.origin=n,t.originPoint=xe(e.min,e.max,t.origin),t.scale=He(s)/He(e),t.translate=xe(s.min,s.max,t.origin)-t.originPoint,(t.scale>=Lp&&t.scale<=Op||isNaN(t.scale))&&(t.scale=1),(t.translate>=Fp&&t.translate<=Vp||isNaN(t.translate))&&(t.translate=0)}function Us(t,e,s,n){Ba(t.x,e.x,s.x,n?n.originX:void 0),Ba(t.y,e.y,s.y,n?n.originY:void 0)}function Ua(t,e,s){t.min=s.min+e.min,t.max=t.min+He(e)}function qp(t,e,s){Ua(t.x,e.x,s.x),Ua(t.y,e.y,s.y)}function Ga(t,e,s){t.min=e.min-s.min,t.max=t.min+He(e)}function Gs(t,e,s){Ga(t.x,e.x,s.x),Ga(t.y,e.y,s.y)}function $p(t,{min:e,max:s},n){return e!==void 0&&t<e?t=n?xe(e,t,n.min):Math.max(t,e):s!==void 0&&t>s&&(t=n?xe(s,t,n.max):Math.min(t,s)),t}function za(t,e,s){return{min:e!==void 0?t.min+e:void 0,max:s!==void 0?t.max+s-(t.max-t.min):void 0}}function Bp(t,{top:e,left:s,bottom:n,right:i}){return{x:za(t.x,s,i),y:za(t.y,e,n)}}function Ha(t,e){let s=e.min-t.min,n=e.max-t.max;return e.max-e.min<t.max-t.min&&([s,n]=[n,s]),{min:s,max:n}}function Up(t,e){return{x:Ha(t.x,e.x),y:Ha(t.y,e.y)}}function Gp(t,e){let s=.5;const n=He(t),i=He(e);return i>n?s=Cs(e.min,e.max-n,t.min):n>i&&(s=Cs(t.min,t.max-i,e.min)),mt(0,1,s)}function zp(t,e){const s={};return e.min!==void 0&&(s.min=e.min-t.min),e.max!==void 0&&(s.max=e.max-t.min),s}const Fr=.35;function Hp(t=Fr){return t===!1?t=0:t===!0&&(t=Fr),{x:Ka(t,"left","right"),y:Ka(t,"top","bottom")}}function Ka(t,e,s){return{min:Wa(t,e),max:Wa(t,s)}}function Wa(t,e){return typeof t=="number"?t:t[e]||0}const Qa=()=>({translate:0,scale:1,origin:0,originPoint:0}),ls=()=>({x:Qa(),y:Qa()}),Ya=()=>({min:0,max:0}),Ne=()=>({x:Ya(),y:Ya()});function Ye(t){return[t("x"),t("y")]}function wc({top:t,left:e,right:s,bottom:n}){return{x:{min:e,max:s},y:{min:t,max:n}}}function Kp({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function Wp(t,e){if(!e)return t;const s=e({x:t.left,y:t.top}),n=e({x:t.right,y:t.bottom});return{top:s.y,left:s.x,bottom:n.y,right:n.x}}function ir(t){return t===void 0||t===1}function Vr({scale:t,scaleX:e,scaleY:s}){return!ir(t)||!ir(e)||!ir(s)}function Vt(t){return Vr(t)||jc(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function jc(t){return Xa(t.x)||Xa(t.y)}function Xa(t){return t&&t!=="0%"}function Ln(t,e,s){const n=t-s,i=e*n;return s+i}function Ja(t,e,s,n,i){return i!==void 0&&(t=Ln(t,i,n)),Ln(t,s,n)+e}function Ir(t,e=0,s=1,n,i){t.min=Ja(t.min,e,s,n,i),t.max=Ja(t.max,e,s,n,i)}function Nc(t,{x:e,y:s}){Ir(t.x,e.translate,e.scale,e.originPoint),Ir(t.y,s.translate,s.scale,s.originPoint)}const Za=.999999999999,eo=1.0000000000001;function Qp(t,e,s,n=!1){const i=s.length;if(!i)return;e.x=e.y=1;let o,a;for(let c=0;c<i;c++){o=s[c],a=o.projectionDelta;const{visualElement:l}=o.options;l&&l.props.style&&l.props.style.display==="contents"||(n&&o.options.layoutScroll&&o.scroll&&o!==o.root&&us(t,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,Nc(t,a)),n&&Vt(o.latestValues)&&us(t,o.latestValues))}e.x<eo&&e.x>Za&&(e.x=1),e.y<eo&&e.y>Za&&(e.y=1)}function cs(t,e){t.min=t.min+e,t.max=t.max+e}function to(t,e,s,n,i=.5){const o=xe(t.min,t.max,i);Ir(t,e,s,o,n)}function us(t,e){to(t.x,e.x,e.scaleX,e.scale,e.originX),to(t.y,e.y,e.scaleY,e.scale,e.originY)}function Sc(t,e){return wc(Wp(t.getBoundingClientRect(),e))}function Yp(t,e,s){const n=Sc(t,s),{scroll:i}=e;return i&&(cs(n.x,i.offset.x),cs(n.y,i.offset.y)),n}const Cc=({current:t})=>t?t.ownerDocument.defaultView:null,Xp=new WeakMap;class Jp{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ne(),this.visualElement=e}start(e,{snapToCursor:s=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const i=h=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),s&&this.snapToCursor(dn(h).point)},o=(h,f)=>{const{drag:m,dragPropagation:g,onDragStart:x}=this.getProps();if(m&&!g&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Gf(m),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ye(y=>{let j=this.getAxisMotionValue(y).get()||0;if(ot.test(j)){const{projection:A}=this.visualElement;if(A&&A.layout){const E=A.layout.layoutBox[y];E&&(j=He(E)*(parseFloat(j)/100))}}this.originPoint[y]=j}),x&&pe.postRender(()=>x(h,f)),Tr(this.visualElement,"transform");const{animationState:v}=this.visualElement;v&&v.setActive("whileDrag",!0)},a=(h,f)=>{const{dragPropagation:m,dragDirectionLock:g,onDirectionLock:x,onDrag:v}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:y}=f;if(g&&this.currentDirection===null){this.currentDirection=Zp(y),this.currentDirection!==null&&x&&x(this.currentDirection);return}this.updateAxis("x",f.point,y),this.updateAxis("y",f.point,y),this.visualElement.render(),v&&v(h,f)},c=(h,f)=>this.stop(h,f),l=()=>Ye(h=>{var f;return this.getAnimationState(h)==="paused"&&((f=this.getAxisMotionValue(h).animation)===null||f===void 0?void 0:f.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new xc(e,{onSessionStart:i,onStart:o,onMove:a,onSessionEnd:c,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:Cc(this.visualElement)})}stop(e,s){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:i}=s;this.startAnimation(i);const{onDragEnd:o}=this.getProps();o&&pe.postRender(()=>o(e,s))}cancel(){this.isDragging=!1;const{projection:e,animationState:s}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),s&&s.setActive("whileDrag",!1)}updateAxis(e,s,n){const{drag:i}=this.getProps();if(!n||!jn(e,i,this.currentDirection))return;const o=this.getAxisMotionValue(e);let a=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(a=$p(a,this.constraints[e],this.elastic[e])),o.set(a)}resolveConstraints(){var e;const{dragConstraints:s,dragElastic:n}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,o=this.constraints;s&&as(s)?this.constraints||(this.constraints=this.resolveRefConstraints()):s&&i?this.constraints=Bp(i.layoutBox,s):this.constraints=!1,this.elastic=Hp(n),o!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&Ye(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=zp(i.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:s}=this.getProps();if(!e||!as(e))return!1;const n=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const o=Yp(n,i.root,this.visualElement.getTransformPagePoint());let a=Up(i.layout.layoutBox,o);if(s){const c=s(Kp(a));this.hasMutatedConstraints=!!c,c&&(a=wc(c))}return a}startAnimation(e){const{drag:s,dragMomentum:n,dragElastic:i,dragTransition:o,dragSnapToOrigin:a,onDragTransitionEnd:c}=this.getProps(),l=this.constraints||{},u=Ye(h=>{if(!jn(h,s,this.currentDirection))return;let f=l&&l[h]||{};a&&(f={min:0,max:0});const m=i?200:1e6,g=i?40:1e7,x={type:"inertia",velocity:n?e[h]:0,bounceStiffness:m,bounceDamping:g,timeConstant:750,restDelta:1,restSpeed:10,...o,...f};return this.startAxisValueAnimation(h,x)});return Promise.all(u).then(c)}startAxisValueAnimation(e,s){const n=this.getAxisMotionValue(e);return Tr(this.visualElement,e),n.start(Ti(e,n,0,s,this.visualElement,!1))}stopAnimation(){Ye(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Ye(e=>{var s;return(s=this.getAxisMotionValue(e).animation)===null||s===void 0?void 0:s.pause()})}getAnimationState(e){var s;return(s=this.getAxisMotionValue(e).animation)===null||s===void 0?void 0:s.state}getAxisMotionValue(e){const s=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),i=n[s];return i||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){Ye(s=>{const{drag:n}=this.getProps();if(!jn(s,n,this.currentDirection))return;const{projection:i}=this.visualElement,o=this.getAxisMotionValue(s);if(i&&i.layout){const{min:a,max:c}=i.layout.layoutBox[s];o.set(e[s]-xe(a,c,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:s}=this.getProps(),{projection:n}=this.visualElement;if(!as(s)||!n||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Ye(a=>{const c=this.getAxisMotionValue(a);if(c&&this.constraints!==!1){const l=c.get();i[a]=Gp({min:l,max:l},this.constraints[a])}});const{transformTemplate:o}=this.visualElement.getProps();this.visualElement.current.style.transform=o?o({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Ye(a=>{if(!jn(a,e,null))return;const c=this.getAxisMotionValue(a),{min:l,max:u}=this.constraints[a];c.set(xe(l,u,i[a]))})}addListeners(){if(!this.visualElement.current)return;Xp.set(this.visualElement,this);const e=this.visualElement.current,s=Bs(e,"pointerdown",l=>{const{drag:u,dragListener:h=!0}=this.getProps();u&&h&&this.start(l)}),n=()=>{const{dragConstraints:l}=this.getProps();as(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,o=i.addEventListener("measure",n);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),pe.read(n);const a=Zs(window,"resize",()=>this.scalePositionWithinConstraints()),c=i.addEventListener("didUpdate",(({delta:l,hasLayoutChanged:u})=>{this.isDragging&&u&&(Ye(h=>{const f=this.getAxisMotionValue(h);f&&(this.originPoint[h]+=l[h].translate,f.set(f.get()+l[h].translate))}),this.visualElement.render())}));return()=>{a(),s(),o(),c&&c()}}getProps(){const e=this.visualElement.getProps(),{drag:s=!1,dragDirectionLock:n=!1,dragPropagation:i=!1,dragConstraints:o=!1,dragElastic:a=Fr,dragMomentum:c=!0}=e;return{...e,drag:s,dragDirectionLock:n,dragPropagation:i,dragConstraints:o,dragElastic:a,dragMomentum:c}}}function jn(t,e,s){return(e===!0||e===t)&&(s===null||s===t)}function Zp(t,e=10){let s=null;return Math.abs(t.y)>e?s="y":Math.abs(t.x)>e&&(s="x"),s}class eg extends Mt{constructor(e){super(e),this.removeGroupControls=ze,this.removeListeners=ze,this.controls=new Jp(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ze}unmount(){this.removeGroupControls(),this.removeListeners()}}const so=t=>(e,s)=>{t&&pe.postRender(()=>t(e,s))};class tg extends Mt{constructor(){super(...arguments),this.removePointerDownListener=ze}onPointerDown(e){this.session=new xc(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Cc(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:s,onPan:n,onPanEnd:i}=this.node.getProps();return{onSessionStart:so(e),onStart:so(s),onMove:n,onEnd:(o,a)=>{delete this.session,i&&pe.postRender(()=>i(o,a))}}}mount(){this.removePointerDownListener=Bs(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const _n={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function no(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Os={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(ee.test(t))t=parseFloat(t);else return t;const s=no(t,e.target.x),n=no(t,e.target.y);return`${s}% ${n}%`}},sg={correct:(t,{treeScale:e,projectionDelta:s})=>{const n=t,i=At.parse(t);if(i.length>5)return n;const o=At.createTransformer(t),a=typeof i[0]!="number"?1:0,c=s.x.scale*e.x,l=s.y.scale*e.y;i[0+a]/=c,i[1+a]/=l;const u=xe(c,l,.5);return typeof i[2+a]=="number"&&(i[2+a]/=u),typeof i[3+a]=="number"&&(i[3+a]/=u),o(i)}};class ng extends d.Component{componentDidMount(){const{visualElement:e,layoutGroup:s,switchLayoutGroup:n,layoutId:i}=this.props,{projection:o}=e;Nf(rg),o&&(s.group&&s.group.add(o),n&&n.register&&i&&n.register(o),o.root.didUpdate(),o.addEventListener("animationComplete",()=>{this.safeToRemove()}),o.setOptions({...o.options,onExitComplete:()=>this.safeToRemove()})),_n.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:s,visualElement:n,drag:i,isPresent:o}=this.props,a=n.projection;return a&&(a.isPresent=o,i||e.layoutDependency!==s||s===void 0?a.willUpdate():this.safeToRemove(),e.isPresent!==o&&(o?a.promote():a.relegate()||pe.postRender(()=>{const c=a.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),ri.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:s,switchLayoutGroup:n}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),s&&s.group&&s.group.remove(i),n&&n.deregister&&n.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function _c(t){const[e,s]=ll(),n=d.useContext(Yr);return r.jsx(ng,{...t,layoutGroup:n,switchLayoutGroup:d.useContext(gl),isPresent:e,safeToRemove:s})}const rg={borderRadius:{...Os,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Os,borderTopRightRadius:Os,borderBottomLeftRadius:Os,borderBottomRightRadius:Os,boxShadow:sg};function ig(t,e,s){const n=Re(t)?t:Xs(t);return n.start(Ti("",n,e,s)),n.animation}function ag(t){return t instanceof SVGElement&&t.tagName!=="svg"}const og=(t,e)=>t.depth-e.depth;class lg{constructor(){this.children=[],this.isDirty=!1}add(e){yi(this.children,e),this.isDirty=!0}remove(e){vi(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(og),this.isDirty=!1,this.children.forEach(e)}}function cg(t,e){const s=lt.now(),n=({timestamp:i})=>{const o=i-s;o>=e&&(Tt(n),t(o-e))};return pe.read(n,!0),()=>Tt(n)}const kc=["TopLeft","TopRight","BottomLeft","BottomRight"],ug=kc.length,ro=t=>typeof t=="string"?parseFloat(t):t,io=t=>typeof t=="number"||ee.test(t);function dg(t,e,s,n,i,o){i?(t.opacity=xe(0,s.opacity!==void 0?s.opacity:1,hg(n)),t.opacityExit=xe(e.opacity!==void 0?e.opacity:1,0,fg(n))):o&&(t.opacity=xe(e.opacity!==void 0?e.opacity:1,s.opacity!==void 0?s.opacity:1,n));for(let a=0;a<ug;a++){const c=`border${kc[a]}Radius`;let l=ao(e,c),u=ao(s,c);if(l===void 0&&u===void 0)continue;l||(l=0),u||(u=0),l===0||u===0||io(l)===io(u)?(t[c]=Math.max(xe(ro(l),ro(u),n),0),(ot.test(u)||ot.test(l))&&(t[c]+="%")):t[c]=u}(e.rotate||s.rotate)&&(t.rotate=xe(e.rotate||0,s.rotate||0,n))}function ao(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const hg=Pc(0,.5,Hl),fg=Pc(.5,.95,ze);function Pc(t,e,s){return n=>n<t?0:n>e?1:s(Cs(t,e,n))}function oo(t,e){t.min=e.min,t.max=e.max}function We(t,e){oo(t.x,e.x),oo(t.y,e.y)}function lo(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function co(t,e,s,n,i){return t-=e,t=Ln(t,1/s,n),i!==void 0&&(t=Ln(t,1/i,n)),t}function mg(t,e=0,s=1,n=.5,i,o=t,a=t){if(ot.test(e)&&(e=parseFloat(e),e=xe(a.min,a.max,e/100)-a.min),typeof e!="number")return;let c=xe(o.min,o.max,n);t===o&&(c-=e),t.min=co(t.min,e,s,c,i),t.max=co(t.max,e,s,c,i)}function uo(t,e,[s,n,i],o,a){mg(t,e[s],e[n],e[i],e.scale,o,a)}const pg=["x","scaleX","originX"],gg=["y","scaleY","originY"];function ho(t,e,s,n){uo(t.x,e,pg,s?s.x:void 0,n?n.x:void 0),uo(t.y,e,gg,s?s.y:void 0,n?n.y:void 0)}function fo(t){return t.translate===0&&t.scale===1}function Tc(t){return fo(t.x)&&fo(t.y)}function mo(t,e){return t.min===e.min&&t.max===e.max}function xg(t,e){return mo(t.x,e.x)&&mo(t.y,e.y)}function po(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function Ac(t,e){return po(t.x,e.x)&&po(t.y,e.y)}function go(t){return He(t.x)/He(t.y)}function xo(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class yg{constructor(){this.members=[]}add(e){yi(this.members,e),e.scheduleRender()}remove(e){if(vi(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const s=this.members[this.members.length-1];s&&this.promote(s)}}relegate(e){const s=this.members.findIndex(i=>e===i);if(s===0)return!1;let n;for(let i=s;i>=0;i--){const o=this.members[i];if(o.isPresent!==!1){n=o;break}}return n?(this.promote(n),!0):!1}promote(e,s){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,s&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:s,resumingFrom:n}=e;s.onExitComplete&&s.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function vg(t,e,s){let n="";const i=t.x.translate/e.x,o=t.y.translate/e.y,a=s?.z||0;if((i||o||a)&&(n=`translate3d(${i}px, ${o}px, ${a}px) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),s){const{transformPerspective:u,rotate:h,rotateX:f,rotateY:m,skewX:g,skewY:x}=s;u&&(n=`perspective(${u}px) ${n}`),h&&(n+=`rotate(${h}deg) `),f&&(n+=`rotateX(${f}deg) `),m&&(n+=`rotateY(${m}deg) `),g&&(n+=`skewX(${g}deg) `),x&&(n+=`skewY(${x}deg) `)}const c=t.x.scale*e.x,l=t.y.scale*e.y;return(c!==1||l!==1)&&(n+=`scale(${c}, ${l})`),n||"none"}const It={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},qs=typeof window<"u"&&window.MotionDebug!==void 0,ar=["","X","Y","Z"],bg={visibility:"hidden"},yo=1e3;let wg=0;function or(t,e,s,n){const{latestValues:i}=e;i[t]&&(s[t]=i[t],e.setStaticValue(t,0),n&&(n[t]=0))}function Ec(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const s=Il(e);if(window.MotionHasOptimisedAnimation(s,"transform")){const{layout:i,layoutId:o}=t.options;window.MotionCancelOptimisedAnimation(s,"transform",pe,!(i||o))}const{parent:n}=t;n&&!n.hasCheckedOptimisedAppear&&Ec(n)}function Mc({attachResizeListener:t,defaultParent:e,measureScroll:s,checkIsScrollRoot:n,resetTransform:i}){return class{constructor(a={},c=e?.()){this.id=wg++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,qs&&(It.totalNodes=It.resolvedTargetDeltas=It.recalculatedProjection=0),this.nodes.forEach(Sg),this.nodes.forEach(Tg),this.nodes.forEach(Ag),this.nodes.forEach(Cg),qs&&window.MotionDebug.record(It)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new lg)}addEventListener(a,c){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new bi),this.eventHandlers.get(a).add(c)}notifyListeners(a,...c){const l=this.eventHandlers.get(a);l&&l.notify(...c)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,c=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=ag(a),this.instance=a;const{layoutId:l,layout:u,visualElement:h}=this.options;if(h&&!h.current&&h.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),c&&(u||l)&&(this.isLayoutDirty=!0),t){let f;const m=()=>this.root.updateBlockedByResize=!1;t(a,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=cg(m,250),_n.hasAnimatedSinceResize&&(_n.hasAnimatedSinceResize=!1,this.nodes.forEach(bo))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&h&&(l||u)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:m,hasRelativeTargetChanged:g,layout:x})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const v=this.options.transition||h.getDefaultTransition()||Lg,{onLayoutAnimationStart:y,onLayoutAnimationComplete:j}=h.getProps(),A=!this.targetLayout||!Ac(this.targetLayout,x)||g,E=!m&&g;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||E||m&&(A||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,E);const M={...mi(v,"layout"),onPlay:y,onComplete:j};(h.shouldReduceMotion||this.options.layoutRoot)&&(M.delay=0,M.type=!1),this.startAnimation(M)}else m||bo(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=x})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Tt(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Eg),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Ec(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const f=this.path[h];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:c,layout:l}=this.options;if(c===void 0&&!l)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(vo);return}this.isUpdating||this.nodes.forEach(kg),this.isUpdating=!1,this.nodes.forEach(Pg),this.nodes.forEach(jg),this.nodes.forEach(Ng),this.clearAllSnapshots();const c=lt.now();Te.delta=mt(0,1e3/60,c-Te.timestamp),Te.timestamp=c,Te.isProcessing=!0,Xn.update.process(Te),Xn.preRender.process(Te),Xn.render.process(Te),Te.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,ri.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(_g),this.sharedNodes.forEach(Mg)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,pe.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){pe.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ne(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(c=!1),c){const l=n(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:s(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!Tc(this.projectionDelta),l=this.getTransformTemplate(),u=l?l(this.latestValues,""):void 0,h=u!==this.prevTransformTemplateValue;a&&(c||Vt(this.latestValues)||h)&&(i(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const c=this.measurePageBox();let l=this.removeElementScroll(c);return a&&(l=this.removeTransform(l)),Og(l),{animationId:this.root.animationId,measuredBox:c,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var a;const{visualElement:c}=this.options;if(!c)return Ne();const l=c.measureViewportBox();if(!(((a=this.scroll)===null||a===void 0?void 0:a.wasRoot)||this.path.some(Fg))){const{scroll:h}=this.root;h&&(cs(l.x,h.offset.x),cs(l.y,h.offset.y))}return l}removeElementScroll(a){var c;const l=Ne();if(We(l,a),!((c=this.scroll)===null||c===void 0)&&c.wasRoot)return l;for(let u=0;u<this.path.length;u++){const h=this.path[u],{scroll:f,options:m}=h;h!==this.root&&f&&m.layoutScroll&&(f.wasRoot&&We(l,a),cs(l.x,f.offset.x),cs(l.y,f.offset.y))}return l}applyTransform(a,c=!1){const l=Ne();We(l,a);for(let u=0;u<this.path.length;u++){const h=this.path[u];!c&&h.options.layoutScroll&&h.scroll&&h!==h.root&&us(l,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),Vt(h.latestValues)&&us(l,h.latestValues)}return Vt(this.latestValues)&&us(l,this.latestValues),l}removeTransform(a){const c=Ne();We(c,a);for(let l=0;l<this.path.length;l++){const u=this.path[l];if(!u.instance||!Vt(u.latestValues))continue;Vr(u.latestValues)&&u.updateSnapshot();const h=Ne(),f=u.measurePageBox();We(h,f),ho(c,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,h)}return Vt(this.latestValues)&&ho(c,this.latestValues),c}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Te.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var c;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==l;if(!(a||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((c=this.parent)===null||c===void 0)&&c.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:f,layoutId:m}=this.options;if(!(!this.layout||!(f||m))){if(this.resolvedRelativeTargetAt=Te.timestamp,!this.targetDelta&&!this.relativeTarget){const g=this.getClosestProjectingParent();g&&g.layout&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ne(),this.relativeTargetOrigin=Ne(),Gs(this.relativeTargetOrigin,this.layout.layoutBox,g.layout.layoutBox),We(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Ne(),this.targetWithTransforms=Ne()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),qp(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):We(this.target,this.layout.layoutBox),Nc(this.target,this.targetDelta)):We(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const g=this.getClosestProjectingParent();g&&!!g.resumingFrom==!!this.resumingFrom&&!g.options.layoutScroll&&g.target&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ne(),this.relativeTargetOrigin=Ne(),Gs(this.relativeTargetOrigin,this.target,g.target),We(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}qs&&It.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Vr(this.parent.latestValues)||jc(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const c=this.getLead(),l=!!this.resumingFrom||this!==c;let u=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(u=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===Te.timestamp&&(u=!1),u)return;const{layout:h,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||f))return;We(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,g=this.treeScale.y;Qp(this.layoutCorrected,this.treeScale,this.path,l),c.layout&&!c.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(c.target=c.layout.layoutBox,c.targetWithTransforms=Ne());const{target:x}=c;if(!x){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(lo(this.prevProjectionDelta.x,this.projectionDelta.x),lo(this.prevProjectionDelta.y,this.projectionDelta.y)),Us(this.projectionDelta,this.layoutCorrected,x,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==g||!xo(this.projectionDelta.x,this.prevProjectionDelta.x)||!xo(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",x)),qs&&It.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var c;if((c=this.options.visualElement)===null||c===void 0||c.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=ls(),this.projectionDelta=ls(),this.projectionDeltaWithTransform=ls()}setAnimationOrigin(a,c=!1){const l=this.snapshot,u=l?l.latestValues:{},h={...this.latestValues},f=ls();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const m=Ne(),g=l?l.source:void 0,x=this.layout?this.layout.source:void 0,v=g!==x,y=this.getStack(),j=!y||y.members.length<=1,A=!!(v&&!j&&this.options.crossfade===!0&&!this.path.some(Dg));this.animationProgress=0;let E;this.mixTargetDelta=M=>{const _=M/1e3;wo(f.x,a.x,_),wo(f.y,a.y,_),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Gs(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Rg(this.relativeTarget,this.relativeTargetOrigin,m,_),E&&xg(this.relativeTarget,E)&&(this.isProjectionDirty=!1),E||(E=Ne()),We(E,this.relativeTarget)),v&&(this.animationValues=h,dg(h,u,this.latestValues,_,A,j)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=_},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Tt(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=pe.update(()=>{_n.hasAnimatedSinceResize=!0,this.currentAnimation=ig(0,yo,{...a,onUpdate:c=>{this.mixTargetDelta(c),a.onUpdate&&a.onUpdate(c)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(yo),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:c,target:l,layout:u,latestValues:h}=a;if(!(!c||!l||!u)){if(this!==a&&this.layout&&u&&Rc(this.options.animationType,this.layout.layoutBox,u.layoutBox)){l=this.target||Ne();const f=He(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+f;const m=He(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+m}We(c,l),us(c,h),Us(this.projectionDeltaWithTransform,this.layoutCorrected,c,h)}}registerSharedNode(a,c){this.sharedNodes.has(a)||this.sharedNodes.set(a,new yg),this.sharedNodes.get(a).add(c);const u=c.options.initialPromotionConfig;c.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(c):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:c}=this.options;return c?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:c}=this.options;return c?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:c,preserveFollowOpacity:l}={}){const u=this.getStack();u&&u.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let c=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(c=!0),!c)return;const u={};l.z&&or("z",a,u,this.animationValues);for(let h=0;h<ar.length;h++)or(`rotate${ar[h]}`,a,u,this.animationValues),or(`skew${ar[h]}`,a,u,this.animationValues);a.render();for(const h in u)a.setStaticValue(h,u[h]),this.animationValues&&(this.animationValues[h]=u[h]);a.scheduleRender()}getProjectionStyles(a){var c,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return bg;const u={visibility:""},h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=Sn(a?.pointerEvents)||"",u.transform=h?h(this.latestValues,""):"none",u;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const v={};return this.options.layoutId&&(v.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,v.pointerEvents=Sn(a?.pointerEvents)||""),this.hasProjected&&!Vt(this.latestValues)&&(v.transform=h?h({},""):"none",this.hasProjected=!1),v}const m=f.animationValues||f.latestValues;this.applyTransformsToTarget(),u.transform=vg(this.projectionDeltaWithTransform,this.treeScale,m),h&&(u.transform=h(m,u.transform));const{x:g,y:x}=this.projectionDelta;u.transformOrigin=`${g.origin*100}% ${x.origin*100}% 0`,f.animationValues?u.opacity=f===this?(l=(c=m.opacity)!==null&&c!==void 0?c:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:u.opacity=f===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const v in An){if(m[v]===void 0)continue;const{correct:y,applyTo:j}=An[v],A=u.transform==="none"?m[v]:y(m[v],f);if(j){const E=j.length;for(let M=0;M<E;M++)u[j[M]]=A}else u[v]=A}return this.options.layoutId&&(u.pointerEvents=f===this?Sn(a?.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var c;return(c=a.currentAnimation)===null||c===void 0?void 0:c.stop()}),this.root.nodes.forEach(vo),this.root.sharedNodes.clear()}}}function jg(t){t.updateLayout()}function Ng(t){var e;const s=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&s&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:i}=t.layout,{animationType:o}=t.options,a=s.source!==t.layout.source;o==="size"?Ye(f=>{const m=a?s.measuredBox[f]:s.layoutBox[f],g=He(m);m.min=n[f].min,m.max=m.min+g}):Rc(o,s.layoutBox,n)&&Ye(f=>{const m=a?s.measuredBox[f]:s.layoutBox[f],g=He(n[f]);m.max=m.min+g,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[f].max=t.relativeTarget[f].min+g)});const c=ls();Us(c,n,s.layoutBox);const l=ls();a?Us(l,t.applyTransform(i,!0),s.measuredBox):Us(l,n,s.layoutBox);const u=!Tc(c);let h=!1;if(!t.resumeFrom){const f=t.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:m,layout:g}=f;if(m&&g){const x=Ne();Gs(x,s.layoutBox,m.layoutBox);const v=Ne();Gs(v,n,g.layoutBox),Ac(x,v)||(h=!0),f.options.layoutRoot&&(t.relativeTarget=v,t.relativeTargetOrigin=x,t.relativeParent=f)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:s,delta:l,layoutDelta:c,hasLayoutChanged:u,hasRelativeTargetChanged:h})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function Sg(t){qs&&It.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function Cg(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function _g(t){t.clearSnapshot()}function vo(t){t.clearMeasurements()}function kg(t){t.isLayoutDirty=!1}function Pg(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function bo(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function Tg(t){t.resolveTargetDelta()}function Ag(t){t.calcProjection()}function Eg(t){t.resetSkewAndRotation()}function Mg(t){t.removeLeadSnapshot()}function wo(t,e,s){t.translate=xe(e.translate,0,s),t.scale=xe(e.scale,1,s),t.origin=e.origin,t.originPoint=e.originPoint}function jo(t,e,s,n){t.min=xe(e.min,s.min,n),t.max=xe(e.max,s.max,n)}function Rg(t,e,s,n){jo(t.x,e.x,s.x,n),jo(t.y,e.y,s.y,n)}function Dg(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const Lg={duration:.45,ease:[.4,0,.1,1]},No=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),So=No("applewebkit/")&&!No("chrome/")?Math.round:ze;function Co(t){t.min=So(t.min),t.max=So(t.max)}function Og(t){Co(t.x),Co(t.y)}function Rc(t,e,s){return t==="position"||t==="preserve-aspect"&&!Ip(go(e),go(s),.2)}function Fg(t){var e;return t!==t.root&&((e=t.scroll)===null||e===void 0?void 0:e.wasRoot)}const Vg=Mc({attachResizeListener:(t,e)=>Zs(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),lr={current:void 0},Dc=Mc({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!lr.current){const t=new Vg({});t.mount(window),t.setOptions({layoutScroll:!0}),lr.current=t}return lr.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),Ig={pan:{Feature:tg},drag:{Feature:eg,ProjectionNode:Dc,MeasureLayout:_c}};function _o(t,e,s){const{props:n}=t;t.animationState&&n.whileHover&&t.animationState.setActive("whileHover",s==="Start");const i="onHover"+s,o=n[i];o&&pe.postRender(()=>o(e,dn(e)))}class qg extends Mt{mount(){const{current:e}=this.node;e&&(this.unmount=If(e,s=>(_o(this.node,s,"Start"),n=>_o(this.node,n,"End"))))}unmount(){}}class $g extends Mt{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=un(Zs(this.node.current,"focus",()=>this.onFocus()),Zs(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function ko(t,e,s){const{props:n}=t;t.animationState&&n.whileTap&&t.animationState.setActive("whileTap",s==="Start");const i="onTap"+(s==="End"?"":s),o=n[i];o&&pe.postRender(()=>o(e,dn(e)))}class Bg extends Mt{mount(){const{current:e}=this.node;e&&(this.unmount=Uf(e,s=>(ko(this.node,s,"Start"),(n,{success:i})=>ko(this.node,n,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const qr=new WeakMap,cr=new WeakMap,Ug=t=>{const e=qr.get(t.target);e&&e(t)},Gg=t=>{t.forEach(Ug)};function zg({root:t,...e}){const s=t||document;cr.has(s)||cr.set(s,{});const n=cr.get(s),i=JSON.stringify(e);return n[i]||(n[i]=new IntersectionObserver(Gg,{root:t,...e})),n[i]}function Hg(t,e,s){const n=zg(e);return qr.set(t,s),n.observe(t),()=>{qr.delete(t),n.unobserve(t)}}const Kg={some:0,all:1};class Wg extends Mt{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:s,margin:n,amount:i="some",once:o}=e,a={root:s?s.current:void 0,rootMargin:n,threshold:typeof i=="number"?i:Kg[i]},c=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,o&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:h,onViewportLeave:f}=this.node.getProps(),m=u?h:f;m&&m(l)};return Hg(this.node.current,a,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:s}=this.node;["amount","margin","root"].some(Qg(e,s))&&this.startObserver()}unmount(){}}function Qg({viewport:t={}},{viewport:e={}}={}){return s=>t[s]!==e[s]}const Yg={inView:{Feature:Wg},tap:{Feature:Bg},focus:{Feature:$g},hover:{Feature:qg}},Xg={layout:{ProjectionNode:Dc,MeasureLayout:_c}},On={current:null},Ai={current:!1};function Lc(){if(Ai.current=!0,!!Zr)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>On.current=t.matches;t.addListener(e),e()}else On.current=!1}const Jg=[...ac,Me,At],Zg=t=>Jg.find(ic(t)),Po=new WeakMap;function ex(t,e,s){for(const n in e){const i=e[n],o=s[n];if(Re(i))t.addValue(n,i);else if(Re(o))t.addValue(n,Xs(i,{owner:t}));else if(o!==i)if(t.hasValue(n)){const a=t.getValue(n);a.liveStyle===!0?a.jump(i):a.hasAnimated||a.set(i)}else{const a=t.getStaticValue(n);t.addValue(n,Xs(a!==void 0?a:i,{owner:t}))}}for(const n in s)e[n]===void 0&&t.removeValue(n);return e}const To=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class tx{scrapeMotionValuesFromProps(e,s,n){return{}}constructor({parent:e,props:s,presenceContext:n,reducedMotionConfig:i,blockInitialAnimation:o,visualState:a},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=_i,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const g=lt.now();this.renderScheduledAt<g&&(this.renderScheduledAt=g,pe.render(this.render,!1,!0))};const{latestValues:l,renderState:u,onUpdate:h}=a;this.onUpdate=h,this.latestValues=l,this.baseTarget={...l},this.initialValues=s.initial?{...l}:{},this.renderState=u,this.parent=e,this.props=s,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=c,this.blockInitialAnimation=!!o,this.isControllingVariants=$n(s),this.isVariantNode=ml(s),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:f,...m}=this.scrapeMotionValuesFromProps(s,{},this);for(const g in m){const x=m[g];l[g]!==void 0&&Re(x)&&x.set(l[g],!1)}}mount(e){this.current=e,Po.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((s,n)=>this.bindToMotionValue(n,s)),Ai.current||Lc(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:On.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){Po.delete(this.current),this.projection&&this.projection.unmount(),Tt(this.notifyUpdate),Tt(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const s=this.features[e];s&&(s.unmount(),s.isMounted=!1)}this.current=null}bindToMotionValue(e,s){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=es.has(e),i=s.on("change",c=>{this.latestValues[e]=c,this.props.onUpdate&&pe.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0)}),o=s.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,s)),this.valueSubscriptions.set(e,()=>{i(),o(),a&&a(),s.owner&&s.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in _s){const s=_s[e];if(!s)continue;const{isEnabled:n,Feature:i}=s;if(!this.features[e]&&i&&n(this.props)&&(this.features[e]=new i(this)),this.features[e]){const o=this.features[e];o.isMounted?o.update():(o.mount(),o.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ne()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,s){this.latestValues[e]=s}update(e,s){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=s;for(let n=0;n<To.length;n++){const i=To[n];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const o="on"+i,a=e[o];a&&(this.propEventSubscriptions[i]=this.on(i,a))}this.prevMotionValues=ex(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const s=this.getClosestVariantNode();if(s)return s.variantChildren&&s.variantChildren.add(e),()=>s.variantChildren.delete(e)}addValue(e,s){const n=this.values.get(e);s!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,s),this.values.set(e,s),this.latestValues[e]=s.get())}removeValue(e){this.values.delete(e);const s=this.valueSubscriptions.get(e);s&&(s(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,s){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&s!==void 0&&(n=Xs(s===null?void 0:s,{owner:this}),this.addValue(e,n)),n}readValue(e,s){var n;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(n=this.getBaseTargetFromProps(this.props,e))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(nc(i)||Wl(i))?i=parseFloat(i):!Zg(i)&&At.test(s)&&(i=ec(e,s)),this.setBaseTarget(e,Re(i)?i.get():i)),Re(i)?i.get():i}setBaseTarget(e,s){this.baseTarget[e]=s}getBaseTarget(e){var s;const{initial:n}=this.props;let i;if(typeof n=="string"||typeof n=="object"){const a=ai(this.props,n,(s=this.presenceContext)===null||s===void 0?void 0:s.custom);a&&(i=a[e])}if(n&&i!==void 0)return i;const o=this.getBaseTargetFromProps(this.props,e);return o!==void 0&&!Re(o)?o:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,s){return this.events[e]||(this.events[e]=new bi),this.events[e].add(s)}notify(e,...s){this.events[e]&&this.events[e].notify(...s)}}class Oc extends tx{constructor(){super(...arguments),this.KeyframeResolver=oc}sortInstanceNodePosition(e,s){return e.compareDocumentPosition(s)&2?1:-1}getBaseTargetFromProps(e,s){return e.style?e.style[s]:void 0}removeValueFromRenderState(e,{vars:s,style:n}){delete s[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Re(e)&&(this.childSubscription=e.on("change",s=>{this.current&&(this.current.textContent=`${s}`)}))}}function sx(t){return window.getComputedStyle(t)}class nx extends Oc{constructor(){super(...arguments),this.type="html",this.renderInstance=Nl}readValueFromInstance(e,s){if(es.has(s)){const n=Ci(s);return n&&n.default||0}else{const n=sx(e),i=(bl(s)?n.getPropertyValue(s):n[s])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:s}){return Sc(e,s)}build(e,s,n){ci(e,s,n.transformTemplate)}scrapeMotionValuesFromProps(e,s,n){return fi(e,s,n)}}class rx extends Oc{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ne}getBaseTargetFromProps(e,s){return e[s]}readValueFromInstance(e,s){if(es.has(s)){const n=Ci(s);return n&&n.default||0}return s=Sl.has(s)?s:ni(s),e.getAttribute(s)}scrapeMotionValuesFromProps(e,s,n){return kl(e,s,n)}build(e,s,n){ui(e,s,this.isSVGTag,n.transformTemplate)}renderInstance(e,s,n,i){Cl(e,s,n,i)}mount(e){this.isSVGTag=hi(e.tagName),super.mount(e)}}const ix=(t,e)=>ii(t)?new rx(e):new nx(e,{allowProjection:t!==d.Fragment}),ax=Mf({...Ap,...Yg,...Ig,...Xg},ix),Ao=Hh(ax);function ox(){!Ai.current&&Lc();const[t]=d.useState(On.current);return t}const Qe=[{title:"Welcome to Circles",text:"Create and join micro-groups for games, study, and local meetups.",image:"/circles/image2.png"},{title:"Find Your People",text:"Match by interests. See active circles. Join in two taps.",image:"/circles/image3.png"},{title:"Chat & Organize",text:"Lightweight DMs, clean group chats, quick polls and events.",image:"/circles/image.png"},{title:"Privacy First",text:"You choose what to share. RLS-secured backend powered by Supabase.",image:"/circles/image4.png"},{title:"Join Circles Now",text:"Sign in to start connecting with others!",image:"/circles/image5.png"}];function lx(){const[t,e]=d.useState(0),[s,n]=d.useState(null),[i,o]=d.useState(""),[a,c]=d.useState(null),[l,u]=d.useState(""),[h,f]=d.useState("signin"),[m,g]=d.useState(!1),[x,v]=d.useState(!1),{user:y}=Es(),j=pt(),A=Et(),E=ox(),M=d.useRef(null);d.useEffect(()=>{n(null)},[t]),d.useEffect(()=>{const{data:{subscription:b}}=w.auth.onAuthStateChange((L,H)=>{if(L!=="SIGNED_IN"||!H?.user)return;localStorage.setItem("onboardingSeen","1"),(async()=>{try{await w.from("profiles").update({onboarded:!0}).eq("user_id",H.user.id)}catch(X){console.error("Failed to update onboarding:",X)}})();const ce=A?.state?.from,G=localStorage.getItem("postLoginRedirect"),se=G||ce||"/profile";G&&localStorage.removeItem("postLoginRedirect"),A.pathname.includes("onboarding")?j("/profile",{replace:!0}):j(se,{replace:!0})});return()=>b.unsubscribe()},[A.pathname,A.state,j]);const _=t===Qe.length-1,$=E?0:.45,S=d.useMemo(()=>({duration:$,ease:[.22,1,.36,1]}),[$]);function C(b){b<0||b>=Qe.length||e(b)}function R(){_?g(!0):e(b=>Math.min(b+1,Qe.length-1))}function q(){e(b=>Math.max(b-1,0))}d.useEffect(()=>{function b(L){L.key==="ArrowRight"&&R(),L.key==="ArrowLeft"&&q(),L.key.toLowerCase()==="escape"&&Q()}return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[]);function Q(){localStorage.setItem("onboardingSeen","1"),e(Qe.length-1),g(!0)}const U=90;function P(b,L){const H=L?.offset?.x??0;H<=-U?R():H>=U&&q()}const T=(t+1)/Qe.length*100,N="/circles/".replace(/\/+$/,""),F=`${window.location.origin}${N}/auth/callback`;async function D(){try{c(null),localStorage.setItem("onboardingSeen","1");const{error:b}=await w.auth.signInWithOAuth({provider:"facebook",options:{redirectTo:F}});if(b)throw b}catch(b){c(b?.message??"Failed to start Facebook login")}}async function I(){try{c(null),localStorage.setItem("onboardingSeen","1");const{error:b}=await w.auth.signInWithOAuth({provider:"google",options:{redirectTo:F}});if(b)throw b}catch(b){c(b?.message??"Failed to start Google login")}}async function z(b){if(b.preventDefault(),c(null),!i.trim()||!l.trim()){c("Enter email and password");return}try{if(v(!0),localStorage.setItem("onboardingSeen","1"),h==="signup"){const{error:L}=await w.auth.signUp({email:i.trim(),password:l.trim()});if(L)throw L}else{const{error:L}=await w.auth.signInWithPassword({email:i.trim(),password:l.trim()});if(L)throw L}}catch(L){c(L?.message??"Authentication failed")}finally{v(!1)}}return r.jsxs("div",{ref:M,className:"min-h-dvh w-full bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 text-white flex flex-col","aria-label":"Onboarding",children:[r.jsx("div",{className:"flex-1 flex flex-col items-center justify-center px-6",children:r.jsx(Vh,{mode:"wait",initial:!1,children:r.jsx(Ao.div,{initial:{opacity:0,x:60},animate:{opacity:1,x:0},exit:{opacity:0,x:-60},transition:S,className:"w-full max-w-md",children:r.jsxs(Ao.div,{drag:"x",dragConstraints:{left:0,right:0},onDragEnd:P,className:"text-center select-none",children:[s===!1?r.jsxs("div",{className:"mx-auto mb-6 w-64 h-64 flex items-center justify-center rounded-lg border border-white/40 bg-white/10 text-xs text-white/90 p-3",children:["Missing image:",r.jsx("span",{className:"ml-1 break-all",children:Qe[t].image})]}):r.jsx("img",{src:Qe[t].image,alt:Qe[t].title,className:"mx-auto mb-6 w-full max-w-[28rem] md:max-w-[32rem] h-auto object-contain drop-shadow-2xl",draggable:!1,onLoad:()=>n(!0),onError:b=>{console.error("Onboarding image failed to load:",Qe[t].image),n(!1)}}),r.jsx("h1",{className:"text-3xl font-extrabold mb-3",children:Qe[t].title}),r.jsx("p",{className:"text-base/7 opacity-95",children:Qe[t].text}),_&&r.jsxs("div",{className:"mt-6 w-full max-w-sm mx-auto",children:[m?r.jsxs("form",{onSubmit:z,className:"grid grid-cols-1 gap-3",children:[r.jsx("input",{type:"email",placeholder:"you@example.com",value:i,onChange:b=>o(b.target.value),className:"w-full rounded-lg border border-white/30 bg-white/10 px-3 py-3 text-white placeholder-white/70 outline-none focus:bg-white/15"}),r.jsx("input",{type:"password",placeholder:"Password (min 6)",value:l,onChange:b=>u(b.target.value),className:"w-full rounded-lg border border-white/30 bg-white/10 px-3 py-3 text-white placeholder-white/70 outline-none focus:bg-white/15"}),r.jsx("button",{type:"submit",disabled:x,className:`w-full rounded-lg px-4 py-3 font-semibold ${x?"bg-white/40":"bg-white text-indigo-700"}`,children:x?"Please waitâ€¦":h==="signup"?"Sign up":"Sign in"}),r.jsx("button",{type:"button",onClick:()=>f(h==="signup"?"signin":"signup"),className:"text-sm underline opacity-90",children:h==="signup"?"Have an account? Sign in":"No account? Sign up"}),r.jsx("button",{type:"button",onClick:()=>g(!1),className:"text-xs opacity-75 hover:opacity-100",children:"â† Back to options"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[r.jsx("button",{onClick:I,className:"w-full rounded-lg bg-white/90 px-4 py-3 font-semibold text-indigo-700 hover:bg-white",children:"Continue with Google"}),r.jsx("button",{onClick:()=>{g(!0),c(null)},className:"w-full rounded-lg bg-white text-indigo-700 px-4 py-3 font-semibold",children:"Continue with Email"}),r.jsx("button",{onClick:D,className:"w-full rounded-lg bg-[#1877F2] px-4 py-3 font-semibold text-white",children:"Continue with Facebook"})]}),r.jsxs("p",{className:"mt-4 text-center text-[10px] text-white/60",children:["By continuing, you agree to our"," ",r.jsx(me,{to:"/legal",className:"underline hover:text-white",children:"Terms & Privacy Policy"}),"."]})]}),a&&r.jsx("div",{className:"mt-3 rounded border border-red-200 bg-red-50/90 px-3 py-2 text-sm text-red-800",children:a})]})]})},t)})}),r.jsxs("div",{className:`px-6 pb-6 ${_&&m?"hidden":""}`,children:[r.jsxs("div",{className:"mb-5",children:[r.jsx("div",{className:"h-1.5 w-full bg-white/25 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-white rounded-full transition-all",style:{width:`${T}%`},"aria-hidden":!0})}),r.jsxs("div",{className:"sr-only",role:"status","aria-live":"polite",children:[Math.round(T)," percent complete"]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("button",{onClick:q,disabled:t===0,className:"px-4 py-2 rounded bg-white text-indigo-700 font-semibold disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-white/40","aria-label":"Previous",children:"Back"}),r.jsx("div",{className:"flex gap-2",children:Qe.map((b,L)=>r.jsx("button",{"aria-label":`Go to slide ${L+1}`,onClick:()=>C(L),className:`w-3 h-3 rounded-full transition-opacity ${L===t?"bg-white":"bg-white/50 hover:bg-white/70"}`},L))}),r.jsx("button",{onClick:R,className:"px-4 py-2 rounded bg-white text-indigo-700 font-semibold focus:outline-none focus:ring-2 focus:ring-white/40","aria-label":_?"Login":"Next",children:_?"Login":"Next"})]})]})]})}const cx=/^[A-Z0-9]{6,12}$/i;function ux(){const{code:t}=an(),e=pt(),[s,n]=d.useState("Joiningâ€¦"),i=d.useMemo(()=>t?`/invite/${t}`:"/invite/invalid",[t]),o=d.useRef(!1);return d.useEffect(()=>{let a=!1;if(!o.current)return o.current=!0,(async()=>{if(!t||!cx.test(t)){a||n("Invalid or malformed link");return}const{data:c}=await w.auth.getUser();if(!c?.user){try{localStorage.setItem("postLoginRedirect",i)}catch{}e("/onboarding",{state:{redirect:i},replace:!0});return}try{const{data:l,error:u}=await w.rpc("join_via_code",{p_code:t});if(u){a||n(Eo(u.message));return}if(!l){a||n("Invite not found or expired");return}e(`/group/${l}`,{replace:!0})}catch(l){a||n(Eo(l?.message||String(l)))}})(),()=>{a=!0}},[t,i,e]),r.jsx("div",{className:"mx-auto max-w-md p-6 text-sm text-neutral-700","aria-live":"polite",children:s})}function Eo(t){const e=t.toLowerCase();return e.includes("permission")||e.includes("rls")?"You donâ€™t have permission to join this group.":e.includes("not found")||e.includes("no rows")?"Invite not found.":e.includes("expired")?"Invite expired.":e.includes("invalid input syntax for type uuid")?"Invalid invite code.":t}function dx(){const t=pt(),{user:e}=Es(),[s,n]=d.useState(!0),[i,o]=d.useState([]),[a,c]=d.useState([]),[l,u]=d.useState([]),[h,f]=d.useState([]),[m,g]=d.useState([]),[x,v]=d.useState(!1);d.useEffect(()=>{if(!e)return;const S=e.id;async function C(){n(!0);try{const{data:R}=await w.rpc("get_my_friend_requests"),q=(R||[]).map(D=>({id:D.id,user_id_a:D.sender_id,created_at:D.created_at,profiles:{name:D.sender_name,avatar_url:D.sender_avatar}})),{data:Q}=await w.from("group_members").select("group_id, created_at, groups(title)").eq("user_id",S).eq("status","invited").order("created_at",{ascending:!1}),{data:U}=await w.from("group_members").select("group_id").eq("user_id",S).eq("status","accepted"),P=U?.map(D=>D.group_id)||[];let T=[],N=[],F=[];if(P.length>0){const{data:D}=await w.from("group_polls").select("id, title, group_id, created_at, groups(title)").in("group_id",P).eq("status","open").order("created_at",{ascending:!1});T=D||[];const{data:I}=await w.from("group_messages").select("group_id, created_at, groups(title)").in("group_id",P).neq("sender_id",S).order("created_at",{ascending:!1}).limit(50);N=I||[];const{data:z}=await w.from("group_votes").select("poll_id, option_id, created_at, group_polls(id, title, group_id, groups(title)), group_poll_options(id, label)").eq("user_id",S).order("created_at",{ascending:!1}).limit(200);F=z||[]}o(q||[]),c(Q||[]),u(T),f(N),g(F)}catch(R){console.error("Error loading notifications",R)}finally{n(!1)}}C()},[e]);const y=d.useMemo(()=>{const S=[],C=new Date;C.setHours(0,0,0,0),i.forEach(P=>{S.push({id:`fr-${P.id}`,type:"friend_req",date:new Date(P.created_at),data:P})}),a.forEach(P=>{S.push({id:`inv-${P.group_id}`,type:"invite",date:new Date(P.created_at),data:P})});const R=new Map;l.forEach(P=>{R.has(P.id)||R.set(P.id,P)}),Array.from(R.values()).forEach(P=>{S.push({id:`poll-${P.id}`,type:"poll",date:new Date(P.created_at),data:P})});const q={};h.forEach(P=>{const T=P.group_id;q[T]||(q[T]={count:0,latest:new Date(P.created_at),groupName:P.groups?.title||"Unknown Group"}),q[T].count++;const N=new Date(P.created_at);N>q[T].latest&&(q[T].latest=N)}),Object.keys(q).forEach(P=>{S.push({id:`msg-group-${P}`,type:"message_summary",date:q[P].latest,data:{group_id:P,title:q[P].groupName,count:q[P].count}})}),m.forEach(P=>{S.push({id:`vote-${P.poll_id}-${P.option_id}-${P.created_at}`,type:"vote",date:new Date(P.created_at),data:P})}),S.sort((P,T)=>T.date.getTime()-P.date.getTime());const Q=S.filter(P=>P.date.getTime()>=C.getTime()),U=S.filter(P=>P.date.getTime()<C.getTime());return{recent:Q,older:U}},[i,a,l,h,m]);async function j(S,C){await w.rpc("accept_friend",{from_id:C}),o(R=>R.filter(q=>q.id!==S))}async function A(S){if(!e)return;const{error:C}=await w.from("group_members").update({status:"accepted"}).eq("group_id",S).eq("user_id",e.id);if(C){console.error("Failed to join group from notifications",C);return}c(R=>R.filter(q=>q.group_id!==S)),t(`/group/${S}`)}const E=S=>{const C=Date.now()-S.date.getTime()<864e5;return r.jsxs("div",{className:"bg-white border border-neutral-100 p-3 rounded-2xl flex items-center gap-3 shadow-sm mb-3 animate-in fade-in slide-in-from-bottom-2",children:[r.jsxs("div",{className:`h-10 w-10 shrink-0 rounded-full flex items-center justify-center ${S.type==="friend_req"?"bg-purple-100 text-purple-600":S.type==="invite"?"bg-amber-100 text-amber-600":S.type==="poll"?"bg-blue-100 text-blue-600":(S.type==="vote","bg-emerald-100 text-emerald-600")}`,children:[S.type==="friend_req"&&r.jsx(il,{className:"h-5 w-5"}),S.type==="invite"&&r.jsx(vd,{className:"h-5 w-5"}),S.type==="poll"&&r.jsx(ia,{className:"h-5 w-5"}),S.type==="vote"&&r.jsx(ia,{className:"h-5 w-5"}),S.type==="message_summary"&&r.jsx(rl,{className:"h-5 w-5"})]}),r.jsxs("div",{className:"flex-1 min-w-0",children:[S.type==="friend_req"&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-sm font-bold text-neutral-900",children:S.data.profiles?.name||"User"}),r.jsx("div",{className:"text-xs text-neutral-500",children:"Sent you a friend request"}),r.jsx("div",{className:"mt-2 flex gap-2",children:r.jsx("button",{onClick:()=>j(S.data.id,S.data.user_id_a),className:"bg-black text-white px-3 py-1 rounded-full text-xs font-bold",children:"Accept"})})]}),S.type==="invite"&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-sm font-bold text-neutral-900",children:S.data.groups?.title}),r.jsx("div",{className:"text-xs text-neutral-500",children:"You were invited to join"}),r.jsx("div",{className:"mt-2 flex gap-2",children:r.jsx("button",{onClick:()=>A(S.data.group_id),className:"bg-black text-white px-3 py-1 rounded-full text-xs font-bold",children:"Join"})})]}),S.type==="poll"&&r.jsxs("div",{onClick:()=>t(`/group/${S.data.group_id}`),className:"cursor-pointer",children:[r.jsx("div",{className:"text-sm font-bold text-neutral-900",children:S.data.title}),r.jsxs("div",{className:"text-xs text-neutral-500 flex items-center gap-1",children:["Vote in ",r.jsx("span",{className:"font-medium text-neutral-700",children:S.data.groups?.title})]})]}),S.type==="vote"&&r.jsxs("div",{onClick:()=>t(`/group/${S.data.group_polls?.group_id||S.data.group_polls?.group_id}`),className:"cursor-pointer",children:[r.jsx("div",{className:"text-sm font-bold text-neutral-900",children:"You voted"}),r.jsx("div",{className:"text-xs text-neutral-500",children:S.data.group_polls?.title?`Poll: ${S.data.group_polls.title}`:"Poll"}),r.jsx("div",{className:"text-xs text-neutral-500",children:S.data.group_poll_options?.label?`Choice: ${S.data.group_poll_options.label}`:""}),r.jsx("div",{className:"text-xs text-neutral-500",children:S.data.group_polls?.groups?.title?`Group: ${S.data.group_polls.groups.title}`:""})]}),S.type==="message_summary"&&r.jsxs("div",{onClick:()=>t(`/group/${S.data.group_id}`),className:"cursor-pointer",children:[r.jsx("div",{className:"text-sm font-bold text-neutral-900",children:S.data.title}),r.jsxs("div",{className:"text-xs text-neutral-500 font-medium",children:[S.data.count," new message",S.data.count>1?"s":""]})]})]}),r.jsx("div",{className:"text-[10px] text-neutral-400 whitespace-nowrap self-start",children:C?S.date.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):S.date.toLocaleDateString()})]},S.id)};if(s)return r.jsx("div",{className:"pt-24 text-center text-neutral-400 text-sm",children:"Checking for updates..."});const{recent:M,older:_}=y,$=M.length===0&&_.length===0;return r.jsxs("div",{className:"mx-auto w-full max-w-xl px-4 py-8 pb-32",children:[r.jsx("h1",{className:"text-2xl font-extrabold text-neutral-900 mb-6",children:"Activity"}),$&&r.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[r.jsx("div",{className:"h-16 w-16 bg-neutral-100 rounded-full flex items-center justify-center mb-4",children:r.jsx("span",{className:"text-2xl",children:"ğŸ’¤"})}),r.jsx("h3",{className:"text-neutral-900 font-bold",children:"All caught up"}),r.jsx("p",{className:"text-neutral-500 text-sm",children:"No activity yet."})]}),M.length>0&&r.jsxs("div",{className:"mb-6",children:[r.jsx("h2",{className:"text-xs font-bold text-neutral-400 uppercase tracking-wider mb-3",children:"New"}),M.map(E)]}),_.length>0&&r.jsxs("div",{children:[r.jsxs("button",{onClick:()=>v(!x),className:"flex items-center gap-2 text-xs font-bold text-neutral-400 uppercase tracking-wider mb-3 hover:text-neutral-600 transition-colors w-full",children:[x?r.jsx(nl,{className:"h-4 w-4"}):r.jsx(sl,{className:"h-4 w-4"}),"Earlier (",_.length,")"]}),x&&r.jsx("div",{className:"animate-in slide-in-from-top-2 fade-in duration-300",children:_.map(E)})]})]})}function Mo({size:t=20,className:e=""}){return r.jsxs("svg",{className:`animate-spin ${e}`,width:t,height:t,viewBox:"0 0 24 24",fill:"none",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]})}const hx=d.lazy(()=>Fn(()=>import("./ChatPanel-CXNAhs57.js"),__vite__mapDeps([3,1,2])));function fx(){const t=pt(),e=Et(),[s,n]=d.useState(null),[i,o]=d.useState([]),[a,c]=d.useState(!0),[l,u]=d.useState(null),[h,f]=d.useState(null),[m,g]=d.useState([]),[x,v]=d.useState(""),[y,j]=d.useState(!1),A=d.useRef(null),E=d.useRef(null),[M,_]=d.useState("all"),[$,S]=d.useState("");d.useEffect(()=>{async function N(){const{data:{user:F}}=await w.auth.getUser();if(!F)return;n(F.id);const D=new Set(JSON.parse(localStorage.getItem("chat_favorites")||"[]")),{data:I}=await w.from("group_members").select("group_id, groups(id, title, category)").eq("user_id",F.id).in("status",["active","accepted"]),{data:z}=await w.from("friendships").select("user_id_a, user_id_b").or(`user_id_a.eq.${F.id},user_id_b.eq.${F.id}`).eq("status","accepted"),b=[];if(I&&I.forEach(L=>{L.groups&&b.push({type:"group",id:L.groups.id,name:L.groups.title,avatar_url:null,subtitle:L.groups.category||"Group",isFavorite:D.has(L.groups.id)})}),z){const L=z.map(H=>H.user_id_a===F.id?H.user_id_b:H.user_id_a);if(L.length>0){const{data:H}=await w.from("profiles").select("user_id, name, avatar_url").in("user_id",L);H?.forEach(ce=>{b.push({type:"dm",id:ce.user_id,name:ce.name||"User",avatar_url:ce.avatar_url,subtitle:"Direct Message",isFavorite:D.has(ce.user_id)})})}}b.sort((L,H)=>L.isFavorite&&!H.isFavorite?-1:!L.isFavorite&&H.isFavorite?1:L.name.localeCompare(H.name)),o(b),c(!1)}N()},[]);const C=N=>{const F=new Set(JSON.parse(localStorage.getItem("chat_favorites")||"[]"));let D=!1;F.has(N)?(F.delete(N),D=!1):(F.add(N),D=!0),localStorage.setItem("chat_favorites",JSON.stringify(Array.from(F))),o(I=>I.map(z=>z.id===N?{...z,isFavorite:D}:z).sort((z,b)=>z.isFavorite&&!b.isFavorite?-1:!z.isFavorite&&b.isFavorite?1:z.name.localeCompare(b.name))),l&&l.id===N&&u(I=>I?{...I,isFavorite:D}:null)};d.useEffect(()=>{const N=e.state?.openDmId;if(N&&i.length>0&&!l){const F=i.find(D=>D.id===N&&D.type==="dm");F?u(F):(async()=>{const{data:D}=await w.from("profiles").select("name, avatar_url").eq("user_id",N).single();if(D){const I=new Set(JSON.parse(localStorage.getItem("chat_favorites")||"[]")),z={type:"dm",id:N,name:D.name||"User",avatar_url:D.avatar_url,subtitle:"Direct Message",isFavorite:I.has(N)};o(b=>[z,...b]),u(z)}})(),window.history.replaceState({},"")}},[e.state,i,l]),d.useEffect(()=>{if(!s||!l||l.type!=="dm")return;let N=null,F=null;async function D(){j(!0);const I=l.id,{data:z}=await w.from("direct_messages").select("id, sender, receiver, content, created_at").or(`and(sender.eq.${s},receiver.eq.${I}),and(sender.eq.${I},receiver.eq.${s})`).order("created_at",{ascending:!0}).limit(100);g(z||[]),j(!1),setTimeout(()=>A.current?.scrollIntoView({behavior:"smooth"}),100),N=w.channel(`dm:${I}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"direct_messages",filter:`or(and(sender.eq.${s},receiver.eq.${I}),and(sender.eq.${I},receiver.eq.${s}))`},b=>{const L=b.new;(L.sender===s&&L.receiver===I||L.sender===I&&L.receiver===s)&&(g(ce=>[...ce,L]),setTimeout(()=>A.current?.scrollIntoView({behavior:"smooth"}),100))}).subscribe(),F=setInterval(async()=>{const{data:b}=await w.from("direct_messages").select("id, sender, receiver, content, created_at").or(`and(sender.eq.${s},receiver.eq.${I}),and(sender.eq.${I},receiver.eq.${s})`).order("created_at",{ascending:!0}).limit(100);b&&g(b)},5e3)}return D(),()=>{N&&w.removeChannel(N),F&&clearInterval(F)}},[l,s]),d.useEffect(()=>{l?.type==="dm"&&E.current?.focus()},[l]);const R=async()=>{if(!x.trim()||!s||!l||l.type!=="dm")return;const N=x.trim();v(""),E.current?.focus(),await w.from("direct_messages").insert({sender:s,receiver:l.id,content:N})},Q=i.filter(N=>!(M==="groups"&&N.type!=="group"||M==="private"&&N.type!=="dm"||M==="fav"&&!N.isFavorite||!N.name.toLowerCase().includes($.toLowerCase()))),U=({id:N,label:F})=>r.jsx("button",{onClick:()=>_(N),className:`
        whitespace-nowrap px-4 py-1.5 rounded-full text-xs font-semibold transition-all border
        ${M===N?"bg-neutral-900 text-white border-neutral-900 shadow-md transform scale-105":"bg-white text-neutral-600 border-neutral-200 hover:bg-neutral-50 hover:border-neutral-300"}
      `,children:F}),P=()=>r.jsxs("div",{className:`flex flex-col h-full bg-white border-r border-neutral-200 ${l?"hidden md:flex":"flex"} w-full md:w-80 lg:w-96`,children:[r.jsxs("div",{className:"p-5 border-b border-neutral-100 bg-white/80 backdrop-blur-md sticky top-0 z-10",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h1",{className:"text-2xl font-bold text-neutral-900 tracking-tight",children:"Chats"}),a&&r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-neutral-900"})]}),r.jsxs("div",{className:"relative mb-4 group",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-neutral-400 group-focus-within:text-emerald-600 transition-colors",children:r.jsx(Kr,{className:"h-4 w-4"})}),r.jsx("input",{value:$,onChange:N=>S(N.target.value),placeholder:"Search conversations...",className:"block w-full pl-10 pr-3 py-2.5 border border-neutral-200 rounded-xl leading-5 bg-neutral-50 placeholder-neutral-400 focus:outline-none focus:bg-white focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 transition-all text-sm font-medium"})]}),r.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-1 scrollbar-hide",children:[r.jsx(U,{id:"all",label:"All"}),r.jsx(U,{id:"groups",label:"Groups"}),r.jsx(U,{id:"private",label:"Private"}),r.jsx(U,{id:"fav",label:"Favorites"})]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto",children:a?r.jsx("div",{className:"p-8 flex justify-center",children:r.jsx(Mo,{})}):Q.length===0?r.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-neutral-400 px-6 text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-neutral-50 rounded-full flex items-center justify-center mb-4",children:r.jsx(ud,{className:"h-6 w-6 opacity-30"})}),r.jsx("p",{className:"text-sm font-medium",children:"No chats found."}),r.jsx("p",{className:"text-xs mt-1 opacity-70",children:"Try adjusting your filters or search."})]}):r.jsx("div",{className:"px-2 py-2 space-y-1",children:Q.map(N=>r.jsxs("div",{className:"group relative",children:[r.jsxs("button",{onClick:()=>u(N),className:`
                    w-full flex items-center gap-3 p-3 rounded-xl text-left transition-all duration-200
                    ${l?.id===N.id?"bg-emerald-50 shadow-sm ring-1 ring-emerald-100":"hover:bg-neutral-50"}
                  `,children:[r.jsx("div",{className:`
                    h-12 w-12 rounded-full flex items-center justify-center text-lg font-bold shrink-0 shadow-sm
                    ${N.type==="group"?"bg-gradient-to-br from-indigo-100 to-indigo-200 text-indigo-700":"bg-gradient-to-br from-neutral-100 to-neutral-200 text-neutral-600"}
                  `,children:N.type==="dm"&&N.avatar_url?r.jsx("img",{src:N.avatar_url,alt:"",className:"h-full w-full object-cover rounded-full"}):N.type==="group"?r.jsx(Ps,{className:"h-5 w-5"}):N.name.slice(0,1).toUpperCase()}),r.jsxs("div",{className:"min-w-0 flex-1 pr-8",children:[r.jsx("div",{className:`font-semibold truncate ${l?.id===N.id?"text-emerald-900":"text-neutral-900"}`,children:N.name}),r.jsx("div",{className:"text-xs text-neutral-500 truncate mt-0.5",children:N.subtitle})]})]}),r.jsx("button",{onClick:F=>{F.stopPropagation(),C(N.id)},className:`
                    absolute right-3 top-1/2 -translate-y-1/2 p-2 rounded-full transition-all duration-200
                    hover:bg-white hover:shadow-sm
                    ${N.isFavorite?"opacity-100 text-rose-500":"opacity-0 group-hover:opacity-100 text-neutral-300 hover:text-rose-400"}
                  `,title:N.isFavorite?"Remove from Favorites":"Add to Favorites",children:r.jsx(ra,{className:`h-4 w-4 ${N.isFavorite?"fill-current":""}`})})]},N.type+N.id))})})]}),T=()=>{if(!l)return r.jsxs("div",{className:"hidden md:flex flex-1 items-center justify-center bg-neutral-50/50 flex-col gap-6",children:[r.jsx("div",{className:"bg-white p-6 rounded-full shadow-sm ring-1 ring-black/5",children:r.jsx(Pn,{className:"h-12 w-12 text-emerald-500/50"})}),r.jsxs("div",{className:"text-center",children:[r.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:"Select a conversation"}),r.jsx("p",{className:"text-sm text-neutral-500 mt-1",children:"Choose a group or friend to start chatting"})]})]});const N=()=>{l.type==="group"?t(`/group/${l.id}`):l.type==="dm"&&f(l.id)};return r.jsxs("div",{className:"fixed inset-0 z-50 pb-20 md:pb-0 md:static md:inset-auto md:flex-1 bg-white flex flex-col h-full",children:[r.jsxs("div",{className:"h-[72px] border-b border-neutral-200 flex items-center px-4 gap-4 bg-white/95 backdrop-blur-sm shrink-0 shadow-sm z-20",children:[r.jsx("button",{onClick:()=>u(null),className:"md:hidden p-2 -ml-2 rounded-full hover:bg-neutral-100 transition-colors",children:r.jsx(Ns,{className:"h-5 w-5 text-neutral-600"})}),r.jsxs("div",{onClick:N,className:"flex items-center gap-4 flex-1 min-w-0 cursor-pointer hover:opacity-70 transition-opacity",title:`View ${l.type==="group"?"Group":"Profile"}`,children:[r.jsx("div",{className:`h-10 w-10 rounded-full flex items-center justify-center text-sm font-bold shadow-sm ${l.type==="group"?"bg-indigo-100 text-indigo-700":"bg-neutral-100 text-neutral-600"}`,children:l.type==="dm"&&l.avatar_url?r.jsx("img",{src:l.avatar_url,alt:"",className:"h-full w-full object-cover rounded-full"}):l.type==="group"?"#":l.name.slice(0,1)}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"font-bold text-neutral-900 truncate text-base",children:l.name}),r.jsxs("div",{className:"text-xs text-neutral-500 flex items-center gap-1",children:[r.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${l.type==="group"?"bg-indigo-500":"bg-emerald-500"}`}),l.type==="group"?"Group Chat":"Direct Message"]})]})]}),r.jsx("button",{onClick:()=>C(l.id),className:"p-2 rounded-full hover:bg-neutral-100 transition-colors focus:outline-none focus:ring-2 focus:ring-neutral-200",title:l.isFavorite?"Remove from Favorites":"Add to Favorites",children:r.jsx(ra,{className:`h-5 w-5 transition-colors ${l.isFavorite?"fill-rose-500 text-rose-500":"text-neutral-400"}`})})]}),r.jsxs("div",{className:"flex-1 overflow-hidden relative bg-neutral-50",children:[r.jsx("div",{className:"absolute inset-0 opacity-[0.03] pointer-events-none",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='20' height='20' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23000000' fill-opacity='1' fill-rule='evenodd'%3E%3Ccircle cx='3' cy='3' r='1'/%3E%3C/g%3E%3C/svg%3E")`}}),l.type==="group"?r.jsx(d.Suspense,{fallback:r.jsx("div",{className:"h-full w-full flex items-center justify-center",children:r.jsx(Mo,{})}),children:r.jsx("div",{className:"h-full w-full relative z-10",children:r.jsx(hx,{groupId:l.id,onClose:()=>u(null),full:!0,setFull:()=>{},user:{id:s}})})}):r.jsxs("div",{className:"flex flex-col h-full relative z-10",children:[r.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[y&&r.jsx("div",{className:"flex justify-center py-4",children:r.jsx("div",{className:"bg-white/80 px-4 py-1.5 rounded-full text-xs font-medium text-neutral-500 shadow-sm border border-neutral-100",children:"Loading history..."})}),!y&&m.length===0&&r.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-neutral-400 space-y-3",children:[r.jsx("div",{className:"w-16 h-16 bg-white rounded-full shadow-sm flex items-center justify-center",children:r.jsx(Pn,{className:"h-8 w-8 text-neutral-200"})}),r.jsx("div",{className:"text-sm",children:"No messages yet. Say hi! ğŸ‘‹"})]}),m.map((F,D)=>{const I=F.sender===s,z=!I&&(D===0||m[D-1].sender!==F.sender);return r.jsx("div",{className:`flex ${I?"justify-end":"justify-start"} group animate-in fade-in slide-in-from-bottom-2 duration-300`,children:r.jsxs("div",{className:`flex max-w-[80%] md:max-w-[70%] ${I?"flex-row-reverse":"flex-row"} items-end gap-2`,children:[!I&&r.jsx("div",{className:"w-6 h-6 shrink-0 mb-1",children:z&&(l.avatar_url?r.jsx("img",{src:l.avatar_url,className:"w-6 h-6 rounded-full object-cover shadow-sm"}):r.jsx("div",{className:"w-6 h-6 rounded-full bg-neutral-200 flex items-center justify-center text-[9px] font-bold text-neutral-500",children:l.name.slice(0,1)}))}),r.jsxs("div",{className:`
                          px-4 py-2.5 text-sm shadow-sm relative
                          ${I?"bg-gradient-to-br from-emerald-500 to-emerald-600 text-white rounded-2xl rounded-tr-sm":"bg-white text-neutral-800 border border-neutral-100 rounded-2xl rounded-tl-sm"}
                        `,children:[F.content,r.jsx("div",{className:`text-[9px] mt-1 text-right opacity-70 ${I?"text-emerald-100":"text-neutral-400"}`,children:new Date(F.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})},F.id)}),r.jsx("div",{ref:A})]}),r.jsx("div",{className:"p-4 bg-white border-t border-neutral-200/80 backdrop-blur-md",children:r.jsxs("div",{className:"flex items-center gap-2 max-w-4xl mx-auto bg-neutral-50 border border-neutral-200 rounded-full px-2 py-2 focus-within:ring-2 focus-within:ring-emerald-500/20 focus-within:border-emerald-500 transition-all shadow-inner",children:[r.jsx("input",{ref:E,value:x,onChange:F=>v(F.target.value),onKeyDown:F=>F.key==="Enter"&&R(),autoFocus:!0,placeholder:"Type a message...",className:"flex-1 bg-transparent border-0 px-4 py-1 text-sm focus:ring-0 text-neutral-900 placeholder-neutral-400 outline-none"}),r.jsx("button",{onClick:R,disabled:!x.trim(),className:`
                      p-2.5 rounded-full transition-all duration-200 flex items-center justify-center shadow-sm
                      ${x.trim()?"bg-emerald-600 text-white hover:bg-emerald-700 hover:scale-105 active:scale-95":"bg-neutral-200 text-neutral-400 cursor-not-allowed"}
                    `,children:r.jsx(Pd,{className:"h-4 w-4 ml-0.5"})})]})})]})]})]})};return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex h-[calc(100vh-64px)] w-full overflow-hidden bg-white fixed top-0 left-0",children:[r.jsx(P,{}),r.jsx(T,{})]}),r.jsx(Wr,{isOpen:!!h,onClose:()=>f(null),viewUserId:h})]})}function mx(){return r.jsxs("div",{className:"min-h-screen bg-white p-6 max-w-2xl mx-auto",children:[r.jsxs(me,{to:"/onboarding",className:"inline-flex items-center gap-2 text-neutral-600 mb-6 hover:text-black",children:[r.jsx(Ns,{className:"h-4 w-4"})," Back"]}),r.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Legal & Privacy"}),r.jsxs("section",{className:"mb-8 space-y-4",children:[r.jsx("h2",{className:"text-xl font-bold",children:"Privacy Policy"}),r.jsx("p",{className:"text-neutral-600 text-sm",children:"We respect your privacy. We only store the data necessary for the app to function (your profile, messages, and groups). We do not sell your data. You can delete your account and data at any time by contacting support."})]}),r.jsxs("section",{className:"mb-8 space-y-4",children:[r.jsx("h2",{className:"text-xl font-bold",children:"Terms of Service"}),r.jsx("p",{className:"text-neutral-600 text-sm",children:"By using Circles, you agree to be kind and respectful. We have zero tolerance for harassment, hate speech, or objectional content. Users posting such content will be banned. You are responsible for your own interactions."})]}),r.jsxs("section",{className:"mb-8 space-y-4",children:[r.jsx("h2",{className:"text-xl font-bold",children:"Contact"}),r.jsx("p",{className:"text-neutral-600 text-sm",children:"Questions? Email us at support@yourdomain.com"})]})]})}function px(){const t=pt();return d.useEffect(()=>{(async()=>(await w.auth.getSession(),t("/",{replace:!0})))()},[t]),null}const Fc=d.createContext({user:null,loading:!0});function Es(){return d.useContext(Fc)}function gx({children:t}){const[e,s]=d.useState(null),[n,i]=d.useState(!0);d.useEffect(()=>{let a=!0;w.auth.getSession().then(({data:l,error:u})=>{a&&(u&&console.warn("[auth] getSession error",u.message),s(l.session?.user??null),i(!1))});const{data:{subscription:c}}=w.auth.onAuthStateChange((l,u)=>{a&&(s(u?.user??null),i(!1))});return()=>{a=!1,c.unsubscribe()}},[]);const o=d.useMemo(()=>({user:e,loading:n}),[e,n]);return r.jsx(Fc.Provider,{value:o,children:t})}function Ro({children:t}){const{user:e,loading:s}=Es(),{data:n,isLoading:i}=al(e?.id??null),o=Et();return s||e&&i?r.jsx("div",{className:"grid min-h-dvh place-items-center text-sm text-neutral-600",children:"Loadingâ€¦"}):e?(!n||n.onboarded===!1)&&o.pathname!=="/profile-creation"?r.jsx(zs,{to:"/profile-creation",replace:!0,state:{from:o.pathname}}):r.jsx(r.Fragment,{children:t}):r.jsx(zs,{to:"/onboarding",replace:!0,state:{from:o.pathname}})}class xx extends Jt.Component{constructor(e){super(e),this.state={error:null}}static getDerivedStateFromError(e){return{error:e}}render(){return this.state.error?r.jsx("div",{className:"grid min-h-screen place-items-center p-6",children:r.jsxs("div",{className:"max-w-md text-center",children:[r.jsx("h1",{className:"text-2xl font-bold",children:"Something broke"}),r.jsx("p",{className:"text-sm text-neutral-600 break-words mt-2",children:String(this.state.error?.message??this.state.error)}),r.jsx("button",{className:"mt-4 rounded-md border border-black/10 bg-white px-3 py-2 text-sm hover:bg-black/[0.04]",onClick:()=>location.reload(),children:"Reload"})]})}):this.props.children}}function yx(){const{id:t}=an();return r.jsx(zs,{to:`/group/${t}`,replace:!0})}function vx(){return r.jsx(zs,{to:"/onboarding",replace:!0})}function bx(){d.useEffect(()=>{window.scrollTo(0,0)},[]),d.useEffect(()=>{try{"scrollRestoration"in history&&(history.scrollRestoration="manual")}catch{}},[]);const t=Et();return d.useEffect(()=>{window.scrollTo(0,0)},[t.pathname,t.search]),r.jsx("div",{id:"page-root",className:"min-h-dvh flow-root flex flex-col",children:r.jsxs(gx,{children:[r.jsx("button",{onClick:()=>window.open("mailto:support@yourdomain.com?subject=Help%20with%20Circles%20App","_blank"),className:"fixed top-4 right-4 z-50 grid h-10 w-10 place-items-center rounded-full bg-white text-neutral-600 shadow-md ring-1 ring-black/5 transition-transform hover:scale-105 hover:text-black",title:"Support","aria-label":"Support",children:r.jsx(id,{className:"h-6 w-6"})}),r.jsx(xx,{children:r.jsx(d.Suspense,{fallback:r.jsx("div",{className:"grid min-h-dvh place-items-center text-sm text-neutral-600",children:"Loadingâ€¦"}),children:r.jsxs(Xc,{children:[r.jsx(ke,{path:"/",element:r.jsx(vx,{})}),r.jsx(ke,{path:"/onboarding",element:r.jsx(lx,{})}),r.jsx(ke,{path:"/legal",element:r.jsx(mx,{})}),r.jsx(ke,{path:"/invite/:code",element:r.jsx(ux,{})}),r.jsx(ke,{path:"/auth/callback",element:r.jsx(px,{})}),r.jsx(ke,{path:"/profile-creation",element:r.jsx(Ro,{children:r.jsx(Th,{})})}),r.jsxs(ke,{element:r.jsx(Ro,{children:r.jsx(Kd,{})}),children:[r.jsx(ke,{path:"/browse",element:r.jsx(Qd,{})}),r.jsx(ke,{path:"/groups",element:r.jsx(wh,{})}),r.jsx(ke,{path:"/notifications",element:r.jsx(dx,{})}),r.jsx(ke,{path:"/profile",element:r.jsx(ha,{})}),r.jsx(ke,{path:"/profile/:userId",element:r.jsx(ha,{})}),r.jsx(ke,{path:"/create",element:r.jsx(Zd,{})}),r.jsx(ke,{path:"/group/:id",element:r.jsx(gh,{})}),r.jsx(ke,{path:"/groups/game/:game",element:r.jsx(Eh,{})}),r.jsx(ke,{path:"/groups/mine",element:r.jsx(Rh,{})}),r.jsx(ke,{path:"/chats",element:r.jsx(fx,{})})]}),r.jsx(ke,{path:"/groups/:id",element:r.jsx(yx,{})}),r.jsx(ke,{path:"*",element:r.jsx(zs,{to:"/onboarding",replace:!0})})]})})})]})})}typeof window<"u"&&"serviceWorker"in navigator&&(navigator.serviceWorker.getRegistrations().then(t=>{t.forEach(e=>e.unregister())}).catch(()=>{}),"caches"in window&&caches.keys().then(t=>{t.forEach(e=>caches.delete(e))}).catch(()=>{}));const wx=new Pu;ru.createRoot(document.getElementById("root")).render(r.jsx(Jt.StrictMode,{children:r.jsx(Au,{client:wx,children:r.jsx(Jc,{basename:"/circles",children:r.jsx(bx,{})})})}));export{Ws as M,Pd as S,ol as W,Nn as X,fh as a,ae as c,r as j,w as s,Es as u};
