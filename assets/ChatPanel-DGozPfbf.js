import{c as $,u as be,s as f,j as e}from"./index-BFSOJQ8p.js";import{c as u}from"./react-Dymf0t1b.js";import{u as _e}from"./useGroupPresence-C2upsTTn.js";import{X as C}from"./ViewOtherProfileModal-C8uVw2Bj.js";import{M as we}from"./map-pin-B0hwBbkr.js";import{S as ve}from"./send-D-31sDb8.js";import"./supabase-BesQZUkt.js";import"./user-plus-D6OwJxO9.js";const je=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ne=$("loader-circle",je);const ye=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],V=$("paperclip",ye);const Ne=[["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}],["path",{d:"m9 17-5-5 5-5",key:"nvlc11"}]],ae=$("reply",Ne);const ke=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],Se=$("smile",ke),le=c=>{const x=Math.floor((Date.now()-new Date(c).getTime())/1e3);if(x<5)return"now";if(x<60)return`${x}s`;const y=Math.floor(x/60);if(y<60)return`${y}m`;const w=Math.floor(y/60);if(w<24)return`${w}h`;const D=Math.floor(w/24);return D===1?"1d":`${D}d`},ie=()=>{const c=typeof globalThis<"u"&&globalThis.crypto?globalThis.crypto:null;return c&&typeof c.randomUUID=="function"?c.randomUUID():Math.random().toString(36).slice(2)},Me=c=>`${ie()}_${c.name}`;function Fe({groupId:c,pageSize:x=30,user:y,onClose:w,full:D,setFull:Ee}){const[R,Ce]=u.useState(null),[g,v]=u.useState(new Map),[p,N]=u.useState([]),[W,T]=u.useState(new Map),[$e,G]=u.useState(new Map),[U,K]=u.useState(""),[P,q]=u.useState(null),[X,Y]=u.useState(!1),[b,j]=u.useState([]),[A,z]=u.useState(!1),[F,J]=u.useState(!1),[oe,O]=u.useState(!0),[H,ce]=u.useState(0),[Q,de]=u.useState(null),[Z,L]=u.useState(null),[k,ue]=u.useState([]),[me,I]=u.useState(!1),B=u.useRef(null),_=u.useRef(null),{user:ee}=be(),m=ee?.id||null,S=ee?.email||null,{isTogether:te}=_e(c,m??void 0);u.useEffect(()=>{let t=!1;async function r(l){const n=l.filter(o=>!g.has(o));if(!n.length)return;const{data:a}=await f.from("profiles").select("user_id,id,name,avatar_url").in("user_id",n);a&&v(o=>{const d=new Map(o);for(const h of a)d.set(h.user_id,h);return d})}async function s(l){if(!l.length)return;const{data:n}=await f.from("group_message_reactions").select("message_id,user_id,emoji").in("message_id",l);if(!n)return;const a=new Map;for(const o of n){const d=a.get(o.message_id)??{},h=d[o.emoji]??[];h.includes(o.user_id)||h.push(o.user_id),d[o.emoji]=h,a.set(o.message_id,d)}T(a)}async function i(l){if(!l.length)return;const{data:n}=await f.from("group_message_reads").select("message_id,user_id,read_at").in("message_id",l);if(!n)return;const a=new Map;for(const o of n){const d=a.get(o.message_id)??[];d.includes(o.user_id)||d.push(o.user_id),a.set(o.message_id,d)}G(a)}return(async()=>{O(!0);const{data:l,error:n}=await f.from("group_messages").select("id,group_id,user_id:sender_id,content,created_at,parent_id,attachments").eq("group_id",c).order("created_at",{ascending:!0});if(t)return;if(n){console.error(n),O(!1);return}const a=l??[];N(a),O(!1),setTimeout(()=>_.current?.scrollIntoView({behavior:"smooth",block:"end"}),0);const o=Array.from(new Set(a.map(d=>d.user_id)));await r(o),await s(a.map(d=>d.id)),await i(a.map(d=>d.id))})(),()=>{t=!0}},[c,x]),u.useEffect(()=>{let t=!1;const r=async()=>{const{data:i,error:l}=await f.from("group_members").select("user_id, profiles(name,avatar_url)").eq("group_id",c);if(l){console.warn("[members] load error",l);return}if(t)return;const n=(i||[]).map(a=>({user_id:a.user_id,name:a.profiles?.name??null,avatar_url:a.profiles?.avatar_url??null}));ue(n),v(a=>{const o=new Map(a);for(const d of n)o.set(d.user_id,{user_id:d.user_id,name:d.name,avatar_url:d.avatar_url});return o})};r();const s=f.channel(`gm:${c}:members`).on("postgres_changes",{event:"*",schema:"public",table:"group_members",filter:`group_id=eq.${c}`},()=>{r()}).subscribe();return()=>{t=!1,f.removeChannel(s)}},[c]),u.useEffect(()=>{_.current?.scrollIntoView({behavior:"smooth",block:"end"})},[p.length]),u.useEffect(()=>{const t=f.channel(`gm:${c}`);return t.on("postgres_changes",{event:"INSERT",schema:"public",table:"group_messages"},async r=>{const s=r.new;if(s.group_id!==c)return;const i={id:s.id,group_id:s.group_id,user_id:s.user_id??s.sender_id??s.author_id,content:s.content,created_at:s.created_at,parent_id:s.parent_id??null,attachments:s.attachments??[]};if(N(n=>{const a=Date.now()-3e4,o=n.filter(h=>!h.id.startsWith("phantom-")||h.user_id!==i.user_id||h.content!==i.content?!0:+new Date(h.created_at)<a);return o.find(h=>h.id===i.id)?o:[...o,i].sort((h,E)=>+new Date(h.created_at)-+new Date(E.created_at))}),!g.get(i.user_id)){const{data:n}=await f.from("profiles").select("user_id,id,name,avatar_url").eq("user_id",i.user_id).maybeSingle();n&&v(a=>new Map(a).set(n.user_id,n))}(()=>{const n=B.current;return n?n.scrollHeight-n.scrollTop-n.clientHeight<200:!0})()&&_.current?.scrollIntoView({behavior:"smooth",block:"end"})}).on("postgres_changes",{event:"INSERT",schema:"public",table:"group_message_reactions"},r=>{const s=r.new;T(i=>{const l=new Map(i),n=l.get(s.message_id)??{},a=n[s.emoji]??[];return a.includes(s.user_id)||a.push(s.user_id),n[s.emoji]=a,l.set(s.message_id,n),l})}).on("postgres_changes",{event:"DELETE",schema:"public",table:"group_message_reactions"},r=>{const s=r.old;T(i=>{const l=new Map(i),n=l.get(s.message_id)??{},a=(n[s.emoji]??[]).filter(o=>o!==s.user_id);return a.length?n[s.emoji]=a:delete n[s.emoji],l.set(s.message_id,n),l})}).on("postgres_changes",{event:"INSERT",schema:"public",table:"group_message_reads"},r=>{const s=r.new;G(i=>{const l=new Map(i),n=l.get(s.message_id)??[];return n.includes(s.user_id)||n.push(s.user_id),l.set(s.message_id,n),l})}).subscribe(),()=>{f.removeChannel(t)}},[c]),u.useEffect(()=>{const t=f.channel(`gm:${c}:presence`,{config:{presence:{key:m||Math.random().toString(36).slice(2)}}});return t.on("presence",{event:"sync"},()=>{const r=t.presenceState(),s=Object.keys(r);ce(s.length);let i=null;for(const l of s){const n=r[l],a=n[n.length-1];if(a?.typing&&a?.uid!==m){i=a.name||"Someone";break}}de(i)}),t.subscribe(r=>{r==="SUBSCRIBED"&&t.track({uid:m,name:R?.name||(S?S.split("@")[0]:void 0),typing:!1})}),()=>{f.removeChannel(t)}},[c,m,R?.name]),u.useEffect(()=>{const t=f.channel("profiles-realtime").on("postgres_changes",{event:"*",schema:"public",table:"profiles"},r=>{const s=r.new;s?.user_id&&v(i=>{const l=new Map(i);return l.set(s.user_id,{user_id:s.user_id,id:s.user_id,name:s.name,avatar_url:s.avatar_url??null}),l})}).subscribe();return()=>{f.removeChannel(t)}},[]),u.useEffect(()=>{(async()=>{if(!p.length)return;const t=Array.from(new Set(p.map(i=>i.user_id))).filter(i=>!g.has(i));if(!t.length)return;const{data:r,error:s}=await f.from("profiles").select("user_id,id,name,avatar_url").in("user_id",t);s||r?.length&&v(i=>{const l=new Map(i);for(const n of r)l.set(n.user_id,n);return l})})()},[p,g]),u.useEffect(()=>{if(!m||!p.length)return;const t=B.current;if(!t)return;const r=new IntersectionObserver(async i=>{for(const l of i)if(l.isIntersecting){const n=l.target.dataset.mid;if(!n||n.startsWith("phantom-"))continue;await f.from("group_message_reads").upsert({message_id:n,user_id:m})}},{root:t,threshold:.6});return t.querySelectorAll("[data-mid]").forEach(i=>r.observe(i)),()=>r.disconnect()},[m,p]);const se=async()=>{const t=U.trim(),r=P?.id??null,s=m;if(!s||!X||!t&&b.length===0||F||A)return;J(!0);const i=`phantom-${ie()}`,l={id:i,group_id:c,user_id:s,content:t,created_at:new Date().toISOString(),parent_id:r,attachments:[]};N(o=>[...o,l]),_.current?.scrollIntoView({behavior:"smooth",block:"end"}),K(""),q(null);let n=[];if(b.length){z(!0);try{n=await Promise.all(b.map(async d=>{const h=`${c}/${Me(d)}`,{error:E}=await f.storage.from("chat-uploads").upload(h,d);if(E)throw E;const{data:ge}=await f.storage.from("chat-uploads").createSignedUrl(h,3600*24*7);return{bucket:"chat-uploads",path:h,url:ge?.signedUrl??null,name:d.name,size:d.size,type:d.type}}))}catch(o){console.error(o),z(!1);return}z(!1),j([])}const{error:a}=await f.rpc("send_group_message",{p_group_id:c,p_content:t,p_parent_id:r,p_attachments:n});if(J(!1),a){N(o=>o.filter(d=>d.id!==i)),alert(a.message);return}_.current?.scrollIntoView({behavior:"smooth",block:"end"})};u.useEffect(()=>{(async()=>{if(!(!m||!c))try{await f.from("group_members").upsert({group_id:c,user_id:m,role:"member",status:"active"},{onConflict:"group_id,user_id"}),Y(!0)}catch(t){console.warn("membership ensure failed",t),Y(!1)}})()},[c,m]),u.useEffect(()=>{(async()=>{if(!(!m||!c))try{await f.rpc("mark_group_read",{p_group_id:c});try{window.dispatchEvent(new CustomEvent("group-read",{detail:{groupId:c}}))}catch{}await f.from("notifications").update({is_read:!0}).eq("user_id",m).eq("payload->>group_id",c).eq("is_read",!1)}catch{}})()},[c,m]),u.useEffect(()=>{if(!m||!c)return;const t=async()=>{try{await f.rpc("mark_group_read",{p_group_id:c});try{window.dispatchEvent(new CustomEvent("group-read",{detail:{groupId:c}}))}catch{}}catch{}};return window.addEventListener("focus",t),()=>window.removeEventListener("focus",t)},[c,m]);const re=async(t,r)=>{if(!m)return;(W.get(t)?.[r]??[]).includes(m)?await f.from("group_message_reactions").delete().eq("message_id",t).eq("user_id",m).eq("emoji",r):await f.from("group_message_reactions").insert({message_id:t,emoji:r})},M=t=>{if(t===m){const s=(R?.name??"").trim();return s||(S?S.split("@")[0]:"You")}return(g.get(t)?.name??"").trim()||k.find(s=>s.user_id===t)?.name||"Player"},fe=t=>{const r=g.get(t);if(r?.avatar_url)return e.jsx("img",{src:r.avatar_url,alt:"",className:"h-8 w-8 rounded-full object-cover ring-2 ring-white shadow-sm"});const s=(r?.name||t.slice(0,2)).slice(0,2).toUpperCase();return e.jsx("div",{className:"h-8 w-8 rounded-full border border-neutral-200 bg-neutral-100 flex items-center justify-center text-[10px] text-neutral-600 font-bold",children:s})},he=t=>{t.preventDefault();const r=Array.from(t.dataTransfer?.files||[]);r.length&&j(s=>[...s,...r])},pe=t=>{const r=[],s=Array.from(t.clipboardData?.items||[]);for(const i of s)if(i.kind==="file"){const l=i.getAsFile();l&&r.push(l)}r.length&&j(i=>[...i,...r])},xe=t=>t?.length?e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:t.map((r,s)=>r?.type?.startsWith("image/")&&r.url?e.jsx("img",{src:r.url,alt:r.name||"",className:"max-h-48 rounded-lg border border-neutral-100 shadow-sm"},s):e.jsxs("a",{href:r.url||"#",target:"_blank",rel:"noreferrer",className:"flex items-center gap-2 rounded-lg bg-neutral-100 px-3 py-2 text-xs font-medium text-neutral-700 hover:bg-neutral-200",children:[e.jsx(V,{className:"h-3 w-3"}),r.name||r.path]},s))}):null;return e.jsxs("div",{className:"relative flex h-full w-full flex-col overflow-hidden bg-white",children:[e.jsxs("div",{className:"flex shrink-0 items-center justify-between border-b border-neutral-100 bg-white/80 px-4 py-3 backdrop-blur-md z-10",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"text-base font-bold text-neutral-900",children:"Group Chat"}),e.jsxs("div",{className:"flex items-center gap-2 text-[11px] font-medium text-neutral-500",children:[e.jsx("span",{className:`inline-block h-2 w-2 rounded-full ${H>0?"bg-emerald-500":"bg-neutral-300"}`}),H>0?`${H} online`:"Offline"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>I(t=>!t),className:"rounded-full bg-neutral-100 px-3 py-1.5 text-xs font-semibold text-neutral-600 hover:bg-neutral-200 transition-colors",children:"Members"}),e.jsx("button",{onClick:w,className:"grid h-8 w-8 place-items-center rounded-full bg-neutral-100 text-neutral-500 hover:bg-neutral-200 transition-colors",children:e.jsx(C,{className:"h-4 w-4"})})]})]}),me&&e.jsxs("div",{className:"absolute top-[60px] right-4 z-20 w-64 rounded-2xl border border-neutral-200 bg-white p-4 shadow-xl animate-in slide-in-from-top-2",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs font-bold text-neutral-500 uppercase tracking-wide",children:["Members (",k.length,")"]}),e.jsx("button",{onClick:()=>I(!1),children:e.jsx(C,{className:"h-3 w-3 text-neutral-400"})})]}),k.length===0?e.jsx("div",{className:"text-xs text-neutral-400",children:"No members yet."}):e.jsx("ul",{className:"max-h-60 overflow-y-auto space-y-1 pr-1",children:k.map(t=>{const r=te(t.user_id);return e.jsxs("li",{className:"flex items-center gap-3 rounded-lg px-2 py-2 hover:bg-neutral-50 transition-colors",children:[e.jsxs("div",{className:"relative",children:[t.avatar_url?e.jsx("img",{src:t.avatar_url,alt:"",className:"h-8 w-8 rounded-full object-cover border border-neutral-100"}):e.jsx("div",{className:"h-8 w-8 rounded-full bg-neutral-100 flex items-center justify-center text-[10px] font-bold text-neutral-500",children:(t.name||"").slice(0,2).toUpperCase()||"?"}),r&&e.jsx("span",{className:"absolute -bottom-0.5 -right-0.5 h-3 w-3 rounded-full bg-emerald-500 border-2 border-white"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"truncate text-sm font-semibold text-neutral-900",children:t.name&&t.name.trim()||"Player"}),r&&e.jsx("div",{className:"text-[10px] font-medium text-emerald-600 flex items-center gap-1",children:"Here with you"})]})]},t.user_id)})})]}),e.jsx("div",{className:"flex-1 overflow-hidden bg-white",children:e.jsx("div",{ref:B,className:"h-full overflow-y-auto p-4 space-y-6",onDrop:he,onDragOver:t=>t.preventDefault(),onClick:()=>L(null),children:oe&&p.length===0?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(ne,{className:"h-6 w-6 animate-spin text-neutral-300"})}):p.length===0?e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-3 text-center p-8",children:[e.jsx("div",{className:"h-16 w-16 bg-neutral-50 rounded-full flex items-center justify-center mb-2",children:e.jsx("span",{className:"text-3xl",children:"ðŸ‘‹"})}),e.jsx("h3",{className:"text-lg font-bold text-neutral-900",children:"No messages yet"}),e.jsx("p",{className:"text-sm text-neutral-500",children:"Be the first to break the ice!"})]}):e.jsxs(e.Fragment,{children:[p.map((t,r)=>{const s=!!m&&t.user_id===m,i=W.get(t.id)??{},l=te(t.user_id),n=!s&&(r===0||p[r-1].user_id!==t.user_id||new Date(t.created_at).getTime()-new Date(p[r-1].created_at).getTime()>3e5);return e.jsxs("div",{className:`group flex gap-3 ${s?"justify-end":"justify-start"} ${n?"mt-4":"mt-1"}`,"data-mid":t.id,children:[!s&&e.jsx("div",{className:"w-8 shrink-0 flex flex-col items-center",children:n&&fe(t.user_id)}),e.jsxs("div",{className:`flex max-w-[80%] flex-col ${s?"items-end":"items-start"}`,children:[n&&!s&&e.jsxs("div",{className:"ml-1 mb-1 flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-bold text-neutral-900",children:M(t.user_id)}),l&&e.jsxs("span",{className:"inline-flex items-center gap-0.5 rounded px-1.5 py-0.5 bg-emerald-50 text-[9px] font-bold text-emerald-600 uppercase tracking-wide border border-emerald-100",children:[e.jsx(we,{className:"h-2.5 w-2.5"})," HERE"]}),e.jsx("span",{className:"text-[10px] text-neutral-400 font-medium",children:le(t.created_at)})]}),e.jsxs("div",{className:"relative group/msg",children:[e.jsxs("div",{className:`relative px-4 py-2.5 text-sm leading-relaxed shadow-sm ${s?"bg-neutral-900 text-white rounded-2xl rounded-tr-sm":"bg-neutral-100 text-neutral-800 rounded-2xl rounded-tl-sm"}`,children:[t.parent_id&&(()=>{const a=p.find(o=>o.id===t.parent_id);return a?e.jsxs("div",{className:`mb-2 rounded-lg border-l-2 px-2 py-1 text-xs opacity-90 ${s?"border-neutral-500 bg-white/10":"border-neutral-300 bg-white"}`,children:[e.jsx("span",{className:"font-bold block mb-0.5",children:M(a.user_id)}),e.jsx("span",{className:"line-clamp-1",children:a.content})]}):null})(),e.jsx("div",{className:"whitespace-pre-wrap break-words",children:t.content}),xe(t.attachments)]}),e.jsxs("div",{className:`absolute top-1/2 -translate-y-1/2 opacity-0 group-hover/msg:opacity-100 transition-opacity flex gap-1 ${s?"right-full mr-2":"left-full ml-2"}`,children:[e.jsx("button",{onClick:()=>q(t),className:"p-1.5 rounded-full bg-neutral-100 hover:bg-neutral-200 text-neutral-500 hover:text-neutral-900 shadow-sm",children:e.jsx(ae,{className:"h-3.5 w-3.5"})}),e.jsx("button",{onClick:()=>L(Z===t.id?null:t.id),className:"p-1.5 rounded-full bg-neutral-100 hover:bg-neutral-200 text-neutral-500 hover:text-neutral-900 shadow-sm",children:e.jsx(Se,{className:"h-3.5 w-3.5"})})]}),Z===t.id&&e.jsx("div",{className:`absolute z-20 flex gap-1 p-1.5 bg-white rounded-full shadow-lg border border-neutral-200 ${s?"right-0 top-full mt-1":"left-0 top-full mt-1"}`,children:["ðŸ‘","â¤ï¸","ðŸ˜‚","ðŸ˜®","ðŸ˜¢"].map(a=>e.jsx("button",{onClick:()=>{re(t.id,a),L(null)},className:"hover:scale-125 transition-transform text-lg px-1",children:a},a))})]}),Object.keys(i).length>0&&e.jsx("div",{className:"mt-1 flex flex-wrap gap-1.5",children:Object.entries(i).map(([a,o])=>{const d=m?o.includes(m):!1;return e.jsxs("button",{onClick:()=>re(t.id,a),className:`flex items-center gap-1 rounded-full px-2 py-0.5 text-[10px] font-bold border transition-colors ${d?"bg-neutral-800 text-white border-neutral-800":"bg-white text-neutral-600 border-neutral-200 hover:border-neutral-300"}`,title:o.map(h=>M(h)).join(", "),children:[e.jsx("span",{children:a}),e.jsx("span",{children:o.length})]},a)})}),s&&e.jsx("div",{className:"mt-1 text-[9px] font-medium text-neutral-300 mr-1",children:le(t.created_at)})]})]},t.id)}),e.jsx("div",{ref:_,className:"h-2"})]})})}),Q&&e.jsx("div",{className:"absolute bottom-[70px] left-4 z-10 animate-in fade-in slide-in-from-bottom-2",children:e.jsxs("div",{className:"bg-white/90 backdrop-blur rounded-full px-3 py-1.5 text-xs font-medium text-neutral-500 shadow-sm border border-neutral-100 flex items-center gap-2",children:[e.jsxs("div",{className:"flex gap-0.5",children:[e.jsx("span",{className:"w-1 h-1 bg-neutral-400 rounded-full animate-bounce [animation-delay:-0.3s]"}),e.jsx("span",{className:"w-1 h-1 bg-neutral-400 rounded-full animate-bounce [animation-delay:-0.15s]"}),e.jsx("span",{className:"w-1 h-1 bg-neutral-400 rounded-full animate-bounce"})]}),Q," is typing..."]})}),e.jsxs("div",{className:"border-t border-neutral-100 bg-white p-3 sm:p-4",children:[P&&e.jsxs("div",{className:"mb-2 flex items-center justify-between rounded-lg bg-neutral-50 border border-neutral-100 px-3 py-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-3 w-3 text-neutral-400"}),e.jsxs("span",{className:"text-neutral-500",children:["Replying to ",e.jsx("span",{className:"font-bold text-neutral-800",children:M(P.user_id)})]})]}),e.jsx("button",{onClick:()=>q(null),className:"p-1 hover:bg-neutral-200 rounded-full",children:e.jsx(C,{className:"h-3 w-3 text-neutral-500"})})]}),b.length>0&&e.jsx("div",{className:"mb-2 flex gap-2 overflow-x-auto pb-2",children:b.map((t,r)=>e.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-neutral-50 px-3 py-2 text-xs font-medium text-neutral-700 border border-neutral-100",children:[e.jsx(V,{className:"h-3 w-3"}),e.jsx("span",{className:"max-w-[100px] truncate",children:t.name}),e.jsx("button",{onClick:()=>j(s=>s.filter((i,l)=>l!==r)),children:e.jsx(C,{className:"h-3 w-3 hover:text-red-500"})})]},r))}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsxs("label",{className:"flex h-10 w-10 shrink-0 cursor-pointer items-center justify-center rounded-full bg-neutral-50 text-neutral-500 hover:bg-neutral-100 hover:text-neutral-900 transition-colors",children:[e.jsx(V,{className:"h-5 w-5"}),e.jsx("input",{type:"file",multiple:!0,className:"hidden",onChange:t=>j(r=>[...r,...Array.from(t.target.files||[])])})]}),e.jsx("div",{className:"relative flex-1",children:e.jsx("textarea",{value:U,onChange:t=>K(t.target.value),onKeyDown:t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),se())},onPaste:pe,autoFocus:!0,placeholder:"Type a message...",rows:1,className:"w-full resize-none rounded-2xl border border-neutral-200 bg-neutral-50 px-4 py-2.5 text-sm text-neutral-900 placeholder-neutral-400 focus:border-neutral-300 focus:bg-white focus:outline-none focus:ring-0 max-h-32 transition-all",style:{minHeight:"42px"}})}),e.jsx("button",{onClick:se,disabled:F||A||!X||U.trim().length===0&&b.length===0,className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-neutral-900 text-white shadow-sm hover:bg-black disabled:bg-neutral-200 disabled:text-neutral-400 transition-all active:scale-95",children:A||F?e.jsx(ne,{className:"h-4 w-4 animate-spin"}):e.jsx(ve,{className:"h-4 w-4 ml-0.5"})})]})]})]})}export{Fe as default};
